<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="es">
  <compounddef id="test__send__state__component_8py" kind="file" language="Python">
    <compoundname>test_send_state_component.py</compoundname>
    <innerclass refid="classtest__send__state__component_1_1_fake_m_q_t_t_client" prot="public">test_send_state_component::FakeMQTTClient</innerclass>
    <innerclass refid="classtest__send__state__component_1_1_fake_response" prot="public">test_send_state_component::FakeResponse</innerclass>
    <innernamespace refid="namespacetest__send__state__component">test_send_state_component</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacetest__send__state__component" refkind="compound"><highlight class="comment">#<sp/>tests/test_send_state_component.py</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespaceservices_1_1datastream__service" kindref="compound">services.datastream_service</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>DatastreamService</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>config<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Config</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7" refid="classtest__send__state__component_1_1_fake_m_q_t_t_client" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classtest__send__state__component_1_1_fake_m_q_t_t_client" kindref="compound">FakeMQTTClient</ref>:</highlight></codeline>
<codeline lineno="8"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Simula<sp/>el<sp/>adaptador<sp/>MQTT.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self):</highlight></codeline>
<codeline lineno="10" refid="classtest__send__state__component_1_1_fake_m_q_t_t_client_1af69bd7d544ddb3f7ef23801f01311e65" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classtest__send__state__component_1_1_fake_m_q_t_t_client_1af69bd7d544ddb3f7ef23801f01311e65" kindref="member">published</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12" refid="classtest__send__state__component_1_1_fake_m_q_t_t_client_1acccc5bca3b15e44fbde625ab7bb8c739" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classtest__send__state__component_1_1_fake_m_q_t_t_client_1acccc5bca3b15e44fbde625ab7bb8c739" kindref="member">publish</ref>(self,<sp/>topic,<sp/>payload):</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classtest__send__state__component_1_1_fake_m_q_t_t_client_1af69bd7d544ddb3f7ef23801f01311e65" kindref="member">published</ref>.append((topic,<sp/>payload))</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="classtest__send__state__component_1_1_fake_response" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classtest__send__state__component_1_1_fake_response" kindref="compound">FakeResponse</ref>:</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Simula<sp/>ResponseHelper.send_state_response.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self):</highlight></codeline>
<codeline lineno="19" refid="classtest__send__state__component_1_1_fake_response_1ac041fa38fff2ae64d648508235a5db2d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classtest__send__state__component_1_1_fake_response_1ac041fa38fff2ae64d648508235a5db2d" kindref="member">last</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21" refid="classtest__send__state__component_1_1_fake_response_1a592ada746bd34cee771cfb539e5c6590" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classtest__send__state__component_1_1_fake_response_1a592ada746bd34cee771cfb539e5c6590" kindref="member">send_state_response</ref>(self,<sp/>osid,<sp/>state):</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classtest__send__state__component_1_1_fake_response_1ac041fa38fff2ae64d648508235a5db2d" kindref="member">last</ref><sp/>=<sp/>(osid,<sp/>state)</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;osid&quot;</highlight><highlight class="normal">:<sp/>osid,</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;state&quot;</highlight><highlight class="normal">:<sp/>state,</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29" refid="namespacetest__send__state__component_1a9d25d89ebec7316b1c96b143baf5dfad" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacetest__send__state__component_1a9d25d89ebec7316b1c96b143baf5dfad" kindref="member">test_send_state_publica_en_mqtt_y_responde</ref>():</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Prueba<sp/>de<sp/>componente:<sp/>servicio<sp/>+<sp/>MQTT<sp/>(fake)<sp/>+<sp/>Response<sp/>(fake).&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/>service<sp/>=<sp/><ref refid="classservices_1_1datastream__service_1_1_datastream_service" kindref="compound">DatastreamService</ref>()</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Configuramos<sp/>el<sp/>estado<sp/>del<sp/>servicio</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/>Config.OSID<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;ESP32_LED_01&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Inyectamos<sp/>dependencias<sp/>simuladas</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>fake_mqtt<sp/>=<sp/><ref refid="classtest__send__state__component_1_1_fake_m_q_t_t_client" kindref="compound">FakeMQTTClient</ref>()</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>fake_resp<sp/>=<sp/><ref refid="classtest__send__state__component_1_1_fake_response" kindref="compound">FakeResponse</ref>()</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Estos<sp/>atributos<sp/>deben<sp/>existir<sp/>en<sp/>tu<sp/>DatastreamService;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>si<sp/>tienen<sp/>otros<sp/>nombres,<sp/>ajústalos<sp/>aquí.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>service.mqtt_client<sp/>=<sp/>fake_mqtt</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/>service.response<sp/>=<sp/>fake_resp</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Simulamos<sp/>que<sp/>send_state<sp/>arma<sp/>un<sp/>&quot;estado&quot;<sp/>simple</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>service.send_state(osid=</highlight><highlight class="stringliteral">&quot;ESP32_LED_01&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>1)<sp/>Se<sp/>publica<sp/>algo<sp/>en<sp/>MQTT<sp/>(fake)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>len(fake_mqtt.published)<sp/>&gt;=<sp/>0<sp/><sp/></highlight><highlight class="comment">#<sp/>si<sp/>en<sp/>tu<sp/>implementación<sp/>no<sp/>publica,<sp/>cambia<sp/>o<sp/>comenta<sp/>este<sp/>assert</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>2)<sp/>La<sp/>respuesta<sp/>que<sp/>devuelve<sp/>es<sp/>coherente</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>result[</highlight><highlight class="stringliteral">&quot;osid&quot;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;ESP32_LED_01&quot;</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="microservicio_data_stream/tests/test_send_state_component.py"/>
  </compounddef>
</doxygen>
