<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="es">
  <compounddef id="microdot_8py" kind="file" language="Python">
    <compoundname>microdot.py</compoundname>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict" prot="public">lib::microdot::microdot::NoCaseDict</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict" prot="public">lib::microdot::microdot::MultiDict</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o" prot="public">lib::microdot::microdot::AsyncBytesIO</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_request" prot="public">lib::microdot::microdot::Request</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_request_1_1_g" prot="public">lib::microdot::microdot::Request::G</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_response" prot="public">lib::microdot::microdot::Response</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern" prot="public">lib::microdot::microdot::URLPattern</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception" prot="public">lib::microdot::microdot::HTTPException</innerclass>
    <innerclass refid="classlib_1_1microdot_1_1microdot_1_1_microdot" prot="public">lib::microdot::microdot::Microdot</innerclass>
    <innernamespace refid="namespacelib">lib</innernamespace>
    <innernamespace refid="namespacelib_1_1microdot">lib::microdot</innernamespace>
    <innernamespace refid="namespacelib_1_1microdot_1_1microdot">lib::microdot::microdot</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacelib_1_1microdot_1_1microdot" refkind="compound"><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2"><highlight class="stringliteral">microdot</highlight></codeline>
<codeline lineno="3"><highlight class="stringliteral">--------</highlight></codeline>
<codeline lineno="4"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="5"><highlight class="stringliteral">The<sp/>``microdot``<sp/>module<sp/>defines<sp/>a<sp/>few<sp/>classes<sp/>that<sp/>help<sp/>implement<sp/>HTTP-based</highlight></codeline>
<codeline lineno="6"><highlight class="stringliteral">servers<sp/>for<sp/>MicroPython<sp/>and<sp/>standard<sp/>Python.</highlight></codeline>
<codeline lineno="7"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>asyncio</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>io</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>re</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>time</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>orjson<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>json</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>json</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>inspect<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>iscoroutinefunction,<sp/>iscoroutine</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>functools<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>partial</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22" refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(handler,<sp/>*args,<sp/>**kwargs):</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Invoke<sp/>a<sp/>handler<sp/>and<sp/>return<sp/>the<sp/>result.</highlight></codeline>
<codeline lineno="24"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="25"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>runs<sp/>sync<sp/>handlers<sp/>in<sp/>a<sp/>thread<sp/>pool<sp/>executor.</highlight></codeline>
<codeline lineno="26"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>iscoroutinefunction(handler):</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/>await<sp/>handler(*args,<sp/>**kwargs)</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/>await<sp/>asyncio.get_running_loop().run_in_executor(</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>partial(handler,<sp/>*args,<sp/>**kwargs))</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="namespacelib_1_1microdot_1_1microdot_1a3ad5db3c17e73adbb3fa7be466a799e0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a3ad5db3c17e73adbb3fa7be466a799e0" kindref="member">iscoroutine</ref>(coro):</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hasattr(coro,<sp/></highlight><highlight class="stringliteral">&apos;send&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>hasattr(coro,<sp/></highlight><highlight class="stringliteral">&apos;throw&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(handler,<sp/>*args,<sp/>**kwargs):</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Invoke<sp/>a<sp/>handler<sp/>and<sp/>return<sp/>the<sp/>result.</highlight></codeline>
<codeline lineno="39"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="40"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>runs<sp/>sync<sp/>handlers<sp/>in<sp/>the<sp/>asyncio<sp/>thread,<sp/>which<sp/>can</highlight></codeline>
<codeline lineno="41"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>potentially<sp/>cause<sp/>blocking<sp/>and<sp/>performance<sp/>issues.</highlight></codeline>
<codeline lineno="42"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/>handler(*args,<sp/>**kwargs)</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a3ad5db3c17e73adbb3fa7be466a799e0" kindref="member">iscoroutine</ref>(ret):</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/>await<sp/>ret</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>sys<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>print_exception</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>traceback</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="namespacelib_1_1microdot_1_1microdot_1a7dc11fdc825cde8a3020a273d44cc9c1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a7dc11fdc825cde8a3020a273d44cc9c1" kindref="member">print_exception</ref>(exc):</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>traceback.print_exc()</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="namespacelib_1_1microdot_1_1microdot_1a3894b36712c381fc5f90701ab5eee744" refkind="member"><highlight class="normal">MUTED_SOCKET_ERRORS<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>32,<sp/><sp/></highlight><highlight class="comment">#<sp/>Broken<sp/>pipe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>54,<sp/><sp/></highlight><highlight class="comment">#<sp/>Connection<sp/>reset<sp/>by<sp/>peer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>104,<sp/><sp/></highlight><highlight class="comment">#<sp/>Connection<sp/>reset<sp/>by<sp/>peer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>128,<sp/><sp/></highlight><highlight class="comment">#<sp/>Operation<sp/>on<sp/>closed<sp/>socket</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal">]</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="namespacelib_1_1microdot_1_1microdot_1a90e22c7db22353d712b3f744a463647f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a90e22c7db22353d712b3f744a463647f" kindref="member">urldecode</ref>(s):</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(s,<sp/>str):</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>=<sp/>s.encode()</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>s<sp/>=<sp/>s.replace(b</highlight><highlight class="stringliteral">&apos;+&apos;</highlight><highlight class="normal">,<sp/>b</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>parts<sp/>=<sp/>s.split(b</highlight><highlight class="stringliteral">&apos;%&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(parts)<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s.decode()</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>[parts[0]]</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>item<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>parts[1:]:</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>item<sp/>==<sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(b</highlight><highlight class="stringliteral">&apos;%&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>code<sp/>=<sp/>item[:2]</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(bytes([int(code,<sp/>16)]))</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(item[2:])</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">.join(result).decode()</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82" refid="namespacelib_1_1microdot_1_1microdot_1a93cf47811feb6dc5b3dfcaea67693427" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a93cf47811feb6dc5b3dfcaea67693427" kindref="member">urlencode</ref>(s):</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s.replace(</highlight><highlight class="stringliteral">&apos;+&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;%2B&apos;</highlight><highlight class="normal">).replace(</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;+&apos;</highlight><highlight class="normal">).replace(</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;%25&apos;</highlight><highlight class="normal">).replace(</highlight><highlight class="stringliteral">&apos;?&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;%3F&apos;</highlight><highlight class="normal">).replace(</highlight><highlight class="stringliteral">&apos;#&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;%23&apos;</highlight><highlight class="normal">).replace(</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&amp;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;%26&apos;</highlight><highlight class="normal">).replace(</highlight><highlight class="stringliteral">&apos;=&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;%3D&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict" kindref="compound">NoCaseDict</ref>(dict):</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>subclass<sp/>of<sp/>dictionary<sp/>that<sp/>holds<sp/>case-insensitive<sp/>keys.</highlight></codeline>
<codeline lineno="90"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="91"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:param<sp/>initial_dict:<sp/>an<sp/>initial<sp/>dictionary<sp/>of<sp/>key/value<sp/>pairs<sp/>to</highlight></codeline>
<codeline lineno="92"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initialize<sp/>this<sp/>object<sp/>with.</highlight></codeline>
<codeline lineno="93"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="94"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="95"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="96"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d<sp/>=<sp/>NoCaseDict()</highlight></codeline>
<codeline lineno="97"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d[&apos;Content-Type&apos;]<sp/>=<sp/>&apos;text/html&apos;</highlight></codeline>
<codeline lineno="98"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(d[&apos;Content-Type&apos;])</highlight></codeline>
<codeline lineno="99"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text/html</highlight></codeline>
<codeline lineno="100"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(d[&apos;content-type&apos;])</highlight></codeline>
<codeline lineno="101"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text/html</highlight></codeline>
<codeline lineno="102"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(d[&apos;CONTENT-TYPE&apos;])</highlight></codeline>
<codeline lineno="103"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text/html</highlight></codeline>
<codeline lineno="104"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>del<sp/>d[&apos;cOnTeNt-TyPe&apos;]</highlight></codeline>
<codeline lineno="105"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(d)</highlight></codeline>
<codeline lineno="106"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{}</highlight></codeline>
<codeline lineno="107"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>initial_dict=None):</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().__init__(initial_dict<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>{})</highlight></codeline>
<codeline lineno="110" refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" kindref="member">keymap</ref><sp/>=<sp/>{k.lower():<sp/>k<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.keys()<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k.lower()<sp/>!=<sp/>k}</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__setitem__(self,<sp/>key,<sp/>value):</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kl<sp/>=<sp/>key.lower()</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>key<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" kindref="member">keymap</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" kindref="member">get</ref>(kl,<sp/>key)</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>kl<sp/>!=<sp/>key:</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" kindref="member">keymap</ref>[kl]<sp/>=<sp/>key</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().__setitem__(key,<sp/>value)</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__getitem__(self,<sp/>key):</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kl<sp/>=<sp/>key.lower()</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>super().__getitem__(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" kindref="member">keymap</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" kindref="member">get</ref>(kl,<sp/>kl))</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__delitem__(self,<sp/>key):</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kl<sp/>=<sp/>key.lower()</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().__delitem__(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" kindref="member">keymap</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" kindref="member">get</ref>(kl,<sp/>kl))</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__contains__(self,<sp/>key):</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kl<sp/>=<sp/>key.lower()</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" kindref="member">keymap</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" kindref="member">get</ref>(kl,<sp/>kl)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.keys()</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131" refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" kindref="member">get</ref>(self,<sp/>key,<sp/>default=None):</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kl<sp/>=<sp/>key.lower()</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>super().<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" kindref="member">get</ref>(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a860a7ce48d7c8bed8e77ff336aca336b" kindref="member">keymap</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1ad410c242a813b8919b33411e570daffb" kindref="member">get</ref>(kl,<sp/>kl),<sp/>default)</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135" refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a0b308b6cbbd443898c3bbe0e94fc61a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict_1a0b308b6cbbd443898c3bbe0e94fc61a3" kindref="member">update</ref>(self,<sp/>other_dict):</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>key,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>other_dict.items():</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self[key]<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="namespacelib_1_1microdot_1_1microdot_1a6053923ec11384d589f74a5ec12ea3f2" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a6053923ec11384d589f74a5ec12ea3f2" kindref="member">mro</ref>(cls):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>method<sp/>resolution<sp/>order<sp/>of<sp/>a<sp/>class.</highlight></codeline>
<codeline lineno="142"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="143"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>is<sp/>a<sp/>helper<sp/>function<sp/>that<sp/>returns<sp/>the<sp/>method<sp/>resolution<sp/>order<sp/>of<sp/>a</highlight></codeline>
<codeline lineno="144"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>class.<sp/>It<sp/>is<sp/>used<sp/>by<sp/>Microdot<sp/>to<sp/>find<sp/>the<sp/>best<sp/>error<sp/>handler<sp/>to<sp/>invoke<sp/>for</highlight></codeline>
<codeline lineno="145"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>raised<sp/>exception.</highlight></codeline>
<codeline lineno="146"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="147"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>In<sp/>CPython,<sp/>this<sp/>function<sp/>returns<sp/>the<sp/>``__mro__``<sp/>attribute<sp/>of<sp/>the<sp/>class.</highlight></codeline>
<codeline lineno="148"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>In<sp/>MicroPython,<sp/>this<sp/>function<sp/>implements<sp/>a<sp/>recursive<sp/>depth-first<sp/>scanning</highlight></codeline>
<codeline lineno="149"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>the<sp/>class<sp/>hierarchy.</highlight></codeline>
<codeline lineno="150"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(cls,<sp/></highlight><highlight class="stringliteral">&apos;mro&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cls.__mro__</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">_mro(cls):</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m<sp/>=<sp/>[cls]</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>base<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>cls.__bases__:</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m<sp/>+=<sp/>_mro(base)</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>mro_list<sp/>=<sp/>_mro(cls)</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>a<sp/>class<sp/>appears<sp/>multiple<sp/>times<sp/>(due<sp/>to<sp/>multiple<sp/>inheritance)<sp/>remove</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>all<sp/>but<sp/>the<sp/>last<sp/>occurence.<sp/>This<sp/>matches<sp/>the<sp/>method<sp/>resolution<sp/>order</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>of<sp/>MicroPython,<sp/>but<sp/>not<sp/>CPython.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>mro_pruned<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(mro_list)):</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base<sp/>=<sp/>mro_list.pop(0)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>base<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>mro_list:</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mro_pruned.append(base)</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mro_pruned</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173" refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict" kindref="compound">MultiDict</ref>(dict):</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>subclass<sp/>of<sp/>dictionary<sp/>that<sp/>can<sp/>hold<sp/>multiple<sp/>values<sp/>for<sp/>the<sp/>same</highlight></codeline>
<codeline lineno="175"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>key.<sp/>It<sp/>is<sp/>used<sp/>to<sp/>hold<sp/>key/value<sp/>pairs<sp/>decoded<sp/>from<sp/>query<sp/>strings<sp/>and</highlight></codeline>
<codeline lineno="176"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>form<sp/>submissions.</highlight></codeline>
<codeline lineno="177"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="178"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:param<sp/>initial_dict:<sp/>an<sp/>initial<sp/>dictionary<sp/>of<sp/>key/value<sp/>pairs<sp/>to</highlight></codeline>
<codeline lineno="179"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initialize<sp/>this<sp/>object<sp/>with.</highlight></codeline>
<codeline lineno="180"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="181"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="182"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="183"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d<sp/>=<sp/>MultiDict()</highlight></codeline>
<codeline lineno="184"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d[&apos;sort&apos;]<sp/>=<sp/>&apos;name&apos;</highlight></codeline>
<codeline lineno="185"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d[&apos;sort&apos;]<sp/>=<sp/>&apos;email&apos;</highlight></codeline>
<codeline lineno="186"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(d[&apos;sort&apos;])</highlight></codeline>
<codeline lineno="187"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;name&apos;</highlight></codeline>
<codeline lineno="188"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(d.getlist(&apos;sort&apos;))</highlight></codeline>
<codeline lineno="189"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&apos;name&apos;,<sp/>&apos;email&apos;]</highlight></codeline>
<codeline lineno="190"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>initial_dict=None):</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().__init__()</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>initial_dict:</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>key,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>initial_dict.items():</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self[key]<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__setitem__(self,<sp/>key,<sp/>value):</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>key<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self:</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().__setitem__(key,<sp/>[])</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().__getitem__(key).append(value)</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__getitem__(self,<sp/>key):</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>super().__getitem__(key)[0]</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205" refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict_1a7fa109baf2477b0dcc91da666e5babee" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict_1a7fa109baf2477b0dcc91da666e5babee" kindref="member">get</ref>(self,<sp/>key,<sp/>default=None,<sp/>type=None):</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>value<sp/>for<sp/>a<sp/>given<sp/>key.</highlight></codeline>
<codeline lineno="207"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="208"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>key:<sp/>The<sp/>key<sp/>to<sp/>retrieve.</highlight></codeline>
<codeline lineno="209"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>default:<sp/>A<sp/>default<sp/>value<sp/>to<sp/>use<sp/>if<sp/>the<sp/>key<sp/>does<sp/>not<sp/>exist.</highlight></codeline>
<codeline lineno="210"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>type:<sp/>A<sp/>type<sp/>conversion<sp/>callable<sp/>to<sp/>apply<sp/>to<sp/>the<sp/>value.</highlight></codeline>
<codeline lineno="211"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>the<sp/>multidict<sp/>contains<sp/>more<sp/>than<sp/>one<sp/>value<sp/>for<sp/>the<sp/>requested<sp/>key,</highlight></codeline>
<codeline lineno="213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>method<sp/>returns<sp/>the<sp/>first<sp/>value<sp/>only.</highlight></codeline>
<codeline lineno="214"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="215"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="216"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="217"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d<sp/>=<sp/>MultiDict()</highlight></codeline>
<codeline lineno="218"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d[&apos;age&apos;]<sp/>=<sp/>&apos;42&apos;</highlight></codeline>
<codeline lineno="219"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d.get(&apos;age&apos;)</highlight></codeline>
<codeline lineno="220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;42&apos;</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d.get(&apos;age&apos;,<sp/>type=int)</highlight></codeline>
<codeline lineno="222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>42</highlight></codeline>
<codeline lineno="223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d.get(&apos;name&apos;,<sp/>default=&apos;noname&apos;)</highlight></codeline>
<codeline lineno="224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;noname&apos;</highlight></codeline>
<codeline lineno="225"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>key<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self:</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>default</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>self[key]</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>type<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>type(value)</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>value</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233" refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict_1af824502ae43042a72a80f2ab57d22ab1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict_1af824502ae43042a72a80f2ab57d22ab1" kindref="member">getlist</ref>(self,<sp/>key,<sp/>type=None):</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>all<sp/>the<sp/>values<sp/>for<sp/>a<sp/>given<sp/>key.</highlight></codeline>
<codeline lineno="235"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="236"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>key:<sp/>The<sp/>key<sp/>to<sp/>retrieve.</highlight></codeline>
<codeline lineno="237"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>type:<sp/>A<sp/>type<sp/>conversion<sp/>callable<sp/>to<sp/>apply<sp/>to<sp/>the<sp/>values.</highlight></codeline>
<codeline lineno="238"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="239"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>the<sp/>requested<sp/>key<sp/>does<sp/>not<sp/>exist<sp/>in<sp/>the<sp/>dictionary,<sp/>this<sp/>method</highlight></codeline>
<codeline lineno="240"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>an<sp/>empty<sp/>list.</highlight></codeline>
<codeline lineno="241"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="242"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="243"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="244"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d<sp/>=<sp/>MultiDict()</highlight></codeline>
<codeline lineno="245"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d.getlist(&apos;items&apos;)</highlight></codeline>
<codeline lineno="246"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[]</highlight></codeline>
<codeline lineno="247"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d[&apos;items&apos;]<sp/>=<sp/>&apos;3&apos;</highlight></codeline>
<codeline lineno="248"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d.getlist(&apos;items&apos;)</highlight></codeline>
<codeline lineno="249"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&apos;3&apos;]</highlight></codeline>
<codeline lineno="250"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d[&apos;items&apos;]<sp/>=<sp/>&apos;56&apos;</highlight></codeline>
<codeline lineno="251"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d.getlist(&apos;items&apos;)</highlight></codeline>
<codeline lineno="252"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&apos;3&apos;,<sp/>&apos;56&apos;]</highlight></codeline>
<codeline lineno="253"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>d.getlist(&apos;items&apos;,<sp/>type=int)</highlight></codeline>
<codeline lineno="254"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[3,<sp/>56]</highlight></codeline>
<codeline lineno="255"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>key<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self:</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[]</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>=<sp/>super().__getitem__(key)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>type<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>=<sp/>[type(value)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>values]</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>values</highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o" kindref="compound">AsyncBytesIO</ref>:</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;An<sp/>async<sp/>wrapper<sp/>for<sp/>BytesIO.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>data):</highlight></codeline>
<codeline lineno="267" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a61f5e6461aa054c872ad288331d4de5d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a61f5e6461aa054c872ad288331d4de5d" kindref="member">stream</ref><sp/>=<sp/>io.BytesIO(data)</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a7eaf06eeff4187c21b027f330466fc5e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a7eaf06eeff4187c21b027f330466fc5e" kindref="member">read</ref>(self,<sp/>n=-1):</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a61f5e6461aa054c872ad288331d4de5d" kindref="member">stream</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a7eaf06eeff4187c21b027f330466fc5e" kindref="member">read</ref>(n)</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1aa0bd70a4c3ded4feb05fef43def3dd36" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1aa0bd70a4c3ded4feb05fef43def3dd36" kindref="member">readline</ref>(self):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a61f5e6461aa054c872ad288331d4de5d" kindref="member">stream</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1aa0bd70a4c3ded4feb05fef43def3dd36" kindref="member">readline</ref>()</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a39cd0d29f8e2597239776bce76f863c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a39cd0d29f8e2597239776bce76f863c8" kindref="member">readexactly</ref>(self,<sp/>n):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a61f5e6461aa054c872ad288331d4de5d" kindref="member">stream</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a7eaf06eeff4187c21b027f330466fc5e" kindref="member">read</ref>(n)</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a51b2b4e632dc6aaae1cb5f594d315e28" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a51b2b4e632dc6aaae1cb5f594d315e28" kindref="member">readuntil</ref>(self,<sp/>separator=b&apos;\n&apos;):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a61f5e6461aa054c872ad288331d4de5d" kindref="member">stream</ref>.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a51b2b4e632dc6aaae1cb5f594d315e28" kindref="member">readuntil</ref>(separator=separator)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a4162d51f65963860040be5eb6adac732" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a4162d51f65963860040be5eb6adac732" kindref="member">awrite</ref>(self,<sp/>data):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1a61f5e6461aa054c872ad288331d4de5d" kindref="member">stream</ref>.write(data)</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284" refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1adbcb74fce8f60505d9a757c692b0d570" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o_1adbcb74fce8f60505d9a757c692b0d570" kindref="member">aclose</ref>(self):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288" refid="classlib_1_1microdot_1_1microdot_1_1_request" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">Request:</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;An<sp/>HTTP<sp/>request.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Specify<sp/>the<sp/>maximum<sp/>payload<sp/>size<sp/>that<sp/>is<sp/>accepted.<sp/>Requests<sp/>with<sp/>larger</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>payloads<sp/>will<sp/>be<sp/>rejected<sp/>with<sp/>a<sp/>413<sp/>status<sp/>code.<sp/>Applications<sp/>can</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>change<sp/>this<sp/>maximum<sp/>as<sp/>necessary.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Example::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/><sp/><sp/><sp/>Request.max_content_length<sp/>=<sp/>1<sp/>*<sp/>1024<sp/>*<sp/>1024<sp/><sp/>#<sp/>1MB<sp/>requests<sp/>allowed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a0d1b43a1562f23e423404fd764c88cd9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>max_content_length<sp/>=<sp/>16<sp/>*<sp/>1024</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Specify<sp/>the<sp/>maximum<sp/>payload<sp/>size<sp/>that<sp/>can<sp/>be<sp/>stored<sp/>in<sp/>``body``.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Requests<sp/>with<sp/>payloads<sp/>that<sp/>are<sp/>larger<sp/>than<sp/>this<sp/>size<sp/>and<sp/>up<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>``max_content_length``<sp/>bytes<sp/>will<sp/>be<sp/>accepted,<sp/>but<sp/>the<sp/>application<sp/>will</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>only<sp/>be<sp/>able<sp/>to<sp/>access<sp/>the<sp/>body<sp/>of<sp/>the<sp/>request<sp/>by<sp/>reading<sp/>from</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>``stream``.<sp/>Set<sp/>to<sp/>0<sp/>if<sp/>you<sp/>always<sp/>access<sp/>the<sp/>body<sp/>as<sp/>a<sp/>stream.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Example::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/><sp/><sp/><sp/>Request.max_body_length<sp/>=<sp/>4<sp/>*<sp/>1024<sp/><sp/>#<sp/>up<sp/>to<sp/>4KB<sp/>bodies<sp/>read</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a310e42bbe60f4c545f23e9c52ecf7f17" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>max_body_length<sp/>=<sp/>16<sp/>*<sp/>1024</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Specify<sp/>the<sp/>maximum<sp/>length<sp/>allowed<sp/>for<sp/>a<sp/>line<sp/>in<sp/>the<sp/>request.<sp/>Requests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>with<sp/>longer<sp/>lines<sp/>will<sp/>not<sp/>be<sp/>correctly<sp/>interpreted.<sp/>Applications<sp/>can</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>change<sp/>this<sp/>maximum<sp/>as<sp/>necessary.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Example::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/><sp/><sp/><sp/>Request.max_readline<sp/>=<sp/>16<sp/>*<sp/>1024<sp/><sp/>#<sp/>16KB<sp/>lines<sp/>allowed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a5484822cc078878a5a242907ca628974" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>max_readline<sp/>=<sp/>2<sp/>*<sp/>1024</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319" refid="classlib_1_1microdot_1_1microdot_1_1_request_1_1_g" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1_1_g" kindref="compound">G</ref>:</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>app,<sp/>client_addr,<sp/>method,<sp/>url,<sp/>http_version,<sp/>headers,</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body=None,<sp/>stream=None,<sp/>sock=None,<sp/>url_prefix=&apos;&apos;,</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subapp=None):</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>application<sp/>instance<sp/>to<sp/>which<sp/>this<sp/>request<sp/>belongs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a76d9b530ec277b6cfd21b2dc374be52e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a76d9b530ec277b6cfd21b2dc374be52e" kindref="member">app</ref><sp/>=<sp/>app</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>address<sp/>of<sp/>the<sp/>client,<sp/>as<sp/>a<sp/>tuple<sp/>(host,<sp/>port).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ab8273eaf8bf9dcef03869396098067f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ab8273eaf8bf9dcef03869396098067f6" kindref="member">client_addr</ref><sp/>=<sp/>client_addr</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>HTTP<sp/>method<sp/>of<sp/>the<sp/>request.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ad9ba6a3fc4cf4d11a7159957ff320d55" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ad9ba6a3fc4cf4d11a7159957ff320d55" kindref="member">method</ref><sp/>=<sp/>method</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>request<sp/>URL,<sp/>including<sp/>the<sp/>path<sp/>and<sp/>query<sp/>string.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a18800da7d87f17dbe0884001ab26a55f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a18800da7d87f17dbe0884001ab26a55f" kindref="member">url</ref><sp/>=<sp/>url</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>URL<sp/>prefix,<sp/>if<sp/>the<sp/>endpoint<sp/>comes<sp/>from<sp/>a<sp/>mounted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>sub-application,<sp/>or<sp/>else<sp/>&apos;&apos;.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6e5ab8568928d538d7101d9e95ff9762" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6e5ab8568928d538d7101d9e95ff9762" kindref="member">url_prefix</ref><sp/>=<sp/>url_prefix</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>sub-application<sp/>instance,<sp/>or<sp/>`None`<sp/>if<sp/>this<sp/>isn&apos;t<sp/>a<sp/>mounted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>endpoint.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a04f6facbd996bd649890963a6916ae30" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a04f6facbd996bd649890963a6916ae30" kindref="member">subapp</ref><sp/>=<sp/>subapp</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>path<sp/>portion<sp/>of<sp/>the<sp/>URL.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6ef7372aaff0e4eda7adead89f37e212" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6ef7372aaff0e4eda7adead89f37e212" kindref="member">path</ref><sp/>=<sp/>url</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>query<sp/>string<sp/>portion<sp/>of<sp/>the<sp/>URL.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="342" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a0f6a8005f72dbe3fa045945588909fcd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a0f6a8005f72dbe3fa045945588909fcd" kindref="member">query_string</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>parsed<sp/>query<sp/>string,<sp/>as<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>:class:`MultiDict<sp/>&lt;microdot.MultiDict&gt;`<sp/>object.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a9af45af34e30356da81fcd3c963207de" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a9af45af34e30356da81fcd3c963207de" kindref="member">args</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>A<sp/>dictionary<sp/>with<sp/>the<sp/>headers<sp/>included<sp/>in<sp/>the<sp/>request.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" kindref="member">headers</ref><sp/>=<sp/>headers</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>A<sp/>dictionary<sp/>with<sp/>the<sp/>cookies<sp/>included<sp/>in<sp/>the<sp/>request.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a3661e55461801ad82c454f2c1b84220b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a3661e55461801ad82c454f2c1b84220b" kindref="member">cookies</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>parsed<sp/>``Content-Length``<sp/>header.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a205377c2cef19a2395156493fd2801ea" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a205377c2cef19a2395156493fd2801ea" kindref="member">content_length</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>parsed<sp/>``Content-Type``<sp/>header.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a03588645edf4a3ee1db7f1ed5d47b7af" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a03588645edf4a3ee1db7f1ed5d47b7af" kindref="member">content_type</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>A<sp/>general<sp/>purpose<sp/>container<sp/>for<sp/>applications<sp/>to<sp/>store<sp/>data<sp/>during</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>the<sp/>life<sp/>of<sp/>the<sp/>request.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ad243b75027929cf3f41ddd7fc5d72df2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ad243b75027929cf3f41ddd7fc5d72df2" kindref="member">g</ref><sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1_1_g" kindref="compound">Request.G</ref>()</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6195f21229fbd556c8c12aa3dd8b8e99" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6195f21229fbd556c8c12aa3dd8b8e99" kindref="member">http_version</ref><sp/>=<sp/>http_version</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;?&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6ef7372aaff0e4eda7adead89f37e212" kindref="member">path</ref>:</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6ef7372aaff0e4eda7adead89f37e212" kindref="member">path</ref>,<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a0f6a8005f72dbe3fa045945588909fcd" kindref="member">query_string</ref><sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a6ef7372aaff0e4eda7adead89f37e212" kindref="member">path</ref>.split(</highlight><highlight class="stringliteral">&apos;?&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a9af45af34e30356da81fcd3c963207de" kindref="member">args</ref><sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a7d04d1ba304bc9fcd03f7721a1a116f3" kindref="member">_parse_urlencoded</ref>(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a0f6a8005f72dbe3fa045945588909fcd" kindref="member">query_string</ref>)</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Content-Length&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" kindref="member">headers</ref>:</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a205377c2cef19a2395156493fd2801ea" kindref="member">content_length</ref><sp/>=<sp/>int(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Content-Length&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" kindref="member">headers</ref>:</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a03588645edf4a3ee1db7f1ed5d47b7af" kindref="member">content_type</ref><sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Cookie&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" kindref="member">headers</ref>:</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cookie<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a86b47b9e2407864d5efbb9ba999423b2" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Cookie&apos;</highlight><highlight class="normal">].split(</highlight><highlight class="stringliteral">&apos;;&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>cookie.strip().split(</highlight><highlight class="stringliteral">&apos;=&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a3661e55461801ad82c454f2c1b84220b" kindref="member">cookies</ref>[c[0]]<sp/>=<sp/>c[1]<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(c)<sp/>&gt;<sp/>1<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a47d8e8d658f557303ebce5bd5052e03a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a47d8e8d658f557303ebce5bd5052e03a" kindref="member">_body</ref><sp/>=<sp/>body</highlight></codeline>
<codeline lineno="373" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ab5907ab2ba81a98f029839ac31c8fb3e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ab5907ab2ba81a98f029839ac31c8fb3e" kindref="member">body_used</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac62f483c0d118e26c5084e961cb17f46" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac62f483c0d118e26c5084e961cb17f46" kindref="member">_stream</ref><sp/>=<sp/>stream</highlight></codeline>
<codeline lineno="375" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a476d57980178a129fdfdcc452de662c2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a476d57980178a129fdfdcc452de662c2" kindref="member">sock</ref><sp/>=<sp/>sock</highlight></codeline>
<codeline lineno="376" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a97c3f5f65252ec6d285883b482c88e3d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a97c3f5f65252ec6d285883b482c88e3d" kindref="member">_json</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ae70867cd561916ac37b4c6cb27dcc654" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ae70867cd561916ac37b4c6cb27dcc654" kindref="member">_form</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378" refid="classlib_1_1microdot_1_1microdot_1_1_request_1aa60156319fb36b89c368fe12db459165" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1aa60156319fb36b89c368fe12db459165" kindref="member">_files</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a92c3bf7d42647bd839a1a1323f16df79" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a92c3bf7d42647bd839a1a1323f16df79" kindref="member">after_request_handlers</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@staticmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382" refid="classlib_1_1microdot_1_1microdot_1_1_request_1aaf2e1c0659ea9befc447f8c9ef3f0a0b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1aaf2e1c0659ea9befc447f8c9ef3f0a0b" kindref="member">create</ref>(app,<sp/>client_reader,<sp/>client_writer,<sp/>client_addr):</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Create<sp/>a<sp/>request<sp/>object.</highlight></codeline>
<codeline lineno="384"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="385"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>app:<sp/>The<sp/>Microdot<sp/>application<sp/>instance.</highlight></codeline>
<codeline lineno="386"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>client_reader:<sp/>An<sp/>input<sp/>stream<sp/>from<sp/>where<sp/>the<sp/>request<sp/>data<sp/>can</highlight></codeline>
<codeline lineno="387"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>read.</highlight></codeline>
<codeline lineno="388"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>client_writer:<sp/>An<sp/>output<sp/>stream<sp/>where<sp/>the<sp/>response<sp/>data<sp/>can<sp/>be</highlight></codeline>
<codeline lineno="389"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>written.</highlight></codeline>
<codeline lineno="390"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>client_addr:<sp/>The<sp/>address<sp/>of<sp/>the<sp/>client,<sp/>as<sp/>a<sp/>tuple.</highlight></codeline>
<codeline lineno="391"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="392"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>is<sp/>a<sp/>coroutine.<sp/>It<sp/>returns<sp/>a<sp/>newly<sp/>created<sp/>``Request``</highlight></codeline>
<codeline lineno="393"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object.</highlight></codeline>
<codeline lineno="394"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>request<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>(await<sp/>Request._safe_readline(client_reader)).strip().decode()</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>line:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method,<sp/>url,<sp/>http_version<sp/>=<sp/>line.split()</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_version<sp/>=<sp/>http_version.split(</highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">,<sp/>1)[1]</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict" kindref="compound">NoCaseDict</ref>()</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content_length<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>(await<sp/>Request._safe_readline(</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client_reader)).strip().decode()</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>line<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header,<sp/>value<sp/>=<sp/>line.split(</highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>value.strip()</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers[header]<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>header.lower()<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;content-length&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content_length<sp/>=<sp/>int(value)</highlight></codeline>
<codeline lineno="415"><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>body</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body<sp/>=<sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>content_length<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>content_length<sp/>&lt;=<sp/>Request.max_body_length:</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body<sp/>=<sp/>await<sp/>client_reader.readexactly(content_length)</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body<sp/>=<sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>=<sp/>client_reader</highlight></codeline>
<codeline lineno="424"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_request" kindref="compound">Request</ref>(app,<sp/>client_addr,<sp/>method,<sp/>url,<sp/>http_version,<sp/>headers,</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body=body,<sp/>stream=stream,</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock=(client_reader,<sp/>client_writer))</highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight></codeline>
<codeline lineno="429" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a7d04d1ba304bc9fcd03f7721a1a116f3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a7d04d1ba304bc9fcd03f7721a1a116f3" kindref="member">_parse_urlencoded</ref>(self,<sp/>urlencoded):</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_multi_dict" kindref="compound">MultiDict</ref>()</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(urlencoded)<sp/>&gt;<sp/>0:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>branch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(urlencoded,<sp/>str):</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>kv<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>[pair.split(</highlight><highlight class="stringliteral">&apos;=&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>pair<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>urlencoded.split(</highlight><highlight class="stringliteral">&apos;&amp;&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pair]:</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data[<ref refid="namespacelib_1_1microdot_1_1microdot_1a90e22c7db22353d712b3f744a463647f" kindref="member">urldecode</ref>(kv[0])]<sp/>=<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a90e22c7db22353d712b3f744a463647f" kindref="member">urldecode</ref>(kv[1])<sp/>\</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(kv)<sp/>&gt;<sp/>1<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(urlencoded,<sp/>bytes):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>branch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>kv<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>[pair.split(b</highlight><highlight class="stringliteral">&apos;=&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>pair<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>urlencoded.split(b</highlight><highlight class="stringliteral">&apos;&amp;&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pair]:</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data[<ref refid="namespacelib_1_1microdot_1_1microdot_1a90e22c7db22353d712b3f744a463647f" kindref="member">urldecode</ref>(kv[0])]<sp/>=<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a90e22c7db22353d712b3f744a463647f" kindref="member">urldecode</ref>(kv[1])<sp/>\</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(kv)<sp/>&gt;<sp/>1<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>data</highlight></codeline>
<codeline lineno="443"><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="445" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a8f1864753e8571ea3de6eece3e929ad5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a8f1864753e8571ea3de6eece3e929ad5" kindref="member">body</ref>(self):</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;The<sp/>body<sp/>of<sp/>the<sp/>request,<sp/>as<sp/>bytes.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a47d8e8d658f557303ebce5bd5052e03a" kindref="member">_body</ref></highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="450" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac673d0555c4977a7d2e10d539241432b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac673d0555c4977a7d2e10d539241432b" kindref="member">stream</ref>(self):</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;The<sp/>body<sp/>of<sp/>the<sp/>request,<sp/>as<sp/>a<sp/>bytes<sp/>stream.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac62f483c0d118e26c5084e961cb17f46" kindref="member">_stream</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac62f483c0d118e26c5084e961cb17f46" kindref="member">_stream</ref><sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_async_bytes_i_o" kindref="compound">AsyncBytesIO</ref>(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a47d8e8d658f557303ebce5bd5052e03a" kindref="member">_body</ref>)</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac62f483c0d118e26c5084e961cb17f46" kindref="member">_stream</ref></highlight></codeline>
<codeline lineno="455"><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a9fed592fcfc8d9cba92f4e3f33b7a6ad" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a9fed592fcfc8d9cba92f4e3f33b7a6ad" kindref="member">json</ref>(self):</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;The<sp/>parsed<sp/>JSON<sp/>body,<sp/>or<sp/>``None``<sp/>if<sp/>the<sp/>request<sp/>does<sp/>not<sp/>have<sp/>a</highlight></codeline>
<codeline lineno="459"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JSON<sp/>body.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a97c3f5f65252ec6d285883b482c88e3d" kindref="member">_json</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a03588645edf4a3ee1db7f1ed5d47b7af" kindref="member">content_type</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mime_type<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a03588645edf4a3ee1db7f1ed5d47b7af" kindref="member">content_type</ref>.split(</highlight><highlight class="stringliteral">&apos;;&apos;</highlight><highlight class="normal">)[0]</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>mime_type<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;application/json&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a97c3f5f65252ec6d285883b482c88e3d" kindref="member">_json</ref><sp/>=<sp/>json.loads(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a8f1864753e8571ea3de6eece3e929ad5" kindref="member">body</ref>.decode())</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a97c3f5f65252ec6d285883b482c88e3d" kindref="member">_json</ref></highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="470" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ab7fa561ec1c7b6808ab27a84d36b4528" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ab7fa561ec1c7b6808ab27a84d36b4528" kindref="member">form</ref>(self):</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;The<sp/>parsed<sp/>form<sp/>submission<sp/>body,<sp/>as<sp/>a</highlight></codeline>
<codeline lineno="472"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:class:`MultiDict<sp/>&lt;microdot.MultiDict&gt;`<sp/>object,<sp/>or<sp/>``None``<sp/>if<sp/>the</highlight></codeline>
<codeline lineno="473"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request<sp/>does<sp/>not<sp/>have<sp/>a<sp/>form<sp/>submission.</highlight></codeline>
<codeline lineno="474"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="475"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Forms<sp/>that<sp/>are<sp/>URL<sp/>encoded<sp/>are<sp/>processed<sp/>by<sp/>default.<sp/>For<sp/>multipart</highlight></codeline>
<codeline lineno="476"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>forms<sp/>to<sp/>be<sp/>processed,<sp/>the</highlight></codeline>
<codeline lineno="477"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:func:`with_form_data<sp/>&lt;microdot.multipart.with_form_data&gt;`</highlight></codeline>
<codeline lineno="478"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decorator<sp/>must<sp/>be<sp/>added<sp/>to<sp/>the<sp/>route.</highlight></codeline>
<codeline lineno="479"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ae70867cd561916ac37b4c6cb27dcc654" kindref="member">_form</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a03588645edf4a3ee1db7f1ed5d47b7af" kindref="member">content_type</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mime_type<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a03588645edf4a3ee1db7f1ed5d47b7af" kindref="member">content_type</ref>.split(</highlight><highlight class="stringliteral">&apos;;&apos;</highlight><highlight class="normal">)[0]</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>mime_type<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;application/x-www-form-urlencoded&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ae70867cd561916ac37b4c6cb27dcc654" kindref="member">_form</ref><sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a7d04d1ba304bc9fcd03f7721a1a116f3" kindref="member">_parse_urlencoded</ref>(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a8f1864753e8571ea3de6eece3e929ad5" kindref="member">body</ref>)</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ae70867cd561916ac37b4c6cb27dcc654" kindref="member">_form</ref></highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="490" refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac1a46f195faf0d4202f3fad3c381e870" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1ac1a46f195faf0d4202f3fad3c381e870" kindref="member">files</ref>(self):</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;The<sp/>files<sp/>uploaded<sp/>in<sp/>the<sp/>request<sp/>as<sp/>a<sp/>dictionary,<sp/>or<sp/>``None``<sp/>if</highlight></codeline>
<codeline lineno="492"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>request<sp/>does<sp/>not<sp/>have<sp/>any<sp/>files.</highlight></codeline>
<codeline lineno="493"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="494"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>:func:`with_form_data<sp/>&lt;microdot.multipart.with_form_data&gt;`</highlight></codeline>
<codeline lineno="495"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decorator<sp/>must<sp/>be<sp/>added<sp/>to<sp/>the<sp/>route<sp/>that<sp/>receives<sp/>file<sp/>uploads<sp/>for</highlight></codeline>
<codeline lineno="496"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>property<sp/>to<sp/>be<sp/>set.</highlight></codeline>
<codeline lineno="497"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1aa60156319fb36b89c368fe12db459165" kindref="member">_files</ref></highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a341f18eefce5c35168455b67ec764411" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a341f18eefce5c35168455b67ec764411" kindref="member">after_request</ref>(self,<sp/>f):</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Register<sp/>a<sp/>request-specific<sp/>function<sp/>to<sp/>run<sp/>after<sp/>the<sp/>request<sp/>is</highlight></codeline>
<codeline lineno="502"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handled.<sp/>Request-specific<sp/>after<sp/>request<sp/>handlers<sp/>run<sp/>at<sp/>the<sp/>very<sp/>end,</highlight></codeline>
<codeline lineno="503"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>after<sp/>the<sp/>application&apos;s<sp/>own<sp/>after<sp/>request<sp/>handlers.<sp/>The<sp/>function<sp/>must</highlight></codeline>
<codeline lineno="504"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>take<sp/>two<sp/>arguments,<sp/>the<sp/>request<sp/>and<sp/>response<sp/>objects.<sp/>The<sp/>return<sp/>value</highlight></codeline>
<codeline lineno="505"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>the<sp/>function<sp/>must<sp/>be<sp/>the<sp/>updated<sp/>response<sp/>object.</highlight></codeline>
<codeline lineno="506"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="507"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="508"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="509"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.route(&apos;/&apos;)</highlight></codeline>
<codeline lineno="510"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>index(request):</highlight></codeline>
<codeline lineno="511"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>register<sp/>a<sp/>request-specific<sp/>after<sp/>request<sp/>handler</highlight></codeline>
<codeline lineno="512"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@req.after_request</highlight></codeline>
<codeline lineno="513"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>func(request,<sp/>response):</highlight></codeline>
<codeline lineno="514"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="515"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>response</highlight></codeline>
<codeline lineno="516"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="517"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>&apos;Hello,<sp/>World!&apos;</highlight></codeline>
<codeline lineno="518"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="519"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>the<sp/>function<sp/>is<sp/>not<sp/>called<sp/>if<sp/>the<sp/>request<sp/>handler<sp/>raises<sp/>an</highlight></codeline>
<codeline lineno="520"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exception<sp/>and<sp/>an<sp/>error<sp/>response<sp/>is<sp/>returned<sp/>instead.</highlight></codeline>
<codeline lineno="521"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a92c3bf7d42647bd839a1a1323f16df79" kindref="member">after_request_handlers</ref>.append(f)</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="524"><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@staticmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="526" refid="classlib_1_1microdot_1_1microdot_1_1_request_1a864431a3bdd2bb6e84599991f14d4a7f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_request_1a864431a3bdd2bb6e84599991f14d4a7f" kindref="member">_safe_readline</ref>(stream):</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>(await<sp/>stream.readline())</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(line)<sp/>&gt;<sp/>Request.max_readline:</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;line<sp/>too<sp/>long&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>line</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight></codeline>
<codeline lineno="533" refid="classlib_1_1microdot_1_1microdot_1_1_response" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_response" kindref="compound">Response</ref>:</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;An<sp/>HTTP<sp/>response<sp/>class.</highlight></codeline>
<codeline lineno="535"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="536"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:param<sp/>body:<sp/>The<sp/>body<sp/>of<sp/>the<sp/>response.<sp/>If<sp/>a<sp/>dictionary<sp/>or<sp/>list<sp/>is<sp/>given,</highlight></codeline>
<codeline lineno="537"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>JSON<sp/>formatter<sp/>is<sp/>used<sp/>to<sp/>generate<sp/>the<sp/>body.<sp/>If<sp/>a<sp/>file-like</highlight></codeline>
<codeline lineno="538"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object<sp/>or<sp/>an<sp/>async<sp/>generator<sp/>is<sp/>given,<sp/>a<sp/>streaming<sp/>response<sp/>is</highlight></codeline>
<codeline lineno="539"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>used.<sp/>If<sp/>a<sp/>string<sp/>is<sp/>given,<sp/>it<sp/>is<sp/>encoded<sp/>from<sp/>UTF-8.<sp/>Else,</highlight></codeline>
<codeline lineno="540"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>body<sp/>should<sp/>be<sp/>a<sp/>byte<sp/>sequence.</highlight></codeline>
<codeline lineno="541"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:param<sp/>status_code:<sp/>The<sp/>numeric<sp/>HTTP<sp/>status<sp/>code<sp/>of<sp/>the<sp/>response.<sp/>The</highlight></codeline>
<codeline lineno="542"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>is<sp/>200.</highlight></codeline>
<codeline lineno="543"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:param<sp/>headers:<sp/>A<sp/>dictionary<sp/>of<sp/>headers<sp/>to<sp/>include<sp/>in<sp/>the<sp/>response.</highlight></codeline>
<codeline lineno="544"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:param<sp/>reason:<sp/>A<sp/>custom<sp/>reason<sp/>phrase<sp/>to<sp/>add<sp/>after<sp/>the<sp/>status<sp/>code.<sp/>The</highlight></codeline>
<codeline lineno="545"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>is<sp/>&quot;OK&quot;<sp/>for<sp/>responses<sp/>with<sp/>a<sp/>200<sp/>status<sp/>code<sp/>and</highlight></codeline>
<codeline lineno="546"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;N/A&quot;<sp/>for<sp/>any<sp/>other<sp/>status<sp/>codes.</highlight></codeline>
<codeline lineno="547"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548" refid="classlib_1_1microdot_1_1microdot_1_1_response_1ac2af66d198c3a0ca2f49a5fd2736c37f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>types_map<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;css&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text/css&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;gif&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;image/gif&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;html&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text/html&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;jpg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;image/jpeg&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;js&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;application/javascript&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;json&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;application/json&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;png&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;image/png&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;txt&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text/plain&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;svg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;image/svg+xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight></codeline>
<codeline lineno="560" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a54d07a966938fd47152318e8dde1f18e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>send_file_buffer_size<sp/>=<sp/>1024</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>content<sp/>type<sp/>to<sp/>use<sp/>for<sp/>responses<sp/>that<sp/>do<sp/>not<sp/>explicitly<sp/>define<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>``Content-Type``<sp/>header.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="564" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a9985d2fdec4df6b5e2a5ec9257c26c0d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>default_content_type<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;text/plain&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>The<sp/>default<sp/>cache<sp/>control<sp/>max<sp/>age<sp/>used<sp/>by<sp/>:meth:`send_file`.<sp/>A<sp/>value</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>of<sp/>``None``<sp/>means<sp/>that<sp/>no<sp/>``Cache-Control``<sp/>header<sp/>is<sp/>added.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568" refid="classlib_1_1microdot_1_1microdot_1_1_response_1adb58d298f51b4b5efe1670ddf0932f7b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>default_send_file_max_age<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Special<sp/>response<sp/>used<sp/>to<sp/>signal<sp/>that<sp/>a<sp/>response<sp/>does<sp/>not<sp/>need<sp/>to<sp/>be</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>written<sp/>to<sp/>the<sp/>client.<sp/>Used<sp/>to<sp/>exit<sp/>WebSocket<sp/>connections<sp/>cleanly.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572" refid="classlib_1_1microdot_1_1microdot_1_1_response_1ae505af6a1537c9124c76ef8f031136c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>already_handled<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>body=&apos;&apos;,<sp/>status_code=200,<sp/>headers=None,<sp/>reason=None):</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>body<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>status_code<sp/>==<sp/>200:</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_code<sp/>=<sp/>204</highlight></codeline>
<codeline lineno="578" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a03f0905157656facc97a2bd153c3670e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a03f0905157656facc97a2bd153c3670e" kindref="member">status_code</ref><sp/>=<sp/>status_code</highlight></codeline>
<codeline lineno="579" refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref><sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_no_case_dict" kindref="compound">NoCaseDict</ref>(headers<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>{})</highlight></codeline>
<codeline lineno="580" refid="classlib_1_1microdot_1_1microdot_1_1_response_1acd94676728835a170bd134caa612faff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1acd94676728835a170bd134caa612faff" kindref="member">reason</ref><sp/>=<sp/>reason</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(body,<sp/>(dict,<sp/>list)):</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body<sp/>=<sp/>json.dumps(body)</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;application/json;<sp/>charset=UTF-8&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(body,<sp/>str):</highlight></codeline>
<codeline lineno="585" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a0967e5680c1395e3dedc25cb1c3b96e1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a0967e5680c1395e3dedc25cb1c3b96e1" kindref="member">body</ref><sp/>=<sp/>body.encode()</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>this<sp/>applies<sp/>to<sp/>bytes,<sp/>file-like<sp/>objects<sp/>or<sp/>generators</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a0967e5680c1395e3dedc25cb1c3b96e1" kindref="member">body</ref><sp/>=<sp/>body</highlight></codeline>
<codeline lineno="589" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a065306a010785093a0dcdf2238475388" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a065306a010785093a0dcdf2238475388" kindref="member">is_head</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"></highlight></codeline>
<codeline lineno="591" refid="classlib_1_1microdot_1_1microdot_1_1_response_1aba8f1a13868472e3c31ed587b7053662" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aba8f1a13868472e3c31ed587b7053662" kindref="member">set_cookie</ref>(self,<sp/>cookie,<sp/>value,<sp/>path=None,<sp/>domain=None,<sp/>expires=None,</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_age=None,<sp/>secure=False,<sp/>http_only=False,</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>partitioned=False):</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Add<sp/>a<sp/>cookie<sp/>to<sp/>the<sp/>response.</highlight></codeline>
<codeline lineno="595"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="596"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>cookie:<sp/>The<sp/>cookie&apos;s<sp/>name.</highlight></codeline>
<codeline lineno="597"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>value:<sp/>The<sp/>cookie&apos;s<sp/>value.</highlight></codeline>
<codeline lineno="598"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>path:<sp/>The<sp/>cookie&apos;s<sp/>path.</highlight></codeline>
<codeline lineno="599"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>domain:<sp/>The<sp/>cookie&apos;s<sp/>domain.</highlight></codeline>
<codeline lineno="600"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>expires:<sp/>The<sp/>cookie<sp/>expiration<sp/>time,<sp/>as<sp/>a<sp/>``datetime``<sp/>object</highlight></codeline>
<codeline lineno="601"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>a<sp/>correctly<sp/>formatted<sp/>string.</highlight></codeline>
<codeline lineno="602"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>max_age:<sp/>The<sp/>cookie&apos;s<sp/>``Max-Age``<sp/>value.</highlight></codeline>
<codeline lineno="603"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>secure:<sp/>The<sp/>cookie&apos;s<sp/>``secure``<sp/>flag.</highlight></codeline>
<codeline lineno="604"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>http_only:<sp/>The<sp/>cookie&apos;s<sp/>``HttpOnly``<sp/>flag.</highlight></codeline>
<codeline lineno="605"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>partitioned:<sp/>Whether<sp/>the<sp/>cookie<sp/>is<sp/>partitioned.</highlight></codeline>
<codeline lineno="606"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{cookie}={value}&apos;</highlight><highlight class="normal">.format(cookie=cookie,<sp/>value=value)</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>path:</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>Path=&apos;</highlight><highlight class="normal"><sp/>+<sp/>path</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>domain:</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>Domain=&apos;</highlight><highlight class="normal"><sp/>+<sp/>domain</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>expires:</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(expires,<sp/>str):</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>Expires=&apos;</highlight><highlight class="normal"><sp/>+<sp/>expires</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>Expires=&apos;</highlight><highlight class="normal"><sp/>+<sp/>time.strftime(</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%a,<sp/>%d<sp/>%b<sp/>%Y<sp/>%H:%M:%S<sp/>GMT&apos;</highlight><highlight class="normal">,<sp/>expires.timetuple())</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>max_age<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>Max-Age=&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(max_age)</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>secure:</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>Secure&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>http_only:</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>HttpOnly&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>partitioned:</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_cookie<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>Partitioned&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Set-Cookie&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>:</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Set-Cookie&apos;</highlight><highlight class="normal">].append(http_cookie)</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Set-Cookie&apos;</highlight><highlight class="normal">]<sp/>=<sp/>[http_cookie]</highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a580f35c32153c5624c8deb739c8ac7a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a580f35c32153c5624c8deb739c8ac7a1" kindref="member">delete_cookie</ref>(self,<sp/>cookie,<sp/>**kwargs):</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Delete<sp/>a<sp/>cookie.</highlight></codeline>
<codeline lineno="633"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="634"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>cookie:<sp/>The<sp/>cookie&apos;s<sp/>name.</highlight></codeline>
<codeline lineno="635"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>kwargs:<sp/>Any<sp/>cookie<sp/>options<sp/>and<sp/>flags<sp/>supported<sp/>by</highlight></codeline>
<codeline lineno="636"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:meth:`set_cookie()<sp/>&lt;microdot.Response.set_cookie&gt;`.</highlight></codeline>
<codeline lineno="637"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Values<sp/>given<sp/>for<sp/>``expires``<sp/>and<sp/>``max_age``<sp/>are</highlight></codeline>
<codeline lineno="638"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ignored.</highlight></codeline>
<codeline lineno="639"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kwargs.pop(</highlight><highlight class="stringliteral">&apos;expires&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kwargs.pop(</highlight><highlight class="stringliteral">&apos;max_age&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aba8f1a13868472e3c31ed587b7053662" kindref="member">set_cookie</ref>(cookie,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/>expires=</highlight><highlight class="stringliteral">&apos;Thu,<sp/>01<sp/>Jan<sp/>1970<sp/>00:00:01<sp/>GMT&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_age=0,<sp/>**kwargs)</highlight></codeline>
<codeline lineno="644"><highlight class="normal"></highlight></codeline>
<codeline lineno="645" refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab2581e8851d29f2d3d7f73dd0f3e2b4f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab2581e8851d29f2d3d7f73dd0f3e2b4f" kindref="member">complete</ref>(self):</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a0967e5680c1395e3dedc25cb1c3b96e1" kindref="member">body</ref>,<sp/>bytes)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Content-Length&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>:</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Content-Length&apos;</highlight><highlight class="normal">]<sp/>=<sp/>str(len(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a0967e5680c1395e3dedc25cb1c3b96e1" kindref="member">body</ref>))</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>:</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal">]<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a9985d2fdec4df6b5e2a5ec9257c26c0d" kindref="member">default_content_type</ref></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;charset=&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>[</highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal">]<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;;<sp/>charset=UTF-8&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"></highlight></codeline>
<codeline lineno="654" refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa981eee0b2321a82085a1b59ec7c8db0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa981eee0b2321a82085a1b59ec7c8db0" kindref="member">write</ref>(self,<sp/>stream):</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab2581e8851d29f2d3d7f73dd0f3e2b4f" kindref="member">complete</ref>()</highlight></codeline>
<codeline lineno="656"><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>status<sp/>code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1acd94676728835a170bd134caa612faff" kindref="member">reason</ref><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1acd94676728835a170bd134caa612faff" kindref="member">reason</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;OK&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a03f0905157656facc97a2bd153c3670e" kindref="member">status_code</ref><sp/>==<sp/>200<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;N/A&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>stream.awrite(</highlight><highlight class="stringliteral">&apos;HTTP/1.0<sp/>{status_code}<sp/>{reason}\r\n&apos;</highlight><highlight class="normal">.format(</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_code=self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a03f0905157656facc97a2bd153c3670e" kindref="member">status_code</ref>,<sp/>reason=reason).encode())</highlight></codeline>
<codeline lineno="663"><highlight class="normal"></highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>header,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1ab9ad4b076f086c75c77e124e285e3c0f" kindref="member">headers</ref>.items():</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>=<sp/>value<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(value,<sp/>list)<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>[value]</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>values:</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>stream.awrite(</highlight><highlight class="stringliteral">&apos;{header}:<sp/>{value}\r\n&apos;</highlight><highlight class="normal">.format(</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header=header,<sp/>value=value).encode())</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>stream.awrite(b</highlight><highlight class="stringliteral">&apos;\r\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>body</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a065306a010785093a0dcdf2238475388" kindref="member">is_head</ref>:</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iter<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa7032ab1010a453ed6b463cbe03c3cb3" kindref="member">body_iter</ref>()</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>body<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>iter:</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(body,<sp/>str):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body<sp/>=<sp/>body.encode()</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>stream.awrite(body)</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>OSError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exc:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>exc.errno<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>MUTED_SOCKET_ERRORS<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exc.args[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;Connection<sp/>lost&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(iter,<sp/></highlight><highlight class="stringliteral">&apos;aclose&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>iter.aclose()</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(iter,<sp/></highlight><highlight class="stringliteral">&apos;aclose&apos;</highlight><highlight class="normal">):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>branch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>iter.aclose()</highlight></codeline>
<codeline lineno="688"><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>OSError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exc:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>exc.errno<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>MUTED_SOCKET_ERRORS<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exc.args[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;Connection<sp/>lost&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"></highlight></codeline>
<codeline lineno="696" refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa7032ab1010a453ed6b463cbe03c3cb3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa7032ab1010a453ed6b463cbe03c3cb3" kindref="member">body_iter</ref>(self):</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a0967e5680c1395e3dedc25cb1c3b96e1" kindref="member">body</ref>,<sp/></highlight><highlight class="stringliteral">&apos;__anext__&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>response<sp/>body<sp/>is<sp/>an<sp/>async<sp/>generator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1a0967e5680c1395e3dedc25cb1c3b96e1" kindref="member">body</ref></highlight></codeline>
<codeline lineno="700"><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>response<sp/>=<sp/>self</highlight></codeline>
<codeline lineno="702"><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">iter:</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ITER_UNKNOWN<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ITER_SYNC_GEN<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ITER_FILE_OBJ<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ITER_NO_BODY<sp/>=<sp/>-1</highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__aiter__(self):</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>response.body:</highlight></codeline>
<codeline lineno="711" refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>=<sp/>self.ITER_UNKNOWN<sp/><sp/></highlight><highlight class="comment">#<sp/>need<sp/>to<sp/>determine<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>=<sp/>self.ITER_NO_BODY</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal">__anext__(self):</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>==<sp/>self.ITER_NO_BODY:</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.aclose()</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>StopAsyncIteration</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>==<sp/>self.ITER_UNKNOWN:</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(response.body,<sp/></highlight><highlight class="stringliteral">&apos;read&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>=<sp/>self.ITER_FILE_OBJ</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>hasattr(response.body,<sp/></highlight><highlight class="stringliteral">&apos;__next__&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>=<sp/>self.ITER_SYNC_GEN</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next(response.body)</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>=<sp/>self.ITER_NO_BODY</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>response.body</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>==<sp/>self.ITER_SYNC_GEN:</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next(response.body)</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>StopIteration:</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.aclose()</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>StopAsyncIteration</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>=<sp/>response.body.read(response.send_file_buffer_size)</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a3ad5db3c17e73adbb3fa7be466a799e0" kindref="member">iscoroutine</ref>(buf):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>=<sp/>await<sp/>buf</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(buf)<sp/>&lt;<sp/>response.send_file_buffer_size:</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1aa994a5b4550b24e99e40740270e3d7e5" kindref="member">i</ref><sp/>=<sp/>self.ITER_NO_BODY</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>buf</highlight></codeline>
<codeline lineno="741"><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal">aclose(self):</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(response.body,<sp/></highlight><highlight class="stringliteral">&apos;close&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>response.body.close()</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a3ad5db3c17e73adbb3fa7be466a799e0" kindref="member">iscoroutine</ref>(result):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>result</highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>iter()</highlight></codeline>
<codeline lineno="749"><highlight class="normal"></highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@classmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="751" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a3b581dd14af5dc3c1d02051e26c8ad52" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a2207eb7a8167ad4d77f95e6798c96b47" kindref="member">redirect</ref>(cls,<sp/>location,<sp/>status_code=302):</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>a<sp/>redirect<sp/>response.</highlight></codeline>
<codeline lineno="753"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="754"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>location:<sp/>The<sp/>URL<sp/>to<sp/>redirect<sp/>to.</highlight></codeline>
<codeline lineno="755"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>status_code:<sp/>The<sp/>3xx<sp/>status<sp/>code<sp/>to<sp/>use<sp/>for<sp/>the<sp/>redirect.<sp/>The</highlight></codeline>
<codeline lineno="756"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>is<sp/>302.</highlight></codeline>
<codeline lineno="757"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;\x0d&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>location<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;\x0a&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>location:</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;invalid<sp/>redirect<sp/>URL&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cls(status_code=status_code,<sp/>headers={</highlight><highlight class="stringliteral">&apos;Location&apos;</highlight><highlight class="normal">:<sp/>location})</highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@classmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="763" refid="classlib_1_1microdot_1_1microdot_1_1_response_1a377288cd56ffac7c3639151cca4e1f30" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1add1b27da3f4a2fc9a20bd69db7a52e82" kindref="member">send_file</ref>(cls,<sp/>filename,<sp/>status_code=200,<sp/>content_type=None,</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream=None,<sp/>max_age=None,<sp/>compressed=False,</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file_extension=&apos;&apos;):</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Send<sp/>file<sp/>contents<sp/>in<sp/>a<sp/>response.</highlight></codeline>
<codeline lineno="767"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="768"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>filename:<sp/>The<sp/>filename<sp/>of<sp/>the<sp/>file.</highlight></codeline>
<codeline lineno="769"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>status_code:<sp/>The<sp/>3xx<sp/>status<sp/>code<sp/>to<sp/>use<sp/>for<sp/>the<sp/>redirect.<sp/>The</highlight></codeline>
<codeline lineno="770"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>is<sp/>302.</highlight></codeline>
<codeline lineno="771"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>content_type:<sp/>The<sp/>``Content-Type``<sp/>header<sp/>to<sp/>use<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="772"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>response.<sp/>If<sp/>omitted,<sp/>it<sp/>is<sp/>generated</highlight></codeline>
<codeline lineno="773"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>automatically<sp/>from<sp/>the<sp/>file<sp/>extension<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="774"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``filename``<sp/>parameter.</highlight></codeline>
<codeline lineno="775"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>stream:<sp/>A<sp/>file-like<sp/>object<sp/>to<sp/>read<sp/>the<sp/>file<sp/>contents<sp/>from.<sp/>If</highlight></codeline>
<codeline lineno="776"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>stream<sp/>is<sp/>given,<sp/>the<sp/>``filename``<sp/>parameter<sp/>is<sp/>only</highlight></codeline>
<codeline lineno="777"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>used<sp/>when<sp/>generating<sp/>the<sp/>``Content-Type``<sp/>header.</highlight></codeline>
<codeline lineno="778"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>max_age:<sp/>The<sp/>``Cache-Control``<sp/>header&apos;s<sp/>``max-age``<sp/>value<sp/>in</highlight></codeline>
<codeline lineno="779"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seconds.<sp/>If<sp/>omitted,<sp/>the<sp/>value<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="780"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:attr:`Response.default_send_file_max_age`<sp/>attribute<sp/>is</highlight></codeline>
<codeline lineno="781"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>used.</highlight></codeline>
<codeline lineno="782"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>compressed:<sp/>Whether<sp/>the<sp/>file<sp/>is<sp/>compressed.<sp/>If<sp/>``True``,<sp/>the</highlight></codeline>
<codeline lineno="783"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``Content-Encoding``<sp/>header<sp/>is<sp/>set<sp/>to<sp/>``gzip``.<sp/>A</highlight></codeline>
<codeline lineno="784"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>with<sp/>the<sp/>header<sp/>value<sp/>can<sp/>also<sp/>be<sp/>passed.</highlight></codeline>
<codeline lineno="785"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>when<sp/>using<sp/>this<sp/>option<sp/>the<sp/>file<sp/>must<sp/>have</highlight></codeline>
<codeline lineno="786"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>been<sp/>compressed<sp/>beforehand.<sp/>This<sp/>option<sp/>only<sp/>sets</highlight></codeline>
<codeline lineno="787"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>header.</highlight></codeline>
<codeline lineno="788"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>file_extension:<sp/>A<sp/>file<sp/>extension<sp/>to<sp/>append<sp/>to<sp/>the<sp/>``filename``</highlight></codeline>
<codeline lineno="789"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameter<sp/>when<sp/>opening<sp/>the<sp/>file,<sp/>including<sp/>the</highlight></codeline>
<codeline lineno="790"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dot.<sp/>The<sp/>extension<sp/>given<sp/>here<sp/>is<sp/>not<sp/>considered</highlight></codeline>
<codeline lineno="791"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when<sp/>generating<sp/>the<sp/>``Content-Type``<sp/>header.</highlight></codeline>
<codeline lineno="792"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="793"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Security<sp/>note:<sp/>The<sp/>filename<sp/>is<sp/>assumed<sp/>to<sp/>be<sp/>trusted.<sp/>Never<sp/>pass</highlight></codeline>
<codeline lineno="794"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filenames<sp/>provided<sp/>by<sp/>the<sp/>user<sp/>without<sp/>validating<sp/>and<sp/>sanitizing<sp/>them</highlight></codeline>
<codeline lineno="795"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>first.</highlight></codeline>
<codeline lineno="796"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>content_type<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>compressed<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>filename.endswith(</highlight><highlight class="stringliteral">&apos;.gz&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ext<sp/>=<sp/>filename[:-3].split(</highlight><highlight class="stringliteral">&apos;.&apos;</highlight><highlight class="normal">)[-1]</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ext<sp/>=<sp/>filename.split(</highlight><highlight class="stringliteral">&apos;.&apos;</highlight><highlight class="normal">)[-1]</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ext<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>Response.types_map:</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content_type<sp/>=<sp/>Response.types_map[ext]</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content_type<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;application/octet-stream&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/>{</highlight><highlight class="stringliteral">&apos;Content-Type&apos;</highlight><highlight class="normal">:<sp/>content_type}</highlight></codeline>
<codeline lineno="807"><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>max_age<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_age<sp/>=<sp/>cls.<ref refid="classlib_1_1microdot_1_1microdot_1_1_response_1adb58d298f51b4b5efe1670ddf0932f7b" kindref="member">default_send_file_max_age</ref></highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>max_age<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers[</highlight><highlight class="stringliteral">&apos;Cache-Control&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;max-age={}&apos;</highlight><highlight class="normal">.format(max_age)</highlight></codeline>
<codeline lineno="812"><highlight class="normal"></highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>compressed:</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers[</highlight><highlight class="stringliteral">&apos;Content-Encoding&apos;</highlight><highlight class="normal">]<sp/>=<sp/>compressed<sp/>\</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(compressed,<sp/>str)<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;gzip&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>stream<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>open(filename<sp/>+<sp/>file_extension,<sp/></highlight><highlight class="stringliteral">&apos;rb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cls(body=f,<sp/>status_code=status_code,<sp/>headers=headers)</highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"></highlight></codeline>
<codeline lineno="821" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern" kindref="compound">URLPattern</ref>():</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>class<sp/>that<sp/>represents<sp/>the<sp/>URL<sp/>pattern<sp/>for<sp/>a<sp/>route.</highlight></codeline>
<codeline lineno="823"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="824"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:param<sp/>url_pattern:<sp/>The<sp/>route<sp/>URL<sp/>pattern,<sp/>which<sp/>can<sp/>include<sp/>static<sp/>and</highlight></codeline>
<codeline lineno="825"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dynamic<sp/>path<sp/>segments.<sp/>Dynamic<sp/>segments<sp/>are<sp/>enclosed<sp/>in</highlight></codeline>
<codeline lineno="826"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``&lt;``<sp/>and<sp/>``&gt;``.<sp/>The<sp/>type<sp/>of<sp/>the<sp/>segment<sp/>can<sp/>be<sp/>given</highlight></codeline>
<codeline lineno="827"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>as<sp/>a<sp/>prefix,<sp/>separated<sp/>from<sp/>the<sp/>name<sp/>with<sp/>a<sp/>colon.</highlight></codeline>
<codeline lineno="828"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Supported<sp/>types<sp/>are<sp/>``string``<sp/>(the<sp/>default),</highlight></codeline>
<codeline lineno="829"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``int``<sp/>and<sp/>``path``.<sp/>Custom<sp/>types<sp/>can<sp/>be<sp/>registered</highlight></codeline>
<codeline lineno="830"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>using<sp/>the<sp/>:meth:`URLPattern.register_type`<sp/>method.</highlight></codeline>
<codeline lineno="831"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"></highlight></codeline>
<codeline lineno="833" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a201ef6d4927b1225b2e3dc7d4892c6e6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>segment_patterns<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;string&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;/([^/]+)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;int&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;/(-?\\d+)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;path&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;/(.+)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="838" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a5488f9deb26f1659dfa1ae5a4111bfbe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>segment_parsers<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;int&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>value:<sp/>int(value),</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="841"><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@classmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="843" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1af1c7b2a2bb5baffb4b887e6f2c118ac7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1af1c7b2a2bb5baffb4b887e6f2c118ac7" kindref="member">register_type</ref>(cls,<sp/>type_name,<sp/>pattern=&apos;[^/]+&apos;,<sp/>parser=None):</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Register<sp/>a<sp/>new<sp/>URL<sp/>segment<sp/>type.</highlight></codeline>
<codeline lineno="845"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="846"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>type_name:<sp/>The<sp/>name<sp/>of<sp/>the<sp/>segment<sp/>type<sp/>to<sp/>register.</highlight></codeline>
<codeline lineno="847"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>pattern:<sp/>The<sp/>regular<sp/>expression<sp/>pattern<sp/>to<sp/>use<sp/>when<sp/>matching</highlight></codeline>
<codeline lineno="848"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>segment<sp/>type.<sp/>If<sp/>not<sp/>given,<sp/>a<sp/>default<sp/>matcher<sp/>for</highlight></codeline>
<codeline lineno="849"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>single<sp/>path<sp/>segment<sp/>is<sp/>used.</highlight></codeline>
<codeline lineno="850"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>parser:<sp/>A<sp/>callable<sp/>that<sp/>will<sp/>be<sp/>used<sp/>to<sp/>parse<sp/>and<sp/>transform<sp/>the</highlight></codeline>
<codeline lineno="851"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>of<sp/>the<sp/>segment.<sp/>If<sp/>omitted,<sp/>the<sp/>value<sp/>is<sp/>returned</highlight></codeline>
<codeline lineno="852"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>as<sp/>a<sp/>string.</highlight></codeline>
<codeline lineno="853"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cls.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a201ef6d4927b1225b2e3dc7d4892c6e6" kindref="member">segment_patterns</ref>[type_name]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;/({})&apos;</highlight><highlight class="normal">.format(pattern)</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cls.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a5488f9deb26f1659dfa1ae5a4111bfbe" kindref="member">segment_parsers</ref>[type_name]<sp/>=<sp/>parser</highlight></codeline>
<codeline lineno="856"><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>url_pattern):</highlight></codeline>
<codeline lineno="858" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a654f92a1e32fc2f05bde3aeef1644cdf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a654f92a1e32fc2f05bde3aeef1644cdf" kindref="member">url_pattern</ref><sp/>=<sp/>url_pattern</highlight></codeline>
<codeline lineno="859" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1ae1c37544164fac7695ebac5c7eeff980" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1ae1c37544164fac7695ebac5c7eeff980" kindref="member">segments</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="860" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a3b5b045438bdca0c75678866f436545c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a3b5b045438bdca0c75678866f436545c" kindref="member">regex</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal"></highlight></codeline>
<codeline lineno="862" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a7101f46b6709439b135321f1115378b8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a7101f46b6709439b135321f1115378b8" kindref="member">compile</ref>(self):</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Generate<sp/>a<sp/>regular<sp/>expression<sp/>for<sp/>the<sp/>URL<sp/>pattern.</highlight></codeline>
<codeline lineno="864"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="865"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>is<sp/>automatically<sp/>invoked<sp/>the<sp/>first<sp/>time<sp/>the<sp/>URL<sp/>pattern<sp/>is</highlight></codeline>
<codeline lineno="866"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>matched<sp/>against<sp/>a<sp/>path.</highlight></codeline>
<codeline lineno="867"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pattern<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>segment<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a654f92a1e32fc2f05bde3aeef1644cdf" kindref="member">url_pattern</ref>.lstrip(</highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">).split(</highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>segment<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>segment[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;&lt;&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>segment[-1]<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;&gt;&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;invalid<sp/>URL<sp/>pattern&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segment<sp/>=<sp/>segment[1:-1]</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>segment:</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type_,<sp/>name<sp/>=<sp/>segment.rsplit(</highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type_<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;string&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>segment</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parser<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>type_.startswith(</highlight><highlight class="stringliteral">&apos;re:&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pattern<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;/({pattern})&apos;</highlight><highlight class="normal">.format(pattern=type_[3:])</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>type_<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a201ef6d4927b1225b2e3dc7d4892c6e6" kindref="member">segment_patterns</ref>:</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;invalid<sp/>URL<sp/>segment<sp/>type&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pattern<sp/>+=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a201ef6d4927b1225b2e3dc7d4892c6e6" kindref="member">segment_patterns</ref>[type_]</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parser<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a5488f9deb26f1659dfa1ae5a4111bfbe" kindref="member">segment_parsers</ref>.get(type_)</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1ae1c37544164fac7695ebac5c7eeff980" kindref="member">segments</ref>.append({</highlight><highlight class="stringliteral">&apos;parser&apos;</highlight><highlight class="normal">:<sp/>parser,<sp/></highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">:<sp/>name,</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;type&apos;</highlight><highlight class="normal">:<sp/>type_})</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pattern<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>+<sp/>segment</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1ae1c37544164fac7695ebac5c7eeff980" kindref="member">segments</ref>.append({</highlight><highlight class="stringliteral">&apos;parser&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a3b5b045438bdca0c75678866f436545c" kindref="member">regex</ref><sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">&apos;^&apos;</highlight><highlight class="normal"><sp/>+<sp/>pattern<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a3b5b045438bdca0c75678866f436545c" kindref="member">regex</ref></highlight></codeline>
<codeline lineno="894"><highlight class="normal"></highlight></codeline>
<codeline lineno="895" refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a0669e68f780516d7e0bc4b191f900290" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a0669e68f780516d7e0bc4b191f900290" kindref="member">match</ref>(self,<sp/>path):</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Match<sp/>a<sp/>path<sp/>against<sp/>the<sp/>URL<sp/>pattern.</highlight></codeline>
<codeline lineno="897"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="898"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>a<sp/>dictionary<sp/>with<sp/>the<sp/>values<sp/>of<sp/>all<sp/>dynamic<sp/>path<sp/>segments<sp/>if<sp/>a</highlight></codeline>
<codeline lineno="899"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>matche<sp/>is<sp/>found,<sp/>or<sp/>``None``<sp/>if<sp/>the<sp/>path<sp/>does<sp/>not<sp/>match<sp/>this<sp/>pattern.</highlight></codeline>
<codeline lineno="900"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a3b5b045438bdca0c75678866f436545c" kindref="member">regex</ref><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a7101f46b6709439b135321f1115378b8" kindref="member">compile</ref>()).<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a0669e68f780516d7e0bc4b191f900290" kindref="member">match</ref>(path)</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>segment<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1ae1c37544164fac7695ebac5c7eeff980" kindref="member">segments</ref>:</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>segment:</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arg<sp/>=<sp/>g.group(i)</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>segment[</highlight><highlight class="stringliteral">&apos;parser&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arg<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a5488f9deb26f1659dfa1ae5a4111bfbe" kindref="member">segment_parsers</ref>[segment[</highlight><highlight class="stringliteral">&apos;type&apos;</highlight><highlight class="normal">]](arg)</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>arg<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args[segment[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">]]<sp/>=<sp/>arg</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>args</highlight></codeline>
<codeline lineno="917"><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__repr__(self):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;URLPattern:<sp/>{}&apos;</highlight><highlight class="normal">.format(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern_1a654f92a1e32fc2f05bde3aeef1644cdf" kindref="member">url_pattern</ref>)</highlight></codeline>
<codeline lineno="920"><highlight class="normal"></highlight></codeline>
<codeline lineno="921"><highlight class="normal"></highlight></codeline>
<codeline lineno="922" refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception" kindref="compound">HTTPException</ref>(Exception):</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>status_code,<sp/>reason=None):</highlight></codeline>
<codeline lineno="924" refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception_1a4059650868a0342b57a76277b4a39fe8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception_1a4059650868a0342b57a76277b4a39fe8" kindref="member">status_code</ref><sp/>=<sp/>status_code</highlight></codeline>
<codeline lineno="925" refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception_1a8028a476fc6dde84f03af2d1d1582d85" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception_1a8028a476fc6dde84f03af2d1d1582d85" kindref="member">reason</ref><sp/>=<sp/>reason<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>str(status_code)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>error&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__repr__(self):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;HTTPException:<sp/>{}&apos;</highlight><highlight class="normal">.format(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception_1a4059650868a0342b57a76277b4a39fe8" kindref="member">status_code</ref>)</highlight></codeline>
<codeline lineno="929"><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931" refid="classlib_1_1microdot_1_1microdot_1_1_microdot" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot" kindref="compound">Microdot</ref>:</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;An<sp/>HTTP<sp/>application<sp/>class.</highlight></codeline>
<codeline lineno="933"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="934"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>class<sp/>implements<sp/>an<sp/>HTTP<sp/>application<sp/>instance<sp/>and<sp/>is<sp/>heavily</highlight></codeline>
<codeline lineno="935"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>influenced<sp/>by<sp/>the<sp/>``Flask``<sp/>class<sp/>of<sp/>the<sp/>Flask<sp/>framework.<sp/>It<sp/>is<sp/>typically</highlight></codeline>
<codeline lineno="936"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>declared<sp/>near<sp/>the<sp/>start<sp/>of<sp/>the<sp/>main<sp/>application<sp/>script.</highlight></codeline>
<codeline lineno="937"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="938"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="939"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="940"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>microdot<sp/>import<sp/>Microdot</highlight></codeline>
<codeline lineno="941"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="942"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>app<sp/>=<sp/>Microdot()</highlight></codeline>
<codeline lineno="943"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="944"><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self):</highlight></codeline>
<codeline lineno="946" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1af02ae65e93c68095d857619646990b89" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1af02ae65e93c68095d857619646990b89" kindref="member">url_map</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="947" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a28128d3f426a1605e5bc2a644198b2df" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a28128d3f426a1605e5bc2a644198b2df" kindref="member">before_request_handlers</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="948" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a616bb78c555de2500d81256659ec0a86" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a616bb78c555de2500d81256659ec0a86" kindref="member">after_request_handlers</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="949" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a1e11710f9bf25739e0d671bf0b763dcc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a1e11710f9bf25739e0d671bf0b763dcc" kindref="member">after_error_request_handlers</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="950" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="951" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a40c0864d7eb796fa841799d1c6dac9b7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a40c0864d7eb796fa841799d1c6dac9b7" kindref="member">options_handler</ref><sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9fc21df5db33c03db48df2c76842049f" kindref="member">default_options_handler</ref></highlight></codeline>
<codeline lineno="952" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1abc0dc52ddc5182d86a1604502488bdda" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1abc0dc52ddc5182d86a1604502488bdda" kindref="member">debug</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="953" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" kindref="member">server</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"></highlight></codeline>
<codeline lineno="955" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a56b430590336c2e42189f8779378bae6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a56b430590336c2e42189f8779378bae6" kindref="member">route</ref>(self,<sp/>url_pattern,<sp/>methods=None):</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>that<sp/>is<sp/>used<sp/>to<sp/>register<sp/>a<sp/>function<sp/>as<sp/>a<sp/>request<sp/>handler</highlight></codeline>
<codeline lineno="957"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>a<sp/>given<sp/>URL.</highlight></codeline>
<codeline lineno="958"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="959"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url_pattern:<sp/>The<sp/>URL<sp/>pattern<sp/>that<sp/>will<sp/>be<sp/>compared<sp/>against</highlight></codeline>
<codeline lineno="960"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>incoming<sp/>requests.</highlight></codeline>
<codeline lineno="961"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>methods:<sp/>The<sp/>list<sp/>of<sp/>HTTP<sp/>methods<sp/>to<sp/>be<sp/>handled<sp/>by<sp/>the</highlight></codeline>
<codeline lineno="962"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decorated<sp/>function.<sp/>If<sp/>omitted,<sp/>only<sp/>``GET``<sp/>requests</highlight></codeline>
<codeline lineno="963"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>are<sp/>handled.</highlight></codeline>
<codeline lineno="964"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="965"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>URL<sp/>pattern<sp/>can<sp/>be<sp/>a<sp/>static<sp/>path<sp/>(for<sp/>example,<sp/>``/users``<sp/>or</highlight></codeline>
<codeline lineno="966"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``/api/invoices/search``)<sp/>or<sp/>a<sp/>path<sp/>with<sp/>dynamic<sp/>components<sp/>enclosed</highlight></codeline>
<codeline lineno="967"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in<sp/>``&lt;``<sp/>and<sp/>``&gt;``<sp/>(for<sp/>example,<sp/>``/users/&lt;id&gt;``<sp/>or</highlight></codeline>
<codeline lineno="968"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``/invoices/&lt;number&gt;/products``).<sp/>Dynamic<sp/>path<sp/>components<sp/>can<sp/>also</highlight></codeline>
<codeline lineno="969"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>include<sp/>a<sp/>type<sp/>prefix,<sp/>separated<sp/>from<sp/>the<sp/>name<sp/>with<sp/>a<sp/>colon<sp/>(for</highlight></codeline>
<codeline lineno="970"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>example,<sp/>``/users/&lt;int:id&gt;``).<sp/>The<sp/>type<sp/>can<sp/>be<sp/>``string``<sp/>(the</highlight></codeline>
<codeline lineno="971"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default),<sp/>``int``,<sp/>``path``<sp/>or<sp/>``re:[regular-expression]``.</highlight></codeline>
<codeline lineno="972"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="973"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>first<sp/>argument<sp/>of<sp/>the<sp/>decorated<sp/>function<sp/>must<sp/>be</highlight></codeline>
<codeline lineno="974"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>request<sp/>object.<sp/>Any<sp/>path<sp/>arguments<sp/>that<sp/>are<sp/>specified<sp/>in<sp/>the<sp/>URL</highlight></codeline>
<codeline lineno="975"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pattern<sp/>are<sp/>passed<sp/>as<sp/>keyword<sp/>arguments.<sp/>The<sp/>return<sp/>value<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="976"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function<sp/>must<sp/>be<sp/>a<sp/>:class:`Response`<sp/>instance,<sp/>or<sp/>the<sp/>arguments<sp/>to</highlight></codeline>
<codeline lineno="977"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>passed<sp/>to<sp/>this<sp/>class.</highlight></codeline>
<codeline lineno="978"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="979"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="980"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="981"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.route(&apos;/&apos;)</highlight></codeline>
<codeline lineno="982"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>index(request):</highlight></codeline>
<codeline lineno="983"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>&apos;Hello,<sp/>world!&apos;</highlight></codeline>
<codeline lineno="984"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">decorated(f):</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1af02ae65e93c68095d857619646990b89" kindref="member">url_map</ref>.append(</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>([m.upper()<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>(methods<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>[</highlight><highlight class="stringliteral">&apos;GET&apos;</highlight><highlight class="normal">])],</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern" kindref="compound">URLPattern</ref>(url_pattern),<sp/>f,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>decorated</highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight></codeline>
<codeline lineno="992" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a0d88ef5e105effdb2f7eab6f0676f1a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a0d88ef5e105effdb2f7eab6f0676f1a1" kindref="member">get</ref>(self,<sp/>url_pattern):</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>that<sp/>is<sp/>used<sp/>to<sp/>register<sp/>a<sp/>function<sp/>as<sp/>a<sp/>``GET``<sp/>request</highlight></codeline>
<codeline lineno="994"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>for<sp/>a<sp/>given<sp/>URL.</highlight></codeline>
<codeline lineno="995"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="996"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url_pattern:<sp/>The<sp/>URL<sp/>pattern<sp/>that<sp/>will<sp/>be<sp/>compared<sp/>against</highlight></codeline>
<codeline lineno="997"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>incoming<sp/>requests.</highlight></codeline>
<codeline lineno="998"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="999"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>decorator<sp/>can<sp/>be<sp/>used<sp/>as<sp/>an<sp/>alias<sp/>to<sp/>the<sp/>``route``<sp/>decorator<sp/>with</highlight></codeline>
<codeline lineno="1000"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``methods=[&apos;GET&apos;]``.</highlight></codeline>
<codeline lineno="1001"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1002"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1003"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1004"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.get(&apos;/users/&lt;int:id&gt;&apos;)</highlight></codeline>
<codeline lineno="1005"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>get_user(request,<sp/>id):</highlight></codeline>
<codeline lineno="1006"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1007"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a56b430590336c2e42189f8779378bae6" kindref="member">route</ref>(url_pattern,<sp/>methods=[</highlight><highlight class="stringliteral">&apos;GET&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"></highlight></codeline>
<codeline lineno="1010" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aff926f2cca9f28ca8a8d6f4e7532ef85" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aff926f2cca9f28ca8a8d6f4e7532ef85" kindref="member">post</ref>(self,<sp/>url_pattern):</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>that<sp/>is<sp/>used<sp/>to<sp/>register<sp/>a<sp/>function<sp/>as<sp/>a<sp/>``POST``<sp/>request</highlight></codeline>
<codeline lineno="1012"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>for<sp/>a<sp/>given<sp/>URL.</highlight></codeline>
<codeline lineno="1013"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1014"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url_pattern:<sp/>The<sp/>URL<sp/>pattern<sp/>that<sp/>will<sp/>be<sp/>compared<sp/>against</highlight></codeline>
<codeline lineno="1015"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>incoming<sp/>requests.</highlight></codeline>
<codeline lineno="1016"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1017"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>decorator<sp/>can<sp/>be<sp/>used<sp/>as<sp/>an<sp/>alias<sp/>to<sp/>the``route``<sp/>decorator<sp/>with</highlight></codeline>
<codeline lineno="1018"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``methods=[&apos;POST&apos;]``.</highlight></codeline>
<codeline lineno="1019"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1020"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1021"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1022"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.post(&apos;/users&apos;)</highlight></codeline>
<codeline lineno="1023"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>create_user(request):</highlight></codeline>
<codeline lineno="1024"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1025"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a56b430590336c2e42189f8779378bae6" kindref="member">route</ref>(url_pattern,<sp/>methods=[</highlight><highlight class="stringliteral">&apos;POST&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"></highlight></codeline>
<codeline lineno="1028" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a19ff078c929c68f71295f99beaad87a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a19ff078c929c68f71295f99beaad87a1" kindref="member">put</ref>(self,<sp/>url_pattern):</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>that<sp/>is<sp/>used<sp/>to<sp/>register<sp/>a<sp/>function<sp/>as<sp/>a<sp/>``PUT``<sp/>request</highlight></codeline>
<codeline lineno="1030"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>for<sp/>a<sp/>given<sp/>URL.</highlight></codeline>
<codeline lineno="1031"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1032"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url_pattern:<sp/>The<sp/>URL<sp/>pattern<sp/>that<sp/>will<sp/>be<sp/>compared<sp/>against</highlight></codeline>
<codeline lineno="1033"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>incoming<sp/>requests.</highlight></codeline>
<codeline lineno="1034"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1035"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>decorator<sp/>can<sp/>be<sp/>used<sp/>as<sp/>an<sp/>alias<sp/>to<sp/>the<sp/>``route``<sp/>decorator<sp/>with</highlight></codeline>
<codeline lineno="1036"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``methods=[&apos;PUT&apos;]``.</highlight></codeline>
<codeline lineno="1037"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1038"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1039"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1040"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.put(&apos;/users/&lt;int:id&gt;&apos;)</highlight></codeline>
<codeline lineno="1041"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>edit_user(request,<sp/>id):</highlight></codeline>
<codeline lineno="1042"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1043"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a56b430590336c2e42189f8779378bae6" kindref="member">route</ref>(url_pattern,<sp/>methods=[</highlight><highlight class="stringliteral">&apos;PUT&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"></highlight></codeline>
<codeline lineno="1046" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a37da904c5f86fe081b75857435c8301f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a37da904c5f86fe081b75857435c8301f" kindref="member">patch</ref>(self,<sp/>url_pattern):</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>that<sp/>is<sp/>used<sp/>to<sp/>register<sp/>a<sp/>function<sp/>as<sp/>a<sp/>``PATCH``<sp/>request</highlight></codeline>
<codeline lineno="1048"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>for<sp/>a<sp/>given<sp/>URL.</highlight></codeline>
<codeline lineno="1049"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1050"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url_pattern:<sp/>The<sp/>URL<sp/>pattern<sp/>that<sp/>will<sp/>be<sp/>compared<sp/>against</highlight></codeline>
<codeline lineno="1051"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>incoming<sp/>requests.</highlight></codeline>
<codeline lineno="1052"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1053"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>decorator<sp/>can<sp/>be<sp/>used<sp/>as<sp/>an<sp/>alias<sp/>to<sp/>the<sp/>``route``<sp/>decorator<sp/>with</highlight></codeline>
<codeline lineno="1054"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``methods=[&apos;PATCH&apos;]``.</highlight></codeline>
<codeline lineno="1055"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1056"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1057"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1058"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.patch(&apos;/users/&lt;int:id&gt;&apos;)</highlight></codeline>
<codeline lineno="1059"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>edit_user(request,<sp/>id):</highlight></codeline>
<codeline lineno="1060"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1061"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a56b430590336c2e42189f8779378bae6" kindref="member">route</ref>(url_pattern,<sp/>methods=[</highlight><highlight class="stringliteral">&apos;PATCH&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aa71d799f80fa71c535240f4e17d21f9f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aa71d799f80fa71c535240f4e17d21f9f" kindref="member">delete</ref>(self,<sp/>url_pattern):</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>that<sp/>is<sp/>used<sp/>to<sp/>register<sp/>a<sp/>function<sp/>as<sp/>a<sp/>``DELETE``</highlight></codeline>
<codeline lineno="1066"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request<sp/>handler<sp/>for<sp/>a<sp/>given<sp/>URL.</highlight></codeline>
<codeline lineno="1067"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1068"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url_pattern:<sp/>The<sp/>URL<sp/>pattern<sp/>that<sp/>will<sp/>be<sp/>compared<sp/>against</highlight></codeline>
<codeline lineno="1069"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>incoming<sp/>requests.</highlight></codeline>
<codeline lineno="1070"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1071"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>decorator<sp/>can<sp/>be<sp/>used<sp/>as<sp/>an<sp/>alias<sp/>to<sp/>the<sp/>``route``<sp/>decorator<sp/>with</highlight></codeline>
<codeline lineno="1072"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``methods=[&apos;DELETE&apos;]``.</highlight></codeline>
<codeline lineno="1073"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1074"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1075"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1076"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.delete(&apos;/users/&lt;int:id&gt;&apos;)</highlight></codeline>
<codeline lineno="1077"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>delete_user(request,<sp/>id):</highlight></codeline>
<codeline lineno="1078"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1079"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a56b430590336c2e42189f8779378bae6" kindref="member">route</ref>(url_pattern,<sp/>methods=[</highlight><highlight class="stringliteral">&apos;DELETE&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9531ff37dd205ae3cf7649d68c19b028" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9531ff37dd205ae3cf7649d68c19b028" kindref="member">before_request</ref>(self,<sp/>f):</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>to<sp/>register<sp/>a<sp/>function<sp/>to<sp/>run<sp/>before<sp/>each<sp/>request<sp/>is</highlight></codeline>
<codeline lineno="1084"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handled.<sp/>The<sp/>decorated<sp/>function<sp/>must<sp/>take<sp/>a<sp/>single<sp/>argument,<sp/>the</highlight></codeline>
<codeline lineno="1085"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request<sp/>object.</highlight></codeline>
<codeline lineno="1086"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1087"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1088"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1089"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.before_request</highlight></codeline>
<codeline lineno="1090"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>func(request):</highlight></codeline>
<codeline lineno="1091"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1092"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a28128d3f426a1605e5bc2a644198b2df" kindref="member">before_request_handlers</ref>.append(f)</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"></highlight></codeline>
<codeline lineno="1096" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ac885e6eee3cc06e80d20d4ebd3839fda" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ac885e6eee3cc06e80d20d4ebd3839fda" kindref="member">after_request</ref>(self,<sp/>f):</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>to<sp/>register<sp/>a<sp/>function<sp/>to<sp/>run<sp/>after<sp/>each<sp/>request<sp/>is</highlight></codeline>
<codeline lineno="1098"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handled.<sp/>The<sp/>decorated<sp/>function<sp/>must<sp/>take<sp/>two<sp/>arguments,<sp/>the<sp/>request</highlight></codeline>
<codeline lineno="1099"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>response<sp/>objects.<sp/>The<sp/>return<sp/>value<sp/>of<sp/>the<sp/>function<sp/>must<sp/>be<sp/>an</highlight></codeline>
<codeline lineno="1100"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>updated<sp/>response<sp/>object.</highlight></codeline>
<codeline lineno="1101"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1102"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1103"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1104"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.after_request</highlight></codeline>
<codeline lineno="1105"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>func(request,<sp/>response):</highlight></codeline>
<codeline lineno="1106"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1107"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>response</highlight></codeline>
<codeline lineno="1108"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a616bb78c555de2500d81256659ec0a86" kindref="member">after_request_handlers</ref>.append(f)</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"></highlight></codeline>
<codeline lineno="1112" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aa09a53b544b8c4f74059a1f4b0c671d8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aa09a53b544b8c4f74059a1f4b0c671d8" kindref="member">after_error_request</ref>(self,<sp/>f):</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>to<sp/>register<sp/>a<sp/>function<sp/>to<sp/>run<sp/>after<sp/>an<sp/>error<sp/>response<sp/>is</highlight></codeline>
<codeline lineno="1114"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>generated.<sp/>The<sp/>decorated<sp/>function<sp/>must<sp/>take<sp/>two<sp/>arguments,<sp/>the<sp/>request</highlight></codeline>
<codeline lineno="1115"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>response<sp/>objects.<sp/>The<sp/>return<sp/>value<sp/>of<sp/>the<sp/>function<sp/>must<sp/>be<sp/>an</highlight></codeline>
<codeline lineno="1116"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>updated<sp/>response<sp/>object.<sp/>The<sp/>handler<sp/>is<sp/>invoked<sp/>for<sp/>error<sp/>responses</highlight></codeline>
<codeline lineno="1117"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>generated<sp/>by<sp/>Microdot,<sp/>as<sp/>well<sp/>as<sp/>those<sp/>returned<sp/>by<sp/>application-defined</highlight></codeline>
<codeline lineno="1118"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>error<sp/>handlers.</highlight></codeline>
<codeline lineno="1119"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1120"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1121"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1122"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.after_error_request</highlight></codeline>
<codeline lineno="1123"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>func(request,<sp/>response):</highlight></codeline>
<codeline lineno="1124"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...</highlight></codeline>
<codeline lineno="1125"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>response</highlight></codeline>
<codeline lineno="1126"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a1e11710f9bf25739e0d671bf0b763dcc" kindref="member">after_error_request_handlers</ref>.append(f)</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"></highlight></codeline>
<codeline lineno="1130" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a7bc550b0998f85235e84272a13965ee1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a7bc550b0998f85235e84272a13965ee1" kindref="member">errorhandler</ref>(self,<sp/>status_code_or_exception_class):</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Decorator<sp/>to<sp/>register<sp/>a<sp/>function<sp/>as<sp/>an<sp/>error<sp/>handler.<sp/>Error<sp/>handler</highlight></codeline>
<codeline lineno="1132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>functions<sp/>for<sp/>numeric<sp/>HTTP<sp/>status<sp/>codes<sp/>must<sp/>accept<sp/>a<sp/>single<sp/>argument,</highlight></codeline>
<codeline lineno="1133"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>request<sp/>object.<sp/>Error<sp/>handler<sp/>functions<sp/>for<sp/>Python<sp/>exceptions</highlight></codeline>
<codeline lineno="1134"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>must<sp/>accept<sp/>two<sp/>arguments,<sp/>the<sp/>request<sp/>object<sp/>and<sp/>the<sp/>exception</highlight></codeline>
<codeline lineno="1135"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object.</highlight></codeline>
<codeline lineno="1136"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1137"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>status_code_or_exception_class:<sp/>The<sp/>numeric<sp/>HTTP<sp/>status<sp/>code<sp/>or</highlight></codeline>
<codeline lineno="1138"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Python<sp/>exception<sp/>class<sp/>to</highlight></codeline>
<codeline lineno="1139"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handle.</highlight></codeline>
<codeline lineno="1140"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1141"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Examples::</highlight></codeline>
<codeline lineno="1142"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1143"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.errorhandler(404)</highlight></codeline>
<codeline lineno="1144"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>not_found(request):</highlight></codeline>
<codeline lineno="1145"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>&apos;Not<sp/>found&apos;</highlight></codeline>
<codeline lineno="1146"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1147"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.errorhandler(RuntimeError)</highlight></codeline>
<codeline lineno="1148"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>runtime_error(request,<sp/>exception):</highlight></codeline>
<codeline lineno="1149"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>&apos;Runtime<sp/>error&apos;</highlight></codeline>
<codeline lineno="1150"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">decorated(f):</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>[status_code_or_exception_class]<sp/>=<sp/>f</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>decorated</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"></highlight></codeline>
<codeline lineno="1156" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ac8673801a27078cbc65d8ed0daad5906" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ac8673801a27078cbc65d8ed0daad5906" kindref="member">mount</ref>(self,<sp/>subapp,<sp/>url_prefix=&apos;&apos;,<sp/>local=False):</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Mount<sp/>a<sp/>sub-application,<sp/>optionally<sp/>under<sp/>the<sp/>given<sp/>URL<sp/>prefix.</highlight></codeline>
<codeline lineno="1158"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1159"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>subapp:<sp/>The<sp/>sub-application<sp/>to<sp/>mount.</highlight></codeline>
<codeline lineno="1160"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url_prefix:<sp/>The<sp/>URL<sp/>prefix<sp/>to<sp/>mount<sp/>the<sp/>application<sp/>under.</highlight></codeline>
<codeline lineno="1161"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>local:<sp/>When<sp/>set<sp/>to<sp/>``True``,<sp/>the<sp/>before,<sp/>after<sp/>and<sp/>error<sp/>request</highlight></codeline>
<codeline lineno="1162"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers<sp/>only<sp/>apply<sp/>to<sp/>endpoints<sp/>defined<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="1163"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sub-application.<sp/>When<sp/>``False``,<sp/>they<sp/>apply<sp/>to<sp/>the<sp/>entire</highlight></codeline>
<codeline lineno="1164"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>application.<sp/>The<sp/>default<sp/>is<sp/>``False``.</highlight></codeline>
<codeline lineno="1165"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>methods,<sp/>pattern,<sp/>handler,<sp/>_prefix,<sp/>_subapp<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>subapp.url_map:</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1af02ae65e93c68095d857619646990b89" kindref="member">url_map</ref>.append(</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(methods,<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_u_r_l_pattern" kindref="compound">URLPattern</ref>(url_prefix<sp/>+<sp/>pattern.url_pattern),</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler,<sp/>url_prefix<sp/>+<sp/>_prefix,<sp/>_subapp<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>subapp))</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>local:</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>subapp.before_request_handlers:</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a28128d3f426a1605e5bc2a644198b2df" kindref="member">before_request_handlers</ref>.append(handler)</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subapp.before_request_handlers<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>subapp.after_request_handlers:</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a616bb78c555de2500d81256659ec0a86" kindref="member">after_request_handlers</ref>.append(handler)</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subapp.after_request_handlers<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>subapp.after_error_request_handlers:</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a1e11710f9bf25739e0d671bf0b763dcc" kindref="member">after_error_request_handlers</ref>.append(handler)</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subapp.after_error_request_handlers<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>status_code,<sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>subapp.error_handlers.items():</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>[status_code]<sp/>=<sp/>handler</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subapp.error_handlers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@staticmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1185" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8ab736759aa11ce92f3b4a8d28db55c7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacelib_1_1microdot_1_1microdot_1a9447ec9249a994d0ea84a81c527bba22" kindref="member">abort</ref>(status_code,<sp/>reason=None):</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Abort<sp/>the<sp/>current<sp/>request<sp/>and<sp/>return<sp/>an<sp/>error<sp/>response<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="1187"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>given<sp/>status<sp/>code.</highlight></codeline>
<codeline lineno="1188"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1189"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>status_code:<sp/>The<sp/>numeric<sp/>status<sp/>code<sp/>of<sp/>the<sp/>response.</highlight></codeline>
<codeline lineno="1190"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>reason:<sp/>The<sp/>reason<sp/>for<sp/>the<sp/>response,<sp/>which<sp/>is<sp/>included<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="1191"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>response<sp/>body.</highlight></codeline>
<codeline lineno="1192"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1193"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1194"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1195"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>microdot<sp/>import<sp/>abort</highlight></codeline>
<codeline lineno="1196"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1197"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.route(&apos;/users/&lt;int:id&gt;&apos;)</highlight></codeline>
<codeline lineno="1198"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>get_user(id):</highlight></codeline>
<codeline lineno="1199"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>user<sp/>=<sp/>get_user_by_id(id)</highlight></codeline>
<codeline lineno="1200"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>user<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1201"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>abort(404)</highlight></codeline>
<codeline lineno="1202"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>user.to_dict()</highlight></codeline>
<codeline lineno="1203"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_h_t_t_p_exception" kindref="compound">HTTPException</ref>(status_code,<sp/>reason)</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"></highlight></codeline>
<codeline lineno="1206" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9d04a8523b65458f8b1323edd391a2d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9d04a8523b65458f8b1323edd391a2d6" kindref="member">start_server</ref>(self,<sp/>host=&apos;0.0.0.0&apos;,<sp/>port=5000,<sp/>debug=False,</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl=None):</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Start<sp/>the<sp/>Microdot<sp/>web<sp/>server<sp/>as<sp/>a<sp/>coroutine.<sp/>This<sp/>coroutine<sp/>does</highlight></codeline>
<codeline lineno="1209"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>normally<sp/>return,<sp/>as<sp/>the<sp/>server<sp/>enters<sp/>an<sp/>endless<sp/>listening<sp/>loop.</highlight></codeline>
<codeline lineno="1210"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>:func:`shutdown`<sp/>function<sp/>provides<sp/>a<sp/>method<sp/>for<sp/>terminating<sp/>the</highlight></codeline>
<codeline lineno="1211"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>server<sp/>gracefully.</highlight></codeline>
<codeline lineno="1212"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>host:<sp/>The<sp/>hostname<sp/>or<sp/>IP<sp/>address<sp/>of<sp/>the<sp/>network<sp/>interface<sp/>that</highlight></codeline>
<codeline lineno="1214"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>be<sp/>listening<sp/>for<sp/>requests.<sp/>A<sp/>value<sp/>of<sp/>``&apos;0.0.0.0&apos;``</highlight></codeline>
<codeline lineno="1215"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(the<sp/>default)<sp/>indicates<sp/>that<sp/>the<sp/>server<sp/>should<sp/>listen<sp/>for</highlight></codeline>
<codeline lineno="1216"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requests<sp/>on<sp/>all<sp/>the<sp/>available<sp/>interfaces,<sp/>and<sp/>a<sp/>value<sp/>of</highlight></codeline>
<codeline lineno="1217"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``127.0.0.1``<sp/>indicates<sp/>that<sp/>the<sp/>server<sp/>should<sp/>listen</highlight></codeline>
<codeline lineno="1218"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>requests<sp/>only<sp/>on<sp/>the<sp/>internal<sp/>networking<sp/>interface<sp/>of</highlight></codeline>
<codeline lineno="1219"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>host.</highlight></codeline>
<codeline lineno="1220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>port:<sp/>The<sp/>port<sp/>number<sp/>to<sp/>listen<sp/>for<sp/>requests.<sp/>The<sp/>default<sp/>is</highlight></codeline>
<codeline lineno="1221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>port<sp/>5000.</highlight></codeline>
<codeline lineno="1222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>debug:<sp/>If<sp/>``True``,<sp/>the<sp/>server<sp/>logs<sp/>debugging<sp/>information.<sp/>The</highlight></codeline>
<codeline lineno="1223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>is<sp/>``False``.</highlight></codeline>
<codeline lineno="1224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>ssl:<sp/>An<sp/>``SSLContext``<sp/>instance<sp/>or<sp/>``None``<sp/>if<sp/>the<sp/>server<sp/>should</highlight></codeline>
<codeline lineno="1225"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>use<sp/>TLS.<sp/>The<sp/>default<sp/>is<sp/>``None``.</highlight></codeline>
<codeline lineno="1226"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1227"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>is<sp/>a<sp/>coroutine.</highlight></codeline>
<codeline lineno="1228"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1229"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1230"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1231"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>import<sp/>asyncio</highlight></codeline>
<codeline lineno="1232"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>microdot<sp/>import<sp/>Microdot</highlight></codeline>
<codeline lineno="1233"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1234"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>app<sp/>=<sp/>Microdot()</highlight></codeline>
<codeline lineno="1235"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1236"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.route(&apos;/&apos;)</highlight></codeline>
<codeline lineno="1237"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>async<sp/>def<sp/>index(request):</highlight></codeline>
<codeline lineno="1238"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>&apos;Hello,<sp/>world!&apos;</highlight></codeline>
<codeline lineno="1239"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1240"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>async<sp/>def<sp/>main():</highlight></codeline>
<codeline lineno="1241"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>app.start_server(debug=True)</highlight></codeline>
<codeline lineno="1242"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1243"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>asyncio.run(main())</highlight></codeline>
<codeline lineno="1244"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1abc0dc52ddc5182d86a1604502488bdda" kindref="member">debug</ref><sp/>=<sp/>debug</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"></highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal">serve(reader,<sp/>writer):</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>hasattr(writer,<sp/></highlight><highlight class="stringliteral">&apos;awrite&apos;</highlight><highlight class="normal">):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>CPython<sp/>provides<sp/>the<sp/>awrite<sp/>and<sp/>aclose<sp/>methods<sp/>in<sp/>3.8+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal">awrite(self,<sp/>data):</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.write(data)</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.drain()</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"></highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal">aclose(self):</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.close()</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.wait_closed()</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"></highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>types<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>MethodType</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer.awrite<sp/>=<sp/>MethodType(awrite,<sp/>writer)</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer.aclose<sp/>=<sp/>MethodType(aclose,<sp/>writer)</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aa8ca605ebda18eef0b44e228d44607cc" kindref="member">handle_request</ref>(reader,<sp/>writer)</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"></highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1abc0dc52ddc5182d86a1604502488bdda" kindref="member">debug</ref>:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;Starting<sp/>async<sp/>server<sp/>on<sp/>{host}:{port}...&apos;</highlight><highlight class="normal">.format(</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host=host,<sp/>port=port))</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" kindref="member">server</ref><sp/>=<sp/>await<sp/>asyncio.start_server(serve,<sp/>host,<sp/>port,</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl=ssl)</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" kindref="member">server</ref><sp/>=<sp/>await<sp/>asyncio.start_server(serve,<sp/>host,<sp/>port)</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"></highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" kindref="member">server</ref>,<sp/></highlight><highlight class="stringliteral">&apos;serve_forever&apos;</highlight><highlight class="normal">):<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" kindref="member">server</ref>.serve_forever()</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>asyncio.CancelledError:</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" kindref="member">server</ref>.wait_closed()</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>AttributeError:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>task<sp/>hasn&apos;t<sp/>been<sp/>initialized<sp/>in<sp/>the<sp/>server<sp/>object<sp/>yet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>wait<sp/>a<sp/>bit<sp/>and<sp/>try<sp/>again</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>asyncio.sleep(0.1)</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"></highlight></codeline>
<codeline lineno="1288" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ae0fe9d3ab62adf7b1b728ec5d633b1c2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ae0fe9d3ab62adf7b1b728ec5d633b1c2" kindref="member">run</ref>(self,<sp/>host=&apos;0.0.0.0&apos;,<sp/>port=5000,<sp/>debug=False,<sp/>ssl=None):</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Start<sp/>the<sp/>web<sp/>server.<sp/>This<sp/>function<sp/>does<sp/>not<sp/>normally<sp/>return,<sp/>as</highlight></codeline>
<codeline lineno="1290"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>server<sp/>enters<sp/>an<sp/>endless<sp/>listening<sp/>loop.<sp/>The<sp/>:func:`shutdown`</highlight></codeline>
<codeline lineno="1291"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function<sp/>provides<sp/>a<sp/>method<sp/>for<sp/>terminating<sp/>the<sp/>server<sp/>gracefully.</highlight></codeline>
<codeline lineno="1292"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1293"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>host:<sp/>The<sp/>hostname<sp/>or<sp/>IP<sp/>address<sp/>of<sp/>the<sp/>network<sp/>interface<sp/>that</highlight></codeline>
<codeline lineno="1294"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>be<sp/>listening<sp/>for<sp/>requests.<sp/>A<sp/>value<sp/>of<sp/>``&apos;0.0.0.0&apos;``</highlight></codeline>
<codeline lineno="1295"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(the<sp/>default)<sp/>indicates<sp/>that<sp/>the<sp/>server<sp/>should<sp/>listen<sp/>for</highlight></codeline>
<codeline lineno="1296"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requests<sp/>on<sp/>all<sp/>the<sp/>available<sp/>interfaces,<sp/>and<sp/>a<sp/>value<sp/>of</highlight></codeline>
<codeline lineno="1297"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``127.0.0.1``<sp/>indicates<sp/>that<sp/>the<sp/>server<sp/>should<sp/>listen</highlight></codeline>
<codeline lineno="1298"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>requests<sp/>only<sp/>on<sp/>the<sp/>internal<sp/>networking<sp/>interface<sp/>of</highlight></codeline>
<codeline lineno="1299"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>host.</highlight></codeline>
<codeline lineno="1300"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>port:<sp/>The<sp/>port<sp/>number<sp/>to<sp/>listen<sp/>for<sp/>requests.<sp/>The<sp/>default<sp/>is</highlight></codeline>
<codeline lineno="1301"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>port<sp/>5000.</highlight></codeline>
<codeline lineno="1302"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>debug:<sp/>If<sp/>``True``,<sp/>the<sp/>server<sp/>logs<sp/>debugging<sp/>information.<sp/>The</highlight></codeline>
<codeline lineno="1303"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>is<sp/>``False``.</highlight></codeline>
<codeline lineno="1304"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>ssl:<sp/>An<sp/>``SSLContext``<sp/>instance<sp/>or<sp/>``None``<sp/>if<sp/>the<sp/>server<sp/>should</highlight></codeline>
<codeline lineno="1305"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>use<sp/>TLS.<sp/>The<sp/>default<sp/>is<sp/>``None``.</highlight></codeline>
<codeline lineno="1306"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1307"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1308"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1309"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>microdot<sp/>import<sp/>Microdot</highlight></codeline>
<codeline lineno="1310"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1311"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>app<sp/>=<sp/>Microdot()</highlight></codeline>
<codeline lineno="1312"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1313"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.route(&apos;/&apos;)</highlight></codeline>
<codeline lineno="1314"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>async<sp/>def<sp/>index(request):</highlight></codeline>
<codeline lineno="1315"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>&apos;Hello,<sp/>world!&apos;</highlight></codeline>
<codeline lineno="1316"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1317"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>app.run(debug=True)</highlight></codeline>
<codeline lineno="1318"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>asyncio.run(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9d04a8523b65458f8b1323edd391a2d6" kindref="member">start_server</ref>(host=host,<sp/>port=port,<sp/>debug=debug,</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl=ssl))<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"></highlight></codeline>
<codeline lineno="1322" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8609b04c5dfdd06779712c0c82298e98" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8609b04c5dfdd06779712c0c82298e98" kindref="member">shutdown</ref>(self):</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Request<sp/>a<sp/>server<sp/>shutdown.<sp/>The<sp/>server<sp/>will<sp/>then<sp/>exit<sp/>its<sp/>request</highlight></codeline>
<codeline lineno="1324"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listening<sp/>loop<sp/>and<sp/>the<sp/>:func:`run`<sp/>function<sp/>will<sp/>return.<sp/>This<sp/>function</highlight></codeline>
<codeline lineno="1325"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>can<sp/>be<sp/>safely<sp/>called<sp/>from<sp/>a<sp/>route<sp/>handler,<sp/>as<sp/>it<sp/>only<sp/>schedules<sp/>the</highlight></codeline>
<codeline lineno="1326"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>server<sp/>to<sp/>terminate<sp/>as<sp/>soon<sp/>as<sp/>the<sp/>request<sp/>completes.</highlight></codeline>
<codeline lineno="1327"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1328"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1329"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1330"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@app.route(&apos;/shutdown&apos;)</highlight></codeline>
<codeline lineno="1331"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>shutdown(request):</highlight></codeline>
<codeline lineno="1332"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.app.shutdown()</highlight></codeline>
<codeline lineno="1333"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>&apos;The<sp/>server<sp/>is<sp/>shutting<sp/>down...&apos;</highlight></codeline>
<codeline lineno="1334"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a92ea29fcad5ca0843c2929a4bcd11644" kindref="member">server</ref>.close()</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"></highlight></codeline>
<codeline lineno="1337" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ae02efcc22036c0efe4486914ffa6fa87" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ae02efcc22036c0efe4486914ffa6fa87" kindref="member">find_route</ref>(self,<sp/>req):</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/>req.method.upper()</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>method<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;OPTIONS&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a40c0864d7eb796fa841799d1c6dac9b7" kindref="member">options_handler</ref>:</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a40c0864d7eb796fa841799d1c6dac9b7" kindref="member">options_handler</ref>(req),<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>method<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;HEAD&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;GET&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>404</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>route_methods,<sp/>route_pattern,<sp/>route_handler,<sp/>url_prefix,<sp/>subapp<sp/>\</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1af02ae65e93c68095d857619646990b89" kindref="member">url_map</ref>:</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req.url_args<sp/>=<sp/>route_pattern.match(req.path)</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>req.url_args<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>url_prefix</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>=<sp/>subapp</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>method<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>route_methods:</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>route_handler</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>405</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f,<sp/>p,<sp/>s</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"></highlight></codeline>
<codeline lineno="1359" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9fc21df5db33c03db48df2c76842049f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9fc21df5db33c03db48df2c76842049f" kindref="member">default_options_handler</ref>(self,<sp/>req):</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>route_methods,<sp/>route_pattern,<sp/>_,<sp/>_,<sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1af02ae65e93c68095d857619646990b89" kindref="member">url_map</ref>:</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>route_pattern.match(req.path)<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow.extend(route_methods)</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;GET&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>allow:</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow.append(</highlight><highlight class="stringliteral">&apos;HEAD&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow.append(</highlight><highlight class="stringliteral">&apos;OPTIONS&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{</highlight><highlight class="stringliteral">&apos;Allow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&apos;</highlight><highlight class="normal">.join(allow)}</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"></highlight></codeline>
<codeline lineno="1369" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aa8ca605ebda18eef0b44e228d44607cc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aa8ca605ebda18eef0b44e228d44607cc" kindref="member">handle_request</ref>(self,<sp/>reader,<sp/>writer):</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req<sp/>=<sp/>await<sp/>Request.create(self,<sp/>reader,<sp/>writer,</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer.get_extra_info(</highlight><highlight class="stringliteral">&apos;peername&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>Exception<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exc:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a7dc11fdc825cde8a3020a273d44cc9c1" kindref="member">print_exception</ref>(exc)</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"></highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ab0edd2d275e2c662d9890190e3e18a55" kindref="member">dispatch_request</ref>(req)</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>res<sp/>!=<sp/>Response.already_handled:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>branch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>res.write(writer)</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>writer.aclose()</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>OSError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exc:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>exc.errno<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>MUTED_SOCKET_ERRORS:</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1abc0dc52ddc5182d86a1604502488bdda" kindref="member">debug</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>req:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;{method}<sp/>{path}<sp/>{status_code}&apos;</highlight><highlight class="normal">.format(</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method=req.method,<sp/>path=req.path,</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_code=res.status_code))</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"></highlight></codeline>
<codeline lineno="1392" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9648e7fb9c6cd6e0774a0875b3fc9938" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9648e7fb9c6cd6e0774a0875b3fc9938" kindref="member">get_request_handlers</ref>(self,<sp/>req,<sp/>attr,<sp/>local_first=True):</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers<sp/>=<sp/>getattr(self,<sp/>attr<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;_handlers&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_handlers<sp/>=<sp/>getattr(req.subapp,<sp/>attr<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;_handlers&apos;</highlight><highlight class="normal">)<sp/>\</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>req<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>req.subapp<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>[]</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>local_handlers<sp/>+<sp/>handlers<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>local_first<sp/>\</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>handlers<sp/>+<sp/>local_handlers</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"></highlight></codeline>
<codeline lineno="1399" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a815364cc7e6431f444016d60435b263f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a815364cc7e6431f444016d60435b263f" kindref="member">error_response</ref>(self,<sp/>req,<sp/>status_code,<sp/>reason=None):</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>req<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>req.subapp<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>status_code<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>req.subapp.error_handlers:</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req.subapp.error_handlers[status_code],<sp/>req)</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>status_code<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>:</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>[status_code],<sp/>req)</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>reason<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;N/A&apos;</highlight><highlight class="normal">,<sp/>status_code</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"></highlight></codeline>
<codeline lineno="1407" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ab0edd2d275e2c662d9890190e3e18a55" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ab0edd2d275e2c662d9890190e3e18a55" kindref="member">dispatch_request</ref>(self,<sp/>req):</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>after_request_handled<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>req:</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>req.content_length<sp/>&gt;<sp/>req.max_content_length:</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>request<sp/>body<sp/>is<sp/>larger<sp/>than<sp/>allowed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a815364cc7e6431f444016d60435b263f" kindref="member">error_response</ref>(req,<sp/>413,<sp/></highlight><highlight class="stringliteral">&apos;Payload<sp/>too<sp/>large&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>find<sp/>the<sp/>route<sp/>in<sp/>the<sp/>app&apos;s<sp/>URL<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>req.url_prefix,<sp/>req.subapp<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1ae02efcc22036c0efe4486914ffa6fa87" kindref="member">find_route</ref>(req)</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"></highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>callable(f):</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>invoke<sp/>the<sp/>before<sp/>request<sp/>handlers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9648e7fb9c6cd6e0774a0875b3fc9938" kindref="member">get_request_handlers</ref>(</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req,<sp/></highlight><highlight class="stringliteral">&apos;before_request&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(handler,<sp/>req)</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>res:</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1426"><highlight class="normal"></highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>invoke<sp/>the<sp/>endpoint<sp/>handler</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>res<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(f,<sp/>req,<sp/>**req.url_args)</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"></highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>process<sp/>the<sp/>response</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(res,<sp/>int):</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>an<sp/>integer<sp/>response<sp/>is<sp/>taken<sp/>as<sp/>a<sp/>status<sp/>code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>with<sp/>an<sp/>empty<sp/>body</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/>res</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(res,<sp/>tuple):</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>handle<sp/>a<sp/>tuple<sp/>response</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(res[0],<sp/>int):</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>a<sp/>tuple<sp/>that<sp/>starts<sp/>with<sp/>an<sp/>int<sp/>has<sp/>an<sp/>empty</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>body</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>(</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/>res[0],</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[1]<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(res)<sp/>&gt;<sp/>1<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{})</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body<sp/>=<sp/>res[0]</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(res[1],<sp/>int):</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>extract<sp/>the<sp/>status<sp/>code<sp/>and<sp/>headers<sp/>(if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>available)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_code<sp/>=<sp/>res[1]</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/>res[2]<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(res)<sp/>&gt;<sp/>2<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{}</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>the<sp/>status<sp/>code<sp/>is<sp/>missing,<sp/>assume<sp/>200</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_code<sp/>=<sp/>200</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/>res[1]</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_response" kindref="compound">Response</ref>(body,<sp/>status_code,<sp/>headers)</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(res,<sp/>Response):</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>any<sp/>other<sp/>response<sp/>types<sp/>are<sp/>wrapped<sp/>in<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Response<sp/>object</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_response" kindref="compound">Response</ref>(res)</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"></highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>invoke<sp/>the<sp/>after<sp/>request<sp/>handlers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9648e7fb9c6cd6e0774a0875b3fc9938" kindref="member">get_request_handlers</ref>(</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req,<sp/></highlight><highlight class="stringliteral">&apos;after_request&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler,<sp/>req,<sp/>res)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>res</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>req.after_request_handlers:</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler,<sp/>req,<sp/>res)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>res</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>after_request_handled<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(f,<sp/>dict):</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>response<sp/>from<sp/>an<sp/>OPTIONS<sp/>request<sp/>is<sp/>a<sp/>dict<sp/>with</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_response" kindref="compound">Response</ref>(headers=f)</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>the<sp/>route<sp/>is<sp/>not<sp/>found,<sp/>return<sp/>a<sp/>404<sp/>or<sp/>405</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>response<sp/>as<sp/>appropriate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a815364cc7e6431f444016d60435b263f" kindref="member">error_response</ref>(req,<sp/>f,<sp/></highlight><highlight class="stringliteral">&apos;Not<sp/>found&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>HTTPException<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exc:</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>an<sp/>HTTP<sp/>exception<sp/>was<sp/>raised<sp/>while<sp/>handling<sp/>this<sp/>request</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a815364cc7e6431f444016d60435b263f" kindref="member">error_response</ref>(req,<sp/>exc.status_code,</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exc.reason)</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>Exception<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exc:</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>an<sp/>unexpected<sp/>exception<sp/>was<sp/>raised<sp/>while<sp/>handling<sp/>this</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>request</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a7dc11fdc825cde8a3020a273d44cc9c1" kindref="member">print_exception</ref>(exc)</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"></highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>invoke<sp/>the<sp/>error<sp/>handler<sp/>for<sp/>the<sp/>exception<sp/>class<sp/>if<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>exists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>req.subapp<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>exc.__class__<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req.subapp.error_handlers:</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>=<sp/>req.subapp.error_handlers[exc.__class__]</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>exc.__class__<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>:</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>[exc.__class__]</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>walk<sp/>up<sp/>the<sp/>exception<sp/>class<sp/>hierarchy<sp/>to<sp/>try<sp/>to<sp/>find</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>a<sp/>handler</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>c<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a6053923ec11384d589f74a5ec12ea3f2" kindref="member">mro</ref>(exc.__class__)[1:]:</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>req.subapp<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>c<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>req.subapp.error_handlers:</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>=<sp/>req.subapp.error_handlers[c]</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>c<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>:</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler<sp/>=<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a8687edf1df76b035483d719c88cf4529" kindref="member">error_handlers</ref>[c]</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>handler:</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(handler,<sp/>req,<sp/>exc)</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>Exception<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exc2:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a7dc11fdc825cde8a3020a273d44cc9c1" kindref="member">print_exception</ref>(exc2)</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>res<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>there<sp/>is<sp/>still<sp/>no<sp/>response,<sp/>issue<sp/>a<sp/>500<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a815364cc7e6431f444016d60435b263f" kindref="member">error_response</ref>(</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req,<sp/>500,<sp/></highlight><highlight class="stringliteral">&apos;Internal<sp/>server<sp/>error&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>the<sp/>request<sp/>could<sp/>not<sp/>be<sp/>parsed,<sp/>issue<sp/>a<sp/>400<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a815364cc7e6431f444016d60435b263f" kindref="member">error_response</ref>(req,<sp/>400,<sp/></highlight><highlight class="stringliteral">&apos;Bad<sp/>request&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(res,<sp/>tuple):</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_response" kindref="compound">Response</ref>(*res)</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(res,<sp/>Response):</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_response" kindref="compound">Response</ref>(res)</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>after_request_handled:</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>the<sp/>request<sp/>did<sp/>not<sp/>finish<sp/>due<sp/>to<sp/>an<sp/>error,<sp/>invoke<sp/>the<sp/>after</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>error<sp/>request<sp/>handler</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>handler<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1a9648e7fb9c6cd6e0774a0875b3fc9938" kindref="member">get_request_handlers</ref>(</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>req,<sp/></highlight><highlight class="stringliteral">&apos;after_error_request&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>await<sp/><ref refid="namespacelib_1_1microdot_1_1microdot_1a115cac046bbc33d685359322c47989be" kindref="member">invoke_handler</ref>(</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handler,<sp/>req,<sp/>res)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>res</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res.is_head<sp/>=<sp/>(req<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>req.method<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;HEAD&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"></highlight></codeline>
<codeline lineno="1530"><highlight class="normal"></highlight></codeline>
<codeline lineno="1531" refid="classlib_1_1microdot_1_1microdot_1_1_microdot_1aed3eaa6a68205b39276800fccbb64613" refkind="member"><highlight class="normal">Response.already_handled<sp/>=<sp/><ref refid="classlib_1_1microdot_1_1microdot_1_1_response" kindref="compound">Response</ref>()</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"></highlight></codeline>
<codeline lineno="1533" refid="namespacelib_1_1microdot_1_1microdot_1a9447ec9249a994d0ea84a81c527bba22" refkind="member"><highlight class="normal">abort<sp/>=<sp/>Microdot.abort</highlight></codeline>
<codeline lineno="1534" refid="namespacelib_1_1microdot_1_1microdot_1a2207eb7a8167ad4d77f95e6798c96b47" refkind="member"><highlight class="normal">redirect<sp/>=<sp/>Response.redirect</highlight></codeline>
<codeline lineno="1535" refid="namespacelib_1_1microdot_1_1microdot_1add1b27da3f4a2fc9a20bd69db7a52e82" refkind="member"><highlight class="normal">send_file<sp/>=<sp/>Response.send_file</highlight></codeline>
    </programlisting>
    <location file="microservicio_data_stream/lib/microdot/microdot.py"/>
  </compounddef>
</doxygen>
