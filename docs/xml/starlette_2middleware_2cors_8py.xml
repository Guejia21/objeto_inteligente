<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="es">
  <compounddef id="starlette_2middleware_2cors_8py" kind="file" language="Python">
    <compoundname>cors.py</compoundname>
    <innerclass refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware" prot="public">starlette::middleware::cors::CORSMiddleware</innerclass>
    <innernamespace refid="namespacestarlette">starlette</innernamespace>
    <innernamespace refid="namespacestarlette_1_1middleware">starlette::middleware</innernamespace>
    <innernamespace refid="namespacestarlette_1_1middleware_1_1cors">starlette::middleware::cors</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacestarlette_1_1middleware_1_1cors" refkind="compound"><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>annotations</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>functools</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>re</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacecollections_1_1abc" kindref="compound">collections.abc</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Sequence</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacestarlette_1_1datastructures" kindref="compound">starlette.datastructures</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Headers,<sp/>MutableHeaders</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacestarlette_1_1responses" kindref="compound">starlette.responses</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>PlainTextResponse,<sp/>Response</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacestarlette_1_1types" kindref="compound">starlette.types</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>ASGIApp,<sp/>Message,<sp/>Receive,<sp/>Scope,<sp/>Send</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11" refid="namespacestarlette_1_1middleware_1_1cors_1ad27ed25d52c387aaebf10dafbc3add04" refkind="member"><highlight class="normal">ALL_METHODS<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;DELETE&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;GET&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;HEAD&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;OPTIONS&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;PATCH&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;POST&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;PUT&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="12" refid="namespacestarlette_1_1middleware_1_1cors_1a9de31c71f3eeb0821415864270e6a5de" refkind="member"><highlight class="normal">SAFELISTED_HEADERS<sp/>=<sp/>{</highlight><highlight class="stringliteral">&quot;Accept&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Accept-Language&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Content-Language&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Content-Type&quot;</highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware" kindref="compound">CORSMiddleware</ref>:</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>app:<sp/>ASGIApp,</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_origins:<sp/>Sequence[str]<sp/>=<sp/>(),</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_methods:<sp/>Sequence[str]<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;GET&quot;</highlight><highlight class="normal">,),</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_headers:<sp/>Sequence[str]<sp/>=<sp/>(),</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_credentials:<sp/>bool<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_origin_regex:<sp/>str<sp/>|<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>expose_headers:<sp/>Sequence[str]<sp/>=<sp/>(),</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_age:<sp/>int<sp/>=<sp/>600,</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;*&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>allow_methods:</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_methods<sp/>=<sp/>ALL_METHODS</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compiled_allow_origin_regex<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>allow_origin_regex<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compiled_allow_origin_regex<sp/>=<sp/>re.compile(allow_origin_regex)</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_all_origins<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;*&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>allow_origins</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_all_headers<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;*&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>allow_headers</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>preflight_explicit_allow_origin<sp/>=<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>allow_all_origins<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>allow_credentials</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>simple_headers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>allow_all_origins:</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>simple_headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Origin&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;*&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>allow_credentials:</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>simple_headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Credentials&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;true&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>expose_headers:</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>simple_headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Expose-Headers&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>&quot;</highlight><highlight class="normal">.join(expose_headers)</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>preflight_headers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>preflight_explicit_allow_origin:</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>origin<sp/>value<sp/>will<sp/>be<sp/>set<sp/>in<sp/>preflight_response()<sp/>if<sp/>it<sp/>is<sp/>allowed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>preflight_headers[</highlight><highlight class="stringliteral">&quot;Vary&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Origin&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>preflight_headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Origin&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;*&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>preflight_headers.update(</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Methods&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>&quot;</highlight><highlight class="normal">.join(allow_methods),</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Access-Control-Max-Age&quot;</highlight><highlight class="normal">:<sp/>str(max_age),</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allow_headers<sp/>=<sp/>sorted(SAFELISTED_HEADERS<sp/>|<sp/>set(allow_headers))</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>allow_headers<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>allow_all_headers:</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>preflight_headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Headers&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>&quot;</highlight><highlight class="normal">.join(allow_headers)</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>allow_credentials:</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>preflight_headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Credentials&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;true&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1af59c9008018632489cf97f3d18ed60a8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1af59c9008018632489cf97f3d18ed60a8" kindref="member">app</ref><sp/>=<sp/>app</highlight></codeline>
<codeline lineno="65" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1addecf0cc042e5e4da8969036568bcb80" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1addecf0cc042e5e4da8969036568bcb80" kindref="member">allow_origins</ref><sp/>=<sp/>allow_origins</highlight></codeline>
<codeline lineno="66" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1ae006c413d309a99f55a962414a24aba8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1ae006c413d309a99f55a962414a24aba8" kindref="member">allow_methods</ref><sp/>=<sp/>allow_methods</highlight></codeline>
<codeline lineno="67" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a87625e8300d620443e8f2d9cdfaf52cc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a87625e8300d620443e8f2d9cdfaf52cc" kindref="member">allow_headers</ref><sp/>=<sp/>[h.lower()<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>h<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>allow_headers]</highlight></codeline>
<codeline lineno="68" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a9366ae619809488d752a0524e5508818" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a9366ae619809488d752a0524e5508818" kindref="member">allow_all_origins</ref><sp/>=<sp/>allow_all_origins</highlight></codeline>
<codeline lineno="69" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1aa4d884eafea3349117e819bb6bd7ba9a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1aa4d884eafea3349117e819bb6bd7ba9a" kindref="member">allow_all_headers</ref><sp/>=<sp/>allow_all_headers</highlight></codeline>
<codeline lineno="70" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a96d1c0f223227509d041b3862333f0c1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a96d1c0f223227509d041b3862333f0c1" kindref="member">preflight_explicit_allow_origin</ref><sp/>=<sp/>preflight_explicit_allow_origin</highlight></codeline>
<codeline lineno="71" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a68e431c93f773badb0d1e17cb0ecd602" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a68e431c93f773badb0d1e17cb0ecd602" kindref="member">allow_origin_regex</ref><sp/>=<sp/>compiled_allow_origin_regex</highlight></codeline>
<codeline lineno="72" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a475296939a973935bdcba2f79a4049dd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a475296939a973935bdcba2f79a4049dd" kindref="member">simple_headers</ref><sp/>=<sp/>simple_headers</highlight></codeline>
<codeline lineno="73" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a931875020ca82c2484af10872ba1aca4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a931875020ca82c2484af10872ba1aca4" kindref="member">preflight_headers</ref><sp/>=<sp/>preflight_headers</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal">__call__(self,<sp/>scope:<sp/>Scope,<sp/>receive:<sp/>Receive,<sp/>send:<sp/>Send)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>scope[</highlight><highlight class="stringliteral">&quot;type&quot;</highlight><highlight class="normal">]<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;http&quot;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="comment">#<sp/>pragma:<sp/>no<sp/>cover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1af59c9008018632489cf97f3d18ed60a8" kindref="member">app</ref>(scope,<sp/>receive,<sp/>send)</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/>scope[</highlight><highlight class="stringliteral">&quot;method&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/><ref refid="classstarlette_1_1datastructures_1_1_headers" kindref="compound">Headers</ref>(scope=scope)</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin<sp/>=<sp/>headers.get(</highlight><highlight class="stringliteral">&quot;origin&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>origin<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1af59c9008018632489cf97f3d18ed60a8" kindref="member">app</ref>(scope,<sp/>receive,<sp/>send)</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>method<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;OPTIONS&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;access-control-request-method&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>headers:</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>response<sp/>=<sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1add98bfc1d3e26902db7f0121232acc85" kindref="member">preflight_response</ref>(request_headers=headers)</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>response(scope,<sp/>receive,<sp/>send)</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1accb12d96d9da92e36ff77a54f8c4beff" kindref="member">simple_response</ref>(scope,<sp/>receive,<sp/>send,<sp/>request_headers=headers)</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a3773a6cd8ec1b94b6039e425687f1c72" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a3773a6cd8ec1b94b6039e425687f1c72" kindref="member">is_allowed_origin</ref>(self,<sp/>origin:<sp/>str)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a9366ae619809488d752a0524e5508818" kindref="member">allow_all_origins</ref>:</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a68e431c93f773badb0d1e17cb0ecd602" kindref="member">allow_origin_regex</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a68e431c93f773badb0d1e17cb0ecd602" kindref="member">allow_origin_regex</ref>.fullmatch(origin):</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>origin<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1addecf0cc042e5e4da8969036568bcb80" kindref="member">allow_origins</ref></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1add98bfc1d3e26902db7f0121232acc85" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1add98bfc1d3e26902db7f0121232acc85" kindref="member">preflight_response</ref>(self,<sp/>request_headers:<sp/>Headers)<sp/>-&gt;<sp/>Response:</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requested_origin<sp/>=<sp/>request_headers[</highlight><highlight class="stringliteral">&quot;origin&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requested_method<sp/>=<sp/>request_headers[</highlight><highlight class="stringliteral">&quot;access-control-request-method&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requested_headers<sp/>=<sp/>request_headers.get(</highlight><highlight class="stringliteral">&quot;access-control-request-headers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/>dict(self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a931875020ca82c2484af10872ba1aca4" kindref="member">preflight_headers</ref>)</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>failures<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a3773a6cd8ec1b94b6039e425687f1c72" kindref="member">is_allowed_origin</ref>(origin=requested_origin):</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a96d1c0f223227509d041b3862333f0c1" kindref="member">preflight_explicit_allow_origin</ref>:</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>&quot;else&quot;<sp/>case<sp/>is<sp/>already<sp/>accounted<sp/>for<sp/>in<sp/>self.preflight_headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>and<sp/>the<sp/>value<sp/>would<sp/>be<sp/>&quot;*&quot;.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Origin&quot;</highlight><highlight class="normal">]<sp/>=<sp/>requested_origin</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>failures.append(</highlight><highlight class="stringliteral">&quot;origin&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>requested_method<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1ae006c413d309a99f55a962414a24aba8" kindref="member">allow_methods</ref>:</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>failures.append(</highlight><highlight class="stringliteral">&quot;method&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>we<sp/>allow<sp/>all<sp/>headers,<sp/>then<sp/>we<sp/>have<sp/>to<sp/>mirror<sp/>back<sp/>any<sp/>requested</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>headers<sp/>in<sp/>the<sp/>response.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1aa4d884eafea3349117e819bb6bd7ba9a" kindref="member">allow_all_headers</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>requested_headers<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Headers&quot;</highlight><highlight class="normal">]<sp/>=<sp/>requested_headers</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>requested_headers<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>header<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>[h.lower()<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>h<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>requested_headers.split(</highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal">)]:</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>header.strip()<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a87625e8300d620443e8f2d9cdfaf52cc" kindref="member">allow_headers</ref>:</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>failures.append(</highlight><highlight class="stringliteral">&quot;headers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>don&apos;t<sp/>strictly<sp/>need<sp/>to<sp/>use<sp/>400<sp/>responses<sp/>here,<sp/>since<sp/>its<sp/>up<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>browser<sp/>to<sp/>enforce<sp/>the<sp/>CORS<sp/>policy,<sp/>but<sp/>its<sp/>more<sp/>informative</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>we<sp/>do.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>failures:</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>failure_text<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Disallowed<sp/>CORS<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>&quot;</highlight><highlight class="normal">.join(failures)</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classstarlette_1_1responses_1_1_plain_text_response" kindref="compound">PlainTextResponse</ref>(failure_text,<sp/>status_code=400,<sp/>headers=headers)</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classstarlette_1_1responses_1_1_plain_text_response" kindref="compound">PlainTextResponse</ref>(</highlight><highlight class="stringliteral">&quot;OK&quot;</highlight><highlight class="normal">,<sp/>status_code=200,<sp/>headers=headers)</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1accb12d96d9da92e36ff77a54f8c4beff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1accb12d96d9da92e36ff77a54f8c4beff" kindref="member">simple_response</ref>(self,<sp/>scope:<sp/>Scope,<sp/>receive:<sp/>Receive,<sp/>send:<sp/>Send,<sp/>request_headers:<sp/>Headers)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>send<sp/>=<sp/>functools.partial(self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a0bc35b6942aa37db0651a7fb17e526d0" kindref="member">send</ref>,<sp/>send=send,<sp/>request_headers=request_headers)</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1af59c9008018632489cf97f3d18ed60a8" kindref="member">app</ref>(scope,<sp/>receive,<sp/>send)</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a0bc35b6942aa37db0651a7fb17e526d0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">async<sp/>def<sp/></highlight><highlight class="normal"><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a0bc35b6942aa37db0651a7fb17e526d0" kindref="member">send</ref>(self,<sp/>message:<sp/>Message,<sp/>send:<sp/>Send,<sp/>request_headers:<sp/>Headers)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>message[</highlight><highlight class="stringliteral">&quot;type&quot;</highlight><highlight class="normal">]<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;http.response.start&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a0bc35b6942aa37db0651a7fb17e526d0" kindref="member">send</ref>(message)</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.setdefault(</highlight><highlight class="stringliteral">&quot;headers&quot;</highlight><highlight class="normal">,<sp/>[])</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/><ref refid="classstarlette_1_1datastructures_1_1_mutable_headers" kindref="compound">MutableHeaders</ref>(scope=message)</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers.update(self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a475296939a973935bdcba2f79a4049dd" kindref="member">simple_headers</ref>)</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin<sp/>=<sp/>request_headers[</highlight><highlight class="stringliteral">&quot;Origin&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>has_cookie<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;cookie&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>request_headers</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>request<sp/>includes<sp/>any<sp/>cookie<sp/>headers,<sp/>then<sp/>we<sp/>must<sp/>respond</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>with<sp/>the<sp/>specific<sp/>origin<sp/>instead<sp/>of<sp/>&apos;*&apos;.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a9366ae619809488d752a0524e5508818" kindref="member">allow_all_origins</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>has_cookie:</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a63ca922b331b04564d289cf991c4f924" kindref="member">allow_explicit_origin</ref>(headers,<sp/>origin)</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>we<sp/>only<sp/>allow<sp/>specific<sp/>origins,<sp/>then<sp/>we<sp/>have<sp/>to<sp/>mirror<sp/>back</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>Origin<sp/>header<sp/>in<sp/>the<sp/>response.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a9366ae619809488d752a0524e5508818" kindref="member">allow_all_origins</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a3773a6cd8ec1b94b6039e425687f1c72" kindref="member">is_allowed_origin</ref>(origin=origin):</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a63ca922b331b04564d289cf991c4f924" kindref="member">allow_explicit_origin</ref>(headers,<sp/>origin)</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a0bc35b6942aa37db0651a7fb17e526d0" kindref="member">send</ref>(message)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@staticmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170" refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a63ca922b331b04564d289cf991c4f924" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classstarlette_1_1middleware_1_1cors_1_1_c_o_r_s_middleware_1a63ca922b331b04564d289cf991c4f924" kindref="member">allow_explicit_origin</ref>(headers:<sp/>MutableHeaders,<sp/>origin:<sp/>str)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers[</highlight><highlight class="stringliteral">&quot;Access-Control-Allow-Origin&quot;</highlight><highlight class="normal">]<sp/>=<sp/>origin</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers.add_vary_header(</highlight><highlight class="stringliteral">&quot;Origin&quot;</highlight><highlight class="normal">)</highlight></codeline>
    </programlisting>
    <location file="micro_gestion_objetos/venv/Lib/site-packages/starlette/middleware/cors.py"/>
  </compounddef>
</doxygen>
