<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="es">
  <compounddef id="client_8py" kind="file" language="Python">
    <compoundname>client.py</compoundname>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1___in_packet" prot="protected">paho::mqtt::client::_InPacket</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1___out_packet" prot="protected">paho::mqtt::client::_OutPacket</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1_socket_like" prot="public">paho::mqtt::client::SocketLike</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1_connect_flags" prot="public">paho::mqtt::client::ConnectFlags</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1_disconnect_flags" prot="public">paho::mqtt::client::DisconnectFlags</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1_websocket_connection_error" prot="public">paho::mqtt::client::WebsocketConnectionError</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info" prot="public">paho::mqtt::client::MQTTMessageInfo</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message" prot="public">paho::mqtt::client::MQTTMessage</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1_client" prot="public">paho::mqtt::client::Client</innerclass>
    <innerclass refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper" prot="protected">paho::mqtt::client::_WebsocketWrapper</innerclass>
    <innernamespace refid="namespacepaho">paho</innernamespace>
    <innernamespace refid="namespacepaho_1_1mqtt">paho::mqtt</innernamespace>
    <innernamespace refid="namespacepaho_1_1mqtt_1_1client">paho::mqtt::client</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacepaho_1_1mqtt_1_1client" refkind="compound"><highlight class="comment">#<sp/>Copyright<sp/>(c)<sp/>2012-2019<sp/>Roger<sp/>Light<sp/>and<sp/>others</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">#<sp/>All<sp/>rights<sp/>reserved.<sp/>This<sp/>program<sp/>and<sp/>the<sp/>accompanying<sp/>materials</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">#<sp/>are<sp/>made<sp/>available<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>Eclipse<sp/>Public<sp/>License<sp/>v2.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">#<sp/>and<sp/>Eclipse<sp/>Distribution<sp/>License<sp/>v1.0<sp/>which<sp/>accompany<sp/>this<sp/>distribution.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">#<sp/>The<sp/>Eclipse<sp/>Public<sp/>License<sp/>is<sp/>available<sp/>at</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>http://www.eclipse.org/legal/epl-v20.html</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">#<sp/>and<sp/>the<sp/>Eclipse<sp/>Distribution<sp/>License<sp/>is<sp/>available<sp/>at</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>http://www.eclipse.org/org/documents/edl-v10.php.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Contributors:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>Roger<sp/>Light<sp/>-<sp/>initial<sp/>API<sp/>and<sp/>implementation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>Ian<sp/>Craggs<sp/>-<sp/>MQTT<sp/>V5<sp/>support</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="16"><highlight class="stringliteral">This<sp/>is<sp/>an<sp/>MQTT<sp/>client<sp/>module.<sp/>MQTT<sp/>is<sp/>a<sp/>lightweight<sp/>pub/sub<sp/>messaging</highlight></codeline>
<codeline lineno="17"><highlight class="stringliteral">protocol<sp/>that<sp/>is<sp/>easy<sp/>to<sp/>implement<sp/>and<sp/>suitable<sp/>for<sp/>low<sp/>powered<sp/>devices.</highlight></codeline>
<codeline lineno="18"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>annotations</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>base64</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>collections</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>errno</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>hashlib</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>logging</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>platform</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>select</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>socket</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>string</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>struct</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>threading</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>time</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>urllib.parse</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>urllib.request</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>uuid</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>warnings</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>TYPE_CHECKING,<sp/>Any,<sp/>Callable,<sp/>Dict,<sp/>Iterator,<sp/>List,<sp/>NamedTuple,<sp/>Sequence,<sp/>Tuple,<sp/>Union,<sp/>cast</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepaho_1_1mqtt_1_1packettypes" kindref="compound">paho.mqtt.packettypes</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>PacketTypes</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.enums<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>CallbackAPIVersion,<sp/>ConnackCode,<sp/>LogLevel,<sp/>MessageState,<sp/>MessageType,<sp/>MQTTErrorCode,<sp/>MQTTProtocolVersion,<sp/>PahoClientMode,<sp/>_ConnectionState</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.matcher<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>MQTTMatcher</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.properties<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Properties</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.reasoncodes<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>ReasonCode,<sp/>ReasonCodes</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.subscribeoptions<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>SubscribeOptions</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Literal</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing_extensions<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Literal<sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>TYPE_CHECKING:</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>TypedDict<sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing_extensions<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>TypedDict</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Protocol<sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing_extensions<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Protocol<sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="classpaho_1_1mqtt_1_1client_1_1___in_packet" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1___in_packet" kindref="compound">_InPacket</ref>(TypedDict):</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command:<sp/>int</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>have_remaining:<sp/>int</highlight></codeline>
<codeline lineno="67" refid="classpaho_1_1mqtt_1_1client_1_1___in_packet_1ada80f7d0ce57adca694f1ebc4edd8773" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_count:<sp/>list[int]</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_mult:<sp/>int</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length:<sp/>int</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet:<sp/>bytearray</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to_process:<sp/>int</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos:<sp/>int</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75" refid="classpaho_1_1mqtt_1_1client_1_1___out_packet" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1___out_packet" kindref="compound">_OutPacket</ref>(TypedDict):</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command:<sp/>int</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid:<sp/>int</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qos:<sp/>int</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos:<sp/>int</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to_process:<sp/>int</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet:<sp/>bytes</highlight></codeline>
<codeline lineno="82" refid="classpaho_1_1mqtt_1_1client_1_1___out_packet_1a25d8ceba0956c75fae4b4afb5080ed3a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info:<sp/>MQTTMessageInfo<sp/>|<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="classpaho_1_1mqtt_1_1client_1_1_socket_like" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_socket_like" kindref="compound">SocketLike</ref>(<ref refid="classtyping__extensions_1_1_protocol" kindref="compound">Protocol</ref>):</highlight></codeline>
<codeline lineno="85" refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a822b1d6765384bde96edac6e736de8f7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a822b1d6765384bde96edac6e736de8f7" kindref="member">recv</ref>(self,<sp/>buffer_size:<sp/>int)<sp/>-&gt;<sp/>bytes:</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline lineno="87" refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a8a7789e2a089acebc38f223db67d0af4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a8a7789e2a089acebc38f223db67d0af4" kindref="member">send</ref>(self,<sp/>buffer:<sp/>bytes)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline lineno="89" refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a540af55b2eeda7a2c74e60d9193f63dc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a540af55b2eeda7a2c74e60d9193f63dc" kindref="member">close</ref>(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline lineno="91" refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a010dbcc5e6f00865e8f7f3277c7ae798" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1a010dbcc5e6f00865e8f7f3277c7ae798" kindref="member">fileno</ref>(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline lineno="93" refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1ac1b8bdfd75be28ed6285038012e854c5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_socket_like_1ac1b8bdfd75be28ed6285038012e854c5" kindref="member">setblocking</ref>(self,<sp/>flag:<sp/>bool)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>ssl</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="100" refid="namespacepaho_1_1mqtt_1_1client_1a83b7f15c31dd5c27463dab5790c87d25" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>ssl<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore[assignment]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>socks<sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore[import-untyped]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="106" refid="namespacepaho_1_1mqtt_1_1client_1a23a69ff61da74e1e4034717236eed7c5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>socks<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore[assignment]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Use<sp/>monotonic<sp/>clock<sp/>if<sp/>available</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="namespacepaho_1_1mqtt_1_1client_1a834b8f4fbe5ec604671023b59d0377fd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>time_func<sp/>=<sp/>time.monotonic</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>AttributeError:</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>time_func<sp/>=<sp/>time.time</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>dns.resolver</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118" refid="namespacepaho_1_1mqtt_1_1client_1a1b36c54e891f6afc782b8497745d0d9b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>HAVE_DNS<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>HAVE_DNS<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>platform.system()<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;Windows&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="124" refid="namespacepaho_1_1mqtt_1_1client_1aebf92fb3e9c94f285ccebef7f9a846e6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>EAGAIN<sp/>=<sp/>errno.WSAEWOULDBLOCK<sp/><sp/></highlight><highlight class="comment">#<sp/>type:<sp/>ignore[attr-defined]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>EAGAIN<sp/>=<sp/>errno.EAGAIN</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Avoid<sp/>linter<sp/>complain.<sp/>We<sp/>kept<sp/>importing<sp/>it<sp/>as<sp/>ReasonCodes<sp/>(plural)<sp/>for<sp/>compatibility</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129" refid="namespacepaho_1_1mqtt_1_1client_1ac6972bdb0d63d3cef81aa2d5056acd36" refkind="member"><highlight class="normal">_<sp/>=<sp/>ReasonCodes</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Keep<sp/>copy<sp/>of<sp/>enums<sp/>values<sp/>for<sp/>compatibility.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132" refid="namespacepaho_1_1mqtt_1_1client_1a4427fe2ff4ab40e874b766f2011d00a2" refkind="member"><highlight class="normal">CONNECT<sp/>=<sp/>MessageType.CONNECT</highlight></codeline>
<codeline lineno="133" refid="namespacepaho_1_1mqtt_1_1client_1a90dcc43013f19052e43e23549e690887" refkind="member"><highlight class="normal">CONNACK<sp/>=<sp/>MessageType.CONNACK</highlight></codeline>
<codeline lineno="134" refid="namespacepaho_1_1mqtt_1_1client_1a38afb00330799a7595b822c6f9319449" refkind="member"><highlight class="normal">PUBLISH<sp/>=<sp/>MessageType.PUBLISH</highlight></codeline>
<codeline lineno="135" refid="namespacepaho_1_1mqtt_1_1client_1a6dd7b6b3d65891810f6217ec93ed2a4b" refkind="member"><highlight class="normal">PUBACK<sp/>=<sp/>MessageType.PUBACK</highlight></codeline>
<codeline lineno="136" refid="namespacepaho_1_1mqtt_1_1client_1a79d67ba72383fddb0c40fb34b44dde21" refkind="member"><highlight class="normal">PUBREC<sp/>=<sp/>MessageType.PUBREC</highlight></codeline>
<codeline lineno="137" refid="namespacepaho_1_1mqtt_1_1client_1ac750044741dc1c0a4a5a391c9aaae32c" refkind="member"><highlight class="normal">PUBREL<sp/>=<sp/>MessageType.PUBREL</highlight></codeline>
<codeline lineno="138" refid="namespacepaho_1_1mqtt_1_1client_1a2fee5dcadd824c093aa33998e04f7d03" refkind="member"><highlight class="normal">PUBCOMP<sp/>=<sp/>MessageType.PUBCOMP</highlight></codeline>
<codeline lineno="139" refid="namespacepaho_1_1mqtt_1_1client_1af1b23815661f8eacf42aa6c02fa94cfa" refkind="member"><highlight class="normal">SUBSCRIBE<sp/>=<sp/>MessageType.SUBSCRIBE</highlight></codeline>
<codeline lineno="140" refid="namespacepaho_1_1mqtt_1_1client_1a1f68e4c5870219f685711e3d149c626d" refkind="member"><highlight class="normal">SUBACK<sp/>=<sp/>MessageType.SUBACK</highlight></codeline>
<codeline lineno="141" refid="namespacepaho_1_1mqtt_1_1client_1a7583f87343d7afc88c195a62a4495c45" refkind="member"><highlight class="normal">UNSUBSCRIBE<sp/>=<sp/>MessageType.UNSUBSCRIBE</highlight></codeline>
<codeline lineno="142" refid="namespacepaho_1_1mqtt_1_1client_1a6bbab5d499fb78b404ca09af3a5cc144" refkind="member"><highlight class="normal">UNSUBACK<sp/>=<sp/>MessageType.UNSUBACK</highlight></codeline>
<codeline lineno="143" refid="namespacepaho_1_1mqtt_1_1client_1ab9f455a42b2950483ec0eb8cd5edca6e" refkind="member"><highlight class="normal">PINGREQ<sp/>=<sp/>MessageType.PINGREQ</highlight></codeline>
<codeline lineno="144" refid="namespacepaho_1_1mqtt_1_1client_1ab0f04ed86a2b31916daee79be41e927e" refkind="member"><highlight class="normal">PINGRESP<sp/>=<sp/>MessageType.PINGRESP</highlight></codeline>
<codeline lineno="145" refid="namespacepaho_1_1mqtt_1_1client_1ab322a270766353fda4b9de03f0121967" refkind="member"><highlight class="normal">DISCONNECT<sp/>=<sp/>MessageType.DISCONNECT</highlight></codeline>
<codeline lineno="146" refid="namespacepaho_1_1mqtt_1_1client_1a8570eb91aa4566a0118b2ce368cc321d" refkind="member"><highlight class="normal">AUTH<sp/>=<sp/>MessageType.AUTH</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Log<sp/>levels</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149" refid="namespacepaho_1_1mqtt_1_1client_1aa44d1a9715f8e13141b8ae6e97b08a66" refkind="member"><highlight class="normal">MQTT_LOG_INFO<sp/>=<sp/>LogLevel.MQTT_LOG_INFO</highlight></codeline>
<codeline lineno="150" refid="namespacepaho_1_1mqtt_1_1client_1a70f35c1d25c2cc41da1e259fa7bc760e" refkind="member"><highlight class="normal">MQTT_LOG_NOTICE<sp/>=<sp/>LogLevel.MQTT_LOG_NOTICE</highlight></codeline>
<codeline lineno="151" refid="namespacepaho_1_1mqtt_1_1client_1a2ba50bd2cd24f32893bafec8dc3a6070" refkind="member"><highlight class="normal">MQTT_LOG_WARNING<sp/>=<sp/>LogLevel.MQTT_LOG_WARNING</highlight></codeline>
<codeline lineno="152" refid="namespacepaho_1_1mqtt_1_1client_1a4ec979c85243619a48ba8dd6a402dfa4" refkind="member"><highlight class="normal">MQTT_LOG_ERR<sp/>=<sp/>LogLevel.MQTT_LOG_ERR</highlight></codeline>
<codeline lineno="153" refid="namespacepaho_1_1mqtt_1_1client_1a7534cb94cb9ca988c1a21bc07a203935" refkind="member"><highlight class="normal">MQTT_LOG_DEBUG<sp/>=<sp/>LogLevel.MQTT_LOG_DEBUG</highlight></codeline>
<codeline lineno="154" refid="namespacepaho_1_1mqtt_1_1client_1af4c056514b387fb66d4aaa63ae5dab5e" refkind="member"><highlight class="normal">LOGGING_LEVEL<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>LogLevel.MQTT_LOG_DEBUG:<sp/>logging.DEBUG,</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>LogLevel.MQTT_LOG_INFO:<sp/>logging.INFO,</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>LogLevel.MQTT_LOG_NOTICE:<sp/>logging.INFO,<sp/><sp/></highlight><highlight class="comment">#<sp/>This<sp/>has<sp/>no<sp/>direct<sp/>equivalent<sp/>level</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>LogLevel.MQTT_LOG_WARNING:<sp/>logging.WARNING,</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>LogLevel.MQTT_LOG_ERR:<sp/>logging.ERROR,</highlight></codeline>
<codeline lineno="160"><highlight class="normal">}</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight><highlight class="comment">#<sp/>CONNACK<sp/>codes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163" refid="namespacepaho_1_1mqtt_1_1client_1abf727ee613a38b2a94873748cf1ea998" refkind="member"><highlight class="normal">CONNACK_ACCEPTED<sp/>=<sp/>ConnackCode.CONNACK_ACCEPTED</highlight></codeline>
<codeline lineno="164" refid="namespacepaho_1_1mqtt_1_1client_1a75ea575834fdc16b6e1abe4b60a0929b" refkind="member"><highlight class="normal">CONNACK_REFUSED_PROTOCOL_VERSION<sp/>=<sp/>ConnackCode.CONNACK_REFUSED_PROTOCOL_VERSION</highlight></codeline>
<codeline lineno="165" refid="namespacepaho_1_1mqtt_1_1client_1a0876809459a309c437bb175513e0c4ef" refkind="member"><highlight class="normal">CONNACK_REFUSED_IDENTIFIER_REJECTED<sp/>=<sp/>ConnackCode.CONNACK_REFUSED_IDENTIFIER_REJECTED</highlight></codeline>
<codeline lineno="166" refid="namespacepaho_1_1mqtt_1_1client_1a5997f05d945c049e6f227ae8ca8df740" refkind="member"><highlight class="normal">CONNACK_REFUSED_SERVER_UNAVAILABLE<sp/>=<sp/>ConnackCode.CONNACK_REFUSED_SERVER_UNAVAILABLE</highlight></codeline>
<codeline lineno="167" refid="namespacepaho_1_1mqtt_1_1client_1a74fbfb5d67ceb03a9f2b6351d6d8d72d" refkind="member"><highlight class="normal">CONNACK_REFUSED_BAD_USERNAME_PASSWORD<sp/>=<sp/>ConnackCode.CONNACK_REFUSED_BAD_USERNAME_PASSWORD</highlight></codeline>
<codeline lineno="168" refid="namespacepaho_1_1mqtt_1_1client_1a51d1c4f562adefde3dcb86df8c40ec19" refkind="member"><highlight class="normal">CONNACK_REFUSED_NOT_AUTHORIZED<sp/>=<sp/>ConnackCode.CONNACK_REFUSED_NOT_AUTHORIZED</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Message<sp/>state</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171" refid="namespacepaho_1_1mqtt_1_1client_1ab684cfe8393a402782c0802db5bac7ff" refkind="member"><highlight class="normal">mqtt_ms_invalid<sp/>=<sp/>MessageState.MQTT_MS_INVALID</highlight></codeline>
<codeline lineno="172" refid="namespacepaho_1_1mqtt_1_1client_1a02f61a981d2a8d5ccef6c19d493e74ad" refkind="member"><highlight class="normal">mqtt_ms_publish<sp/>=<sp/>MessageState.MQTT_MS_PUBLISH</highlight></codeline>
<codeline lineno="173" refid="namespacepaho_1_1mqtt_1_1client_1a1f931aa4696466d565fc4c18336d3380" refkind="member"><highlight class="normal">mqtt_ms_wait_for_puback<sp/>=<sp/>MessageState.MQTT_MS_WAIT_FOR_PUBACK</highlight></codeline>
<codeline lineno="174" refid="namespacepaho_1_1mqtt_1_1client_1a916f2e81ec11d9f13a3aa40390364c77" refkind="member"><highlight class="normal">mqtt_ms_wait_for_pubrec<sp/>=<sp/>MessageState.MQTT_MS_WAIT_FOR_PUBREC</highlight></codeline>
<codeline lineno="175" refid="namespacepaho_1_1mqtt_1_1client_1a8cdfcd1b0fdd1c65bc854df9684bd11c" refkind="member"><highlight class="normal">mqtt_ms_resend_pubrel<sp/>=<sp/>MessageState.MQTT_MS_RESEND_PUBREL</highlight></codeline>
<codeline lineno="176" refid="namespacepaho_1_1mqtt_1_1client_1ad8a48b34b2804608057880cdf7ff81f1" refkind="member"><highlight class="normal">mqtt_ms_wait_for_pubrel<sp/>=<sp/>MessageState.MQTT_MS_WAIT_FOR_PUBREL</highlight></codeline>
<codeline lineno="177" refid="namespacepaho_1_1mqtt_1_1client_1aac7c177ea72e587d3d2201f4fa448a76" refkind="member"><highlight class="normal">mqtt_ms_resend_pubcomp<sp/>=<sp/>MessageState.MQTT_MS_RESEND_PUBCOMP</highlight></codeline>
<codeline lineno="178" refid="namespacepaho_1_1mqtt_1_1client_1a24aa2eb0e5eaf3117f68412f1420c745" refkind="member"><highlight class="normal">mqtt_ms_wait_for_pubcomp<sp/>=<sp/>MessageState.MQTT_MS_WAIT_FOR_PUBCOMP</highlight></codeline>
<codeline lineno="179" refid="namespacepaho_1_1mqtt_1_1client_1a98d64d2298562a0156c851582b4097e5" refkind="member"><highlight class="normal">mqtt_ms_send_pubrec<sp/>=<sp/>MessageState.MQTT_MS_SEND_PUBREC</highlight></codeline>
<codeline lineno="180" refid="namespacepaho_1_1mqtt_1_1client_1a95b65ed497b7078fb43c59729d45984f" refkind="member"><highlight class="normal">mqtt_ms_queued<sp/>=<sp/>MessageState.MQTT_MS_QUEUED</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182" refid="namespacepaho_1_1mqtt_1_1client_1a29392f868991da09c28189c7d91e5572" refkind="member"><highlight class="normal">MQTT_ERR_AGAIN<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_AGAIN</highlight></codeline>
<codeline lineno="183" refid="namespacepaho_1_1mqtt_1_1client_1a45ee1a9be9e31002a531dcd170f84e4d" refkind="member"><highlight class="normal">MQTT_ERR_SUCCESS<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="184" refid="namespacepaho_1_1mqtt_1_1client_1ae9d887ecfcac44d9008ed02d38149461" refkind="member"><highlight class="normal">MQTT_ERR_NOMEM<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_NOMEM</highlight></codeline>
<codeline lineno="185" refid="namespacepaho_1_1mqtt_1_1client_1af927e41002a5208ec0455352707e9637" refkind="member"><highlight class="normal">MQTT_ERR_PROTOCOL<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="186" refid="namespacepaho_1_1mqtt_1_1client_1aa296ea7742a1a39bac115f70bcef69ec" refkind="member"><highlight class="normal">MQTT_ERR_INVAL<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_INVAL</highlight></codeline>
<codeline lineno="187" refid="namespacepaho_1_1mqtt_1_1client_1a29b5cddd2c5c91daa44edb4b48edc392" refkind="member"><highlight class="normal">MQTT_ERR_NO_CONN<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_NO_CONN</highlight></codeline>
<codeline lineno="188" refid="namespacepaho_1_1mqtt_1_1client_1a58e55dd2da872230a6e25dc0961bb8e1" refkind="member"><highlight class="normal">MQTT_ERR_CONN_REFUSED<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_CONN_REFUSED</highlight></codeline>
<codeline lineno="189" refid="namespacepaho_1_1mqtt_1_1client_1a967d4f9e1a1b2b60f59e2b3a7b104829" refkind="member"><highlight class="normal">MQTT_ERR_NOT_FOUND<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_NOT_FOUND</highlight></codeline>
<codeline lineno="190" refid="namespacepaho_1_1mqtt_1_1client_1a5bcf31cd92fc9dfaf13422591664487d" refkind="member"><highlight class="normal">MQTT_ERR_CONN_LOST<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="191" refid="namespacepaho_1_1mqtt_1_1client_1a54917cd4e29f33575e86f80d5e3f024e" refkind="member"><highlight class="normal">MQTT_ERR_TLS<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_TLS</highlight></codeline>
<codeline lineno="192" refid="namespacepaho_1_1mqtt_1_1client_1a4847d3fea8dcecd133afe3483f9764f0" refkind="member"><highlight class="normal">MQTT_ERR_PAYLOAD_SIZE<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_PAYLOAD_SIZE</highlight></codeline>
<codeline lineno="193" refid="namespacepaho_1_1mqtt_1_1client_1ab21ab64e6f6b1f3c56660fb9b3d2bf65" refkind="member"><highlight class="normal">MQTT_ERR_NOT_SUPPORTED<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_NOT_SUPPORTED</highlight></codeline>
<codeline lineno="194" refid="namespacepaho_1_1mqtt_1_1client_1a522196c6fd2aea46dec5854e7c7b42c8" refkind="member"><highlight class="normal">MQTT_ERR_AUTH<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_AUTH</highlight></codeline>
<codeline lineno="195" refid="namespacepaho_1_1mqtt_1_1client_1a0dfb79164709b2a6ff29002c455e7c30" refkind="member"><highlight class="normal">MQTT_ERR_ACL_DENIED<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_ACL_DENIED</highlight></codeline>
<codeline lineno="196" refid="namespacepaho_1_1mqtt_1_1client_1a811a4eacee53be51ff73485e3c171468" refkind="member"><highlight class="normal">MQTT_ERR_UNKNOWN<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_UNKNOWN</highlight></codeline>
<codeline lineno="197" refid="namespacepaho_1_1mqtt_1_1client_1a5cc647a67e28ee9230530aa2678b8507" refkind="member"><highlight class="normal">MQTT_ERR_ERRNO<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_ERRNO</highlight></codeline>
<codeline lineno="198" refid="namespacepaho_1_1mqtt_1_1client_1aa36d246296cedbe953aefa55a96a313f" refkind="member"><highlight class="normal">MQTT_ERR_QUEUE_SIZE<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_QUEUE_SIZE</highlight></codeline>
<codeline lineno="199" refid="namespacepaho_1_1mqtt_1_1client_1ae0bd7731eb2cb99c7f3b203b293039a6" refkind="member"><highlight class="normal">MQTT_ERR_KEEPALIVE<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_KEEPALIVE</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201" refid="namespacepaho_1_1mqtt_1_1client_1af6d293afa2eaa0fc34026199dfadd09f" refkind="member"><highlight class="normal">MQTTv31<sp/>=<sp/>MQTTProtocolVersion.MQTTv31</highlight></codeline>
<codeline lineno="202" refid="namespacepaho_1_1mqtt_1_1client_1a0cdbbfcb44d70bd8bd28cd5d35e2dc48" refkind="member"><highlight class="normal">MQTTv311<sp/>=<sp/>MQTTProtocolVersion.MQTTv311</highlight></codeline>
<codeline lineno="203" refid="namespacepaho_1_1mqtt_1_1client_1a91758ad0745248ea810df1e34b331ca5" refkind="member"><highlight class="normal">MQTTv5<sp/>=<sp/>MQTTProtocolVersion.MQTTv5</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205" refid="namespacepaho_1_1mqtt_1_1client_1a1169377a79de8213b1326ec35ee95066" refkind="member"><highlight class="normal">MQTT_CLIENT<sp/>=<sp/>PahoClientMode.MQTT_CLIENT</highlight></codeline>
<codeline lineno="206" refid="namespacepaho_1_1mqtt_1_1client_1aea46705b031fff321eef319655c6ce54" refkind="member"><highlight class="normal">MQTT_BRIDGE<sp/>=<sp/>PahoClientMode.MQTT_BRIDGE</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight><highlight class="comment">#<sp/>For<sp/>MQTT<sp/>V5,<sp/>use<sp/>the<sp/>clean<sp/>start<sp/>flag<sp/>only<sp/>on<sp/>the<sp/>first<sp/>successful<sp/>connect</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209" refid="namespacepaho_1_1mqtt_1_1client_1a91cd6b239e675ed0e3c34a188918964b" refkind="member"><highlight class="normal">MQTT_CLEAN_START_FIRST_ONLY:<sp/>CleanStartOption<sp/>=<sp/>3</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211" refid="namespacepaho_1_1mqtt_1_1client_1aa58760325fd0722176923af6028b0418" refkind="member"><highlight class="normal">sockpair_data<sp/>=<sp/>b</highlight><highlight class="stringliteral">&quot;0&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Payload<sp/>support<sp/>all<sp/>those<sp/>type<sp/>and<sp/>will<sp/>be<sp/>converted<sp/>to<sp/>bytes:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight><highlight class="comment">#<sp/>*<sp/>str<sp/>are<sp/>utf8<sp/>encoded</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight><highlight class="comment">#<sp/>*<sp/>int/float<sp/>are<sp/>converted<sp/>to<sp/>string<sp/>and<sp/>utf8<sp/>encoded<sp/>(e.g.<sp/>1<sp/>is<sp/>converted<sp/>to<sp/>b&quot;1&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight><highlight class="comment">#<sp/>*<sp/>None<sp/>is<sp/>converted<sp/>to<sp/>a<sp/>zero-length<sp/>payload<sp/>(i.e.<sp/>b&quot;&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217" refid="namespacepaho_1_1mqtt_1_1client_1a1ad4b2854fdf49be616f09ca7125ccad" refkind="member"><highlight class="normal">PayloadType<sp/>=<sp/>Union[str,<sp/>bytes,<sp/>bytearray,<sp/>int,<sp/>float,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="219" refid="namespacepaho_1_1mqtt_1_1client_1a2fdd812389ca74b3d46476c13755d685" refkind="member"><highlight class="normal">HTTPHeader<sp/>=<sp/>Dict[str,<sp/>str]</highlight></codeline>
<codeline lineno="220" refid="namespacepaho_1_1mqtt_1_1client_1a5617c10b42a3e9823cc68a527e9487c1" refkind="member"><highlight class="normal">WebSocketHeaders<sp/>=<sp/>Union[Callable[[HTTPHeader],<sp/>HTTPHeader],<sp/>HTTPHeader]</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222" refid="namespacepaho_1_1mqtt_1_1client_1a3536cd16c46363a7cf5d633ee764404c" refkind="member"><highlight class="normal">CleanStartOption<sp/>=<sp/>Union[bool,<sp/>Literal[3]]</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225" refid="classpaho_1_1mqtt_1_1client_1_1_connect_flags" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_connect_flags" kindref="compound">ConnectFlags</ref>(NamedTuple):</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Contains<sp/>additional<sp/>information<sp/>passed<sp/>to<sp/>`on_connect`<sp/>callback&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>session_present:<sp/>bool</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="230"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>this<sp/>flag<sp/>is<sp/>useful<sp/>for<sp/>clients<sp/>that<sp/>are</highlight></codeline>
<codeline lineno="231"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>using<sp/>clean<sp/>session<sp/>set<sp/>to<sp/>False<sp/>only<sp/>(MQTTv3)<sp/>or<sp/>clean_start<sp/>=<sp/>False<sp/>(MQTTv5).</highlight></codeline>
<codeline lineno="232"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>In<sp/>that<sp/>case,<sp/>if<sp/>client<sp/><sp/>that<sp/>reconnects<sp/>to<sp/>a<sp/>broker<sp/>that<sp/>it<sp/>has<sp/>previously</highlight></codeline>
<codeline lineno="233"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>connected<sp/>to,<sp/>this<sp/>flag<sp/>indicates<sp/>whether<sp/>the<sp/>broker<sp/>still<sp/>has<sp/>the</highlight></codeline>
<codeline lineno="234"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>session<sp/>information<sp/>for<sp/>the<sp/>client.<sp/>If<sp/>true,<sp/>the<sp/>session<sp/>still<sp/>exists.</highlight></codeline>
<codeline lineno="235"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238" refid="classpaho_1_1mqtt_1_1client_1_1_disconnect_flags" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_disconnect_flags" kindref="compound">DisconnectFlags</ref>(NamedTuple):</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Contains<sp/>additional<sp/>information<sp/>passed<sp/>to<sp/>`on_disconnect`<sp/>callback&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>is_disconnect_packet_from_server:<sp/>bool</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="243"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>tells<sp/>whether<sp/>this<sp/>on_disconnect<sp/>call<sp/>is<sp/>the<sp/>result</highlight></codeline>
<codeline lineno="244"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>receiving<sp/>an<sp/>DISCONNECT<sp/>packet<sp/>from<sp/>the<sp/>broker<sp/>or<sp/>if<sp/>the<sp/>on_disconnect<sp/>is<sp/>only</highlight></codeline>
<codeline lineno="245"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>generated<sp/>by<sp/>the<sp/>client<sp/>library.</highlight></codeline>
<codeline lineno="246"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>When<sp/>true,<sp/>the<sp/>reason<sp/>code<sp/>is<sp/>generated<sp/>by<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="247"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250" refid="namespacepaho_1_1mqtt_1_1client_1a9a29c2c01ce0eee39c3df3b35d6a78d4" refkind="member"><highlight class="normal">CallbackOnConnect_v1_mqtt3<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>Dict[str,<sp/>Any],<sp/>MQTTErrorCode],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="251" refid="namespacepaho_1_1mqtt_1_1client_1a7a498d17a73c7b508012426848529810" refkind="member"><highlight class="normal">CallbackOnConnect_v1_mqtt5<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>Dict[str,<sp/>Any],<sp/>ReasonCode,<sp/>Union[Properties,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="252" refid="namespacepaho_1_1mqtt_1_1client_1a50b0cbb0495bf6aa705b2b8da4640745" refkind="member"><highlight class="normal">CallbackOnConnect_v1<sp/>=<sp/>Union[CallbackOnConnect_v1_mqtt5,<sp/>CallbackOnConnect_v1_mqtt3]</highlight></codeline>
<codeline lineno="253" refid="namespacepaho_1_1mqtt_1_1client_1a54f2e267c361377139226c600cc45146" refkind="member"><highlight class="normal">CallbackOnConnect_v2<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>ConnectFlags,<sp/>ReasonCode,<sp/>Union[Properties,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="254" refid="namespacepaho_1_1mqtt_1_1client_1a31f4a79fde6d775b3a5c1ed7fa8d7f8c" refkind="member"><highlight class="normal">CallbackOnConnect<sp/>=<sp/>Union[CallbackOnConnect_v1,<sp/>CallbackOnConnect_v2]</highlight></codeline>
<codeline lineno="255" refid="namespacepaho_1_1mqtt_1_1client_1a6f627c61f0911f389f82fb089c723204" refkind="member"><highlight class="normal">CallbackOnConnectFail<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="256" refid="namespacepaho_1_1mqtt_1_1client_1a86167752efbbaab96769d6f517456e08" refkind="member"><highlight class="normal">CallbackOnDisconnect_v1_mqtt3<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>MQTTErrorCode],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="257" refid="namespacepaho_1_1mqtt_1_1client_1a98f2615cc6d3a3b664d5d1a1f891ab6b" refkind="member"><highlight class="normal">CallbackOnDisconnect_v1_mqtt5<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>Union[ReasonCode,<sp/>int,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">],<sp/>Union[Properties,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="258" refid="namespacepaho_1_1mqtt_1_1client_1acd4986f267d927d6aa1fc87379e006c3" refkind="member"><highlight class="normal">CallbackOnDisconnect_v1<sp/>=<sp/>Union[CallbackOnDisconnect_v1_mqtt3,<sp/>CallbackOnDisconnect_v1_mqtt5]</highlight></codeline>
<codeline lineno="259" refid="namespacepaho_1_1mqtt_1_1client_1af188c5edf78bd49934cbb45819c907c6" refkind="member"><highlight class="normal">CallbackOnDisconnect_v2<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>DisconnectFlags,<sp/>ReasonCode,<sp/>Union[Properties,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="260" refid="namespacepaho_1_1mqtt_1_1client_1a4c0a18dec79518582ffc06e3a9fd2975" refkind="member"><highlight class="normal">CallbackOnDisconnect<sp/>=<sp/>Union[CallbackOnDisconnect_v1,<sp/>CallbackOnDisconnect_v2]</highlight></codeline>
<codeline lineno="261" refid="namespacepaho_1_1mqtt_1_1client_1af13ab31c142d5fe84b854623e1286e2c" refkind="member"><highlight class="normal">CallbackOnLog<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int,<sp/>str],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="262" refid="namespacepaho_1_1mqtt_1_1client_1aa616fa87eb1f50d10ea31dd344c71178" refkind="member"><highlight class="normal">CallbackOnMessage<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/></highlight><highlight class="stringliteral">&quot;MQTTMessage&quot;</highlight><highlight class="normal">],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="263" refid="namespacepaho_1_1mqtt_1_1client_1a58dda7cbdbf5cf33f435ce28a55870be" refkind="member"><highlight class="normal">CallbackOnPreConnect<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="264" refid="namespacepaho_1_1mqtt_1_1client_1ad638ff6065fad429d9621c4eecad687a" refkind="member"><highlight class="normal">CallbackOnPublish_v1<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="265" refid="namespacepaho_1_1mqtt_1_1client_1a6dfae4b3e5ee29d4d67c55149d45c510" refkind="member"><highlight class="normal">CallbackOnPublish_v2<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int,<sp/>ReasonCode,<sp/>Properties],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="266" refid="namespacepaho_1_1mqtt_1_1client_1a1852cad9b46cf035efd64a63b12be170" refkind="member"><highlight class="normal">CallbackOnPublish<sp/>=<sp/>Union[CallbackOnPublish_v1,<sp/>CallbackOnPublish_v2]</highlight></codeline>
<codeline lineno="267" refid="namespacepaho_1_1mqtt_1_1client_1a8f79e48d2ababef5729f996195c9a174" refkind="member"><highlight class="normal">CallbackOnSocket<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/></highlight><highlight class="stringliteral">&quot;SocketLike&quot;</highlight><highlight class="normal">],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="268" refid="namespacepaho_1_1mqtt_1_1client_1ab4db45ab83e2fc4b40fbeb1c742e7380" refkind="member"><highlight class="normal">CallbackOnSubscribe_v1_mqtt3<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int,<sp/>Tuple[int,<sp/>...]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="269" refid="namespacepaho_1_1mqtt_1_1client_1a82e183d57ce8d1f3250bce81bd8534d6" refkind="member"><highlight class="normal">CallbackOnSubscribe_v1_mqtt5<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int,<sp/>List[ReasonCode],<sp/>Properties],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="270" refid="namespacepaho_1_1mqtt_1_1client_1ab723773fb4defe1e6f41e34d3cb3a9de" refkind="member"><highlight class="normal">CallbackOnSubscribe_v1<sp/>=<sp/>Union[CallbackOnSubscribe_v1_mqtt3,<sp/>CallbackOnSubscribe_v1_mqtt5]</highlight></codeline>
<codeline lineno="271" refid="namespacepaho_1_1mqtt_1_1client_1ab503be16226a7cf5febe7a4d988c635c" refkind="member"><highlight class="normal">CallbackOnSubscribe_v2<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int,<sp/>List[ReasonCode],<sp/>Union[Properties,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="272" refid="namespacepaho_1_1mqtt_1_1client_1ad6d52b40ee0eb0dbc98ac581fed3dc46" refkind="member"><highlight class="normal">CallbackOnSubscribe<sp/>=<sp/>Union[CallbackOnSubscribe_v1,<sp/>CallbackOnSubscribe_v2]</highlight></codeline>
<codeline lineno="273" refid="namespacepaho_1_1mqtt_1_1client_1ae5a3b9ca0661fea33d64ba6df1ef14ac" refkind="member"><highlight class="normal">CallbackOnUnsubscribe_v1_mqtt3<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="274" refid="namespacepaho_1_1mqtt_1_1client_1a3cedfc249a7facec3ac3ec9baf8874a1" refkind="member"><highlight class="normal">CallbackOnUnsubscribe_v1_mqtt5<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int,<sp/>Properties,<sp/>Union[ReasonCode,<sp/>List[ReasonCode]]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="275" refid="namespacepaho_1_1mqtt_1_1client_1a6897a4407bf1706879f72efe00653c90" refkind="member"><highlight class="normal">CallbackOnUnsubscribe_v1<sp/>=<sp/>Union[CallbackOnUnsubscribe_v1_mqtt3,<sp/>CallbackOnUnsubscribe_v1_mqtt5]</highlight></codeline>
<codeline lineno="276" refid="namespacepaho_1_1mqtt_1_1client_1a03fe091365d6358051e9b179c47857ea" refkind="member"><highlight class="normal">CallbackOnUnsubscribe_v2<sp/>=<sp/>Callable[[</highlight><highlight class="stringliteral">&quot;Client&quot;</highlight><highlight class="normal">,<sp/>Any,<sp/>int,<sp/>List[ReasonCode],<sp/>Union[Properties,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]],<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="277" refid="namespacepaho_1_1mqtt_1_1client_1a435a6e11437c1a01f68219f9e392fee7" refkind="member"><highlight class="normal">CallbackOnUnsubscribe<sp/>=<sp/>Union[CallbackOnUnsubscribe_v1,<sp/>CallbackOnUnsubscribe_v2]</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight><highlight class="comment">#<sp/>This<sp/>is<sp/>needed<sp/>for<sp/>typing<sp/>because<sp/>class<sp/>Client<sp/>redefined<sp/>the<sp/>name<sp/>&quot;socket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280" refid="namespacepaho_1_1mqtt_1_1client_1a89622c7d0f124eaaec7583608da92b0f" refkind="member"><highlight class="normal">_socket<sp/>=<sp/>socket</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283" refid="classpaho_1_1mqtt_1_1client_1_1_websocket_connection_error" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_websocket_connection_error" kindref="compound">WebsocketConnectionError</ref>(ConnectionError):</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>WebsocketConnectionError<sp/>is<sp/>a<sp/>subclass<sp/>of<sp/>ConnectionError.</highlight></codeline>
<codeline lineno="285"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="286"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>It&apos;s<sp/>raised<sp/>when<sp/>unable<sp/>to<sp/>perform<sp/>the<sp/>Websocket<sp/>handshake.</highlight></codeline>
<codeline lineno="287"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291" refid="namespacepaho_1_1mqtt_1_1client_1a3365dfa73eb9bb985ae1dbfa5b806608" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1a3365dfa73eb9bb985ae1dbfa5b806608" kindref="member">error_string</ref>(mqtt_errno:<sp/>MQTTErrorCode<sp/>|<sp/>int)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>error<sp/>string<sp/>associated<sp/>with<sp/>an<sp/>mqtt<sp/>error<sp/>number.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;No<sp/>error.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_NOMEM:</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Out<sp/>of<sp/>memory.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_PROTOCOL:</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>network<sp/>protocol<sp/>error<sp/>occurred<sp/>when<sp/>communicating<sp/>with<sp/>the<sp/>broker.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_INVAL:</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>function<sp/>arguments<sp/>provided.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_NO_CONN:</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>client<sp/>is<sp/>not<sp/>currently<sp/>connected.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_CONN_REFUSED:</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>connection<sp/>was<sp/>refused.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_NOT_FOUND:</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Message<sp/>not<sp/>found<sp/>(internal<sp/>error).&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_CONN_LOST:</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>connection<sp/>was<sp/>lost.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_TLS:</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>TLS<sp/>error<sp/>occurred.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_PAYLOAD_SIZE:</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Payload<sp/>too<sp/>large.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_NOT_SUPPORTED:</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;This<sp/>feature<sp/>is<sp/>not<sp/>supported.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_AUTH:</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Authorisation<sp/>failed.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_ACL_DENIED:</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Access<sp/>denied<sp/>by<sp/>ACL.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_UNKNOWN:</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Unknown<sp/>error.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_ERRNO:</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>defined<sp/>by<sp/>errno.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_QUEUE_SIZE:</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Message<sp/>queue<sp/>full.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>mqtt_errno<sp/>==<sp/>MQTT_ERR_KEEPALIVE:</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Client<sp/>or<sp/>broker<sp/>did<sp/>not<sp/>communicate<sp/>in<sp/>the<sp/>keepalive<sp/>interval.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Unknown<sp/>error.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331" refid="namespacepaho_1_1mqtt_1_1client_1a4f87ea488007e0dee8ee4488c85745af" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1a4f87ea488007e0dee8ee4488c85745af" kindref="member">connack_string</ref>(connack_code:<sp/>int|ReasonCode)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>string<sp/>associated<sp/>with<sp/>a<sp/>CONNACK<sp/>result<sp/>or<sp/>CONNACK<sp/>reason<sp/>code.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(connack_code,<sp/>ReasonCode):</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>str(connack_code)</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>CONNACK_ACCEPTED:</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>Accepted.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>CONNACK_REFUSED_PROTOCOL_VERSION:</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>Refused:<sp/>unacceptable<sp/>protocol<sp/>version.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>CONNACK_REFUSED_IDENTIFIER_REJECTED:</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>Refused:<sp/>identifier<sp/>rejected.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>CONNACK_REFUSED_SERVER_UNAVAILABLE:</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>Refused:<sp/>broker<sp/>unavailable.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>CONNACK_REFUSED_BAD_USERNAME_PASSWORD:</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>Refused:<sp/>bad<sp/>user<sp/>name<sp/>or<sp/>password.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>CONNACK_REFUSED_NOT_AUTHORIZED:</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>Refused:<sp/>not<sp/>authorised.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>Refused:<sp/>unknown<sp/>reason.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352" refid="namespacepaho_1_1mqtt_1_1client_1a92b34043dd6fe89bac0ac8c9fa27f35d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1a92b34043dd6fe89bac0ac8c9fa27f35d" kindref="member">convert_connack_rc_to_reason_code</ref>(connack_code:<sp/>ConnackCode)<sp/>-&gt;<sp/>ReasonCode:</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Convert<sp/>a<sp/>MQTTv3<sp/>/<sp/>MQTTv3.1.1<sp/>connack<sp/>result<sp/>to<sp/>`ReasonCode`.</highlight></codeline>
<codeline lineno="354"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="355"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>is<sp/>used<sp/>in<sp/>`on_connect`<sp/>callback<sp/>to<sp/>have<sp/>a<sp/>consistent<sp/>API.</highlight></codeline>
<codeline lineno="356"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="357"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Be<sp/>careful<sp/>that<sp/>the<sp/>numeric<sp/>value<sp/>isn&apos;t<sp/>the<sp/>same,<sp/>for<sp/>example:</highlight></codeline>
<codeline lineno="358"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="359"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>ConnackCode.CONNACK_REFUSED_SERVER_UNAVAILABLE<sp/>==<sp/>3</highlight></codeline>
<codeline lineno="360"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>convert_connack_rc_to_reason_code(ConnackCode.CONNACK_REFUSED_SERVER_UNAVAILABLE)<sp/>==<sp/>136</highlight></codeline>
<codeline lineno="361"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="362"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>It&apos;s<sp/>recommended<sp/>to<sp/>compare<sp/>by<sp/>names</highlight></codeline>
<codeline lineno="363"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="364"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>code_to_test<sp/>=<sp/>ReasonCode(PacketTypes.CONNACK,<sp/>&quot;Server<sp/>unavailable&quot;)</highlight></codeline>
<codeline lineno="365"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>convert_connack_rc_to_reason_code(ConnackCode.CONNACK_REFUSED_SERVER_UNAVAILABLE)<sp/>==<sp/>code_to_test</highlight></codeline>
<codeline lineno="366"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>ConnackCode.CONNACK_ACCEPTED:</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.CONNACK,<sp/></highlight><highlight class="stringliteral">&quot;Success&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>ConnackCode.CONNACK_REFUSED_PROTOCOL_VERSION:</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.CONNACK,<sp/></highlight><highlight class="stringliteral">&quot;Unsupported<sp/>protocol<sp/>version&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>ConnackCode.CONNACK_REFUSED_IDENTIFIER_REJECTED:</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.CONNACK,<sp/></highlight><highlight class="stringliteral">&quot;Client<sp/>identifier<sp/>not<sp/>valid&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>ConnackCode.CONNACK_REFUSED_SERVER_UNAVAILABLE:</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.CONNACK,<sp/></highlight><highlight class="stringliteral">&quot;Server<sp/>unavailable&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>ConnackCode.CONNACK_REFUSED_BAD_USERNAME_PASSWORD:</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.CONNACK,<sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>user<sp/>name<sp/>or<sp/>password&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>connack_code<sp/>==<sp/>ConnackCode.CONNACK_REFUSED_NOT_AUTHORIZED:</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.CONNACK,<sp/></highlight><highlight class="stringliteral">&quot;Not<sp/>authorized&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.CONNACK,<sp/></highlight><highlight class="stringliteral">&quot;Unspecified<sp/>error&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383" refid="namespacepaho_1_1mqtt_1_1client_1a19f6754518375da8d0e59b8fde41222a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1a19f6754518375da8d0e59b8fde41222a" kindref="member">convert_disconnect_error_code_to_reason_code</ref>(rc:<sp/>MQTTErrorCode)<sp/>-&gt;<sp/>ReasonCode:</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Convert<sp/>an<sp/>MQTTErrorCode<sp/>to<sp/>Reason<sp/>code.</highlight></codeline>
<codeline lineno="385"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="386"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>is<sp/>used<sp/>in<sp/>`on_disconnect`<sp/>callback<sp/>to<sp/>have<sp/>a<sp/>consistent<sp/>API.</highlight></codeline>
<codeline lineno="387"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="388"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Be<sp/>careful<sp/>that<sp/>the<sp/>numeric<sp/>value<sp/>isn&apos;t<sp/>the<sp/>same,<sp/>for<sp/>example:</highlight></codeline>
<codeline lineno="389"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="390"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL<sp/>==<sp/>2</highlight></codeline>
<codeline lineno="391"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>convert_disconnect_error_code_to_reason_code(MQTTErrorCode.MQTT_ERR_PROTOCOL)<sp/>==<sp/>130</highlight></codeline>
<codeline lineno="392"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="393"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>It&apos;s<sp/>recommended<sp/>to<sp/>compare<sp/>by<sp/>names</highlight></codeline>
<codeline lineno="394"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="395"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>code_to_test<sp/>=<sp/>ReasonCode(PacketTypes.DISCONNECT,<sp/>&quot;Protocol<sp/>error&quot;)</highlight></codeline>
<codeline lineno="396"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>convert_disconnect_error_code_to_reason_code(MQTTErrorCode.MQTT_ERR_PROTOCOL)<sp/>==<sp/>code_to_test</highlight></codeline>
<codeline lineno="397"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.DISCONNECT,<sp/></highlight><highlight class="stringliteral">&quot;Success&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_KEEPALIVE:</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.DISCONNECT,<sp/></highlight><highlight class="stringliteral">&quot;Keep<sp/>alive<sp/>timeout&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST:</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.DISCONNECT,<sp/></highlight><highlight class="stringliteral">&quot;Unspecified<sp/>error&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpaho_1_1mqtt_1_1reasoncodes_1_1_reason_code" kindref="compound">ReasonCode</ref>(PacketTypes.DISCONNECT,<sp/></highlight><highlight class="stringliteral">&quot;Unspecified<sp/>error&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407" refid="namespacepaho_1_1mqtt_1_1client_1a76f4ea7765086775a4150213a7176bfa" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1a76f4ea7765086775a4150213a7176bfa" kindref="member">_base62</ref>(</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>num:<sp/>int,</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/>base:<sp/>str<sp/>=<sp/>string.digits<sp/>+<sp/>string.ascii_letters,</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/>padding:<sp/>int<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="411"><highlight class="normal">)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Convert<sp/>a<sp/>number<sp/>to<sp/>base-62<sp/>representation.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>num<sp/>&lt;<sp/>0:</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Number<sp/>must<sp/>be<sp/>positive<sp/>or<sp/>zero&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/>digits<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>num:</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num,<sp/>rest<sp/>=<sp/>divmod(num,<sp/>62)</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>digits.append(base[rest])</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>digits.extend(base[0]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(digits),<sp/>padding))</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">.join(reversed(digits))</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423" refid="namespacepaho_1_1mqtt_1_1client_1afb234b76afaaef2e02492baf3bdbc6da" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1afb234b76afaaef2e02492baf3bdbc6da" kindref="member">topic_matches_sub</ref>(sub:<sp/>str,<sp/>topic:<sp/>str)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Check<sp/>whether<sp/>a<sp/>topic<sp/>matches<sp/>a<sp/>subscription.</highlight></codeline>
<codeline lineno="425"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="426"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>For<sp/>example:</highlight></codeline>
<codeline lineno="427"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="428"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>*<sp/>Topic<sp/>&quot;foo/bar&quot;<sp/>would<sp/>match<sp/>the<sp/>subscription<sp/>&quot;foo/#&quot;<sp/>or<sp/>&quot;+/bar&quot;</highlight></codeline>
<codeline lineno="429"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>*<sp/>Topic<sp/>&quot;non/matching&quot;<sp/>would<sp/>not<sp/>match<sp/>the<sp/>subscription<sp/>&quot;non/+/+&quot;</highlight></codeline>
<codeline lineno="430"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/>matcher<sp/>=<sp/><ref refid="classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher" kindref="compound">MQTTMatcher</ref>()</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/>matcher[sub]<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next(matcher.iter_match(topic))</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>StopIteration:</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"></highlight></codeline>
<codeline lineno="440" refid="namespacepaho_1_1mqtt_1_1client_1aded7f14e7eb68bd0137861aac4cff204" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1aded7f14e7eb68bd0137861aac4cff204" kindref="member">_socketpair_compat</ref>()<sp/>-&gt;<sp/>tuple[socket.socket,<sp/>socket.socket]:</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;TCP/IP<sp/>socketpair<sp/>including<sp/>Windows<sp/>support&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/>listensock<sp/>=<sp/>socket.socket(</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket.AF_INET,<sp/>socket.SOCK_STREAM,<sp/>socket.IPPROTO_IP)</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/>listensock.setsockopt(socket.SOL_SOCKET,<sp/>socket.SO_REUSEADDR,<sp/>1)</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/>listensock.bind((</highlight><highlight class="stringliteral">&quot;127.0.0.1&quot;</highlight><highlight class="normal">,<sp/>0))</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/>listensock.listen(1)</highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/>iface,<sp/>port<sp/>=<sp/>listensock.getsockname()</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>sock1<sp/>=<sp/>socket.socket(</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket.AF_INET,<sp/>socket.SOCK_STREAM,<sp/>socket.IPPROTO_IP)</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/>sock1.setblocking(</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock1.connect((</highlight><highlight class="stringliteral">&quot;127.0.0.1&quot;</highlight><highlight class="normal">,<sp/>port))</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>BlockingIOError:</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/>sock2,<sp/>address<sp/>=<sp/>listensock.accept()</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>sock2.setblocking(</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/>listensock.close()</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(sock1,<sp/>sock2)</highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight></codeline>
<codeline lineno="462" refid="namespacepaho_1_1mqtt_1_1client_1a662c2ecb4650420e37b9eb1d72bef78f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1a662c2ecb4650420e37b9eb1d72bef78f" kindref="member">_force_bytes</ref>(s:<sp/>str<sp/>|<sp/>bytes)<sp/>-&gt;<sp/>bytes:</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(s,<sp/>str):</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s.encode(</highlight><highlight class="stringliteral">&quot;utf-8&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s</highlight></codeline>
<codeline lineno="466"><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468" refid="namespacepaho_1_1mqtt_1_1client_1a4e7f9d818bcb74975d254467e7e2f6bb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepaho_1_1mqtt_1_1client_1a4e7f9d818bcb74975d254467e7e2f6bb" kindref="member">_encode_payload</ref>(payload:<sp/>str<sp/>|<sp/>bytes<sp/>|<sp/>bytearray<sp/>|<sp/>int<sp/>|<sp/>float<sp/>|<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)<sp/>-&gt;<sp/>bytes|bytearray:</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(payload,<sp/>str):</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>payload.encode(</highlight><highlight class="stringliteral">&quot;utf-8&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(payload,<sp/>(int,<sp/>float)):</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>str(payload).encode(</highlight><highlight class="stringliteral">&quot;ascii&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>payload<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>b</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(payload,<sp/>(bytes,<sp/>bytearray)):</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>TypeError(</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;payload<sp/>must<sp/>be<sp/>a<sp/>string,<sp/>bytearray,<sp/>int,<sp/>float<sp/>or<sp/>None.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>payload</highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info" kindref="compound">MQTTMessageInfo</ref>:</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;This<sp/>is<sp/>a<sp/>class<sp/>returned<sp/>from<sp/>`Client.publish()`<sp/>and<sp/>can<sp/>be<sp/>used<sp/>to<sp/>find</highlight></codeline>
<codeline lineno="488"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>out<sp/>the<sp/>mid<sp/>of<sp/>the<sp/>message<sp/>that<sp/>was<sp/>published,<sp/>and<sp/>to<sp/>determine<sp/>whether<sp/>the</highlight></codeline>
<codeline lineno="489"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>message<sp/>has<sp/>been<sp/>published,<sp/>and/or<sp/>wait<sp/>until<sp/>it<sp/>is<sp/>published.</highlight></codeline>
<codeline lineno="490"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/>__slots__<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;mid&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;_published&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;_condition&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;rc&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;_iterpos&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>mid:<sp/>int):</highlight></codeline>
<codeline lineno="495" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a0c4d0250d75bc90e8f379d3998bd2ad2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a0c4d0250d75bc90e8f379d3998bd2ad2" kindref="member">mid</ref><sp/>=<sp/>mid</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>The<sp/>message<sp/>Id<sp/>(int)&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1ac1a64565a869f86d53a20badd3089c47" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1ac1a64565a869f86d53a20badd3089c47" kindref="member">_published</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="498" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a1fd517b399d7402cfcb1b25a14191a32" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a1fd517b399d7402cfcb1b25a14191a32" kindref="member">_condition</ref><sp/>=<sp/>threading.Condition()</highlight></codeline>
<codeline lineno="499" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref>:<sp/>MQTTErrorCode<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>The<sp/>`MQTTErrorCode`<sp/>that<sp/>give<sp/>status<sp/>for<sp/>this<sp/>message.</highlight></codeline>
<codeline lineno="501"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>value<sp/>could<sp/>change<sp/>until<sp/>the<sp/>message<sp/>`is_published`&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a375c1bf64e4cb86b69dc57194965d83d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a375c1bf64e4cb86b69dc57194965d83d" kindref="member">_iterpos</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__str__(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>str((self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref>,<sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a0c4d0250d75bc90e8f379d3998bd2ad2" kindref="member">mid</ref>))</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__iter__(self)<sp/>-&gt;<sp/>Iterator[MQTTErrorCode<sp/>|<sp/>int]:</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a375c1bf64e4cb86b69dc57194965d83d" kindref="member">_iterpos</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__next__(self)<sp/>-&gt;<sp/>MQTTErrorCode<sp/>|<sp/>int:</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a7cdde31147fe0d16d5d8d5e2a497eb60" kindref="member">next</ref>()</highlight></codeline>
<codeline lineno="513"><highlight class="normal"></highlight></codeline>
<codeline lineno="514" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a7cdde31147fe0d16d5d8d5e2a497eb60" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a7cdde31147fe0d16d5d8d5e2a497eb60" kindref="member">next</ref>(self)<sp/>-&gt;<sp/>MQTTErrorCode<sp/>|<sp/>int:</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a375c1bf64e4cb86b69dc57194965d83d" kindref="member">_iterpos</ref><sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a375c1bf64e4cb86b69dc57194965d83d" kindref="member">_iterpos</ref><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a375c1bf64e4cb86b69dc57194965d83d" kindref="member">_iterpos</ref><sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a375c1bf64e4cb86b69dc57194965d83d" kindref="member">_iterpos</ref><sp/>=<sp/>2</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a0c4d0250d75bc90e8f379d3998bd2ad2" kindref="member">mid</ref></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>StopIteration</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__getitem__(self,<sp/>index:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode<sp/>|<sp/>int:</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>index<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>index<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a0c4d0250d75bc90e8f379d3998bd2ad2" kindref="member">mid</ref></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IndexError(</highlight><highlight class="stringliteral">&quot;index<sp/>out<sp/>of<sp/>range&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af517480380f71cd10a713f77ef27100d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af517480380f71cd10a713f77ef27100d" kindref="member">_set_as_published</ref>(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a1fd517b399d7402cfcb1b25a14191a32" kindref="member">_condition</ref>:</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1ac1a64565a869f86d53a20badd3089c47" kindref="member">_published</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a1fd517b399d7402cfcb1b25a14191a32" kindref="member">_condition</ref>.notify()</highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a5c693e307e1cd712305cde5172c8b8a2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a5c693e307e1cd712305cde5172c8b8a2" kindref="member">wait_for_publish</ref>(self,<sp/>timeout:<sp/>float<sp/>|<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Block<sp/>until<sp/>the<sp/>message<sp/>associated<sp/>with<sp/>this<sp/>object<sp/>is<sp/>published,<sp/>or</highlight></codeline>
<codeline lineno="539"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>until<sp/>the<sp/>timeout<sp/>occurs.<sp/>If<sp/>timeout<sp/>is<sp/>None,<sp/>this<sp/>will<sp/>never<sp/>time<sp/>out.</highlight></codeline>
<codeline lineno="540"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>timeout<sp/>to<sp/>a<sp/>positive<sp/>number<sp/>of<sp/>seconds,<sp/>e.g.<sp/>1.2,<sp/>to<sp/>enable<sp/>the</highlight></codeline>
<codeline lineno="541"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout.</highlight></codeline>
<codeline lineno="542"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="543"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>ValueError:<sp/>if<sp/>the<sp/>message<sp/>was<sp/>not<sp/>queued<sp/>due<sp/>to<sp/>the<sp/>outgoing</highlight></codeline>
<codeline lineno="544"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>queue<sp/>being<sp/>full.</highlight></codeline>
<codeline lineno="545"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="546"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>RuntimeError:<sp/>if<sp/>the<sp/>message<sp/>was<sp/>not<sp/>published<sp/>for<sp/>another</highlight></codeline>
<codeline lineno="547"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason.</highlight></codeline>
<codeline lineno="548"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref><sp/>==<sp/>MQTT_ERR_QUEUE_SIZE:</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;Message<sp/>is<sp/>not<sp/>queued<sp/>due<sp/>to<sp/>ERR_QUEUE_SIZE&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref><sp/>==<sp/>MQTT_ERR_AGAIN:</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref><sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(f</highlight><highlight class="stringliteral">&apos;Message<sp/>publish<sp/>failed:<sp/>{error_string(self.rc)}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="555"><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout_time<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>timeout<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><ref refid="namespacepaho_1_1mqtt_1_1client_1a834b8f4fbe5ec604671023b59d0377fd" kindref="member">time_func</ref>()<sp/>+<sp/>timeout</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout_tenth<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>timeout<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>timeout<sp/>/<sp/>10.</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">timed_out()<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>timeout_time<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><ref refid="namespacepaho_1_1mqtt_1_1client_1a834b8f4fbe5ec604671023b59d0377fd" kindref="member">time_func</ref>()<sp/>&gt;<sp/>timeout_time</highlight></codeline>
<codeline lineno="560"><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a1fd517b399d7402cfcb1b25a14191a32" kindref="member">_condition</ref>:</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1ac1a64565a869f86d53a20badd3089c47" kindref="member">_published</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>timed_out():</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a1fd517b399d7402cfcb1b25a14191a32" kindref="member">_condition</ref>.wait(timeout_tenth)</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref><sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(f</highlight><highlight class="stringliteral">&apos;Message<sp/>publish<sp/>failed:<sp/>{error_string(self.rc)}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="568" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a4035aee6ba718d37381827427d97c1eb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a4035aee6ba718d37381827427d97c1eb" kindref="member">is_published</ref>(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>True<sp/>if<sp/>the<sp/>message<sp/>associated<sp/>with<sp/>this<sp/>object<sp/>has<sp/>been</highlight></codeline>
<codeline lineno="570"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>published,<sp/>else<sp/>returns<sp/>False.</highlight></codeline>
<codeline lineno="571"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="572"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>To<sp/>wait<sp/>for<sp/>this<sp/>to<sp/>become<sp/>true,<sp/>look<sp/>at<sp/>`wait_for_publish`.</highlight></codeline>
<codeline lineno="573"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref><sp/>==<sp/>MQTTErrorCode.MQTT_ERR_QUEUE_SIZE:</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;Message<sp/>is<sp/>not<sp/>queued<sp/>due<sp/>to<sp/>ERR_QUEUE_SIZE&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref><sp/>==<sp/>MQTTErrorCode.MQTT_ERR_AGAIN:</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1af348bcb9f5ce9b7167e58c1c77df590b" kindref="member">rc</ref><sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(f</highlight><highlight class="stringliteral">&apos;Message<sp/>publish<sp/>failed:<sp/>{error_string(self.rc)}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1a1fd517b399d7402cfcb1b25a14191a32" kindref="member">_condition</ref>:</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info_1ac1a64565a869f86d53a20badd3089c47" kindref="member">_published</ref></highlight></codeline>
<codeline lineno="583"><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message" kindref="compound">MQTTMessage</ref>:</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>This<sp/>is<sp/>a<sp/>class<sp/>that<sp/>describes<sp/>an<sp/>incoming<sp/>message.<sp/>It<sp/>is</highlight></codeline>
<codeline lineno="587"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>passed<sp/>to<sp/>the<sp/>`on_message`<sp/>callback<sp/>as<sp/>the<sp/>message<sp/>parameter.</highlight></codeline>
<codeline lineno="588"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/>__slots__<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;timestamp&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;state&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;dup&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;mid&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;_topic&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;payload&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;qos&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;retain&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;info&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;properties&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__init__(self,<sp/>mid:<sp/>int<sp/>=<sp/>0,<sp/>topic:<sp/>bytes<sp/>=<sp/>b</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="592" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a89e4ad5a8ea2ca7e4fd195136c769e6b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a89e4ad5a8ea2ca7e4fd195136c769e6b" kindref="member">timestamp</ref><sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="593" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1ae39baf2a5ed34d6f6b54ee5ec6283293" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1ae39baf2a5ed34d6f6b54ee5ec6283293" kindref="member">state</ref><sp/>=<sp/>mqtt_ms_invalid</highlight></codeline>
<codeline lineno="594" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3a6ef940a3222e2da683360a2d60e881" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3a6ef940a3222e2da683360a2d60e881" kindref="member">dup</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="595" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a6da129ca77570f29ea742eaba48c1262" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a6da129ca77570f29ea742eaba48c1262" kindref="member">mid</ref><sp/>=<sp/>mid</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>The<sp/>message<sp/>id<sp/>(int).&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="597" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3cf310ff35fbc01fc7a31f85b68745a2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3cf310ff35fbc01fc7a31f85b68745a2" kindref="member">_topic</ref><sp/>=<sp/>topic</highlight></codeline>
<codeline lineno="598" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3ab2b4313c1da60ee4d0f991fe6db2e1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3ab2b4313c1da60ee4d0f991fe6db2e1" kindref="member">payload</ref><sp/>=<sp/>b</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;the<sp/>message<sp/>payload<sp/>(bytes)&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="600" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a0941299a12b88ecb68f23b5561b9a098" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a0941299a12b88ecb68f23b5561b9a098" kindref="member">qos</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>The<sp/>message<sp/>Quality<sp/>of<sp/>Service<sp/>(0,<sp/>1<sp/>or<sp/>2).&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="602" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3877646d7c9f0ff66300bc6420695e8b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3877646d7c9f0ff66300bc6420695e8b" kindref="member">retain</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>If<sp/>true,<sp/>the<sp/>message<sp/>is<sp/>a<sp/>retained<sp/>message<sp/>and<sp/>not<sp/>fresh.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="604" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3b403b429813d2e7570194e27dc44760" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3b403b429813d2e7570194e27dc44760" kindref="member">info</ref><sp/>=<sp/><ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_info" kindref="compound">MQTTMessageInfo</ref>(mid)</highlight></codeline>
<codeline lineno="605" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a7cff9c4a3eb407d9fa2d10d717292f6d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a7cff9c4a3eb407d9fa2d10d717292f6d" kindref="member">properties</ref>:<sp/>Properties<sp/>|<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>In<sp/>MQTT<sp/>v5.0,<sp/>the<sp/>properties<sp/>associated<sp/>with<sp/>the<sp/>message.<sp/>(`Properties`)&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__eq__(self,<sp/>other:<sp/>object)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Override<sp/>the<sp/>default<sp/>Equals<sp/>behavior&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="610"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(other,<sp/>self.__class__):</highlight></codeline>
<codeline lineno="611"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.mid<sp/>==<sp/>other.mid</highlight></codeline>
<codeline lineno="612"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>False</highlight></codeline>
<codeline lineno="613"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="614"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>def<sp/>__ne__(self,<sp/>other:<sp/>object)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="615"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal">Define<sp/>a<sp/>non-equality<sp/>test&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>not<sp/>self.__eq__(other)</highlight></codeline>
<codeline lineno="617"><highlight class="normal"></highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="619" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a109d7a42fe65fb308101a3b7e0db7d9b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>topic(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;topic<sp/>that<sp/>the<sp/>message<sp/>was<sp/>published<sp/>on.</highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>is<sp/>read-only.</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._topic.decode(&apos;utf-8&apos;)</highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/>@topic.setter</highlight></codeline>
<codeline lineno="627" refid="classpaho_1_1mqtt_1_1client_1_1_m_q_t_t_message_1a3730f6ef18b242bb41ef11ec6b2afe73" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>topic(self,<sp/>value:<sp/>bytes)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._topic<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631" refid="classpaho_1_1mqtt_1_1client_1_1_client" refkind="compound"><highlight class="normal">class<sp/>Client:</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;MQTT<sp/>version<sp/>3.1/3.1.1/5.0<sp/>client<sp/>class.</highlight></codeline>
<codeline lineno="633"><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/>This<sp/>is<sp/>the<sp/>main<sp/>class<sp/>for<sp/>use<sp/>communicating<sp/>with<sp/>an<sp/>MQTT<sp/>broker.</highlight></codeline>
<codeline lineno="635"><highlight class="normal"></highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/>General<sp/>usage<sp/>flow:</highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/>*<sp/>Use<sp/>`connect()`,<sp/>`connect_async()`<sp/>or<sp/>`connect_srv()`<sp/>to<sp/>connect<sp/>to<sp/>a<sp/>broker</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/>*<sp/>Use<sp/>`loop_start()`<sp/>to<sp/>set<sp/>a<sp/>thread<sp/>running<sp/>to<sp/>call<sp/>`loop()`<sp/>for<sp/>you.</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/>*<sp/>Or<sp/>use<sp/>`loop_forever()`<sp/>to<sp/>handle<sp/>calling<sp/>`loop()`<sp/>for<sp/>you<sp/>in<sp/>a<sp/>blocking<sp/>function.</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/>*<sp/>Or<sp/>call<sp/>`loop()`<sp/>frequently<sp/>to<sp/>maintain<sp/>network<sp/>traffic<sp/>flow<sp/>with<sp/>the<sp/>broker</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/>*<sp/>Use<sp/>`subscribe()`<sp/>to<sp/>subscribe<sp/>to<sp/>a<sp/>topic<sp/>and<sp/>receive<sp/>messages</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/>*<sp/>Use<sp/>`publish()`<sp/>to<sp/>send<sp/>messages</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/>*<sp/>Use<sp/>`disconnect()`<sp/>to<sp/>disconnect<sp/>from<sp/>the<sp/>broker</highlight></codeline>
<codeline lineno="645"><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/>Data<sp/>returned<sp/>from<sp/>the<sp/>broker<sp/>is<sp/>made<sp/>available<sp/>with<sp/>the<sp/>use<sp/>of<sp/>callback</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/>functions<sp/>as<sp/>described<sp/>below.</highlight></codeline>
<codeline lineno="648"><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>:param<sp/>CallbackAPIVersion<sp/>callback_api_version:<sp/>define<sp/>the<sp/>API<sp/>version<sp/>for<sp/>user-callback<sp/>(on_connect,<sp/>on_publish,...).</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>field<sp/>is<sp/>required<sp/>and<sp/>it&apos;s<sp/>recommended<sp/>to<sp/>use<sp/>the<sp/>latest<sp/>version<sp/>(CallbackAPIVersion.API_VERSION2).</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>See<sp/>each<sp/>callback<sp/>for<sp/>description<sp/>of<sp/>API<sp/>for<sp/>each<sp/>version.<sp/>The<sp/>file<sp/>docs/migrations.rst<sp/>contains<sp/>details<sp/>on</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>how<sp/>to<sp/>migrate<sp/>between<sp/>version.</highlight></codeline>
<codeline lineno="653"><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>client_id:<sp/>the<sp/>unique<sp/>client<sp/>id<sp/>string<sp/>used<sp/>when<sp/>connecting<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>broker.<sp/>If<sp/>client_id<sp/>is<sp/>zero<sp/>length<sp/>or<sp/>None,<sp/>then<sp/>the<sp/>behaviour<sp/>is</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>defined<sp/>by<sp/>which<sp/>protocol<sp/>version<sp/>is<sp/>in<sp/>use.<sp/>If<sp/>using<sp/>MQTT<sp/>v3.1.1,<sp/>then</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>zero<sp/>length<sp/>client<sp/>id<sp/>will<sp/>be<sp/>sent<sp/>to<sp/>the<sp/>broker<sp/>and<sp/>the<sp/>broker<sp/>will</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>generate<sp/>a<sp/>random<sp/>for<sp/>the<sp/>client.<sp/>If<sp/>using<sp/>MQTT<sp/>v3.1<sp/>then<sp/>an<sp/>id<sp/>will<sp/>be</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>randomly<sp/>generated.<sp/>In<sp/>both<sp/>cases,<sp/>clean_session<sp/>must<sp/>be<sp/>True.<sp/>If<sp/>this</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>not<sp/>the<sp/>case<sp/>a<sp/>ValueError<sp/>will<sp/>be<sp/>raised.</highlight></codeline>
<codeline lineno="661"><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/>:param<sp/>bool<sp/>clean_session:<sp/>a<sp/>boolean<sp/>that<sp/>determines<sp/>the<sp/>client<sp/>type.<sp/>If<sp/>True,</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>broker<sp/>will<sp/>remove<sp/>all<sp/>information<sp/>about<sp/>this<sp/>client<sp/>when<sp/>it</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnects.<sp/>If<sp/>False,<sp/>the<sp/>client<sp/>is<sp/>a<sp/>persistent<sp/>client<sp/>and</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscription<sp/>information<sp/>and<sp/>queued<sp/>messages<sp/>will<sp/>be<sp/>retained<sp/>when<sp/>the</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client<sp/>disconnects.</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>a<sp/>client<sp/>will<sp/>never<sp/>discard<sp/>its<sp/>own<sp/>outgoing<sp/>messages<sp/>on</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnect.<sp/>Calling<sp/>connect()<sp/>or<sp/>reconnect()<sp/>will<sp/>cause<sp/>the<sp/>messages<sp/>to</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>resent.<sp/><sp/>Use<sp/>reinitialise()<sp/>to<sp/>reset<sp/>a<sp/>client<sp/>to<sp/>its<sp/>original<sp/>state.</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>clean_session<sp/>argument<sp/>only<sp/>applies<sp/>to<sp/>MQTT<sp/>versions<sp/>v3.1.1<sp/>and<sp/>v3.1.</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>It<sp/>is<sp/>not<sp/>accepted<sp/>if<sp/>the<sp/>MQTT<sp/>version<sp/>is<sp/>v5.0<sp/>-<sp/>use<sp/>the<sp/>clean_start</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argument<sp/>on<sp/>connect()<sp/>instead.</highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>user<sp/>defined<sp/>data<sp/>of<sp/>any<sp/>type<sp/>that<sp/>is<sp/>passed<sp/>as<sp/>the<sp/>&quot;userdata&quot;</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameter<sp/>to<sp/>callbacks.<sp/>It<sp/>may<sp/>be<sp/>updated<sp/>at<sp/>a<sp/>later<sp/>point<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>user_data_set()<sp/>function.</highlight></codeline>
<codeline lineno="677"><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>protocol:<sp/>allows<sp/>explicit<sp/>setting<sp/>of<sp/>the<sp/>MQTT<sp/>version<sp/>to</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use<sp/>for<sp/>this<sp/>client.<sp/>Can<sp/>be<sp/>paho.mqtt.client.MQTTv311<sp/>(v3.1.1),</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paho.mqtt.client.MQTTv31<sp/>(v3.1)<sp/>or<sp/>paho.mqtt.client.MQTTv5<sp/>(v5.0),</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>the<sp/>default<sp/>being<sp/>v3.1.1.</highlight></codeline>
<codeline lineno="682"><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/>:param<sp/>transport:<sp/>use<sp/>&quot;websockets&quot;<sp/>to<sp/>use<sp/>WebSockets<sp/>as<sp/>the<sp/>transport</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mechanism.<sp/>Set<sp/>to<sp/>&quot;tcp&quot;<sp/>to<sp/>use<sp/>raw<sp/>TCP,<sp/>which<sp/>is<sp/>the<sp/>default.</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Use<sp/>&quot;unix&quot;<sp/>to<sp/>use<sp/>Unix<sp/>sockets<sp/>as<sp/>the<sp/>transport<sp/>mechanism;<sp/>note<sp/>that</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>option<sp/>is<sp/>only<sp/>available<sp/>on<sp/>platforms<sp/>that<sp/>support<sp/>Unix<sp/>sockets,</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>the<sp/>&quot;host&quot;<sp/>argument<sp/>is<sp/>interpreted<sp/>as<sp/>the<sp/>path<sp/>to<sp/>the<sp/>Unix<sp/>socket</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file<sp/>in<sp/>this<sp/>case.</highlight></codeline>
<codeline lineno="689"><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/>:param<sp/>bool<sp/>manual_ack:<sp/>normally,<sp/>when<sp/>a<sp/>message<sp/>is<sp/>received,<sp/>the<sp/>library<sp/>automatically</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>acknowledges<sp/>after<sp/>on_message<sp/>callback<sp/>returns.<sp/><sp/>manual_ack=True<sp/>allows<sp/>the<sp/>application<sp/>to</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>acknowledge<sp/>receipt<sp/>after<sp/>it<sp/>has<sp/>completed<sp/>processing<sp/>of<sp/>a<sp/>message</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>using<sp/>a<sp/>the<sp/>ack()<sp/>method.<sp/>This<sp/>addresses<sp/>vulnerability<sp/>to<sp/>message<sp/>loss</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>applications<sp/>fails<sp/>while<sp/>processing<sp/>a<sp/>message,<sp/>or<sp/>while<sp/>it<sp/>pending</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>locally.</highlight></codeline>
<codeline lineno="696"><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/>Callbacks</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/>=========</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/>A<sp/>number<sp/>of<sp/>callback<sp/>functions<sp/>are<sp/>available<sp/>to<sp/>receive<sp/>data<sp/>back<sp/>from<sp/>the</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/>broker.<sp/>To<sp/>use<sp/>a<sp/>callback,<sp/>define<sp/>a<sp/>function<sp/>and<sp/>then<sp/>assign<sp/>it<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/>client::</highlight></codeline>
<codeline lineno="703"><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>on_connect(client,<sp/>userdata,<sp/>flags,<sp/>reason_code,<sp/>properties):</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(f&quot;Connected<sp/>with<sp/>result<sp/>code<sp/>{reason_code}&quot;)</highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client.on_connect<sp/>=<sp/>on_connect</highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/>Callbacks<sp/>can<sp/>also<sp/>be<sp/>attached<sp/>using<sp/>decorators::</highlight></codeline>
<codeline lineno="710"><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mqttc<sp/>=<sp/>paho.mqtt.Client()</highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@mqttc.connect_callback()</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>on_connect(client,<sp/>userdata,<sp/>flags,<sp/>reason_code,<sp/>properties):</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(f&quot;Connected<sp/>with<sp/>result<sp/>code<sp/>{reason_code}&quot;)</highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/>All<sp/>of<sp/>the<sp/>callbacks<sp/>as<sp/>described<sp/>below<sp/>have<sp/>a<sp/>&quot;client&quot;<sp/>and<sp/>an<sp/>&quot;userdata&quot;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/>argument.<sp/>&quot;client&quot;<sp/>is<sp/>the<sp/>`Client`<sp/>instance<sp/>that<sp/>is<sp/>calling<sp/>the<sp/>callback.</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/>userdata&quot;<sp/>is<sp/>user<sp/>data<sp/>of<sp/>any<sp/>type<sp/>and<sp/>can<sp/>be<sp/>set<sp/>when<sp/>creating<sp/>a<sp/>new<sp/>client</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/>instance<sp/>or<sp/>with<sp/>`user_data_set()`.</highlight></codeline>
<codeline lineno="721"><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/>If<sp/>you<sp/>wish<sp/>to<sp/>suppress<sp/>exceptions<sp/>within<sp/>a<sp/>callback,<sp/>you<sp/>should<sp/>set</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/>``mqttc.suppress_exceptions<sp/>=<sp/>True``</highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/>The<sp/>callbacks<sp/>are<sp/>listed<sp/>below,<sp/>documentation<sp/>for<sp/>each<sp/>of<sp/>them<sp/>can<sp/>be<sp/>found</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/>at<sp/>the<sp/>same<sp/>function<sp/>name:</highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/>`on_connect`,<sp/>`on_connect_fail`,<sp/>`on_disconnect`,<sp/>`on_message`,<sp/>`on_publish`,</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/>`on_subscribe`,<sp/>`on_unsubscribe`,<sp/>`on_log`,<sp/>`on_socket_open`,<sp/>`on_socket_close`,</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/>`on_socket_register_write`,<sp/>`on_socket_unregister_write`</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="732"><highlight class="normal"></highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>__init__(</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callback_api_version:<sp/>CallbackAPIVersion<sp/>=<sp/>CallbackAPIVersion.VERSION1,</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client_id:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>&quot;&quot;,</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_session:<sp/>bool<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userdata:<sp/>Any<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>protocol:<sp/>MQTTProtocolVersion<sp/>=<sp/>MQTTv311,</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transport:<sp/>Literal[&quot;tcp&quot;,<sp/>&quot;websockets&quot;,<sp/>&quot;unix&quot;]<sp/>=<sp/>&quot;tcp&quot;,</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reconnect_on_failure:<sp/>bool<sp/>=<sp/>True,</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>manual_ack:<sp/>bool<sp/>=<sp/>False,</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transport<sp/>=<sp/>transport.lower()<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>transport<sp/>==<sp/>&quot;unix&quot;<sp/>and<sp/>not<sp/>hasattr(socket,<sp/>&quot;AF_UNIX&quot;):</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;&quot;unix&quot;<sp/>transport<sp/>not<sp/>supported&apos;)</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>transport<sp/>not<sp/>in<sp/>(&quot;websockets&quot;,<sp/>&quot;tcp&quot;,<sp/>&quot;unix&quot;):</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f&apos;transport<sp/>must<sp/>be<sp/>&quot;websockets&quot;,<sp/>&quot;tcp&quot;<sp/>or<sp/>&quot;unix&quot;,<sp/>not<sp/>{transport}&apos;)</highlight></codeline>
<codeline lineno="750"><highlight class="normal"></highlight></codeline>
<codeline lineno="751" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a7fe06101da847500762a2339abd0c372" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._manual_ack<sp/>=<sp/>manual_ack</highlight></codeline>
<codeline lineno="752" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4f9a9dbec30f933a0acb2a6fae26ae8c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._transport<sp/>=<sp/>transport</highlight></codeline>
<codeline lineno="753" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa4fb80a1eadaf60d16f4fa4aaf808b8e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._protocol<sp/>=<sp/>protocol</highlight></codeline>
<codeline lineno="754" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8a8a1f63475d6b98c274c06e55777d2a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata<sp/>=<sp/>userdata</highlight></codeline>
<codeline lineno="755" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a11db054a98d3a13f053b8a827a5ce0ed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock:<sp/>SocketLike<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="756" refid="classpaho_1_1mqtt_1_1client_1_1_client_1acd05cb20f4f72a77b8123cc0310a4ed3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairR:<sp/>socket.socket<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="757" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a241cf5af9f3ab3318f301e633e9db3bf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairW:<sp/>socket.socket<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="758" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab01994c81ed310ffcbd1febf37a0ecb5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._keepalive<sp/>=<sp/>60</highlight></codeline>
<codeline lineno="759" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab7406304e185c7ef89b9f7453dfe9610" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._connect_timeout<sp/>=<sp/>5.0</highlight></codeline>
<codeline lineno="760" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4a074579d1c4d8964fbe56092a22caa7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_mode<sp/>=<sp/>MQTT_CLIENT</highlight></codeline>
<codeline lineno="761" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a279a8c5ab3fe35c7be2f7d95b94d8a0b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._callback_api_version<sp/>=<sp/>callback_api_version</highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION1:</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>warnings.warn(</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Callback<sp/>API<sp/>version<sp/>1<sp/>is<sp/>deprecated,<sp/>update<sp/>to<sp/>latest<sp/>version&quot;,</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>category=DeprecationWarning,</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stacklevel=2,</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(self._callback_api_version,<sp/>str):</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Help<sp/>user<sp/>to<sp/>migrate,<sp/>it<sp/>probably<sp/>provided<sp/>a<sp/>client<sp/>id</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>as<sp/>first<sp/>arguments</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Unsupported<sp/>callback<sp/>API<sp/>version:<sp/>version<sp/>2.0<sp/>added<sp/>a<sp/>callback_api_version,<sp/>see<sp/>docs/migrations.rst<sp/>for<sp/>details&quot;</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>not<sp/>in<sp/>CallbackAPIVersion:</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Unsupported<sp/>callback<sp/>API<sp/>version&quot;)</highlight></codeline>
<codeline lineno="777"><highlight class="normal"></highlight></codeline>
<codeline lineno="778" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a103f8cb8e8a4307b46215266db8d86d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._clean_start:<sp/>int<sp/>=<sp/>MQTT_CLEAN_START_FIRST_ONLY</highlight></codeline>
<codeline lineno="779"><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>clean_session<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Clean<sp/>session<sp/>is<sp/>not<sp/>used<sp/>for<sp/>MQTT<sp/>5.0&apos;)</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>clean_session<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_session<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>clean_session<sp/>and<sp/>(client_id<sp/>==<sp/>&quot;&quot;<sp/>or<sp/>client_id<sp/>is<sp/>None):</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;A<sp/>client<sp/>id<sp/>must<sp/>be<sp/>provided<sp/>if<sp/>clean<sp/>session<sp/>is<sp/>False.&apos;)</highlight></codeline>
<codeline lineno="789" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8a31d0b27f16368507744e03687e4c7f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._clean_session<sp/>=<sp/>clean_session</highlight></codeline>
<codeline lineno="790"><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>[MQTT-3.1.3-4]<sp/>Client<sp/>Id<sp/>must<sp/>be<sp/>UTF-8<sp/>encoded<sp/>string.</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>client_id<sp/>==<sp/>&quot;&quot;<sp/>or<sp/>client_id<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>protocol<sp/>==<sp/>MQTTv31:</highlight></codeline>
<codeline lineno="794" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae536543913baa32d49329ff94d3f5ecf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_id<sp/>=<sp/>_base62(uuid.uuid4().int,<sp/>padding=22).encode(&quot;utf8&quot;)</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_id<sp/>=<sp/>b&quot;&quot;</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_id<sp/>=<sp/>_force_bytes(client_id)</highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight></codeline>
<codeline lineno="800" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a82c989be5caaa204321ed0f8d973dbb3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._username:<sp/>bytes<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="801" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aca99f33f007b190f666341ffa74036da" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._password:<sp/>bytes<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="802" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa9eb512fc56f43b9a7fa53d89ba083b4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet:<sp/>_InPacket<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;command&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;have_remaining&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_count&quot;:<sp/>[],</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_mult&quot;:<sp/>1,</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_length&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;packet&quot;:<sp/>bytearray(b&quot;&quot;),</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;to_process&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;pos&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="812" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a1491c57865542fbe00cd2ce20cded289" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_packet:<sp/>collections.deque[_OutPacket]<sp/>=<sp/>collections.deque()</highlight></codeline>
<codeline lineno="813" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a06a785bfffc0991ab050c1a67ed4883a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_in<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="814" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad25cb59b162c3f21b2341a7262143f98" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_out<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="815" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af8cac7b7ba706425583cb3f672dac731" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_min_delay<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="816" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa6705ac3018d2dea14d9f7f2b7502796" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_max_delay<sp/>=<sp/>120</highlight></codeline>
<codeline lineno="817" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a003552dc139dd6af3f853aadc7424694" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_delay:<sp/>int<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="818" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6e436ee25abc45343fff51eb147c00a2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_on_failure<sp/>=<sp/>reconnect_on_failure</highlight></codeline>
<codeline lineno="819" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6f21e7446ca39007d8ac5f086e4ba5ee" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ping_t<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="820" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a07dcd2e62f345574e8093161f18a9aa8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_mid<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="821" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aff05914a0eaf55d174c33f108f02ab42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_NEW</highlight></codeline>
<codeline lineno="822" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aea0ddc840d0bc59c276b547fba761945" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_messages:<sp/>collections.OrderedDict[</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int,<sp/>MQTTMessage</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]<sp/>=<sp/>collections.OrderedDict()</highlight></codeline>
<codeline lineno="825" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a83740dee60f96336f1aba754f8a6b5bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_messages:<sp/>collections.OrderedDict[</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int,<sp/>MQTTMessage</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]<sp/>=<sp/>collections.OrderedDict()</highlight></codeline>
<codeline lineno="828" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a676ea86c0198eb2068e808a800558292" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._max_inflight_messages<sp/>=<sp/>20</highlight></codeline>
<codeline lineno="829" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a1fa4bc4131908ca3776bbc6340c45972" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="830" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa1b44b17845d6e5f1269adf9ff030fb8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._max_queued_messages<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="831" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af02f3df4fb72b82e993a87a18a7bc4ef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._connect_properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="832" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a079e7f5d347a80025883fef6a61b14f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="833" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a3f68289c3956e2b69853267b0269a9f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="834" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aaaf756724a72656862ab47beee09fef0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_topic<sp/>=<sp/>b&quot;&quot;</highlight></codeline>
<codeline lineno="835" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a7ef47ed979a7cace660dc2aa7b7e9d5c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_payload<sp/>=<sp/>b&quot;&quot;</highlight></codeline>
<codeline lineno="836" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a2ba5abf3195b6a7885920ad6e6fabf3d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_qos<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="837" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab2a10adf04a7daa877e11dc1847712e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_retain<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="838" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac9de1e2f64dcd64c37b7d22b8bc1018e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_message_filtered<sp/>=<sp/>MQTTMatcher()</highlight></codeline>
<codeline lineno="839" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae526a1f25b27918ff889dcbcc97fda87" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._host<sp/>=<sp/>&quot;&quot;</highlight></codeline>
<codeline lineno="840" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a5f090e12d2f135512867b323874c7aff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._port<sp/>=<sp/>1883</highlight></codeline>
<codeline lineno="841" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0f1914ad9f8643f4b3eafa47466a623f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._bind_address<sp/>=<sp/>&quot;&quot;</highlight></codeline>
<codeline lineno="842" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab332dffb8b70d80307901c48eec3932b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._bind_port<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="843" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a744b44b8fc3c88e675729c5f88982a6a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._proxy:<sp/>Any<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="844" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9949b3a5f6a6253c810aab4c95e358c7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_callback_mutex<sp/>=<sp/>threading.Lock()</highlight></codeline>
<codeline lineno="845" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aac9df5b26c616e062b6f21c52934bab7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._callback_mutex<sp/>=<sp/>threading.RLock()</highlight></codeline>
<codeline lineno="846" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a20d4406adb628ace1e8f7418f8ac5d7c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._msgtime_mutex<sp/>=<sp/>threading.Lock()</highlight></codeline>
<codeline lineno="847" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a52246082a6dcee45c1722694e1620e9d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_message_mutex<sp/>=<sp/>threading.RLock()</highlight></codeline>
<codeline lineno="848" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad373857f3561bc7335087c3bf7dfe56e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_message_mutex<sp/>=<sp/>threading.Lock()</highlight></codeline>
<codeline lineno="849" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a7cc5029a982e724afa65e75e9c8dc6c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_delay_mutex<sp/>=<sp/>threading.Lock()</highlight></codeline>
<codeline lineno="850" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a22840d7b4053d2b0790b9da8607e2999" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._mid_generate_mutex<sp/>=<sp/>threading.Lock()</highlight></codeline>
<codeline lineno="851" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a3718c08e79fc0b99c7e8accecd4980ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread:<sp/>threading.Thread<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="852" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aae523a6001a22c955c5df3d64122ecaa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread_terminate<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="853" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a51c934b23149d69a005fb8059b92ef1e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ssl<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="854" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a428004424c9d250a559b9fbd96b2fca8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ssl_context:<sp/>ssl.SSLContext<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Only<sp/>used<sp/>when<sp/>SSL<sp/>context<sp/>does<sp/>not<sp/>have<sp/>check_hostname<sp/>attribute</highlight></codeline>
<codeline lineno="856" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae29a743bc7e3db0da797f9edefc7e516" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._tls_insecure<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="857" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a81667e41d03238d88256c8d30e79c02e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._logger:<sp/>logging.Logger<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="858" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6327c2950d181d92bae19c5a776ec13c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._registered_write<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>No<sp/>default<sp/>callbacks</highlight></codeline>
<codeline lineno="860" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac6efc240bcef122157e063fde3ae8ff6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_log:<sp/>CallbackOnLog<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="861" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae18b2b4271a90b0158073ad30c4994c0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_pre_connect:<sp/>CallbackOnPreConnect<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="862" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aae97b1dc82711b317b2373ba7b62f4d9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_connect:<sp/>CallbackOnConnect<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="863" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad15a0a1978254452c638035c06143782" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_connect_fail:<sp/>CallbackOnConnectFail<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="864" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a86e8808efde5dc64bbe198a75f8b246d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_subscribe:<sp/>CallbackOnSubscribe<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="865" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad3161aa7e323084c8d81510a46456de7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_message:<sp/>CallbackOnMessage<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="866" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a851777dbbfa0bf35199c5b5a7aa5fe29" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_publish:<sp/>CallbackOnPublish<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="867" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a10e8b181f9294bdf1a7d66d1a34d9bb6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_unsubscribe:<sp/>CallbackOnUnsubscribe<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="868" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae441a88d29c3af6e0cc08a5f8209353b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_disconnect:<sp/>CallbackOnDisconnect<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="869" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad96fbc74a242162e411568a3ffe71524" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_open:<sp/>CallbackOnSocket<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="870" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a229d74bdd59d524d661c488dde381a61" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_close:<sp/>CallbackOnSocket<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="871" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aba7afd38da9ac2b96320d2a0486afa6c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_register_write:<sp/>CallbackOnSocket<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="872" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a51a329e3efb3f0d3b516b777828fbd00" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_unregister_write:<sp/>CallbackOnSocket<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="873" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad2fc6b112f6860253b4bfa8addd6d5e6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._websocket_path<sp/>=<sp/>&quot;/mqtt&quot;</highlight></codeline>
<codeline lineno="874" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aee11260407d769dc779ff1cb04f3ecee" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._websocket_extra_headers:<sp/>WebSocketHeaders<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>for<sp/>clean_start<sp/>==<sp/>MQTT_CLEAN_START_FIRST_ONLY</highlight></codeline>
<codeline lineno="876" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a52f77bfa1a21d35477fab21f221a1b45" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._mqttv5_first_connect<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="877" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aea8562a89bbca773dc634cee4fcf7b5c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.suppress_exceptions<sp/>=<sp/>False<sp/>#<sp/>For<sp/>callbacks</highlight></codeline>
<codeline lineno="878"><highlight class="normal"></highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>__del__(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reset_sockets()</highlight></codeline>
<codeline lineno="881"><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="883" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9e40bfbcd507042660e8567d705ce063" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>host(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Host<sp/>to<sp/>connect<sp/>to.<sp/>If<sp/>`connect()`<sp/>hasn&apos;t<sp/>been<sp/>called<sp/>yet,<sp/>returns<sp/>an<sp/>empty<sp/>string.</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._host</highlight></codeline>
<codeline lineno="890"><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/>@host.setter</highlight></codeline>
<codeline lineno="892" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a7269784b159d128f873707296ff6fadf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>host(self,<sp/>value:<sp/>str)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>host<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="895"><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>value:</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Invalid<sp/>host.&quot;)</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._host<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="899"><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="901" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a66b254f32c1ca4e6aad487d7f5870a4b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>port(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Broker<sp/>TCP<sp/>port<sp/>to<sp/>connect<sp/>to.</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._port</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/>@port.setter</highlight></codeline>
<codeline lineno="910" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab24d1a5d20f01004dede3ac7c8f8646a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>port(self,<sp/>value:<sp/>int)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>port<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="913"><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>value<sp/>&lt;=<sp/>0:</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Invalid<sp/>port<sp/>number.&quot;)</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._port<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="917"><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="919" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4d283d83ab60654a967069659bb3e329" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>keepalive(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Client<sp/>keepalive<sp/>interval<sp/>(in<sp/>seconds).</highlight></codeline>
<codeline lineno="922"><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._keepalive</highlight></codeline>
<codeline lineno="926"><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/>@keepalive.setter</highlight></codeline>
<codeline lineno="928" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a26195e4a4bc38e11c717d3053f965168" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>keepalive(self,<sp/>value:<sp/>int)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>The<sp/>issue<sp/>here<sp/>is<sp/>that<sp/>the<sp/>previous<sp/>value<sp/>of<sp/>keepalive<sp/>matter<sp/>to<sp/>possibly</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>sent<sp/>ping<sp/>packet.</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>keepalive<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>value<sp/>&lt;<sp/>0:</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Keepalive<sp/>must<sp/>be<sp/>&gt;=0.&quot;)</highlight></codeline>
<codeline lineno="936"><highlight class="normal"></highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._keepalive<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="938"><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="940" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae590185a470d6e075aa7e5400f406711" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>transport(self)<sp/>-&gt;<sp/>Literal[&quot;tcp&quot;,<sp/>&quot;websockets&quot;,<sp/>&quot;unix&quot;]:</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Transport<sp/>method<sp/>used<sp/>for<sp/>the<sp/>connection<sp/>(&quot;tcp&quot;<sp/>or<sp/>&quot;websockets&quot;).</highlight></codeline>
<codeline lineno="943"><highlight class="normal"></highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._transport</highlight></codeline>
<codeline lineno="947"><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/>@transport.setter</highlight></codeline>
<codeline lineno="949" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa7377dd45dc80355d50dc4a48b250c7e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>transport(self,<sp/>value:<sp/>Literal[&quot;tcp&quot;,<sp/>&quot;websockets&quot;])<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>transport<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="952"><highlight class="normal"></highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._transport<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="954"><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="956" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae42884718532307fe60a1c06f8d48d8d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>protocol(self)<sp/>-&gt;<sp/>MQTTProtocolVersion:</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Protocol<sp/>version<sp/>used<sp/>(MQTT<sp/>v3,<sp/>MQTT<sp/>v3.11,<sp/>MQTTv5)</highlight></codeline>
<codeline lineno="959"><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>is<sp/>read-only.</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._protocol</highlight></codeline>
<codeline lineno="963"><highlight class="normal"></highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="965" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a5e1c14b5fe76accc8fb0242a8ff60a18" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>connect_timeout(self)<sp/>-&gt;<sp/>float:</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Connection<sp/>establishment<sp/>timeout<sp/>in<sp/>seconds.</highlight></codeline>
<codeline lineno="968"><highlight class="normal"></highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._connect_timeout</highlight></codeline>
<codeline lineno="972"><highlight class="normal"></highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/>@connect_timeout.setter</highlight></codeline>
<codeline lineno="974" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a76542d631adccc451a4d1af25d3248a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>connect_timeout(self,<sp/>value:<sp/>float)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>connect_timeout<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="977"><highlight class="normal"></highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>value<sp/>&lt;=<sp/>0.0:</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;timeout<sp/>must<sp/>be<sp/>a<sp/>positive<sp/>number&quot;)</highlight></codeline>
<codeline lineno="980"><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._connect_timeout<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="982"><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="984" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a603e6b9726a0b986f1af5eae987713dc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>username(self)<sp/>-&gt;<sp/>str<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>username<sp/>used<sp/>to<sp/>connect<sp/>to<sp/>the<sp/>MQTT<sp/>broker,<sp/>or<sp/>None<sp/>if<sp/>no<sp/>username<sp/>is<sp/>used.</highlight></codeline>
<codeline lineno="986"><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._username<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>None</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._username.decode(&quot;utf-8&quot;)</highlight></codeline>
<codeline lineno="992"><highlight class="normal"></highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/>@username.setter</highlight></codeline>
<codeline lineno="994" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa6282e7938909ad6cd66a35ce967476b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>username(self,<sp/>value:<sp/>str<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>username<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="997"><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>value<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._username<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._username<sp/>=<sp/>value.encode(&quot;utf-8&quot;)</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="1004" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a567a5e8ede1f1d5acbc274bf9df713d3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>password(self)<sp/>-&gt;<sp/>str<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>password<sp/>used<sp/>to<sp/>connect<sp/>to<sp/>the<sp/>MQTT<sp/>broker,<sp/>or<sp/>None<sp/>if<sp/>no<sp/>password<sp/>is<sp/>used.</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._password<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>None</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._password.decode(&quot;utf-8&quot;)</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/>@password.setter</highlight></codeline>
<codeline lineno="1014" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a913b1f7ba5251cc88e76490ef16405b1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>password(self,<sp/>value:<sp/>str<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>password<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>value<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._password<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._password<sp/>=<sp/>value.encode(&quot;utf-8&quot;)</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="1024" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a82c3f1df31f7bb3423f44a6256b6c3f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>max_inflight_messages(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Maximum<sp/>number<sp/>of<sp/>messages<sp/>with<sp/>QoS<sp/>&gt;<sp/>0<sp/>that<sp/>can<sp/>be<sp/>partway<sp/>through<sp/>the<sp/>network<sp/>flow<sp/>at<sp/>once</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._max_inflight_messages</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"></highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/>@max_inflight_messages.setter</highlight></codeline>
<codeline lineno="1033" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4f4a9692ec56ac1da9dcabeb2933b563" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>max_inflight_messages(self,<sp/>value:<sp/>int)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Not<sp/>tested.<sp/>Some<sp/>doubt<sp/>that<sp/>everything<sp/>is<sp/>okay<sp/>when<sp/>max_inflight<sp/>change<sp/>between<sp/>0</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>and<sp/>&gt;<sp/>0<sp/>value<sp/>because<sp/>_update_inflight<sp/>is<sp/>skipped<sp/>when<sp/>_max_inflight_messages<sp/>==<sp/>0</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>max_inflight_messages<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"></highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>value<sp/>&lt;<sp/>0:</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Invalid<sp/>inflight.&quot;)</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._max_inflight_messages<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="1045" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad8d7b01180d1be6710f2e3b037fea889" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>max_queued_messages(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Maximum<sp/>number<sp/>of<sp/>message<sp/>in<sp/>the<sp/>outgoing<sp/>message<sp/>queue,<sp/>0<sp/>means<sp/>unlimited</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"></highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>may<sp/>not<sp/>be<sp/>changed<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>already<sp/>open.</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._max_queued_messages</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/>@max_queued_messages.setter</highlight></codeline>
<codeline lineno="1054" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af1de31e6d153ed8869276d47864d2cad" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>max_queued_messages(self,<sp/>value:<sp/>int)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._connection_closed():</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Not<sp/>tested.</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;updating<sp/>max_queued_messages<sp/>on<sp/>established<sp/>connection<sp/>is<sp/>not<sp/>supported&quot;)</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"></highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>value<sp/>&lt;<sp/>0:</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Invalid<sp/>queue<sp/>size.&quot;)</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._max_queued_messages<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="1065" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aea0417dbf2f3ce6206e31a8ee6cde076" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>will_topic(self)<sp/>-&gt;<sp/>str<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>topic<sp/>name<sp/>a<sp/>will<sp/>message<sp/>is<sp/>sent<sp/>to<sp/>when<sp/>disconnecting<sp/>unexpectedly.<sp/>None<sp/>if<sp/>a<sp/>will<sp/>shall<sp/>not<sp/>be<sp/>sent.</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"></highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>is<sp/>read-only.<sp/>Use<sp/>`will_set()`<sp/>to<sp/>change<sp/>its<sp/>value.</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._will_topic<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>None</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._will_topic.decode(&quot;utf-8&quot;)</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"></highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="1077" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a1cc3277bb88f083ef9344f3bb159b65e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>will_payload(self)<sp/>-&gt;<sp/>bytes<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>payload<sp/>for<sp/>the<sp/>will<sp/>message<sp/>that<sp/>is<sp/>sent<sp/>when<sp/>disconnecting<sp/>unexpectedly.<sp/>None<sp/>if<sp/>a<sp/>will<sp/>shall<sp/>not<sp/>be<sp/>sent.</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>is<sp/>read-only.<sp/>Use<sp/>`will_set()`<sp/>to<sp/>change<sp/>its<sp/>value.</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._will_payload</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"></highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="1086" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6b65a434011f13e3cf751ef4b328aa27" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>logger(self)<sp/>-&gt;<sp/>logging.Logger<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._logger</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/>@logger.setter</highlight></codeline>
<codeline lineno="1090" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a56bf722a79a7e36a178d9cfcf30dee97" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>logger(self,<sp/>value:<sp/>logging.Logger<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._logger<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"></highlight></codeline>
<codeline lineno="1093" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad84425d138eb81db8969b0dcb963bc68" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_sock_recv(self,<sp/>bufsize:<sp/>int)<sp/>-&gt;<sp/>bytes:</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ConnectionError(&quot;self._sock<sp/>is<sp/>None&quot;)</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._sock.recv(bufsize)</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ssl.SSLWantReadError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>BlockingIOError()<sp/>from<sp/>err</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ssl.SSLWantWriteError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_register_write()</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>BlockingIOError()<sp/>from<sp/>err</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>AttributeError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,<sp/>&quot;socket<sp/>was<sp/>None:<sp/>%s&quot;,<sp/>err)</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ConnectionError()<sp/>from<sp/>err</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"></highlight></codeline>
<codeline lineno="1108" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae8bf0936b2fe013748c2a5569473ab42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_sock_send(self,<sp/>buf:<sp/>bytes)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ConnectionError(&quot;self._sock<sp/>is<sp/>None&quot;)</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"></highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._sock.send(buf)</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ssl.SSLWantReadError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>BlockingIOError()<sp/>from<sp/>err</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ssl.SSLWantWriteError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_register_write()</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>BlockingIOError()<sp/>from<sp/>err</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>BlockingIOError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_register_write()</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>BlockingIOError()<sp/>from<sp/>err</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"></highlight></codeline>
<codeline lineno="1123" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a05710ea251ddea1ecbc560d625c95a62" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_sock_close(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Close<sp/>the<sp/>connection<sp/>to<sp/>the<sp/>server.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._sock:</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"></highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock<sp/>=<sp/>self._sock</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_unregister_write(sock)</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_close(sock)</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finally:</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>In<sp/>case<sp/>a<sp/>callback<sp/>fails,<sp/>still<sp/>close<sp/>the<sp/>socket<sp/>to<sp/>avoid<sp/>leaking<sp/>the<sp/>file<sp/>descriptor.</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock.close()</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"></highlight></codeline>
<codeline lineno="1137" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4016ad592f2cc3394106f9b7213dd468" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_reset_sockets(self,<sp/>sockpair_only:<sp/>bool<sp/>=<sp/>False)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>sockpair_only:</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"></highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sockpairR:</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairR.close()</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairR<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sockpairW:</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairW.close()</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairW<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"></highlight></codeline>
<codeline lineno="1148" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a151cf343d0aeb2464241ef3601d83679" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>reinitialise(</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client_id:<sp/>str<sp/>=<sp/>&quot;&quot;,</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_session:<sp/>bool<sp/>=<sp/>True,</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userdata:<sp/>Any<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reset_sockets()</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"></highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.__init__(client_id,<sp/>clean_session,<sp/>userdata)<sp/><sp/>#<sp/>type:<sp/>ignore[misc]</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"></highlight></codeline>
<codeline lineno="1158" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a2574db9753040a0a287a7aae66a955eb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>ws_set_options(</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path:<sp/>str<sp/>=<sp/>&quot;/mqtt&quot;,</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers:<sp/>WebSocketHeaders<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;<sp/>Set<sp/>the<sp/>path<sp/>and<sp/>headers<sp/>for<sp/>a<sp/>websocket<sp/>connection</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"></highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>path:<sp/>a<sp/>string<sp/>starting<sp/>with<sp/>/<sp/>which<sp/>should<sp/>be<sp/>the<sp/>endpoint<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mqtt<sp/>connection<sp/>on<sp/>the<sp/>remote<sp/>server</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"></highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>headers:<sp/><sp/>can<sp/>be<sp/>either<sp/>a<sp/>dict<sp/>or<sp/>a<sp/>callable<sp/>object.<sp/>If<sp/>it<sp/>is<sp/>a<sp/>dict<sp/>then</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>extra<sp/>items<sp/>in<sp/>the<sp/>dict<sp/>are<sp/>added<sp/>to<sp/>the<sp/>websocket<sp/>headers.<sp/>If<sp/>it<sp/>is</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>callable,<sp/>then<sp/>the<sp/>default<sp/>websocket<sp/>headers<sp/>are<sp/>passed<sp/>into<sp/>this</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function<sp/>and<sp/>the<sp/>result<sp/>is<sp/>used<sp/>as<sp/>the<sp/>new<sp/>headers.</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._websocket_path<sp/>=<sp/>path</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"></highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>headers<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(headers,<sp/>dict)<sp/>or<sp/>callable(headers):</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._websocket_extra_headers<sp/>=<sp/>headers</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&apos;headers&apos;<sp/>option<sp/>to<sp/>ws_set_options<sp/>has<sp/>to<sp/>be<sp/>either<sp/>a<sp/>dictionary<sp/>or<sp/>callable&quot;)</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"></highlight></codeline>
<codeline lineno="1182" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9e27172d392f63b9548702e3a719c911" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>tls_set_context(</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context:<sp/>ssl.SSLContext<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Configure<sp/>network<sp/>encryption<sp/>and<sp/>authentication<sp/>context.<sp/>Enables<sp/>SSL/TLS<sp/>support.</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"></highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>context:<sp/>an<sp/>ssl.SSLContext<sp/>object.<sp/>By<sp/>default<sp/>this<sp/>is<sp/>given<sp/>by</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``ssl.create_default_context()``,<sp/>if<sp/>available.</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Must<sp/>be<sp/>called<sp/>before<sp/>`connect()`,<sp/>`connect_async()`<sp/>or<sp/>`connect_srv()`.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ssl_context<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;SSL/TLS<sp/>has<sp/>already<sp/>been<sp/>configured.&apos;)</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"></highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>context<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context<sp/>=<sp/>ssl.create_default_context()</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"></highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ssl<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ssl_context<sp/>=<sp/>context</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"></highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Ensure<sp/>_tls_insecure<sp/>is<sp/>consistent<sp/>with<sp/>check_hostname<sp/>attribute</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>hasattr(context,<sp/>&apos;check_hostname&apos;):</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._tls_insecure<sp/>=<sp/>not<sp/>context.check_hostname</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"></highlight></codeline>
<codeline lineno="1205" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a2afd5e0d16f1228c304b7f0e1d64bc5b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>tls_set(</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ca_certs:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>certfile:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keyfile:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cert_reqs:<sp/>ssl.VerifyMode<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tls_version:<sp/>int<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ciphers:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keyfile_password:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alpn_protocols:<sp/>list[str]<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Configure<sp/>network<sp/>encryption<sp/>and<sp/>authentication<sp/>options.<sp/>Enables<sp/>SSL/TLS<sp/>support.</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"></highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>ca_certs:<sp/>a<sp/>string<sp/>path<sp/>to<sp/>the<sp/>Certificate<sp/>Authority<sp/>certificate<sp/>files</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>are<sp/>to<sp/>be<sp/>treated<sp/>as<sp/>trusted<sp/>by<sp/>this<sp/>client.<sp/>If<sp/>this<sp/>is<sp/>the<sp/>only</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>option<sp/>given<sp/>then<sp/>the<sp/>client<sp/>will<sp/>operate<sp/>in<sp/>a<sp/>similar<sp/>manner<sp/>to<sp/>a<sp/>web</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>browser.<sp/>That<sp/>is<sp/>to<sp/>say<sp/>it<sp/>will<sp/>require<sp/>the<sp/>broker<sp/>to<sp/>have<sp/>a</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>certificate<sp/>signed<sp/>by<sp/>the<sp/>Certificate<sp/>Authorities<sp/>in<sp/>ca_certs<sp/>and<sp/>will</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>communicate<sp/>using<sp/>TLS<sp/>v1,2,<sp/>but<sp/>will<sp/>not<sp/>attempt<sp/>any<sp/>form<sp/>of</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>authentication.<sp/>This<sp/>provides<sp/>basic<sp/>network<sp/>encryption<sp/>but<sp/>may<sp/>not<sp/>be</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sufficient<sp/>depending<sp/>on<sp/>how<sp/>the<sp/>broker<sp/>is<sp/>configured.</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"></highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>By<sp/>default,<sp/>on<sp/>Python<sp/>2.7.9+<sp/>or<sp/>3.4+,<sp/>the<sp/>default<sp/>certification</highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>authority<sp/>of<sp/>the<sp/>system<sp/>is<sp/>used.<sp/>On<sp/>older<sp/>Python<sp/>version<sp/>this<sp/>parameter</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>mandatory.</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>certfile:<sp/>PEM<sp/>encoded<sp/>client<sp/>certificate<sp/>filename.<sp/>Used<sp/>with</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keyfile<sp/>for<sp/>client<sp/>TLS<sp/>based<sp/>authentication.<sp/>Support<sp/>for<sp/>this<sp/>feature<sp/>is</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>broker<sp/>dependent.<sp/>Note<sp/>that<sp/>if<sp/>the<sp/>files<sp/>in<sp/>encrypted<sp/>and<sp/>needs<sp/>a<sp/>password<sp/>to</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decrypt<sp/>it,<sp/>then<sp/>this<sp/>can<sp/>be<sp/>passed<sp/>using<sp/>the<sp/>keyfile_password<sp/>argument<sp/>-<sp/>you</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>should<sp/>take<sp/>precautions<sp/>to<sp/>ensure<sp/>that<sp/>your<sp/>password<sp/>is</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>hard<sp/>coded<sp/>into<sp/>your<sp/>program<sp/>by<sp/>loading<sp/>the<sp/>password<sp/>from<sp/>a<sp/>file</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>example.<sp/>If<sp/>you<sp/>do<sp/>not<sp/>provide<sp/>keyfile_password,<sp/>the<sp/>password<sp/>will</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>requested<sp/>to<sp/>be<sp/>typed<sp/>in<sp/>at<sp/>a<sp/>terminal<sp/>window.</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>keyfile:<sp/>PEM<sp/>encoded<sp/>client<sp/>private<sp/>keys<sp/>filename.<sp/>Used<sp/>with</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>certfile<sp/>for<sp/>client<sp/>TLS<sp/>based<sp/>authentication.<sp/>Support<sp/>for<sp/>this<sp/>feature<sp/>is</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>broker<sp/>dependent.<sp/>Note<sp/>that<sp/>if<sp/>the<sp/>files<sp/>in<sp/>encrypted<sp/>and<sp/>needs<sp/>a<sp/>password<sp/>to</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decrypt<sp/>it,<sp/>then<sp/>this<sp/>can<sp/>be<sp/>passed<sp/>using<sp/>the<sp/>keyfile_password<sp/>argument<sp/>-<sp/>you</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>should<sp/>take<sp/>precautions<sp/>to<sp/>ensure<sp/>that<sp/>your<sp/>password<sp/>is</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>hard<sp/>coded<sp/>into<sp/>your<sp/>program<sp/>by<sp/>loading<sp/>the<sp/>password<sp/>from<sp/>a<sp/>file</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>example.<sp/>If<sp/>you<sp/>do<sp/>not<sp/>provide<sp/>keyfile_password,<sp/>the<sp/>password<sp/>will</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>requested<sp/>to<sp/>be<sp/>typed<sp/>in<sp/>at<sp/>a<sp/>terminal<sp/>window.</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>cert_reqs:<sp/>the<sp/>certificate<sp/>requirements<sp/>that<sp/>the<sp/>client<sp/>imposes</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on<sp/>the<sp/>broker<sp/>to<sp/>be<sp/>changed.<sp/>By<sp/>default<sp/>this<sp/>is<sp/>ssl.CERT_REQUIRED,</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>which<sp/>means<sp/>that<sp/>the<sp/>broker<sp/>must<sp/>provide<sp/>a<sp/>certificate.<sp/>See<sp/>the<sp/>ssl</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pydoc<sp/>for<sp/>more<sp/>information<sp/>on<sp/>this<sp/>parameter.</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>tls_version:<sp/>the<sp/>version<sp/>of<sp/>the<sp/>SSL/TLS<sp/>protocol<sp/>used<sp/>to<sp/>be</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specified.<sp/>By<sp/>default<sp/>TLS<sp/>v1.2<sp/>is<sp/>used.<sp/>Previous<sp/>versions<sp/>are<sp/>allowed</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>but<sp/>not<sp/>recommended<sp/>due<sp/>to<sp/>possible<sp/>security<sp/>problems.</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>ciphers:<sp/>encryption<sp/>ciphers<sp/>that<sp/>are<sp/>allowed</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>this<sp/>connection,<sp/>or<sp/>None<sp/>to<sp/>use<sp/>the<sp/>defaults.<sp/>See<sp/>the<sp/>ssl<sp/>pydoc<sp/>for</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>more<sp/>information.</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"></highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Must<sp/>be<sp/>called<sp/>before<sp/>`connect()`,<sp/>`connect_async()`<sp/>or<sp/>`connect_srv()`.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>ssl<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;This<sp/>platform<sp/>has<sp/>no<sp/>SSL/TLS.&apos;)</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"></highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>hasattr(ssl,<sp/>&apos;SSLContext&apos;):</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Require<sp/>Python<sp/>version<sp/>that<sp/>has<sp/>SSL<sp/>context<sp/>support<sp/>in<sp/>standard<sp/>library</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;Python<sp/>2.7.9<sp/>and<sp/>3.2<sp/>are<sp/>the<sp/>minimum<sp/>supported<sp/>versions<sp/>for<sp/>TLS.&apos;)</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>ca_certs<sp/>is<sp/>None<sp/>and<sp/>not<sp/>hasattr(ssl.SSLContext,<sp/>&apos;load_default_certs&apos;):</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;ca_certs<sp/>must<sp/>not<sp/>be<sp/>None.&apos;)</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Create<sp/>SSLContext<sp/>object</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>tls_version<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tls_version<sp/>=<sp/>ssl.PROTOCOL_TLSv1_2</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>the<sp/>python<sp/>version<sp/>supports<sp/>it,<sp/>use<sp/>highest<sp/>TLS<sp/>version<sp/>automatically</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>hasattr(ssl,<sp/>&quot;PROTOCOL_TLS_CLIENT&quot;):</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>This<sp/>also<sp/>enables<sp/>CERT_REQUIRED<sp/>and<sp/>check_hostname<sp/>by<sp/>default.</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tls_version<sp/>=<sp/>ssl.PROTOCOL_TLS_CLIENT</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>hasattr(ssl,<sp/>&quot;PROTOCOL_TLS&quot;):</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tls_version<sp/>=<sp/>ssl.PROTOCOL_TLS</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context<sp/>=<sp/>ssl.SSLContext(tls_version)</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"></highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Configure<sp/>context</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>ciphers<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context.set_ciphers(ciphers)</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>certfile<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context.load_cert_chain(certfile,<sp/>keyfile,<sp/>keyfile_password)</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"></highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>cert_reqs<sp/>==<sp/>ssl.CERT_NONE<sp/>and<sp/>hasattr(context,<sp/>&apos;check_hostname&apos;):</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context.check_hostname<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"></highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context.verify_mode<sp/>=<sp/>ssl.CERT_REQUIRED<sp/>if<sp/>cert_reqs<sp/>is<sp/>None<sp/>else<sp/>cert_reqs</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"></highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>ca_certs<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context.load_verify_locations(ca_certs)</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context.load_default_certs()</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"></highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>alpn_protocols<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>getattr(ssl,<sp/>&quot;HAS_ALPN&quot;,<sp/>None):</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;SSL<sp/>library<sp/>has<sp/>no<sp/>support<sp/>for<sp/>ALPN&quot;)</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context.set_alpn_protocols(alpn_protocols)</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"></highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.tls_set_context(context)</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>cert_reqs<sp/>!=<sp/>ssl.CERT_NONE:</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Default<sp/>to<sp/>secure,<sp/>sets<sp/>context.check_hostname<sp/>attribute</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>if<sp/>available</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.tls_insecure_set(False)</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>But<sp/>with<sp/>ssl.CERT_NONE,<sp/>we<sp/>can<sp/>not<sp/>check_hostname</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.tls_insecure_set(True)</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"></highlight></codeline>
<codeline lineno="1312" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac99c1807751c3f92156229bb32c01ec8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>tls_insecure_set(self,<sp/>value:<sp/>bool)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Configure<sp/>verification<sp/>of<sp/>the<sp/>server<sp/>hostname<sp/>in<sp/>the<sp/>server<sp/>certificate.</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>value<sp/>is<sp/>set<sp/>to<sp/>true,<sp/>it<sp/>is<sp/>impossible<sp/>to<sp/>guarantee<sp/>that<sp/>the<sp/>host</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>you<sp/>are<sp/>connecting<sp/>to<sp/>is<sp/>not<sp/>impersonating<sp/>your<sp/>server.<sp/>This<sp/>can<sp/>be</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>useful<sp/>in<sp/>initial<sp/>server<sp/>testing,<sp/>but<sp/>makes<sp/>it<sp/>possible<sp/>for<sp/>a<sp/>malicious</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>third<sp/>party<sp/>to<sp/>impersonate<sp/>your<sp/>server<sp/>through<sp/>DNS<sp/>spoofing,<sp/>for</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>example.</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Do<sp/>not<sp/>use<sp/>this<sp/>function<sp/>in<sp/>a<sp/>real<sp/>system.<sp/>Setting<sp/>value<sp/>to<sp/>true<sp/>means</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>there<sp/>is<sp/>no<sp/>point<sp/>using<sp/>encryption.</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"></highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Must<sp/>be<sp/>called<sp/>before<sp/>`connect()`<sp/>and<sp/>after<sp/>either<sp/>`tls_set()`<sp/>or</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`tls_set_context()`.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"></highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ssl_context<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;Must<sp/>configure<sp/>SSL<sp/>context<sp/>before<sp/>using<sp/>tls_insecure_set.&apos;)</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"></highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._tls_insecure<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"></highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Ensure<sp/>check_hostname<sp/>is<sp/>consistent<sp/>with<sp/>_tls_insecure<sp/>attribute</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>hasattr(self._ssl_context,<sp/>&apos;check_hostname&apos;):</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Rely<sp/>on<sp/>SSLContext<sp/>to<sp/>check<sp/>host<sp/>name</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>verify_mode<sp/>is<sp/>CERT_NONE<sp/>then<sp/>the<sp/>host<sp/>name<sp/>will<sp/>never<sp/>be<sp/>checked</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ssl_context.check_hostname<sp/>=<sp/>not<sp/>value</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"></highlight></codeline>
<codeline lineno="1339" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a505e3c2240e7baf332cce68a4a5c413d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>proxy_set(self,<sp/>**proxy_args:<sp/>Any)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Configure<sp/>proxying<sp/>of<sp/>MQTT<sp/>connection.<sp/>Enables<sp/>support<sp/>for<sp/>SOCKS<sp/>or</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTP<sp/>proxies.</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"></highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Proxying<sp/>is<sp/>done<sp/>through<sp/>the<sp/>PySocks<sp/>library.<sp/>Brief<sp/>descriptions<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>proxy_args<sp/>parameters<sp/>are<sp/>below;<sp/>see<sp/>the<sp/>PySocks<sp/>docs<sp/>for<sp/>more<sp/>info.</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(Required)</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"></highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>proxy_type:<sp/>One<sp/>of<sp/>{socks.HTTP,<sp/>socks.SOCKS4,<sp/>or<sp/>socks.SOCKS5}</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>proxy_addr:<sp/>IP<sp/>address<sp/>or<sp/>DNS<sp/>name<sp/>of<sp/>proxy<sp/>server</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"></highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(Optional)</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"></highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>proxy_port:<sp/>(int)<sp/>port<sp/>number<sp/>of<sp/>the<sp/>proxy<sp/>server.<sp/>If<sp/>not<sp/>provided,</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>PySocks<sp/>package<sp/>default<sp/>value<sp/>will<sp/>be<sp/>utilized,<sp/>which<sp/>differs<sp/>by<sp/>proxy_type.</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>proxy_rdns:<sp/>boolean<sp/>indicating<sp/>whether<sp/>proxy<sp/>lookup<sp/>should<sp/>be<sp/>performed</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remotely<sp/>(True,<sp/>default)<sp/>or<sp/>locally<sp/>(False)</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>proxy_username:<sp/>username<sp/>for<sp/>SOCKS5<sp/>proxy,<sp/>or<sp/>userid<sp/>for<sp/>SOCKS4<sp/>proxy</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>proxy_password:<sp/>password<sp/>for<sp/>SOCKS5<sp/>proxy</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"></highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"></highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mqttc.proxy_set(proxy_type=socks.HTTP,<sp/>proxy_addr=&apos;1.2.3.4&apos;,<sp/>proxy_port=4231)</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>socks<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;PySocks<sp/>must<sp/>be<sp/>installed<sp/>for<sp/>proxy<sp/>support.&quot;)</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>not<sp/>self._proxy_is_valid(proxy_args):</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;proxy_type<sp/>and/or<sp/>proxy_addr<sp/>are<sp/>invalid.&quot;)</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._proxy<sp/>=<sp/>proxy_args</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"></highlight></codeline>
<codeline lineno="1371" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a43300b7f8ec75f4f59d4b152ee937add" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>enable_logger(self,<sp/>logger:<sp/>logging.Logger<sp/>|<sp/>None<sp/>=<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Enables<sp/>a<sp/>logger<sp/>to<sp/>send<sp/>log<sp/>messages<sp/>to</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"></highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>logging.Logger<sp/>logger:<sp/>if<sp/>specified,<sp/>that<sp/>``logging.Logger``<sp/>object<sp/>will<sp/>be<sp/>used,<sp/>otherwise</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>one<sp/>will<sp/>be<sp/>created<sp/>automatically.</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"></highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>See<sp/>`disable_logger`<sp/>to<sp/>undo<sp/>this<sp/>action.</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>logger<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._logger<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Do<sp/>not<sp/>replace<sp/>existing<sp/>logger</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logger<sp/>=<sp/>logging.getLogger(__name__)</highlight></codeline>
<codeline lineno="1385" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa05aad9cf4b7ec1feea866c60399fa1e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.logger<sp/>=<sp/>logger</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"></highlight></codeline>
<codeline lineno="1387" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a1b30959409e4d205cf943337cb366ae8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>disable_logger(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Disable<sp/>logging<sp/>using<sp/>standard<sp/>python<sp/>logging<sp/>package.<sp/>This<sp/>has<sp/>no<sp/>effect<sp/>on<sp/>the<sp/>`on_log`<sp/>callback.</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._logger<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"></highlight></codeline>
<codeline lineno="1393" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a00ec558b3760ccbd5dfc3ac4e1d250f9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>connect(</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host:<sp/>str,</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>port:<sp/>int<sp/>=<sp/>1883,</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keepalive:<sp/>int<sp/>=<sp/>60,</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bind_address:<sp/>str<sp/>=<sp/>&quot;&quot;,</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bind_port:<sp/>int<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_start:<sp/>CleanStartOption<sp/>=<sp/>MQTT_CLEAN_START_FIRST_ONLY,</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Connect<sp/>to<sp/>a<sp/>remote<sp/>broker.<sp/>This<sp/>is<sp/>a<sp/>blocking<sp/>call<sp/>that<sp/>establishes</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>underlying<sp/>connection<sp/>and<sp/>transmits<sp/>a<sp/>CONNECT<sp/>packet.</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>the<sp/>connection<sp/>status<sp/>will<sp/>not<sp/>be<sp/>updated<sp/>until<sp/>a<sp/>CONNACK<sp/>is<sp/>received<sp/>and</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>processed<sp/>(this<sp/>requires<sp/>a<sp/>running<sp/>network<sp/>loop,<sp/>see<sp/>`loop_start`,<sp/>`loop_forever`,<sp/>`loop`...).</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"></highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>host:<sp/>the<sp/>hostname<sp/>or<sp/>IP<sp/>address<sp/>of<sp/>the<sp/>remote<sp/>broker.</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>port:<sp/>the<sp/>network<sp/>port<sp/>of<sp/>the<sp/>server<sp/>host<sp/>to<sp/>connect<sp/>to.<sp/>Defaults<sp/>to</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1883.<sp/>Note<sp/>that<sp/>the<sp/>default<sp/>port<sp/>for<sp/>MQTT<sp/>over<sp/>SSL/TLS<sp/>is<sp/>8883<sp/>so<sp/>if<sp/>you</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>are<sp/>using<sp/>`tls_set()`<sp/>the<sp/>port<sp/>may<sp/>need<sp/>providing.</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>keepalive:<sp/>Maximum<sp/>period<sp/>in<sp/>seconds<sp/>between<sp/>communications<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>broker.<sp/>If<sp/>no<sp/>other<sp/>messages<sp/>are<sp/>being<sp/>exchanged,<sp/>this<sp/>controls<sp/>the</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rate<sp/>at<sp/>which<sp/>the<sp/>client<sp/>will<sp/>send<sp/>ping<sp/>messages<sp/>to<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>bool<sp/>clean_start:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>True,<sp/>False<sp/>or<sp/>MQTT_CLEAN_START_FIRST_ONLY.</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets<sp/>the<sp/>MQTT<sp/>v5.0<sp/>clean_start<sp/>flag<sp/>always,<sp/>never<sp/>or<sp/>on<sp/>the<sp/>first<sp/>successful<sp/>connect<sp/>only,</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>respectively.<sp/><sp/>MQTT<sp/>session<sp/>data<sp/>(such<sp/>as<sp/>outstanding<sp/>messages<sp/>and<sp/>subscriptions)</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>cleared<sp/>on<sp/>successful<sp/>connect<sp/>when<sp/>the<sp/>clean_start<sp/>flag<sp/>is<sp/>set.</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>MQTT<sp/>v3.1.1,<sp/>the<sp/>``clean_session``<sp/>argument<sp/>of<sp/>`Client`<sp/>should<sp/>be<sp/>used<sp/>for<sp/>similar</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>to<sp/>be<sp/>sent<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT<sp/>connect<sp/>packet.</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._mqttv5_first_connect<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>clean_start<sp/>!=<sp/>MQTT_CLEAN_START_FIRST_ONLY:</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Clean<sp/>start<sp/>only<sp/>applies<sp/>to<sp/>MQTT<sp/>V5&quot;)</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties:</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Properties<sp/>only<sp/>apply<sp/>to<sp/>MQTT<sp/>V5&quot;)</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"></highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.connect_async(host,<sp/>port,<sp/>keepalive,</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bind_address,<sp/>bind_port,<sp/>clean_start,<sp/>properties)</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.reconnect()</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"></highlight></codeline>
<codeline lineno="1437" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae3a48dceead925038b861739da507a86" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>connect_srv(</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>domain:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keepalive:<sp/>int<sp/>=<sp/>60,</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bind_address:<sp/>str<sp/>=<sp/>&quot;&quot;,</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bind_port:<sp/>int<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_start:<sp/>CleanStartOption<sp/>=<sp/>MQTT_CLEAN_START_FIRST_ONLY,</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Connect<sp/>to<sp/>a<sp/>remote<sp/>broker.</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"></highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>domain:<sp/>the<sp/>DNS<sp/>domain<sp/>to<sp/>search<sp/>for<sp/>SRV<sp/>records;<sp/>if<sp/>None,</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try<sp/>to<sp/>determine<sp/>local<sp/>domain<sp/>name.</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>keepalive,<sp/>bind_address,<sp/>clean_start<sp/>and<sp/>properties:<sp/>see<sp/>`connect()`</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"></highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>HAVE_DNS<sp/>is<sp/>False:</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;No<sp/>DNS<sp/>resolver<sp/>library<sp/>found,<sp/>try<sp/>&quot;pip<sp/>install<sp/>dnspython&quot;.&apos;)</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"></highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>domain<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>domain<sp/>=<sp/>socket.getfqdn()</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>domain<sp/>=<sp/>domain[domain.find(&apos;.&apos;)<sp/>+<sp/>1:]</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"></highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rr<sp/>=<sp/>f&apos;_mqtt._tcp.{domain}&apos;</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ssl:</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>IANA<sp/>specifies<sp/>secure-mqtt<sp/>(not<sp/>mqtts)<sp/>for<sp/>port<sp/>8883</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rr<sp/>=<sp/>f&apos;_secure-mqtt._tcp.{domain}&apos;</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>answers<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>answer<sp/>in<sp/>dns.resolver.query(rr,<sp/>dns.rdatatype.SRV):</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>addr<sp/>=<sp/>answer.target.to_text()[:-1]</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>answers.append(</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(addr,<sp/>answer.port,<sp/>answer.priority,<sp/>answer.weight))</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>(dns.resolver.NXDOMAIN,<sp/>dns.resolver.NoAnswer,<sp/>dns.resolver.NoNameservers)<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(f&quot;No<sp/>answer/NXDOMAIN<sp/>for<sp/>SRV<sp/>in<sp/>{domain}&quot;)<sp/>from<sp/>err</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"></highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>FIXME:<sp/>doesn&apos;t<sp/>account<sp/>for<sp/>weight</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>answer<sp/>in<sp/>answers:</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host,<sp/>port,<sp/>prio,<sp/>weight<sp/>=<sp/>answer</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"></highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.connect(host,<sp/>port,<sp/>keepalive,<sp/>bind_address,<sp/>bind_port,<sp/>clean_start,<sp/>properties)</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception:<sp/><sp/>#<sp/>noqa:<sp/>S110</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pass</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"></highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;No<sp/>SRV<sp/>hosts<sp/>responded&quot;)</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"></highlight></codeline>
<codeline lineno="1485" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a378b8b9b6c49faea85fd7cf829beecd2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>connect_async(</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host:<sp/>str,</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>port:<sp/>int<sp/>=<sp/>1883,</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keepalive:<sp/>int<sp/>=<sp/>60,</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bind_address:<sp/>str<sp/>=<sp/>&quot;&quot;,</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bind_port:<sp/>int<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_start:<sp/>CleanStartOption<sp/>=<sp/>MQTT_CLEAN_START_FIRST_ONLY,</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Connect<sp/>to<sp/>a<sp/>remote<sp/>broker<sp/>asynchronously.<sp/>This<sp/>is<sp/>a<sp/>non-blocking</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect<sp/>call<sp/>that<sp/>can<sp/>be<sp/>used<sp/>with<sp/>`loop_start()`<sp/>to<sp/>provide<sp/>very<sp/>quick</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>start.</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"></highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Any<sp/>already<sp/>established<sp/>connection<sp/>will<sp/>be<sp/>terminated<sp/>immediately.</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"></highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>host:<sp/>the<sp/>hostname<sp/>or<sp/>IP<sp/>address<sp/>of<sp/>the<sp/>remote<sp/>broker.</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>port:<sp/>the<sp/>network<sp/>port<sp/>of<sp/>the<sp/>server<sp/>host<sp/>to<sp/>connect<sp/>to.<sp/>Defaults<sp/>to</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1883.<sp/>Note<sp/>that<sp/>the<sp/>default<sp/>port<sp/>for<sp/>MQTT<sp/>over<sp/>SSL/TLS<sp/>is<sp/>8883<sp/>so<sp/>if<sp/>you</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>are<sp/>using<sp/>`tls_set()`<sp/>the<sp/>port<sp/>may<sp/>need<sp/>providing.</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>keepalive:<sp/>Maximum<sp/>period<sp/>in<sp/>seconds<sp/>between<sp/>communications<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>broker.<sp/>If<sp/>no<sp/>other<sp/>messages<sp/>are<sp/>being<sp/>exchanged,<sp/>this<sp/>controls<sp/>the</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rate<sp/>at<sp/>which<sp/>the<sp/>client<sp/>will<sp/>send<sp/>ping<sp/>messages<sp/>to<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>bool<sp/>clean_start:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>True,<sp/>False<sp/>or<sp/>MQTT_CLEAN_START_FIRST_ONLY.</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets<sp/>the<sp/>MQTT<sp/>v5.0<sp/>clean_start<sp/>flag<sp/>always,<sp/>never<sp/>or<sp/>on<sp/>the<sp/>first<sp/>successful<sp/>connect<sp/>only,</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>respectively.<sp/><sp/>MQTT<sp/>session<sp/>data<sp/>(such<sp/>as<sp/>outstanding<sp/>messages<sp/>and<sp/>subscriptions)</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>cleared<sp/>on<sp/>successful<sp/>connect<sp/>when<sp/>the<sp/>clean_start<sp/>flag<sp/>is<sp/>set.</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>MQTT<sp/>v3.1.1,<sp/>the<sp/>``clean_session``<sp/>argument<sp/>of<sp/>`Client`<sp/>should<sp/>be<sp/>used<sp/>for<sp/>similar</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>to<sp/>be<sp/>sent<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT<sp/>connect<sp/>packet.</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>bind_port<sp/>&lt;<sp/>0:</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>bind<sp/>port<sp/>number.&apos;)</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"></highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Switch<sp/>to<sp/>state<sp/>NEW<sp/>to<sp/>allow<sp/>update<sp/>of<sp/>host,<sp/>port<sp/>&amp;<sp/>co.</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_NEW</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"></highlight></codeline>
<codeline lineno="1524" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a43100041f9f9a5e385c231a52172f324" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.host<sp/>=<sp/>host</highlight></codeline>
<codeline lineno="1525" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a83995141bcfaaadb19c9ca75fa9afba0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.port<sp/>=<sp/>port</highlight></codeline>
<codeline lineno="1526" refid="classpaho_1_1mqtt_1_1client_1_1_client_1acd7e95eb9955f6ff9ba41801d886f7a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.keepalive<sp/>=<sp/>keepalive</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._bind_address<sp/>=<sp/>bind_address</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._bind_port<sp/>=<sp/>bind_port</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._clean_start<sp/>=<sp/>clean_start</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._connect_properties<sp/>=<sp/>properties</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_CONNECT_ASYNC</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"></highlight></codeline>
<codeline lineno="1533" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a74567acaade9cf91c1fab880a8650733" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>reconnect_delay_set(self,<sp/>min_delay:<sp/>int<sp/>=<sp/>1,<sp/>max_delay:<sp/>int<sp/>=<sp/>120)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;<sp/>Configure<sp/>the<sp/>exponential<sp/>reconnect<sp/>delay</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"></highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>When<sp/>connection<sp/>is<sp/>lost,<sp/>wait<sp/>initially<sp/>min_delay<sp/>seconds<sp/>and</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>double<sp/>this<sp/>time<sp/>every<sp/>attempt.<sp/>The<sp/>wait<sp/>is<sp/>capped<sp/>at<sp/>max_delay.</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Once<sp/>the<sp/>client<sp/>is<sp/>fully<sp/>connected<sp/>(e.g.<sp/>not<sp/>only<sp/>TCP<sp/>socket,<sp/>but</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>received<sp/>a<sp/>success<sp/>CONNACK),<sp/>the<sp/>wait<sp/>timer<sp/>is<sp/>reset<sp/>to<sp/>min_delay.</highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._reconnect_delay_mutex:</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_min_delay<sp/>=<sp/>min_delay</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_max_delay<sp/>=<sp/>max_delay</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_delay<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"></highlight></codeline>
<codeline lineno="1546" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aaa6237ca2ebefb82fda5bc007cabd78b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>reconnect(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Reconnect<sp/>the<sp/>client<sp/>after<sp/>a<sp/>disconnect.<sp/>Can<sp/>only<sp/>be<sp/>called<sp/>after</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect()/connect_async().&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(self._host)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>host.&apos;)</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._port<sp/>&lt;=<sp/>0:</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>port<sp/>number.&apos;)</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"></highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;command&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;have_remaining&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_count&quot;:<sp/>[],</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_mult&quot;:<sp/>1,</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_length&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;packet&quot;:<sp/>bytearray(b&quot;&quot;),</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;to_process&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;pos&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"></highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ping_t<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_CONNECTING</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"></highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Mark<sp/>all<sp/>currently<sp/>outgoing<sp/>QoS<sp/>=<sp/>0<sp/>packets<sp/>as<sp/>lost,</highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>or<sp/>`wait_for_publish()`<sp/>could<sp/>hang<sp/>forever</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>pkt<sp/>in<sp/>self._out_packet:</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>pkt[&quot;command&quot;]<sp/>&amp;<sp/>0xF0<sp/>==<sp/>PUBLISH<sp/>and<sp/>pkt[&quot;qos&quot;]<sp/>==<sp/>0<sp/>and<sp/>pkt[&quot;info&quot;]<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt[&quot;info&quot;].rc<sp/>=<sp/>MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt[&quot;info&quot;]._set_as_published()</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"></highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_packet.clear()</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"></highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._msgtime_mutex:</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_in<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_out<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"></highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Put<sp/>messages<sp/>in<sp/>progress<sp/>in<sp/>a<sp/>valid<sp/>state.</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._messages_reconnect_reset()</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"></highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_pre_connect<sp/>=<sp/>self.on_pre_connect</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"></highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_pre_connect:</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_pre_connect(self,<sp/>self._userdata)</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_pre_connect:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"></highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock<sp/>=<sp/>self._create_socket()</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"></highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock.setblocking(False)<sp/><sp/>#<sp/>type:<sp/>ignore[attr-defined]</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._registered_write<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_open(self._sock)</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"></highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_connect(self._keepalive)</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"></highlight></codeline>
<codeline lineno="1606" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af6ec6e878ff304f8d019d9da4f550f21" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>loop(self,<sp/>timeout:<sp/>float<sp/>=<sp/>1.0)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Process<sp/>network<sp/>events.</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>It<sp/>is<sp/>strongly<sp/>recommended<sp/>that<sp/>you<sp/>use<sp/>`loop_start()`,<sp/>or</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`loop_forever()`,<sp/>or<sp/>if<sp/>you<sp/>are<sp/>using<sp/>an<sp/>external<sp/>event<sp/>loop<sp/>using</highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`loop_read()`,<sp/>`loop_write()`,<sp/>and<sp/>`loop_misc()`.<sp/>Using<sp/>loop()<sp/>on<sp/>it&apos;s<sp/>own<sp/>is</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>no<sp/>longer<sp/>recommended.</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"></highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>must<sp/>be<sp/>called<sp/>regularly<sp/>to<sp/>ensure<sp/>communication<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>broker<sp/>is<sp/>carried<sp/>out.<sp/>It<sp/>calls<sp/>select()<sp/>on<sp/>the<sp/>network<sp/>socket<sp/>to<sp/>wait</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>network<sp/>events.<sp/>If<sp/>incoming<sp/>data<sp/>is<sp/>present<sp/>it<sp/>will<sp/>then<sp/>be</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>processed.<sp/>Outgoing<sp/>commands,<sp/>from<sp/>e.g.<sp/>`publish()`,<sp/>are<sp/>normally<sp/>sent</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>immediately<sp/>that<sp/>their<sp/>function<sp/>is<sp/>called,<sp/>but<sp/>this<sp/>is<sp/>not<sp/>always</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>possible.<sp/>loop()<sp/>will<sp/>also<sp/>attempt<sp/>to<sp/>send<sp/>any<sp/>remaining<sp/>outgoing</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>messages,<sp/>which<sp/>also<sp/>includes<sp/>commands<sp/>that<sp/>are<sp/>part<sp/>of<sp/>the<sp/>flow<sp/>for</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>messages<sp/>with<sp/>QoS&gt;0.</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"></highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>timeout:<sp/>The<sp/>time<sp/>in<sp/>seconds<sp/>to<sp/>wait<sp/>for<sp/>incoming/outgoing<sp/>network</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>traffic<sp/>before<sp/>timing<sp/>out<sp/>and<sp/>returning.</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"></highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>MQTT_ERR_SUCCESS<sp/>on<sp/>success.</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>&gt;0<sp/>on<sp/>error.</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"></highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>ValueError<sp/>will<sp/>be<sp/>raised<sp/>if<sp/>timeout<sp/>&lt;<sp/>0&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"></highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sockpairR<sp/>is<sp/>None<sp/>or<sp/>self._sockpairW<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reset_sockets(sockpair_only=True)</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairR,<sp/>self._sockpairW<sp/>=<sp/>_socketpair_compat()</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"></highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._loop(timeout)</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"></highlight></codeline>
<codeline lineno="1637" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0636451b4c26174ed77fa1bb3f201c20" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_loop(self,<sp/>timeout:<sp/>float<sp/>=<sp/>1.0)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>timeout<sp/>&lt;<sp/>0.0:</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>timeout.&apos;)</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"></highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self.want_write():</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wlist<sp/>=<sp/>[self._sock]</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wlist<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"></highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>used<sp/>to<sp/>check<sp/>if<sp/>there<sp/>are<sp/>any<sp/>bytes<sp/>left<sp/>in<sp/>the<sp/>(SSL)<sp/>socket</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pending_bytes<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>hasattr(self._sock,<sp/>&apos;pending&apos;):</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pending_bytes<sp/>=<sp/>self._sock.pending()<sp/><sp/>#<sp/>type:<sp/>ignore[union-attr]</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"></highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>if<sp/>bytes<sp/>are<sp/>pending<sp/>do<sp/>not<sp/>wait<sp/>in<sp/>select</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>pending_bytes<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"></highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>sockpairR<sp/>is<sp/>used<sp/>to<sp/>break<sp/>out<sp/>of<sp/>select()<sp/>before<sp/>the<sp/>timeout,<sp/>on<sp/>a</highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>call<sp/>to<sp/>publish()<sp/>etc.</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sockpairR<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rlist<sp/>=<sp/>[self._sock]</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rlist<sp/>=<sp/>[self._sock,<sp/>self._sockpairR]</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"></highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socklist<sp/>=<sp/>select.select(rlist,<sp/>wlist,<sp/>[],<sp/>timeout)</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>TypeError:</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Socket<sp/>isn&apos;t<sp/>correct<sp/>type,<sp/>in<sp/>likelihood<sp/>connection<sp/>is<sp/>lost</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>...<sp/>or<sp/>we<sp/>called<sp/>disconnect().<sp/>In<sp/>that<sp/>case<sp/>the<sp/>socket<sp/>will</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>be<sp/>closed<sp/>but<sp/>some<sp/>loop<sp/>(like<sp/>loop_forever)<sp/>will<sp/>continue<sp/>to</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>call<sp/>_loop().<sp/>We<sp/>still<sp/>want<sp/>to<sp/>break<sp/>that<sp/>loop<sp/>by<sp/>returning<sp/>an</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>rc<sp/>!=<sp/>MQTT_ERR_SUCCESS<sp/>and<sp/>we<sp/>don&apos;t<sp/>want<sp/>state<sp/>to<sp/>change<sp/>from</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>mqtt_cs_disconnecting.</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>not<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED):</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_CONNECTION_LOST</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ValueError:</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Can<sp/>occur<sp/>if<sp/>we<sp/>just<sp/>reconnected<sp/>but<sp/>rlist/wlist<sp/>contain<sp/>a<sp/>-1<sp/>for</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>some<sp/>reason.</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>not<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED):</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_CONNECTION_LOST</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception:</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Note<sp/>that<sp/>KeyboardInterrupt,<sp/>etc.<sp/>can<sp/>still<sp/>terminate<sp/>since<sp/>they</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>are<sp/>not<sp/>derived<sp/>from<sp/>Exception</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_UNKNOWN</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"></highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>in<sp/>socklist[0]<sp/>or<sp/>pending_bytes<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self.loop_read()</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>or<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"></highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sockpairR<sp/>and<sp/>self._sockpairR<sp/>in<sp/>socklist[0]:</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Stimulate<sp/>output<sp/>write<sp/>even<sp/>though<sp/>we<sp/>didn&apos;t<sp/>ask<sp/>for<sp/>it,<sp/>because</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>at<sp/>that<sp/>point<sp/>the<sp/>publish<sp/>or<sp/>other<sp/>command<sp/>wasn&apos;t<sp/>present.</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socklist[1].insert(0,<sp/>self._sock)</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Clear<sp/>sockpairR<sp/>-<sp/>only<sp/>ever<sp/>a<sp/>single<sp/>byte<sp/>written.</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Read<sp/>many<sp/>bytes<sp/>at<sp/>once<sp/>-<sp/>this<sp/>allows<sp/>up<sp/>to<sp/>10000<sp/>calls<sp/>to</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>publish()<sp/>inbetween<sp/>calls<sp/>to<sp/>loop().</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairR.recv(10000)</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>BlockingIOError:</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pass</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"></highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>in<sp/>socklist[1]:</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self.loop_write()</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>or<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"></highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.loop_misc()</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"></highlight></codeline>
<codeline lineno="1709" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aabf69c1755fbd0e5a1e8eb0ec2881e2c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>publish(</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic:<sp/>str,</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload:<sp/>PayloadType<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qos:<sp/>int<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retain:<sp/>bool<sp/>=<sp/>False,</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTMessageInfo:</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Publish<sp/>a<sp/>message<sp/>on<sp/>a<sp/>topic.</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"></highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>causes<sp/>a<sp/>message<sp/>to<sp/>be<sp/>sent<sp/>to<sp/>the<sp/>broker<sp/>and<sp/>subsequently<sp/>from</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>broker<sp/>to<sp/>any<sp/>clients<sp/>subscribing<sp/>to<sp/>matching<sp/>topics.</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"></highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>topic:<sp/>The<sp/>topic<sp/>that<sp/>the<sp/>message<sp/>should<sp/>be<sp/>published<sp/>on.</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>payload:<sp/>The<sp/>actual<sp/>message<sp/>to<sp/>send.<sp/>If<sp/>not<sp/>given,<sp/>or<sp/>set<sp/>to<sp/>None<sp/>a</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zero<sp/>length<sp/>message<sp/>will<sp/>be<sp/>used.<sp/>Passing<sp/>an<sp/>int<sp/>or<sp/>float<sp/>will<sp/>result</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in<sp/>the<sp/>payload<sp/>being<sp/>converted<sp/>to<sp/>a<sp/>string<sp/>representing<sp/>that<sp/>number.<sp/>If</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>you<sp/>wish<sp/>to<sp/>send<sp/>a<sp/>true<sp/>int/float,<sp/>use<sp/>struct.pack()<sp/>to<sp/>create<sp/>the</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload<sp/>you<sp/>require.</highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>qos:<sp/>The<sp/>quality<sp/>of<sp/>service<sp/>level<sp/>to<sp/>use.</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>bool<sp/>retain:<sp/>If<sp/>set<sp/>to<sp/>true,<sp/>the<sp/>message<sp/>will<sp/>be<sp/>set<sp/>as<sp/>the<sp/>&quot;last<sp/>known</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>good&quot;/retained<sp/>message<sp/>for<sp/>the<sp/>topic.</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>to<sp/>be<sp/>included.</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"></highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>a<sp/>`MQTTMessageInfo`<sp/>class,<sp/>which<sp/>can<sp/>be<sp/>used<sp/>to<sp/>determine<sp/>whether</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>message<sp/>has<sp/>been<sp/>delivered<sp/>(using<sp/>`is_published()`)<sp/>or<sp/>to<sp/>block</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>waiting<sp/>for<sp/>the<sp/>message<sp/>to<sp/>be<sp/>delivered<sp/>(`wait_for_publish()`).<sp/>The</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>ID<sp/>and<sp/>return<sp/>code<sp/>of<sp/>the<sp/>publish()<sp/>call<sp/>can<sp/>be<sp/>found<sp/>at</highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:py:attr:`info.mid<sp/>&lt;MQTTMessage.mid&gt;`<sp/>and<sp/>:py:attr:`info.rc<sp/>&lt;MQTTMessage.rc&gt;`.</highlight></codeline>
<codeline lineno="1738"><highlight class="normal"></highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>backwards<sp/>compatibility,<sp/>the<sp/>`MQTTMessageInfo`<sp/>class<sp/>is<sp/>iterable<sp/>so</highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>old<sp/>construct<sp/>of<sp/>``(rc,<sp/>mid)<sp/>=<sp/>client.publish(...)``<sp/>is<sp/>still<sp/>valid.</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"></highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>is<sp/>MQTT_ERR_SUCCESS<sp/>to<sp/>indicate<sp/>success<sp/>or<sp/>MQTT_ERR_NO_CONN<sp/>if<sp/>the</highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client<sp/>is<sp/>not<sp/>currently<sp/>connected.<sp/><sp/>mid<sp/>is<sp/>the<sp/>message<sp/>ID<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>publish<sp/>request.<sp/>The<sp/>mid<sp/>value<sp/>can<sp/>be<sp/>used<sp/>to<sp/>track<sp/>the<sp/>publish<sp/>request</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>by<sp/>checking<sp/>against<sp/>the<sp/>mid<sp/>argument<sp/>in<sp/>the<sp/>on_publish()<sp/>callback<sp/>if<sp/>it</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>defined.</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"></highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>ValueError:<sp/>if<sp/>topic<sp/>is<sp/>None,<sp/>has<sp/>zero<sp/>length<sp/>or<sp/>is</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalid<sp/>(contains<sp/>a<sp/>wildcard),<sp/>except<sp/>if<sp/>the<sp/>MQTT<sp/>version<sp/>used<sp/>is<sp/>v5.0.</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>v5.0,<sp/>a<sp/>zero<sp/>length<sp/>topic<sp/>can<sp/>be<sp/>used<sp/>when<sp/>a<sp/>Topic<sp/>Alias<sp/>has<sp/>been<sp/>set.</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>ValueError:<sp/>if<sp/>qos<sp/>is<sp/>not<sp/>one<sp/>of<sp/>0,<sp/>1<sp/>or<sp/>2</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>ValueError:<sp/>if<sp/>the<sp/>length<sp/>of<sp/>the<sp/>payload<sp/>is<sp/>greater<sp/>than<sp/>268435455<sp/>bytes.</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>!=<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>topic<sp/>is<sp/>None<sp/>or<sp/>len(topic)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>topic.&apos;)</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"></highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_bytes<sp/>=<sp/>topic.encode(&apos;utf-8&apos;)</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"></highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._raise_for_invalid_topic(topic_bytes)</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"></highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>&lt;<sp/>0<sp/>or<sp/>qos<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>QoS<sp/>level.&apos;)</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"></highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_payload<sp/>=<sp/>_encode_payload(payload)</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"></highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(local_payload)<sp/>&gt;<sp/>268435455:</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Payload<sp/>too<sp/>large.&apos;)</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"></highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_mid<sp/>=<sp/>self._mid_generate()</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"></highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info<sp/>=<sp/>MQTTMessageInfo(local_mid)</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_publish(</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_mid,<sp/>topic_bytes,<sp/>local_payload,<sp/>qos,<sp/>retain,<sp/>False,<sp/>info,<sp/>properties)</highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info.rc<sp/>=<sp/>rc</highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>info</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/>MQTTMessage(local_mid,<sp/>topic_bytes)</highlight></codeline>
<codeline lineno="1780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.timestamp<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.payload<sp/>=<sp/>local_payload</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.qos<sp/>=<sp/>qos</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.retain<sp/>=<sp/>retain</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.dup<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.properties<sp/>=<sp/>properties</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"></highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._out_message_mutex:</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._max_queued_messages<sp/>&gt;<sp/>0<sp/>and<sp/>len(self._out_messages)<sp/>&gt;=<sp/>self._max_queued_messages:</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.info.rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_QUEUE_SIZE</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>message.info</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"></highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>local_mid<sp/>in<sp/>self._out_messages:</highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.info.rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_QUEUE_SIZE</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>message.info</highlight></codeline>
<codeline lineno="1795"><highlight class="normal"></highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_messages[message.mid]<sp/>=<sp/>message</highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._max_inflight_messages<sp/>==<sp/>0<sp/>or<sp/>self._inflight_messages<sp/>&lt;<sp/>self._max_inflight_messages:</highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.state<sp/>=<sp/>mqtt_ms_wait_for_puback</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>qos<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.state<sp/>=<sp/>mqtt_ms_wait_for_pubrec</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"></highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_publish(message.mid,<sp/>topic_bytes,<sp/>message.payload,<sp/>message.qos,<sp/>message.retain,</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.dup,<sp/>message.info,<sp/>message.properties)</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"></highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>remove<sp/>from<sp/>inflight<sp/>messages<sp/>so<sp/>it<sp/>will<sp/>be<sp/>send<sp/>after<sp/>a<sp/>connection<sp/>is<sp/>made</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_NO_CONN:</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.state<sp/>=<sp/>mqtt_ms_publish</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"></highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.info.rc<sp/>=<sp/>rc</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>message.info</highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.state<sp/>=<sp/>mqtt_ms_queued</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.info.rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>message.info</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"></highlight></codeline>
<codeline lineno="1819" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a70e8f70fb09f0459ad3a24d854a70b71" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>username_pw_set(</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>username:<sp/>str<sp/>|<sp/>None,<sp/>password:<sp/>str<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Set<sp/>a<sp/>username<sp/>and<sp/>optionally<sp/>a<sp/>password<sp/>for<sp/>broker<sp/>authentication.</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"></highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Must<sp/>be<sp/>called<sp/>before<sp/>connect()<sp/>to<sp/>have<sp/>any<sp/>effect.</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Requires<sp/>a<sp/>broker<sp/>that<sp/>supports<sp/>MQTT<sp/>v3.1<sp/>or<sp/>more.</highlight></codeline>
<codeline lineno="1826"><highlight class="normal"></highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>username:<sp/>The<sp/>username<sp/>to<sp/>authenticate<sp/>with.<sp/>Need<sp/>have<sp/>no<sp/>relationship<sp/>to<sp/>the<sp/>client<sp/>id.<sp/>Must<sp/>be<sp/>str</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[MQTT-3.1.3-11].</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>to<sp/>None<sp/>to<sp/>reset<sp/>client<sp/>back<sp/>to<sp/>not<sp/>using<sp/>username/password<sp/>for<sp/>broker<sp/>authentication.</highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>password:<sp/>The<sp/>password<sp/>to<sp/>authenticate<sp/>with.<sp/>Optional,<sp/>set<sp/>to<sp/>None<sp/>if<sp/>not<sp/>required.<sp/>If<sp/>it<sp/>is<sp/>str,<sp/>then<sp/>it</highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>be<sp/>encoded<sp/>as<sp/>UTF-8.</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"></highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>[MQTT-3.1.3-11]<sp/>User<sp/>name<sp/>must<sp/>be<sp/>UTF-8<sp/>encoded<sp/>string</highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._username<sp/>=<sp/>None<sp/>if<sp/>username<sp/>is<sp/>None<sp/>else<sp/>username.encode(&apos;utf-8&apos;)</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(password,<sp/>str):</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._password<sp/>=<sp/>password.encode(&apos;utf-8&apos;)</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._password<sp/>=<sp/>password</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"></highlight></codeline>
<codeline lineno="1841" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4a22d26b63dec6f8efdade520c138ac3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>enable_bridge_mode(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Sets<sp/>the<sp/>client<sp/>in<sp/>a<sp/>bridge<sp/>mode<sp/>instead<sp/>of<sp/>client<sp/>mode.</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"></highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Must<sp/>be<sp/>called<sp/>before<sp/>`connect()`<sp/>to<sp/>have<sp/>any<sp/>effect.</highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Requires<sp/>brokers<sp/>that<sp/>support<sp/>bridge<sp/>mode.</highlight></codeline>
<codeline lineno="1846"><highlight class="normal"></highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Under<sp/>bridge<sp/>mode,<sp/>the<sp/>broker<sp/>will<sp/>identify<sp/>the<sp/>client<sp/>as<sp/>a<sp/>bridge<sp/>and</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>send<sp/>it&apos;s<sp/>own<sp/>messages<sp/>back<sp/>to<sp/>it.<sp/>Hence<sp/>a<sp/>subsciption<sp/>of<sp/>#<sp/>is</highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>possible<sp/>without<sp/>message<sp/>loops.<sp/>This<sp/>feature<sp/>also<sp/>correctly<sp/>propagates</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>retain<sp/>flag<sp/>on<sp/>the<sp/>messages.</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"></highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Currently<sp/>Mosquitto<sp/>and<sp/>RSMB<sp/>support<sp/>this<sp/>feature.<sp/>This<sp/>feature<sp/>can</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>used<sp/>to<sp/>create<sp/>a<sp/>bridge<sp/>between<sp/>multiple<sp/>broker.</highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_mode<sp/>=<sp/>MQTT_BRIDGE</highlight></codeline>
<codeline lineno="1856"><highlight class="normal"></highlight></codeline>
<codeline lineno="1857" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a26b41408b4e559a2c8a1c349030fcc9c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_connection_closed(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>true<sp/>if<sp/>the<sp/>connection<sp/>is<sp/>closed<sp/>(and<sp/>not<sp/>trying<sp/>to<sp/>be<sp/>opened).</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>==<sp/>_ConnectionState.MQTT_CS_NEW</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>(self._state<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED)<sp/>and<sp/>self._sock<sp/>is<sp/>None))</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"></highlight></codeline>
<codeline lineno="1865" refid="classpaho_1_1mqtt_1_1client_1_1_client_1abf6583580aa1c75fcb0dc04899b9de3a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>is_connected(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Returns<sp/>the<sp/>current<sp/>status<sp/>of<sp/>the<sp/>connection</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"></highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>True<sp/>if<sp/>connection<sp/>exists</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>False<sp/>if<sp/>connection<sp/>is<sp/>closed</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._state<sp/>==<sp/>_ConnectionState.MQTT_CS_CONNECTED</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"></highlight></codeline>
<codeline lineno="1873" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a14defcfe335e623ab11f8d2ad60c473c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>disconnect(</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncode:<sp/>ReasonCode<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Disconnect<sp/>a<sp/>connected<sp/>client<sp/>from<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"></highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>ReasonCode<sp/>reasoncode:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>a<sp/>ReasonCode<sp/>instance<sp/>setting<sp/>the<sp/>MQTT<sp/>v5.0</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncode<sp/>to<sp/>be<sp/>sent<sp/>with<sp/>the<sp/>disconnect<sp/>packet.<sp/>It<sp/>is<sp/>optional,<sp/>the<sp/>receiver</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>then<sp/>assuming<sp/>that<sp/>0<sp/>(success)<sp/>is<sp/>the<sp/>value.</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>a<sp/>Properties<sp/>instance<sp/>setting<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>be<sp/>included.<sp/>Optional<sp/>-<sp/>if<sp/>not<sp/>set,<sp/>no<sp/>properties<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_DISCONNECTED</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTT_ERR_NO_CONN</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_DISCONNECTING</highlight></codeline>
<codeline lineno="1891"><highlight class="normal"></highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_disconnect(reasoncode,<sp/>properties)</highlight></codeline>
<codeline lineno="1893"><highlight class="normal"></highlight></codeline>
<codeline lineno="1894" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8ab1656dba162c1caf11548a853714ee" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>subscribe(</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic:<sp/>str<sp/>|<sp/>tuple[str,<sp/>int]<sp/>|<sp/>tuple[str,<sp/>SubscribeOptions]<sp/>|<sp/>list[tuple[str,<sp/>int]]<sp/>|<sp/>list[tuple[str,<sp/>SubscribeOptions]],</highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qos:<sp/>int<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options:<sp/>SubscribeOptions<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>tuple[MQTTErrorCode,<sp/>int<sp/>|<sp/>None]:</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Subscribe<sp/>the<sp/>client<sp/>to<sp/>one<sp/>or<sp/>more<sp/>topics.</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"></highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>may<sp/>be<sp/>called<sp/>in<sp/>three<sp/>different<sp/>ways<sp/>(and<sp/>a<sp/>further<sp/>three<sp/>for<sp/>MQTT<sp/>v5.0):</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"></highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Simple<sp/>string<sp/>and<sp/>integer</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-------------------------</highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e.g.<sp/>subscribe(&quot;my/topic&quot;,<sp/>2)</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"></highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:topic:<sp/>A<sp/>string<sp/>specifying<sp/>the<sp/>subscription<sp/>topic<sp/>to<sp/>subscribe<sp/>to.</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:qos:<sp/>The<sp/>desired<sp/>quality<sp/>of<sp/>service<sp/>level<sp/>for<sp/>the<sp/>subscription.</highlight></codeline>
<codeline lineno="1911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>0.</highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:options<sp/>and<sp/>properties:<sp/>Not<sp/>used.</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"></highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Simple<sp/>string<sp/>and<sp/>subscribe<sp/>options<sp/>(MQTT<sp/>v5.0<sp/>only)</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>----------------------------------------------------</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e.g.<sp/>subscribe(&quot;my/topic&quot;,<sp/>options=SubscribeOptions(qos=2))</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"></highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:topic:<sp/>A<sp/>string<sp/>specifying<sp/>the<sp/>subscription<sp/>topic<sp/>to<sp/>subscribe<sp/>to.</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:qos:<sp/>Not<sp/>used.</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:options:<sp/>The<sp/>MQTT<sp/>v5.0<sp/>subscribe<sp/>options.</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:properties:<sp/>a<sp/>Properties<sp/>instance<sp/>setting<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>be<sp/>included.<sp/>Optional<sp/>-<sp/>if<sp/>not<sp/>set,<sp/>no<sp/>properties<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"></highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>and<sp/>integer<sp/>tuple</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e.g.<sp/>subscribe((&quot;my/topic&quot;,<sp/>1))</highlight></codeline>
<codeline lineno="1927"><highlight class="normal"></highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:topic:<sp/>A<sp/>tuple<sp/>of<sp/>(topic,<sp/>qos).<sp/>Both<sp/>topic<sp/>and<sp/>qos<sp/>must<sp/>be<sp/>present<sp/>in</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>tuple.</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:qos<sp/>and<sp/>options:<sp/>Not<sp/>used.</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:properties:<sp/>Only<sp/>used<sp/>for<sp/>MQTT<sp/>v5.0.<sp/><sp/>A<sp/>Properties<sp/>instance<sp/>setting<sp/>the</highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT<sp/>v5.0<sp/>properties.<sp/>Optional<sp/>-<sp/>if<sp/>not<sp/>set,<sp/>no<sp/>properties<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"></highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>and<sp/>subscribe<sp/>options<sp/>tuple<sp/>(MQTT<sp/>v5.0<sp/>only)</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>---------------------------------------------------</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e.g.<sp/>subscribe((&quot;my/topic&quot;,<sp/>SubscribeOptions(qos=1)))</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"></highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:topic:<sp/>A<sp/>tuple<sp/>of<sp/>(topic,<sp/>SubscribeOptions).<sp/>Both<sp/>topic<sp/>and<sp/>subscribe</highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options<sp/>must<sp/>be<sp/>present<sp/>in<sp/>the<sp/>tuple.</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:qos<sp/>and<sp/>options:<sp/>Not<sp/>used.</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:properties:<sp/>a<sp/>Properties<sp/>instance<sp/>setting<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>be<sp/>included.<sp/>Optional<sp/>-<sp/>if<sp/>not<sp/>set,<sp/>no<sp/>properties<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"></highlight></codeline>
<codeline lineno="1944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List<sp/>of<sp/>string<sp/>and<sp/>integer<sp/>tuples</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>---------------------------------</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e.g.<sp/>subscribe([(&quot;my/topic&quot;,<sp/>0),<sp/>(&quot;another/topic&quot;,<sp/>2)])</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"></highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>allows<sp/>multiple<sp/>topic<sp/>subscriptions<sp/>in<sp/>a<sp/>single<sp/>SUBSCRIPTION</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command,<sp/>which<sp/>is<sp/>more<sp/>efficient<sp/>than<sp/>using<sp/>multiple<sp/>calls<sp/>to</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscribe().</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"></highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:topic:<sp/>A<sp/>list<sp/>of<sp/>tuple<sp/>of<sp/>format<sp/>(topic,<sp/>qos).<sp/>Both<sp/>topic<sp/>and<sp/>qos<sp/>must</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>present<sp/>in<sp/>all<sp/>of<sp/>the<sp/>tuples.</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:qos,<sp/>options<sp/>and<sp/>properties:<sp/>Not<sp/>used.</highlight></codeline>
<codeline lineno="1955"><highlight class="normal"></highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List<sp/>of<sp/>string<sp/>and<sp/>subscribe<sp/>option<sp/>tuples<sp/>(MQTT<sp/>v5.0<sp/>only)</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-----------------------------------------------------------</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e.g.<sp/>subscribe([(&quot;my/topic&quot;,<sp/>SubscribeOptions(qos=0),<sp/>(&quot;another/topic&quot;,<sp/>SubscribeOptions(qos=2)])</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"></highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>allows<sp/>multiple<sp/>topic<sp/>subscriptions<sp/>in<sp/>a<sp/>single<sp/>SUBSCRIPTION</highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command,<sp/>which<sp/>is<sp/>more<sp/>efficient<sp/>than<sp/>using<sp/>multiple<sp/>calls<sp/>to</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscribe().</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"></highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:topic:<sp/>A<sp/>list<sp/>of<sp/>tuple<sp/>of<sp/>format<sp/>(topic,<sp/>SubscribeOptions).<sp/>Both<sp/>topic<sp/>and<sp/>subscribe</highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options<sp/>must<sp/>be<sp/>present<sp/>in<sp/>all<sp/>of<sp/>the<sp/>tuples.</highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:qos<sp/>and<sp/>options:<sp/>Not<sp/>used.</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:properties:<sp/>a<sp/>Properties<sp/>instance<sp/>setting<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties</highlight></codeline>
<codeline lineno="1968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>be<sp/>included.<sp/>Optional<sp/>-<sp/>if<sp/>not<sp/>set,<sp/>no<sp/>properties<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="1969"><highlight class="normal"></highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>function<sp/>returns<sp/>a<sp/>tuple<sp/>(result,<sp/>mid),<sp/>where<sp/>result<sp/>is</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_ERR_SUCCESS<sp/>to<sp/>indicate<sp/>success<sp/>or<sp/>(MQTT_ERR_NO_CONN,<sp/>None)<sp/>if<sp/>the</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client<sp/>is<sp/>not<sp/>currently<sp/>connected.<sp/><sp/>mid<sp/>is<sp/>the<sp/>message<sp/>ID<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscribe<sp/>request.<sp/>The<sp/>mid<sp/>value<sp/>can<sp/>be<sp/>used<sp/>to<sp/>track<sp/>the<sp/>subscribe</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request<sp/>by<sp/>checking<sp/>against<sp/>the<sp/>mid<sp/>argument<sp/>in<sp/>the<sp/>on_subscribe()</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callback<sp/>if<sp/>it<sp/>is<sp/>defined.</highlight></codeline>
<codeline lineno="1976"><highlight class="normal"></highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Raises<sp/>a<sp/>ValueError<sp/>if<sp/>qos<sp/>is<sp/>not<sp/>0,<sp/>1<sp/>or<sp/>2,<sp/>or<sp/>if<sp/>topic<sp/>is<sp/>None<sp/>or<sp/>has</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zero<sp/>string<sp/>length,<sp/>or<sp/>if<sp/>topic<sp/>is<sp/>not<sp/>a<sp/>string,<sp/>tuple<sp/>or<sp/>list.</highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_qos_list<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"></highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(topic,<sp/>tuple):</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic,<sp/>options<sp/>=<sp/>topic<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>isinstance(options,<sp/>SubscribeOptions):</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;Subscribe<sp/>options<sp/>must<sp/>be<sp/>instance<sp/>of<sp/>SubscribeOptions<sp/>class.&apos;)</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic,<sp/>qos<sp/>=<sp/>topic<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"></highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(topic,<sp/>(bytes,<sp/>str)):</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>&lt;<sp/>0<sp/>or<sp/>qos<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>QoS<sp/>level.&apos;)</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>options<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>if<sp/>no<sp/>options<sp/>are<sp/>provided,<sp/>use<sp/>the<sp/>QoS<sp/>passed<sp/>instead</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options<sp/>=<sp/>SubscribeOptions(qos=qos)</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>qos<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;Subscribe<sp/>options<sp/>and<sp/>qos<sp/>parameters<sp/>cannot<sp/>be<sp/>combined.&apos;)</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>isinstance(options,<sp/>SubscribeOptions):</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;Subscribe<sp/>options<sp/>must<sp/>be<sp/>instance<sp/>of<sp/>SubscribeOptions<sp/>class.&apos;)</highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_qos_list<sp/>=<sp/>[(topic.encode(&apos;utf-8&apos;),<sp/>options)]</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>topic<sp/>is<sp/>None<sp/>or<sp/>len(topic)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>topic.&apos;)</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_qos_list<sp/>=<sp/>[(topic.encode(&apos;utf-8&apos;),<sp/>qos)]<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>isinstance(topic,<sp/>list):</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(topic)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Empty<sp/>topic<sp/>list&apos;)</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_qos_list<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t,<sp/>o<sp/>in<sp/>topic:</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>isinstance(o,<sp/>SubscribeOptions):</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>then<sp/>the<sp/>second<sp/>value<sp/>should<sp/>be<sp/>QoS</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>o<sp/>&lt;<sp/>0<sp/>or<sp/>o<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>QoS<sp/>level.&apos;)</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>o<sp/>=<sp/>SubscribeOptions(qos=o)</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_qos_list.append((t.encode(&apos;utf-8&apos;),<sp/>o))</highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t,<sp/>q<sp/>in<sp/>topic:</highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(q,<sp/>SubscribeOptions)<sp/>or<sp/>q<sp/>&lt;<sp/>0<sp/>or<sp/>q<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>QoS<sp/>level.&apos;)</highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>t<sp/>is<sp/>None<sp/>or<sp/>len(t)<sp/>==<sp/>0<sp/>or<sp/>not<sp/>isinstance(t,<sp/>(bytes,<sp/>str)):</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>topic.&apos;)</highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_qos_list.append((t.encode(&apos;utf-8&apos;),<sp/>q))<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="2028"><highlight class="normal"></highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>topic_qos_list<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;No<sp/>topic<sp/>specified,<sp/>or<sp/>incorrect<sp/>topic<sp/>type.&quot;)</highlight></codeline>
<codeline lineno="2031"><highlight class="normal"></highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>any(self._filter_wildcard_len_check(topic)<sp/>!=<sp/>MQTT_ERR_SUCCESS<sp/>for<sp/>topic,<sp/>_<sp/>in<sp/>topic_qos_list):</highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>subscription<sp/>filter.&apos;)</highlight></codeline>
<codeline lineno="2034"><highlight class="normal"></highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(MQTT_ERR_NO_CONN,<sp/>None)</highlight></codeline>
<codeline lineno="2037"><highlight class="normal"></highlight></codeline>
<codeline lineno="2038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_subscribe(False,<sp/>topic_qos_list,<sp/>properties)</highlight></codeline>
<codeline lineno="2039"><highlight class="normal"></highlight></codeline>
<codeline lineno="2040" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac99a802568904ada5c3170467bf7c0e3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>unsubscribe(</highlight></codeline>
<codeline lineno="2041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>topic:<sp/>str<sp/>|<sp/>list[str],<sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>tuple[MQTTErrorCode,<sp/>int<sp/>|<sp/>None]:</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Unsubscribe<sp/>the<sp/>client<sp/>from<sp/>one<sp/>or<sp/>more<sp/>topics.</highlight></codeline>
<codeline lineno="2044"><highlight class="normal"></highlight></codeline>
<codeline lineno="2045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>topic:<sp/>A<sp/>single<sp/>string,<sp/>or<sp/>list<sp/>of<sp/>strings<sp/>that<sp/>are<sp/>the<sp/>subscription</highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topics<sp/>to<sp/>unsubscribe<sp/>from.</highlight></codeline>
<codeline lineno="2047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>properties:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>a<sp/>Properties<sp/>instance<sp/>setting<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties</highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>be<sp/>included.<sp/>Optional<sp/>-<sp/>if<sp/>not<sp/>set,<sp/>no<sp/>properties<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"></highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>a<sp/>tuple<sp/>(result,<sp/>mid),<sp/>where<sp/>result<sp/>is<sp/>MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>indicate<sp/>success<sp/>or<sp/>(MQTT_ERR_NO_CONN,<sp/>None)<sp/>if<sp/>the<sp/>client<sp/>is<sp/>not</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currently<sp/>connected.</highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid<sp/>is<sp/>the<sp/>message<sp/>ID<sp/>for<sp/>the<sp/>unsubscribe<sp/>request.<sp/>The<sp/>mid<sp/>value<sp/>can<sp/>be</highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>used<sp/>to<sp/>track<sp/>the<sp/>unsubscribe<sp/>request<sp/>by<sp/>checking<sp/>against<sp/>the<sp/>mid</highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argument<sp/>in<sp/>the<sp/>on_unsubscribe()<sp/>callback<sp/>if<sp/>it<sp/>is<sp/>defined.</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"></highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>ValueError:<sp/>if<sp/>topic<sp/>is<sp/>None<sp/>or<sp/>has<sp/>zero<sp/>string<sp/>length,<sp/>or<sp/>is</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>a<sp/>string<sp/>or<sp/>list.</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_list<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>topic<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>topic.&apos;)</highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(topic,<sp/>(bytes,<sp/>str)):</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(topic)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>topic.&apos;)</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_list<sp/>=<sp/>[topic.encode(&apos;utf-8&apos;)]</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>isinstance(topic,<sp/>list):</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_list<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t<sp/>in<sp/>topic:</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(t)<sp/>==<sp/>0<sp/>or<sp/>not<sp/>isinstance(t,<sp/>(bytes,<sp/>str)):</highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>topic.&apos;)</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic_list.append(t.encode(&apos;utf-8&apos;))</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"></highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>topic_list<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;No<sp/>topic<sp/>specified,<sp/>or<sp/>incorrect<sp/>topic<sp/>type.&quot;)</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"></highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(MQTTErrorCode.MQTT_ERR_NO_CONN,<sp/>None)</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"></highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_unsubscribe(False,<sp/>topic_list,<sp/>properties)</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"></highlight></codeline>
<codeline lineno="2082" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad8751126021145a37a8f152009c3a5df" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>loop_read(self,<sp/>max_packets:<sp/>int<sp/>=<sp/>1)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Process<sp/>read<sp/>network<sp/>events.<sp/>Use<sp/>in<sp/>place<sp/>of<sp/>calling<sp/>`loop()`<sp/>if<sp/>you</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wish<sp/>to<sp/>handle<sp/>your<sp/>client<sp/>reads<sp/>as<sp/>part<sp/>of<sp/>your<sp/>own<sp/>application.</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"></highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Use<sp/>`socket()`<sp/>to<sp/>obtain<sp/>the<sp/>client<sp/>socket<sp/>to<sp/>call<sp/>select()<sp/>or<sp/>equivalent</highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on.</highlight></codeline>
<codeline lineno="2088"><highlight class="normal"></highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Do<sp/>not<sp/>use<sp/>if<sp/>you<sp/>are<sp/>using<sp/>`loop_start()`<sp/>or<sp/>`loop_forever()`.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_NO_CONN</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"></highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_packets<sp/>=<sp/>len(self._out_messages)<sp/>+<sp/>len(self._in_messages)</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>max_packets<sp/>&lt;<sp/>1:</highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_packets<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"></highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>_<sp/>in<sp/>range(0,<sp/>max_packets):</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_NO_CONN</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._packet_read()</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._loop_rc_handle(rc)</highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_AGAIN:</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2106"><highlight class="normal"></highlight></codeline>
<codeline lineno="2107" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aae3e67f3535451a2bcfff99a476120d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>loop_write(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Process<sp/>write<sp/>network<sp/>events.<sp/>Use<sp/>in<sp/>place<sp/>of<sp/>calling<sp/>`loop()`<sp/>if<sp/>you</highlight></codeline>
<codeline lineno="2109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wish<sp/>to<sp/>handle<sp/>your<sp/>client<sp/>writes<sp/>as<sp/>part<sp/>of<sp/>your<sp/>own<sp/>application.</highlight></codeline>
<codeline lineno="2110"><highlight class="normal"></highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Use<sp/>`socket()`<sp/>to<sp/>obtain<sp/>the<sp/>client<sp/>socket<sp/>to<sp/>call<sp/>select()<sp/>or<sp/>equivalent</highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on.</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"></highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Use<sp/>`want_write()`<sp/>to<sp/>determine<sp/>if<sp/>there<sp/>is<sp/>data<sp/>waiting<sp/>to<sp/>be<sp/>written.</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"></highlight></codeline>
<codeline lineno="2116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Do<sp/>not<sp/>use<sp/>if<sp/>you<sp/>are<sp/>using<sp/>`loop_start()`<sp/>or<sp/>`loop_forever()`.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_NO_CONN</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"></highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._packet_write()</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_AGAIN:</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>rc<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._loop_rc_handle(rc)</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finally:</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self.want_write():</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_register_write()</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_unregister_write()</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"></highlight></codeline>
<codeline lineno="2134" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a2ae3ea6d747fe0021ec9555b390cef77" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>want_write(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Call<sp/>to<sp/>determine<sp/>if<sp/>there<sp/>is<sp/>network<sp/>data<sp/>waiting<sp/>to<sp/>be<sp/>written.</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Useful<sp/>if<sp/>you<sp/>are<sp/>calling<sp/>select()<sp/>yourself<sp/>rather<sp/>than<sp/>using<sp/>`loop()`,<sp/>`loop_start()`<sp/>or<sp/>`loop_forever()`.</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>len(self._out_packet)<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"></highlight></codeline>
<codeline lineno="2140" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a74a4e5ec68930a72b3f2c42377e12dd8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>loop_misc(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Process<sp/>miscellaneous<sp/>network<sp/>events.<sp/>Use<sp/>in<sp/>place<sp/>of<sp/>calling<sp/>`loop()`<sp/>if<sp/>you</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wish<sp/>to<sp/>call<sp/>select()<sp/>or<sp/>equivalent<sp/>on.</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"></highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Do<sp/>not<sp/>use<sp/>if<sp/>you<sp/>are<sp/>using<sp/>`loop_start()`<sp/>or<sp/>`loop_forever()`.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_NO_CONN</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"></highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>now<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._check_keepalive()</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"></highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ping_t<sp/>&gt;<sp/>0<sp/>and<sp/>now<sp/>-<sp/>self._ping_t<sp/>&gt;=<sp/>self._keepalive:</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>client-&gt;ping_t<sp/>!=<sp/>0<sp/>means<sp/>we<sp/>are<sp/>waiting<sp/>for<sp/>a<sp/>pingresp.</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>This<sp/>hasn&apos;t<sp/>happened<sp/>in<sp/>the<sp/>keepalive<sp/>time<sp/>so<sp/>we<sp/>should<sp/>disconnect.</highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"></highlight></codeline>
<codeline lineno="2156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED):</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_DISCONNECTED</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_CONNECTION_LOST</highlight></codeline>
<codeline lineno="2161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_KEEPALIVE</highlight></codeline>
<codeline lineno="2162"><highlight class="normal"></highlight></codeline>
<codeline lineno="2163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._do_on_disconnect(</highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_from_broker=False,</highlight></codeline>
<codeline lineno="2165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v1_rc=rc,</highlight></codeline>
<codeline lineno="2166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="2167"><highlight class="normal"></highlight></codeline>
<codeline lineno="2168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="2169"><highlight class="normal"></highlight></codeline>
<codeline lineno="2170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"></highlight></codeline>
<codeline lineno="2172" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa4656ed42eaabd09f0d853a42599b56f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>max_inflight_messages_set(self,<sp/>inflight:<sp/>int)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Set<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>messages<sp/>with<sp/>QoS&gt;0<sp/>that<sp/>can<sp/>be<sp/>part<sp/>way</highlight></codeline>
<codeline lineno="2174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>through<sp/>their<sp/>network<sp/>flow<sp/>at<sp/>once.<sp/>Defaults<sp/>to<sp/>20.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2175" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a799baad695b9fd2d84c93561866941a0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.max_inflight_messages<sp/>=<sp/>inflight</highlight></codeline>
<codeline lineno="2176"><highlight class="normal"></highlight></codeline>
<codeline lineno="2177" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a90bd593eea05d7b1411063759f02027a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>max_queued_messages_set(self,<sp/>queue_size:<sp/>int)<sp/>-&gt;<sp/>Client:</highlight></codeline>
<codeline lineno="2178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Set<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>messages<sp/>in<sp/>the<sp/>outgoing<sp/>message<sp/>queue.</highlight></codeline>
<codeline lineno="2179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0<sp/>means<sp/>unlimited.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>isinstance(queue_size,<sp/>int):</highlight></codeline>
<codeline lineno="2181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>type<sp/>of<sp/>queue<sp/>size.&apos;)</highlight></codeline>
<codeline lineno="2182" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6945830484d858d4143b8f51dc39fe52" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.max_queued_messages<sp/>=<sp/>queue_size</highlight></codeline>
<codeline lineno="2183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self</highlight></codeline>
<codeline lineno="2184"><highlight class="normal"></highlight></codeline>
<codeline lineno="2185" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a66917fe16ee88198eaf560a49ccd8e5c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>user_data_set(self,<sp/>userdata:<sp/>Any)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Set<sp/>the<sp/>user<sp/>data<sp/>variable<sp/>passed<sp/>to<sp/>callbacks.<sp/>May<sp/>be<sp/>any<sp/>data<sp/>type.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata<sp/>=<sp/>userdata</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"></highlight></codeline>
<codeline lineno="2189" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a61b29246f9e53c13463fb3fa4f34ace1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>user_data_get(self)<sp/>-&gt;<sp/>Any:</highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Get<sp/>the<sp/>user<sp/>data<sp/>variable<sp/>passed<sp/>to<sp/>callbacks.<sp/>May<sp/>be<sp/>any<sp/>data<sp/>type.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._userdata</highlight></codeline>
<codeline lineno="2192"><highlight class="normal"></highlight></codeline>
<codeline lineno="2193" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a509abdbed08ed12a37957ba7c1f2c3c6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>will_set(</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic:<sp/>str,</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload:<sp/>PayloadType<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qos:<sp/>int<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retain:<sp/>bool<sp/>=<sp/>False,</highlight></codeline>
<codeline lineno="2199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Set<sp/>a<sp/>Will<sp/>to<sp/>be<sp/>sent<sp/>by<sp/>the<sp/>broker<sp/>in<sp/>case<sp/>the<sp/>client<sp/>disconnects<sp/>unexpectedly.</highlight></codeline>
<codeline lineno="2202"><highlight class="normal"></highlight></codeline>
<codeline lineno="2203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>must<sp/>be<sp/>called<sp/>before<sp/>connect()<sp/>to<sp/>have<sp/>any<sp/>effect.</highlight></codeline>
<codeline lineno="2204"><highlight class="normal"></highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>topic:<sp/>The<sp/>topic<sp/>that<sp/>the<sp/>will<sp/>message<sp/>should<sp/>be<sp/>published<sp/>on.</highlight></codeline>
<codeline lineno="2206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>payload:<sp/>The<sp/>message<sp/>to<sp/>send<sp/>as<sp/>a<sp/>will.<sp/>If<sp/>not<sp/>given,<sp/>or<sp/>set<sp/>to<sp/>None<sp/>a</highlight></codeline>
<codeline lineno="2207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zero<sp/>length<sp/>message<sp/>will<sp/>be<sp/>used<sp/>as<sp/>the<sp/>will.<sp/>Passing<sp/>an<sp/>int<sp/>or<sp/>float</highlight></codeline>
<codeline lineno="2208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>result<sp/>in<sp/>the<sp/>payload<sp/>being<sp/>converted<sp/>to<sp/>a<sp/>string<sp/>representing</highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>number.<sp/>If<sp/>you<sp/>wish<sp/>to<sp/>send<sp/>a<sp/>true<sp/>int/float,<sp/>use<sp/>struct.pack()<sp/>to</highlight></codeline>
<codeline lineno="2210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>create<sp/>the<sp/>payload<sp/>you<sp/>require.</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>qos:<sp/>The<sp/>quality<sp/>of<sp/>service<sp/>level<sp/>to<sp/>use<sp/>for<sp/>the<sp/>will.</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>bool<sp/>retain:<sp/>If<sp/>set<sp/>to<sp/>true,<sp/>the<sp/>will<sp/>message<sp/>will<sp/>be<sp/>set<sp/>as<sp/>the<sp/>&quot;last<sp/>known</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>good&quot;/retained<sp/>message<sp/>for<sp/>the<sp/>topic.</highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>(MQTT<sp/>v5.0<sp/>only)<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>be<sp/>included<sp/>with<sp/>the<sp/>will<sp/>message.<sp/>Optional<sp/>-<sp/>if<sp/>not<sp/>set,<sp/>no<sp/>properties<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="2216"><highlight class="normal"></highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>ValueError:<sp/>if<sp/>qos<sp/>is<sp/>not<sp/>0,<sp/>1<sp/>or<sp/>2,<sp/>or<sp/>if<sp/>topic<sp/>is<sp/>None<sp/>or<sp/>has</highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zero<sp/>string<sp/>length.</highlight></codeline>
<codeline lineno="2219"><highlight class="normal"></highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>See<sp/>`will_clear`<sp/>to<sp/>clear<sp/>will.<sp/>Note<sp/>that<sp/>will<sp/>are<sp/>NOT<sp/>send<sp/>if<sp/>the<sp/>client<sp/>disconnect<sp/>cleanly</highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>example<sp/>by<sp/>calling<sp/>`disconnect()`.</highlight></codeline>
<codeline lineno="2222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>topic<sp/>is<sp/>None<sp/>or<sp/>len(topic)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>topic.&apos;)</highlight></codeline>
<codeline lineno="2225"><highlight class="normal"></highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>&lt;<sp/>0<sp/>or<sp/>qos<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="2227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Invalid<sp/>QoS<sp/>level.&apos;)</highlight></codeline>
<codeline lineno="2228"><highlight class="normal"></highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>and<sp/>not<sp/>isinstance(properties,<sp/>Properties):</highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="2231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;The<sp/>properties<sp/>argument<sp/>must<sp/>be<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>Properties<sp/>class.&quot;)</highlight></codeline>
<codeline lineno="2232"><highlight class="normal"></highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_payload<sp/>=<sp/>_encode_payload(payload)</highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_topic<sp/>=<sp/>topic.encode(&apos;utf-8&apos;)</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_qos<sp/>=<sp/>qos</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_retain<sp/>=<sp/>retain</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_properties<sp/>=<sp/>properties</highlight></codeline>
<codeline lineno="2239"><highlight class="normal"></highlight></codeline>
<codeline lineno="2240" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aee45aefd284b6948b81eeeaf3eebd380" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>will_clear(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;<sp/>Removes<sp/>a<sp/>will<sp/>that<sp/>was<sp/>previously<sp/>configured<sp/>with<sp/>`will_set()`.</highlight></codeline>
<codeline lineno="2242"><highlight class="normal"></highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Must<sp/>be<sp/>called<sp/>before<sp/>connect()<sp/>to<sp/>have<sp/>any<sp/>effect.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="2245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_topic<sp/>=<sp/>b&quot;&quot;</highlight></codeline>
<codeline lineno="2246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_payload<sp/>=<sp/>b&quot;&quot;</highlight></codeline>
<codeline lineno="2247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_qos<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._will_retain<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="2249"><highlight class="normal"></highlight></codeline>
<codeline lineno="2250" refid="classpaho_1_1mqtt_1_1client_1_1_client_1adfd1dbbc607760fa5b0a53dffbd8778c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>socket(self)<sp/>-&gt;<sp/>SocketLike<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Return<sp/>the<sp/>socket<sp/>or<sp/>ssl<sp/>object<sp/>for<sp/>this<sp/>client.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._sock</highlight></codeline>
<codeline lineno="2253"><highlight class="normal"></highlight></codeline>
<codeline lineno="2254" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8a5f57a34af92551d79914e5f49825a7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>loop_forever(</highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout:<sp/>float<sp/>=<sp/>1.0,</highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retry_first_connection:<sp/>bool<sp/>=<sp/>False,</highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;This<sp/>function<sp/>calls<sp/>the<sp/>network<sp/>loop<sp/>functions<sp/>for<sp/>you<sp/>in<sp/>an</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>infinite<sp/>blocking<sp/>loop.<sp/>It<sp/>is<sp/>useful<sp/>for<sp/>the<sp/>case<sp/>where<sp/>you<sp/>only<sp/>want</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>run<sp/>the<sp/>MQTT<sp/>client<sp/>loop<sp/>in<sp/>your<sp/>program.</highlight></codeline>
<codeline lineno="2262"><highlight class="normal"></highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loop_forever()<sp/>will<sp/>handle<sp/>reconnecting<sp/>for<sp/>you<sp/>if<sp/>reconnect_on_failure<sp/>is</highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>true<sp/>(this<sp/>is<sp/>the<sp/>default<sp/>behavior).<sp/>If<sp/>you<sp/>call<sp/>`disconnect()`<sp/>in<sp/>a<sp/>callback</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>it<sp/>will<sp/>return.</highlight></codeline>
<codeline lineno="2266"><highlight class="normal"></highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>timeout:<sp/>The<sp/>time<sp/>in<sp/>seconds<sp/>to<sp/>wait<sp/>for<sp/>incoming/outgoing<sp/>network</highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>traffic<sp/>before<sp/>timing<sp/>out<sp/>and<sp/>returning.</highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>bool<sp/>retry_first_connection:<sp/>Should<sp/>the<sp/>first<sp/>connection<sp/>attempt<sp/>be<sp/>retried<sp/>on<sp/>failure.</highlight></codeline>
<codeline lineno="2270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>is<sp/>independent<sp/>of<sp/>the<sp/>reconnect_on_failure<sp/>setting.</highlight></codeline>
<codeline lineno="2271"><highlight class="normal"></highlight></codeline>
<codeline lineno="2272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises<sp/>OSError:<sp/>if<sp/>the<sp/>first<sp/>connection<sp/>fail<sp/>unless<sp/>retry_first_connection=True</highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2274"><highlight class="normal"></highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>run<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="2276"><highlight class="normal"></highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>run:</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._thread_terminate<sp/>is<sp/>True:</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"></highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>==<sp/>_ConnectionState.MQTT_CS_CONNECT_ASYNC:</highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.reconnect()</highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>OSError:</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._handle_on_connect_fail()</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>retry_first_connection:</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,<sp/>&quot;Connection<sp/>failed,<sp/>retrying&quot;)</highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_wait()</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break</highlight></codeline>
<codeline lineno="2293"><highlight class="normal"></highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>run:</highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._loop(timeout)</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>We<sp/>don&apos;t<sp/>need<sp/>to<sp/>worry<sp/>about<sp/>locking<sp/>here,<sp/>because<sp/>we&apos;ve</highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>either<sp/>called<sp/>loop_forever()<sp/>when<sp/>in<sp/>single<sp/>threaded<sp/>mode,<sp/>or</highlight></codeline>
<codeline lineno="2300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>in<sp/>multi<sp/>threaded<sp/>mode<sp/>when<sp/>loop_stop()<sp/>has<sp/>been<sp/>called<sp/>and</highlight></codeline>
<codeline lineno="2301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>so<sp/>no<sp/>other<sp/>threads<sp/>can<sp/>access<sp/>_out_packet<sp/>or<sp/>_messages.</highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(self._thread_terminate<sp/>is<sp/>True</highlight></codeline>
<codeline lineno="2303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>len(self._out_packet)<sp/>==<sp/>0</highlight></codeline>
<codeline lineno="2304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>len(self._out_messages)<sp/>==<sp/>0):</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_NOMEM</highlight></codeline>
<codeline lineno="2306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>run<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="2307"><highlight class="normal"></highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>should_exit()<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(</highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED)<sp/>or</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>run<sp/>is<sp/>False<sp/>or<sp/><sp/>#<sp/>noqa:<sp/>B023<sp/>(uses<sp/>the<sp/>run<sp/>variable<sp/>from<sp/>the<sp/>outer<sp/>scope<sp/>on<sp/>purpose)</highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread_terminate<sp/>is<sp/>True</highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="2314"><highlight class="normal"></highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>should_exit()<sp/>or<sp/>not<sp/>self._reconnect_on_failure:</highlight></codeline>
<codeline lineno="2316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>run<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_wait()</highlight></codeline>
<codeline lineno="2319"><highlight class="normal"></highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>should_exit():</highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>run<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="2323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.reconnect()</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>OSError:</highlight></codeline>
<codeline lineno="2326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._handle_on_connect_fail()</highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,<sp/>&quot;Connection<sp/>failed,<sp/>retrying&quot;)</highlight></codeline>
<codeline lineno="2329"><highlight class="normal"></highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="2331"><highlight class="normal"></highlight></codeline>
<codeline lineno="2332" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4c160c3ff284066cfb609261bc7e6eba" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>loop_start(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;This<sp/>is<sp/>part<sp/>of<sp/>the<sp/>threaded<sp/>client<sp/>interface.<sp/>Call<sp/>this<sp/>once<sp/>to</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>start<sp/>a<sp/>new<sp/>thread<sp/>to<sp/>process<sp/>network<sp/>traffic.<sp/>This<sp/>provides<sp/>an</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alternative<sp/>to<sp/>repeatedly<sp/>calling<sp/>`loop()`<sp/>yourself.</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"></highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Under<sp/>the<sp/>hood,<sp/>this<sp/>will<sp/>call<sp/>`loop_forever`<sp/>in<sp/>a<sp/>thread,<sp/>which<sp/>means<sp/>that</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>thread<sp/>will<sp/>terminate<sp/>if<sp/>you<sp/>call<sp/>`disconnect()`</highlight></codeline>
<codeline lineno="2339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._thread<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_INVAL</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"></highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairR,<sp/>self._sockpairW<sp/>=<sp/>_socketpair_compat()</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread_terminate<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="2345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread<sp/>=<sp/>threading.Thread(target=self._thread_main,<sp/>name=f&quot;paho-mqtt-client-{self._client_id.decode()}&quot;)</highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread.daemon<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread.start()</highlight></codeline>
<codeline lineno="2348"><highlight class="normal"></highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"></highlight></codeline>
<codeline lineno="2351" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a023928200bac92c87bfc3b2366c8375f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>loop_stop(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;This<sp/>is<sp/>part<sp/>of<sp/>the<sp/>threaded<sp/>client<sp/>interface.<sp/>Call<sp/>this<sp/>once<sp/>to</highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stop<sp/>the<sp/>network<sp/>thread<sp/>previously<sp/>created<sp/>with<sp/>`loop_start()`.<sp/>This<sp/>call</highlight></codeline>
<codeline lineno="2354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>block<sp/>until<sp/>the<sp/>network<sp/>thread<sp/>finishes.</highlight></codeline>
<codeline lineno="2355"><highlight class="normal"></highlight></codeline>
<codeline lineno="2356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>don&apos;t<sp/>guarantee<sp/>that<sp/>publish<sp/>packet<sp/>are<sp/>sent,<sp/>use<sp/>`wait_for_publish`<sp/>or</highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`on_publish`<sp/>to<sp/>ensure<sp/>`publish`<sp/>are<sp/>sent.</highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._thread<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_INVAL</highlight></codeline>
<codeline lineno="2361"><highlight class="normal"></highlight></codeline>
<codeline lineno="2362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread_terminate<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="2363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>threading.current_thread()<sp/>!=<sp/>self._thread:</highlight></codeline>
<codeline lineno="2364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread.join()</highlight></codeline>
<codeline lineno="2365"><highlight class="normal"></highlight></codeline>
<codeline lineno="2366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="2367"><highlight class="normal"></highlight></codeline>
<codeline lineno="2368"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2369" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0b9815fd04ca7bc1e726c0db2e356211" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>callback_api_version(self)<sp/>-&gt;<sp/>CallbackAPIVersion:</highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>callback<sp/>API<sp/>version<sp/>used<sp/>for<sp/>user-callback.<sp/>See<sp/>docstring<sp/>for</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>each<sp/>user-callback<sp/>(`on_connect`,<sp/>`on_publish`,<sp/>...)<sp/>for<sp/>details.</highlight></codeline>
<codeline lineno="2373"><highlight class="normal"></highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>property<sp/>is<sp/>read-only.</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._callback_api_version</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"></highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2379" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a276a803fbf57e080420dc3faf207dff9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_log(self)<sp/>-&gt;<sp/>CallbackOnLog<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>client<sp/>has<sp/>log<sp/>information.</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defined<sp/>to<sp/>allow<sp/>debugging.</highlight></codeline>
<codeline lineno="2382"><highlight class="normal"></highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>is::</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"></highlight></codeline>
<codeline lineno="2385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log_callback(client,<sp/>userdata,<sp/>level,<sp/>buf)</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"></highlight></codeline>
<codeline lineno="2387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>level:<sp/>gives<sp/>the<sp/>severity<sp/>of<sp/>the<sp/>message<sp/>and<sp/>will<sp/>be<sp/>one<sp/>of</highlight></codeline>
<codeline lineno="2390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_INFO,<sp/>MQTT_LOG_NOTICE,<sp/>MQTT_LOG_WARNING,</highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>and<sp/>MQTT_LOG_DEBUG.</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>str<sp/>buf:<sp/>the<sp/>message<sp/>itself</highlight></codeline>
<codeline lineno="2393"><highlight class="normal"></highlight></codeline>
<codeline lineno="2394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.log_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_log</highlight></codeline>
<codeline lineno="2398"><highlight class="normal"></highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_log.setter</highlight></codeline>
<codeline lineno="2400" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a612b09e45d5b945a3d9b630b9694162d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_log(self,<sp/>func:<sp/>CallbackOnLog<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_log<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2402"><highlight class="normal"></highlight></codeline>
<codeline lineno="2403" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a261abb871aa1dfce74a8527495e6386f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>log_callback(self)<sp/>-&gt;<sp/>Callable[[CallbackOnLog],<sp/>CallbackOnLog]:</highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnLog)<sp/>-&gt;<sp/>CallbackOnLog:</highlight></codeline>
<codeline lineno="2405" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a75fd364aad96adcbaaf37f0d5ee50bd8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_log<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2408"><highlight class="normal"></highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2410" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a2d474547fedc5ef0e9377663446127de" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_pre_connect(self)<sp/>-&gt;<sp/>CallbackOnPreConnect<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>immediately<sp/>prior<sp/>to<sp/>the<sp/>connection<sp/>is<sp/>made</highlight></codeline>
<codeline lineno="2412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.</highlight></codeline>
<codeline lineno="2413"><highlight class="normal"></highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>(for<sp/>all<sp/>callback<sp/>API<sp/>version)::</highlight></codeline>
<codeline lineno="2415"><highlight class="normal"></highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_callback(client,<sp/>userdata)</highlight></codeline>
<codeline lineno="2417"><highlight class="normal"></highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:parama<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:parama<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2420"><highlight class="normal"></highlight></codeline>
<codeline lineno="2421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.pre_connect_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2423"><highlight class="normal"></highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_pre_connect</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"></highlight></codeline>
<codeline lineno="2427"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_pre_connect.setter</highlight></codeline>
<codeline lineno="2428" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af6f49c8925250b5a4e10de43094da1f3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_pre_connect(self,<sp/>func:<sp/>CallbackOnPreConnect<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_pre_connect<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"></highlight></codeline>
<codeline lineno="2432" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a3f4e84e8624727e4e2d3f262e9b3a031" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>pre_connect_callback(</highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2434"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnPreConnect],<sp/>CallbackOnPreConnect]:</highlight></codeline>
<codeline lineno="2435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnPreConnect)<sp/>-&gt;<sp/>CallbackOnPreConnect:</highlight></codeline>
<codeline lineno="2436" refid="classpaho_1_1mqtt_1_1client_1_1_client_1afb479c7f75d983903d0ef8c4a8e8e530" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_pre_connect<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2439"><highlight class="normal"></highlight></codeline>
<codeline lineno="2440"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2441" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab9bcf475ea3ff7d7954a56cbf1f08b79" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_connect(self)<sp/>-&gt;<sp/>CallbackOnConnect<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>broker<sp/>reponds<sp/>to<sp/>our<sp/>connection<sp/>request.</highlight></codeline>
<codeline lineno="2443"><highlight class="normal"></highlight></codeline>
<codeline lineno="2444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>2::</highlight></codeline>
<codeline lineno="2445"><highlight class="normal"></highlight></codeline>
<codeline lineno="2446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_callback(client,<sp/>userdata,<sp/>connect_flags,<sp/>reason_code,<sp/>properties)</highlight></codeline>
<codeline lineno="2447"><highlight class="normal"></highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>1<sp/>change<sp/>with<sp/>MQTT<sp/>protocol<sp/>version:</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"></highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_callback(client,<sp/>userdata,<sp/>flags,<sp/>rc)</highlight></codeline>
<codeline lineno="2452"><highlight class="normal"></highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v5.0<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2454"><highlight class="normal"></highlight></codeline>
<codeline lineno="2455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_callback(client,<sp/>userdata,<sp/>flags,<sp/>reason_code,<sp/>properties)</highlight></codeline>
<codeline lineno="2456"><highlight class="normal"></highlight></codeline>
<codeline lineno="2457"><highlight class="normal"></highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>ConnectFlags<sp/>connect_flags:<sp/>the<sp/>flags<sp/>for<sp/>this<sp/>connection</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>ReasonCode<sp/>reason_code:<sp/>the<sp/>connection<sp/>reason<sp/>code<sp/>received<sp/>from<sp/>the<sp/>broken.</highlight></codeline>
<codeline lineno="2462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v5.0<sp/>it&apos;s<sp/>the<sp/>reason<sp/>code<sp/>defined<sp/>by<sp/>the<sp/>standard.</highlight></codeline>
<codeline lineno="2463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v3,<sp/>we<sp/>convert<sp/>return<sp/>code<sp/>to<sp/>a<sp/>reason<sp/>code,<sp/>see</highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`convert_connack_rc_to_reason_code()`.</highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`ReasonCode`<sp/>may<sp/>be<sp/>compared<sp/>to<sp/>integer.</highlight></codeline>
<codeline lineno="2466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>received<sp/>from<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>properties<sp/>is<sp/>not<sp/>provided<sp/>and<sp/>an<sp/>empty<sp/>Properties</highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object<sp/>is<sp/>always<sp/>used.</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>dict<sp/>flags:<sp/>response<sp/>flags<sp/>sent<sp/>by<sp/>the<sp/>broker</highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>rc:<sp/>the<sp/>connection<sp/>result,<sp/>should<sp/>have<sp/>a<sp/>value<sp/>of<sp/>`ConnackCode`</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"></highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>is<sp/>a<sp/>dict<sp/>that<sp/>contains<sp/>response<sp/>flags<sp/>from<sp/>the<sp/>broker:</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags[&apos;session<sp/>present&apos;]<sp/>-<sp/>this<sp/>flag<sp/>is<sp/>useful<sp/>for<sp/>clients<sp/>that<sp/>are</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>using<sp/>clean<sp/>session<sp/>set<sp/>to<sp/>0<sp/>only.<sp/>If<sp/>a<sp/>client<sp/>with<sp/>clean</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>session=0,<sp/>that<sp/>reconnects<sp/>to<sp/>a<sp/>broker<sp/>that<sp/>it<sp/>has<sp/>previously</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connected<sp/>to,<sp/>this<sp/>flag<sp/>indicates<sp/>whether<sp/>the<sp/>broker<sp/>still<sp/>has<sp/>the</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>session<sp/>information<sp/>for<sp/>the<sp/>client.<sp/>If<sp/>1,<sp/>the<sp/>session<sp/>still<sp/>exists.</highlight></codeline>
<codeline lineno="2478"><highlight class="normal"></highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>value<sp/>of<sp/>rc<sp/>indicates<sp/>success<sp/>or<sp/>not:</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>0:<sp/>Connection<sp/>successful</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>1:<sp/>Connection<sp/>refused<sp/>-<sp/>incorrect<sp/>protocol<sp/>version</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>2:<sp/>Connection<sp/>refused<sp/>-<sp/>invalid<sp/>client<sp/>identifier</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>3:<sp/>Connection<sp/>refused<sp/>-<sp/>server<sp/>unavailable</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>4:<sp/>Connection<sp/>refused<sp/>-<sp/>bad<sp/>username<sp/>or<sp/>password</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>5:<sp/>Connection<sp/>refused<sp/>-<sp/>not<sp/>authorised</highlight></codeline>
<codeline lineno="2486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>6-255:<sp/>Currently<sp/>unused.</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"></highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.connect_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_connect</highlight></codeline>
<codeline lineno="2492"><highlight class="normal"></highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_connect.setter</highlight></codeline>
<codeline lineno="2494" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af1050a135429b771de5d1c1ea165638b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_connect(self,<sp/>func:<sp/>CallbackOnConnect<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_connect<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2497"><highlight class="normal"></highlight></codeline>
<codeline lineno="2498" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9c9b75dfac2cf644bfe8ad37020f943d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>connect_callback(</highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnConnect],<sp/>CallbackOnConnect]:</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnConnect)<sp/>-&gt;<sp/>CallbackOnConnect:</highlight></codeline>
<codeline lineno="2502" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6ac2e0db13b5612e180c078d31ce4e88" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_connect<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"></highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2507" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9af6a91990ec59ded75667fdae37f873" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_connect_fail(self)<sp/>-&gt;<sp/>CallbackOnConnectFail<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>client<sp/>failed<sp/>to<sp/>connect</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"></highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>is<sp/>(for<sp/>all<sp/>callback_api_version)::</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"></highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_fail_callback(client,<sp/>userdata)</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"></highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:parama<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2517"><highlight class="normal"></highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.connect_fail_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_connect_fail</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"></highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_connect_fail.setter</highlight></codeline>
<codeline lineno="2524" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab3bb381f507926e80a028d713fab04f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_connect_fail(self,<sp/>func:<sp/>CallbackOnConnectFail<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_connect_fail<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2527"><highlight class="normal"></highlight></codeline>
<codeline lineno="2528" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a1bbc8b72ab75c216005e99f8b7cc894b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>connect_fail_callback(</highlight></codeline>
<codeline lineno="2529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnConnectFail],<sp/>CallbackOnConnectFail]:</highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnConnectFail)<sp/>-&gt;<sp/>CallbackOnConnectFail:</highlight></codeline>
<codeline lineno="2532" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af404e68a36aa7a70cce8ab095f5ab2b9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_connect_fail<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2535"><highlight class="normal"></highlight></codeline>
<codeline lineno="2536"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2537" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a7fab243de92079e35852165473e3b39c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_subscribe(self)<sp/>-&gt;<sp/>CallbackOnSubscribe<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>broker<sp/>responds<sp/>to<sp/>a<sp/>subscribe</highlight></codeline>
<codeline lineno="2539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.</highlight></codeline>
<codeline lineno="2540"><highlight class="normal"></highlight></codeline>
<codeline lineno="2541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>2::</highlight></codeline>
<codeline lineno="2542"><highlight class="normal"></highlight></codeline>
<codeline lineno="2543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscribe_callback(client,<sp/>userdata,<sp/>mid,<sp/>reason_code_list,<sp/>properties)</highlight></codeline>
<codeline lineno="2544"><highlight class="normal"></highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>1<sp/>change<sp/>with<sp/>MQTT<sp/>protocol<sp/>version:</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"></highlight></codeline>
<codeline lineno="2548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscribe_callback(client,<sp/>userdata,<sp/>mid,<sp/>granted_qos)</highlight></codeline>
<codeline lineno="2549"><highlight class="normal"></highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v5.0<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"></highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscribe_callback(client,<sp/>userdata,<sp/>mid,<sp/>reason_code_list,<sp/>properties)</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"></highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>mid:<sp/>matches<sp/>the<sp/>mid<sp/>variable<sp/>returned<sp/>from<sp/>the<sp/>corresponding</highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscribe()<sp/>call.</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>list[ReasonCode]<sp/>reason_code_list:<sp/>reason<sp/>codes<sp/>received<sp/>from<sp/>the<sp/>broker<sp/>for<sp/>each<sp/>subscription.</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v5.0<sp/>it&apos;s<sp/>the<sp/>reason<sp/>code<sp/>defined<sp/>by<sp/>the<sp/>standard.</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v3,<sp/>we<sp/>convert<sp/>granted<sp/>QoS<sp/>to<sp/>a<sp/>reason<sp/>code.</highlight></codeline>
<codeline lineno="2561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>It&apos;s<sp/>a<sp/>list<sp/>of<sp/>ReasonCode<sp/>instances.</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>received<sp/>from<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>properties<sp/>is<sp/>not<sp/>provided<sp/>and<sp/>an<sp/>empty<sp/>Properties</highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object<sp/>is<sp/>always<sp/>used.</highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>list[int]<sp/>granted_qos:<sp/>list<sp/>of<sp/>integers<sp/>that<sp/>give<sp/>the<sp/>QoS<sp/>level<sp/>the<sp/>broker<sp/>has</highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>granted<sp/>for<sp/>each<sp/>of<sp/>the<sp/>different<sp/>subscription<sp/>requests.</highlight></codeline>
<codeline lineno="2567"><highlight class="normal"></highlight></codeline>
<codeline lineno="2568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.subscribe_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_subscribe</highlight></codeline>
<codeline lineno="2572"><highlight class="normal"></highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_subscribe.setter</highlight></codeline>
<codeline lineno="2574" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a142d3c9085ea1b491c19b9ca303e5059" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_subscribe(self,<sp/>func:<sp/>CallbackOnSubscribe<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_subscribe<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2577"><highlight class="normal"></highlight></codeline>
<codeline lineno="2578" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0b4e8d2fdea7b08371b093d4734cfc92" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>subscribe_callback(</highlight></codeline>
<codeline lineno="2579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2580"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnSubscribe],<sp/>CallbackOnSubscribe]:</highlight></codeline>
<codeline lineno="2581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnSubscribe)<sp/>-&gt;<sp/>CallbackOnSubscribe:</highlight></codeline>
<codeline lineno="2582" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aeb04093172e4e37989b8760544ffe4ee" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_subscribe<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2585"><highlight class="normal"></highlight></codeline>
<codeline lineno="2586"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2587" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a03188384b44374bb5756ea439548197b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_message(self)<sp/>-&gt;<sp/>CallbackOnMessage<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>a<sp/>message<sp/>has<sp/>been<sp/>received<sp/>on<sp/>a<sp/>topic</highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>the<sp/>client<sp/>subscribes<sp/>to.</highlight></codeline>
<codeline lineno="2590"><highlight class="normal"></highlight></codeline>
<codeline lineno="2591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>callback<sp/>will<sp/>be<sp/>called<sp/>for<sp/>every<sp/>message<sp/>received<sp/>unless<sp/>a</highlight></codeline>
<codeline lineno="2592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`message_callback_add()`<sp/>matched<sp/>the<sp/>message.</highlight></codeline>
<codeline lineno="2593"><highlight class="normal"></highlight></codeline>
<codeline lineno="2594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>is<sp/>(for<sp/>all<sp/>callback<sp/>API<sp/>version):</highlight></codeline>
<codeline lineno="2595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message_callback(client,<sp/>userdata,<sp/>message)</highlight></codeline>
<codeline lineno="2596"><highlight class="normal"></highlight></codeline>
<codeline lineno="2597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>MQTTMessage<sp/>message:<sp/>the<sp/>received<sp/>message.</highlight></codeline>
<codeline lineno="2600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>is<sp/>a<sp/>class<sp/>with<sp/>members<sp/>topic,<sp/>payload,<sp/>qos,<sp/>retain.</highlight></codeline>
<codeline lineno="2601"><highlight class="normal"></highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.message_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_message</highlight></codeline>
<codeline lineno="2606"><highlight class="normal"></highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_message.setter</highlight></codeline>
<codeline lineno="2608" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac16e83728390e22224af97347e6d1e0c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_message(self,<sp/>func:<sp/>CallbackOnMessage<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_message<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2611"><highlight class="normal"></highlight></codeline>
<codeline lineno="2612" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a45d6b5edd9764f2a632475eb12344cfb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>message_callback(</highlight></codeline>
<codeline lineno="2613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2614"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnMessage],<sp/>CallbackOnMessage]:</highlight></codeline>
<codeline lineno="2615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnMessage)<sp/>-&gt;<sp/>CallbackOnMessage:</highlight></codeline>
<codeline lineno="2616" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a27c740e92bf31007ce46617a831fff1e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_message<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2619"><highlight class="normal"></highlight></codeline>
<codeline lineno="2620"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2621" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a175e475ea8c53251f012c2d81782b442" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_publish(self)<sp/>-&gt;<sp/>CallbackOnPublish<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>a<sp/>message<sp/>that<sp/>was<sp/>to<sp/>be<sp/>sent<sp/>using<sp/>the</highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`publish()`<sp/>call<sp/>has<sp/>completed<sp/>transmission<sp/>to<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2624"><highlight class="normal"></highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>messages<sp/>with<sp/>QoS<sp/>levels<sp/>1<sp/>and<sp/>2,<sp/>this<sp/>means<sp/>that<sp/>the<sp/>appropriate</highlight></codeline>
<codeline lineno="2626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handshakes<sp/>have<sp/>completed.<sp/>For<sp/>QoS<sp/>0,<sp/>this<sp/>simply<sp/>means<sp/>that<sp/>the<sp/>message</highlight></codeline>
<codeline lineno="2627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>has<sp/>left<sp/>the<sp/>client.</highlight></codeline>
<codeline lineno="2628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>callback<sp/>is<sp/>important<sp/>because<sp/>even<sp/>if<sp/>the<sp/>`publish()`<sp/>call<sp/>returns</highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>success,<sp/>it<sp/>does<sp/>not<sp/>always<sp/>mean<sp/>that<sp/>the<sp/>message<sp/>has<sp/>been<sp/>sent.</highlight></codeline>
<codeline lineno="2630"><highlight class="normal"></highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>See<sp/>also<sp/>`wait_for_publish`<sp/>which<sp/>could<sp/>be<sp/>simpler<sp/>to<sp/>use.</highlight></codeline>
<codeline lineno="2632"><highlight class="normal"></highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>2::</highlight></codeline>
<codeline lineno="2634"><highlight class="normal"></highlight></codeline>
<codeline lineno="2635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>publish_callback(client,<sp/>userdata,<sp/>mid,<sp/>reason_code,<sp/>properties)</highlight></codeline>
<codeline lineno="2636"><highlight class="normal"></highlight></codeline>
<codeline lineno="2637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>1::</highlight></codeline>
<codeline lineno="2638"><highlight class="normal"></highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>publish_callback(client,<sp/>userdata,<sp/>mid)</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"></highlight></codeline>
<codeline lineno="2641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>mid:<sp/>matches<sp/>the<sp/>mid<sp/>variable<sp/>returned<sp/>from<sp/>the<sp/>corresponding</highlight></codeline>
<codeline lineno="2644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`publish()`<sp/>call,<sp/>to<sp/>allow<sp/>outgoing<sp/>messages<sp/>to<sp/>be<sp/>tracked.</highlight></codeline>
<codeline lineno="2645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>ReasonCode<sp/>reason_code:<sp/>the<sp/>connection<sp/>reason<sp/>code<sp/>received<sp/>from<sp/>the<sp/>broken.</highlight></codeline>
<codeline lineno="2646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v5.0<sp/>it&apos;s<sp/>the<sp/>reason<sp/>code<sp/>defined<sp/>by<sp/>the<sp/>standard.</highlight></codeline>
<codeline lineno="2647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v3<sp/>it&apos;s<sp/>always<sp/>the<sp/>reason<sp/>code<sp/>Success</highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:parama<sp/>Properties<sp/>properties:<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>received<sp/>from<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>properties<sp/>is<sp/>not<sp/>provided<sp/>and<sp/>an<sp/>empty<sp/>Properties</highlight></codeline>
<codeline lineno="2650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object<sp/>is<sp/>always<sp/>used.</highlight></codeline>
<codeline lineno="2651"><highlight class="normal"></highlight></codeline>
<codeline lineno="2652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Note:<sp/>for<sp/>QoS<sp/>=<sp/>0,<sp/>the<sp/>reason_code<sp/>and<sp/>the<sp/>properties<sp/>don&apos;t<sp/>really<sp/>exist,<sp/>it&apos;s<sp/>the<sp/>client</highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>library<sp/>that<sp/>generate<sp/>them.<sp/>It&apos;s<sp/>always<sp/>an<sp/>empty<sp/>properties<sp/>and<sp/>a<sp/>success<sp/>reason<sp/>code.</highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Because<sp/>the<sp/>(MQTTv5)<sp/>standard<sp/>don&apos;t<sp/>have<sp/>reason<sp/>code<sp/>for<sp/>PUBLISH<sp/>packet,<sp/>the<sp/>library<sp/>create<sp/>them</highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>at<sp/>PUBACK<sp/>packet,<sp/>as<sp/>if<sp/>the<sp/>message<sp/>was<sp/>sent<sp/>with<sp/>QoS<sp/>=<sp/>1.</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"></highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.publish_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"></highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_publish</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"></highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_publish.setter</highlight></codeline>
<codeline lineno="2664" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a958cfdb82aaf3adec37b215dfa8f6e61" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_publish(self,<sp/>func:<sp/>CallbackOnPublish<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_publish<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"></highlight></codeline>
<codeline lineno="2668" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a101f17733a42df20eb578895fe2c776a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>publish_callback(</highlight></codeline>
<codeline lineno="2669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2670"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnPublish],<sp/>CallbackOnPublish]:</highlight></codeline>
<codeline lineno="2671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnPublish)<sp/>-&gt;<sp/>CallbackOnPublish:</highlight></codeline>
<codeline lineno="2672" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aed945eccb6d94accec97db9afe1428c5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_publish<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"></highlight></codeline>
<codeline lineno="2676"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2677" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4a5ba8d0e31eb94c5d1c06b21b494c39" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_unsubscribe(self)<sp/>-&gt;<sp/>CallbackOnUnsubscribe<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>broker<sp/>responds<sp/>to<sp/>an<sp/>unsubscribe</highlight></codeline>
<codeline lineno="2679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.</highlight></codeline>
<codeline lineno="2680"><highlight class="normal"></highlight></codeline>
<codeline lineno="2681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>2::</highlight></codeline>
<codeline lineno="2682"><highlight class="normal"></highlight></codeline>
<codeline lineno="2683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unsubscribe_callback(client,<sp/>userdata,<sp/>mid,<sp/>reason_code_list,<sp/>properties)</highlight></codeline>
<codeline lineno="2684"><highlight class="normal"></highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>1<sp/>change<sp/>with<sp/>MQTT<sp/>protocol<sp/>version:</highlight></codeline>
<codeline lineno="2686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2687"><highlight class="normal"></highlight></codeline>
<codeline lineno="2688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unsubscribe_callback(client,<sp/>userdata,<sp/>mid)</highlight></codeline>
<codeline lineno="2689"><highlight class="normal"></highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v5.0<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2691"><highlight class="normal"></highlight></codeline>
<codeline lineno="2692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unsubscribe_callback(client,<sp/>userdata,<sp/>mid,<sp/>properties,<sp/>v1_reason_codes)</highlight></codeline>
<codeline lineno="2693"><highlight class="normal"></highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>mid:<sp/>matches<sp/>the<sp/>mid<sp/>variable<sp/>returned<sp/>from<sp/>the<sp/>corresponding</highlight></codeline>
<codeline lineno="2697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unsubscribe()<sp/>call.</highlight></codeline>
<codeline lineno="2698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>list[ReasonCode]<sp/>reason_code_list:<sp/>reason<sp/>codes<sp/>received<sp/>from<sp/>the<sp/>broker<sp/>for<sp/>each<sp/>unsubscription.</highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v5.0<sp/>it&apos;s<sp/>the<sp/>reason<sp/>code<sp/>defined<sp/>by<sp/>the<sp/>standard.</highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v3,<sp/>there<sp/>is<sp/>not<sp/>equivalent<sp/>from<sp/>broken<sp/>and<sp/>empty<sp/>list</highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>always<sp/>used.</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>received<sp/>from<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>properties<sp/>is<sp/>not<sp/>provided<sp/>and<sp/>an<sp/>empty<sp/>Properties</highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object<sp/>is<sp/>always<sp/>used.</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>v1_reason_codes:<sp/>the<sp/>MQTT<sp/>v5.0<sp/>reason<sp/>codes<sp/>received<sp/>from<sp/>the<sp/>broker<sp/>for<sp/>each</highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unsubscribe<sp/>topic.<sp/><sp/>A<sp/>list<sp/>of<sp/>ReasonCode<sp/>instances<sp/>OR<sp/>a<sp/>single</highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReasonCode<sp/>when<sp/>we<sp/>unsubscribe<sp/>from<sp/>a<sp/>single<sp/>topic.</highlight></codeline>
<codeline lineno="2708"><highlight class="normal"></highlight></codeline>
<codeline lineno="2709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.unsubscribe_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_unsubscribe</highlight></codeline>
<codeline lineno="2713"><highlight class="normal"></highlight></codeline>
<codeline lineno="2714"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_unsubscribe.setter</highlight></codeline>
<codeline lineno="2715" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8ac5e9c42557262c8c93beb199c9d32b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_unsubscribe(self,<sp/>func:<sp/>CallbackOnUnsubscribe<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_unsubscribe<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2718"><highlight class="normal"></highlight></codeline>
<codeline lineno="2719" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a2a42945bab58fa44bc87d4f8d05643ad" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>unsubscribe_callback(</highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2721"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnUnsubscribe],<sp/>CallbackOnUnsubscribe]:</highlight></codeline>
<codeline lineno="2722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnUnsubscribe)<sp/>-&gt;<sp/>CallbackOnUnsubscribe:</highlight></codeline>
<codeline lineno="2723" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a5038ba979ec813e741a1802170b66b91" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_unsubscribe<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2726"><highlight class="normal"></highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2728" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac479c4f2fcac329452532e70eef4562f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_disconnect(self)<sp/>-&gt;<sp/>CallbackOnDisconnect<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>client<sp/>disconnects<sp/>from<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2730"><highlight class="normal"></highlight></codeline>
<codeline lineno="2731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>2::</highlight></codeline>
<codeline lineno="2732"><highlight class="normal"></highlight></codeline>
<codeline lineno="2733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnect_callback(client,<sp/>userdata,<sp/>disconnect_flags,<sp/>reason_code,<sp/>properties)</highlight></codeline>
<codeline lineno="2734"><highlight class="normal"></highlight></codeline>
<codeline lineno="2735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>for<sp/>callback<sp/>API<sp/>version<sp/>1<sp/>change<sp/>with<sp/>MQTT<sp/>protocol<sp/>version:</highlight></codeline>
<codeline lineno="2736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2737"><highlight class="normal"></highlight></codeline>
<codeline lineno="2738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnect_callback(client,<sp/>userdata,<sp/>rc)</highlight></codeline>
<codeline lineno="2739"><highlight class="normal"></highlight></codeline>
<codeline lineno="2740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>For<sp/>MQTT<sp/>v5.0<sp/>it&apos;s::</highlight></codeline>
<codeline lineno="2741"><highlight class="normal"></highlight></codeline>
<codeline lineno="2742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnect_callback(client,<sp/>userdata,<sp/>reason_code,<sp/>properties)</highlight></codeline>
<codeline lineno="2743"><highlight class="normal"></highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/><sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>DisconnectFlag<sp/>disconnect_flags:<sp/>the<sp/>flags<sp/>for<sp/>this<sp/>disconnection.</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>ReasonCode<sp/>reason_code:<sp/><sp/>the<sp/>disconnection<sp/>reason<sp/>code<sp/>possibly<sp/>received<sp/>from<sp/>the<sp/>broker<sp/>(see<sp/>disconnect_flags).</highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v5.0<sp/>it&apos;s<sp/>the<sp/>reason<sp/>code<sp/>defined<sp/>by<sp/>the<sp/>standard.</highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>In<sp/>MQTT<sp/>v3<sp/>it&apos;s<sp/>never<sp/>received<sp/>from<sp/>the<sp/>broker,<sp/>we<sp/>convert<sp/>an<sp/>MQTTErrorCode,</highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>see<sp/>`convert_disconnect_error_code_to_reason_code()`.</highlight></codeline>
<codeline lineno="2751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`ReasonCode`<sp/>may<sp/>be<sp/>compared<sp/>to<sp/>integer.</highlight></codeline>
<codeline lineno="2752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Properties<sp/>properties:<sp/>the<sp/>MQTT<sp/>v5.0<sp/>properties<sp/>received<sp/>from<sp/>the<sp/>broker.</highlight></codeline>
<codeline lineno="2753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>MQTT<sp/>v3.1<sp/>and<sp/>v3.1.1<sp/>properties<sp/>is<sp/>not<sp/>provided<sp/>and<sp/>an<sp/>empty<sp/>Properties</highlight></codeline>
<codeline lineno="2754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>object<sp/>is<sp/>always<sp/>used.</highlight></codeline>
<codeline lineno="2755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>int<sp/>rc:<sp/>the<sp/>disconnection<sp/>result</highlight></codeline>
<codeline lineno="2756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>rc<sp/>parameter<sp/>indicates<sp/>the<sp/>disconnection<sp/>state.<sp/>If</highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_ERR_SUCCESS<sp/>(0),<sp/>the<sp/>callback<sp/>was<sp/>called<sp/>in<sp/>response<sp/>to</highlight></codeline>
<codeline lineno="2758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>disconnect()<sp/>call.<sp/>If<sp/>any<sp/>other<sp/>value<sp/>the<sp/>disconnection</highlight></codeline>
<codeline lineno="2759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>was<sp/>unexpected,<sp/>such<sp/>as<sp/>might<sp/>be<sp/>caused<sp/>by<sp/>a<sp/>network<sp/>error.</highlight></codeline>
<codeline lineno="2760"><highlight class="normal"></highlight></codeline>
<codeline lineno="2761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.disconnect_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2763"><highlight class="normal"></highlight></codeline>
<codeline lineno="2764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_disconnect</highlight></codeline>
<codeline lineno="2766"><highlight class="normal"></highlight></codeline>
<codeline lineno="2767"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_disconnect.setter</highlight></codeline>
<codeline lineno="2768" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a95a92b1e131fa6aa38c2f7fc2c4ade90" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_disconnect(self,<sp/>func:<sp/>CallbackOnDisconnect<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_disconnect<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2771"><highlight class="normal"></highlight></codeline>
<codeline lineno="2772" refid="classpaho_1_1mqtt_1_1client_1_1_client_1add8b585abc7e3624d6ffe8657f4f8aec" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>disconnect_callback(</highlight></codeline>
<codeline lineno="2773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2774"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnDisconnect],<sp/>CallbackOnDisconnect]:</highlight></codeline>
<codeline lineno="2775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnDisconnect)<sp/>-&gt;<sp/>CallbackOnDisconnect:</highlight></codeline>
<codeline lineno="2776" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4d7994580c7c87e5cab27dfb79278b49" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_disconnect<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2779"><highlight class="normal"></highlight></codeline>
<codeline lineno="2780"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2781" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a04b92c19ef3ac76e21616b9f9b4c10f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_open(self)<sp/>-&gt;<sp/>CallbackOnSocket<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>just<sp/>after<sp/>the<sp/>socket<sp/>was<sp/>opend.</highlight></codeline>
<codeline lineno="2783"><highlight class="normal"></highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>should<sp/>be<sp/>used<sp/>to<sp/>register<sp/>the<sp/>socket<sp/>to<sp/>an<sp/>external<sp/>event<sp/>loop<sp/>for<sp/>reading.</highlight></codeline>
<codeline lineno="2785"><highlight class="normal"></highlight></codeline>
<codeline lineno="2786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>is<sp/>(for<sp/>all<sp/>callback<sp/>API<sp/>version)::</highlight></codeline>
<codeline lineno="2787"><highlight class="normal"></highlight></codeline>
<codeline lineno="2788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket_open_callback(client,<sp/>userdata,<sp/>socket)</highlight></codeline>
<codeline lineno="2789"><highlight class="normal"></highlight></codeline>
<codeline lineno="2790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/><sp/><sp/><sp/><sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/><sp/><sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>SocketLike<sp/>sock:<sp/>the<sp/>socket<sp/>which<sp/>was<sp/>just<sp/>opened.</highlight></codeline>
<codeline lineno="2793"><highlight class="normal"></highlight></codeline>
<codeline lineno="2794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.socket_open_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_socket_open</highlight></codeline>
<codeline lineno="2798"><highlight class="normal"></highlight></codeline>
<codeline lineno="2799"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_socket_open.setter</highlight></codeline>
<codeline lineno="2800" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0c9fdea045745d4c1ca5262802f5c63a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_open(self,<sp/>func:<sp/>CallbackOnSocket<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_open<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2803"><highlight class="normal"></highlight></codeline>
<codeline lineno="2804" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a42c964efe92512cfda165accf05d2f2a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>socket_open_callback(</highlight></codeline>
<codeline lineno="2805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2806"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnSocket],<sp/>CallbackOnSocket]:</highlight></codeline>
<codeline lineno="2807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnSocket)<sp/>-&gt;<sp/>CallbackOnSocket:</highlight></codeline>
<codeline lineno="2808" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a14c21fb5d650ecfcb985e1001f93d36f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_socket_open<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2811"><highlight class="normal"></highlight></codeline>
<codeline lineno="2812" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae667e30c290fc830a80e873a0657d508" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_call_socket_open(self,<sp/>sock:<sp/>SocketLike)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Call<sp/>the<sp/>socket_open<sp/>callback<sp/>with<sp/>the<sp/>just-opened<sp/>socket&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_open<sp/>=<sp/>self.on_socket_open</highlight></codeline>
<codeline lineno="2816"><highlight class="normal"></highlight></codeline>
<codeline lineno="2817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_socket_open:</highlight></codeline>
<codeline lineno="2818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="2819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="2820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_open(self,<sp/>self._userdata,<sp/>sock)</highlight></codeline>
<codeline lineno="2821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="2822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="2823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_socket_open:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="2824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="2825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="2826"><highlight class="normal"></highlight></codeline>
<codeline lineno="2827"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2828" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a549dba27a4052d069fdc83611d5500cc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_close(self)<sp/>-&gt;<sp/>CallbackOnSocket<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>just<sp/>before<sp/>the<sp/>socket<sp/>is<sp/>closed.</highlight></codeline>
<codeline lineno="2830"><highlight class="normal"></highlight></codeline>
<codeline lineno="2831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>should<sp/>be<sp/>used<sp/>to<sp/>unregister<sp/>the<sp/>socket<sp/>from<sp/>an<sp/>external<sp/>event<sp/>loop<sp/>for<sp/>reading.</highlight></codeline>
<codeline lineno="2832"><highlight class="normal"></highlight></codeline>
<codeline lineno="2833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>is<sp/>(for<sp/>all<sp/>callback<sp/>API<sp/>version)::</highlight></codeline>
<codeline lineno="2834"><highlight class="normal"></highlight></codeline>
<codeline lineno="2835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket_close_callback(client,<sp/>userdata,<sp/>socket)</highlight></codeline>
<codeline lineno="2836"><highlight class="normal"></highlight></codeline>
<codeline lineno="2837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>SocketLike<sp/>sock:<sp/>the<sp/>socket<sp/>which<sp/>is<sp/>about<sp/>to<sp/>be<sp/>closed.</highlight></codeline>
<codeline lineno="2840"><highlight class="normal"></highlight></codeline>
<codeline lineno="2841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.socket_close_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_socket_close</highlight></codeline>
<codeline lineno="2845"><highlight class="normal"></highlight></codeline>
<codeline lineno="2846"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_socket_close.setter</highlight></codeline>
<codeline lineno="2847" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae55cb9c5e5caf98d04f301bd1fa343e0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_close(self,<sp/>func:<sp/>CallbackOnSocket<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_close<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2850"><highlight class="normal"></highlight></codeline>
<codeline lineno="2851" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a97ea78cec3e79f1420f2cf8f51d6b6c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>socket_close_callback(</highlight></codeline>
<codeline lineno="2852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2853"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnSocket],<sp/>CallbackOnSocket]:</highlight></codeline>
<codeline lineno="2854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnSocket)<sp/>-&gt;<sp/>CallbackOnSocket:</highlight></codeline>
<codeline lineno="2855" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ad4c3bd86a0c197e2e281d8298fd44094" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_socket_close<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2858"><highlight class="normal"></highlight></codeline>
<codeline lineno="2859" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af0764d207253ea83c19a69663babcb97" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_call_socket_close(self,<sp/>sock:<sp/>SocketLike)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Call<sp/>the<sp/>socket_close<sp/>callback<sp/>with<sp/>the<sp/>about-to-be-closed<sp/>socket&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_close<sp/>=<sp/>self.on_socket_close</highlight></codeline>
<codeline lineno="2863"><highlight class="normal"></highlight></codeline>
<codeline lineno="2864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_socket_close:</highlight></codeline>
<codeline lineno="2865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="2866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="2867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_close(self,<sp/>self._userdata,<sp/>sock)</highlight></codeline>
<codeline lineno="2868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="2869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="2870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_socket_close:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="2871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="2872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="2873"><highlight class="normal"></highlight></codeline>
<codeline lineno="2874"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2875" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a251c82966add86932f67ba5d0fbd62f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_register_write(self)<sp/>-&gt;<sp/>CallbackOnSocket<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>socket<sp/>needs<sp/>writing<sp/>but<sp/>can&apos;t.</highlight></codeline>
<codeline lineno="2877"><highlight class="normal"></highlight></codeline>
<codeline lineno="2878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>should<sp/>be<sp/>used<sp/>to<sp/>register<sp/>the<sp/>socket<sp/>with<sp/>an<sp/>external<sp/>event<sp/>loop<sp/>for<sp/>writing.</highlight></codeline>
<codeline lineno="2879"><highlight class="normal"></highlight></codeline>
<codeline lineno="2880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>is<sp/>(for<sp/>all<sp/>callback<sp/>API<sp/>version)::</highlight></codeline>
<codeline lineno="2881"><highlight class="normal"></highlight></codeline>
<codeline lineno="2882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket_register_write_callback(client,<sp/>userdata,<sp/>socket)</highlight></codeline>
<codeline lineno="2883"><highlight class="normal"></highlight></codeline>
<codeline lineno="2884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>SocketLike<sp/>sock:<sp/>the<sp/>socket<sp/>which<sp/>should<sp/>be<sp/>registered<sp/>for<sp/>writing</highlight></codeline>
<codeline lineno="2887"><highlight class="normal"></highlight></codeline>
<codeline lineno="2888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.socket_register_write_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_socket_register_write</highlight></codeline>
<codeline lineno="2892"><highlight class="normal"></highlight></codeline>
<codeline lineno="2893"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_socket_register_write.setter</highlight></codeline>
<codeline lineno="2894" refid="classpaho_1_1mqtt_1_1client_1_1_client_1add9f570b3b03ee574eec9d8d45ddd9e0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_register_write(self,<sp/>func:<sp/>CallbackOnSocket<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_register_write<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2897"><highlight class="normal"></highlight></codeline>
<codeline lineno="2898" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0c0c3d734793bea3f2879245a9f5337a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>socket_register_write_callback(</highlight></codeline>
<codeline lineno="2899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2900"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnSocket],<sp/>CallbackOnSocket]:</highlight></codeline>
<codeline lineno="2901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnSocket)<sp/>-&gt;<sp/>CallbackOnSocket:</highlight></codeline>
<codeline lineno="2902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_register_write<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2905"><highlight class="normal"></highlight></codeline>
<codeline lineno="2906" refid="classpaho_1_1mqtt_1_1client_1_1_client_1afc9137b17c21fa4b3712215338e29217" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_call_socket_register_write(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Call<sp/>the<sp/>socket_register_write<sp/>callback<sp/>with<sp/>the<sp/>unwritable<sp/>socket&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._sock<sp/>or<sp/>self._registered_write:</highlight></codeline>
<codeline lineno="2909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return</highlight></codeline>
<codeline lineno="2910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._registered_write<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="2911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_register_write<sp/>=<sp/>self.on_socket_register_write</highlight></codeline>
<codeline lineno="2913"><highlight class="normal"></highlight></codeline>
<codeline lineno="2914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_socket_register_write:</highlight></codeline>
<codeline lineno="2915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="2916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_register_write(</highlight></codeline>
<codeline lineno="2917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>self._userdata,<sp/>self._sock)</highlight></codeline>
<codeline lineno="2918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="2919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="2920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_socket_register_write:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="2921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="2922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="2923"><highlight class="normal"></highlight></codeline>
<codeline lineno="2924"><highlight class="normal"><sp/><sp/><sp/><sp/>@property</highlight></codeline>
<codeline lineno="2925" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a79e5b1d0bdf2e71380375536260e0d66" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_unregister_write(</highlight></codeline>
<codeline lineno="2926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2927"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>CallbackOnSocket<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="2928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;The<sp/>callback<sp/>called<sp/>when<sp/>the<sp/>socket<sp/>doesn&apos;t<sp/>need<sp/>writing<sp/>anymore.</highlight></codeline>
<codeline lineno="2929"><highlight class="normal"></highlight></codeline>
<codeline lineno="2930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>should<sp/>be<sp/>used<sp/>to<sp/>unregister<sp/>the<sp/>socket<sp/>from<sp/>an<sp/>external<sp/>event<sp/>loop<sp/>for<sp/>writing.</highlight></codeline>
<codeline lineno="2931"><highlight class="normal"></highlight></codeline>
<codeline lineno="2932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Expected<sp/>signature<sp/>is<sp/>(for<sp/>all<sp/>callback<sp/>API<sp/>version)::</highlight></codeline>
<codeline lineno="2933"><highlight class="normal"></highlight></codeline>
<codeline lineno="2934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket_unregister_write_callback(client,<sp/>userdata,<sp/>socket)</highlight></codeline>
<codeline lineno="2935"><highlight class="normal"></highlight></codeline>
<codeline lineno="2936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>Client<sp/>client:<sp/>the<sp/>client<sp/>instance<sp/>for<sp/>this<sp/>callback</highlight></codeline>
<codeline lineno="2937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>userdata:<sp/>the<sp/>private<sp/>user<sp/>data<sp/>as<sp/>set<sp/>in<sp/>Client()<sp/>or<sp/>user_data_set()</highlight></codeline>
<codeline lineno="2938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>SocketLike<sp/>sock:<sp/>the<sp/>socket<sp/>which<sp/>should<sp/>be<sp/>unregistered<sp/>for<sp/>writing</highlight></codeline>
<codeline lineno="2939"><highlight class="normal"></highlight></codeline>
<codeline lineno="2940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.socket_unregister_write_callback()<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._on_socket_unregister_write</highlight></codeline>
<codeline lineno="2944"><highlight class="normal"></highlight></codeline>
<codeline lineno="2945"><highlight class="normal"><sp/><sp/><sp/><sp/>@on_socket_unregister_write.setter</highlight></codeline>
<codeline lineno="2946" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9f5cd884c60c5a93c4c92ae0f7507986" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>on_socket_unregister_write(</highlight></codeline>
<codeline lineno="2947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>func:<sp/>CallbackOnSocket<sp/>|<sp/>None</highlight></codeline>
<codeline lineno="2948"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_unregister_write<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2951"><highlight class="normal"></highlight></codeline>
<codeline lineno="2952" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6ea9fca42dc038ca7668a23378b43fab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>socket_unregister_write_callback(</highlight></codeline>
<codeline lineno="2953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="2954"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnSocket],<sp/>CallbackOnSocket]:</highlight></codeline>
<codeline lineno="2955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(</highlight></codeline>
<codeline lineno="2956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>func:<sp/>CallbackOnSocket,</highlight></codeline>
<codeline lineno="2957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>CallbackOnSocket:</highlight></codeline>
<codeline lineno="2958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_socket_unregister_write<sp/>=<sp/>func</highlight></codeline>
<codeline lineno="2959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="2960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="2961"><highlight class="normal"></highlight></codeline>
<codeline lineno="2962" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac1afc86e685ad720c4ed2d2e71194e89" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_call_socket_unregister_write(</highlight></codeline>
<codeline lineno="2963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>sock:<sp/>SocketLike<sp/>|<sp/>None<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="2964"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Call<sp/>the<sp/>socket_unregister_write<sp/>callback<sp/>with<sp/>the<sp/>writable<sp/>socket&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock<sp/>=<sp/>sock<sp/>or<sp/>self._sock</highlight></codeline>
<codeline lineno="2967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>sock<sp/>or<sp/>not<sp/>self._registered_write:</highlight></codeline>
<codeline lineno="2968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return</highlight></codeline>
<codeline lineno="2969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._registered_write<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="2970"><highlight class="normal"></highlight></codeline>
<codeline lineno="2971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="2972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_unregister_write<sp/>=<sp/>self.on_socket_unregister_write</highlight></codeline>
<codeline lineno="2973"><highlight class="normal"></highlight></codeline>
<codeline lineno="2974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_socket_unregister_write:</highlight></codeline>
<codeline lineno="2975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="2976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_socket_unregister_write(self,<sp/>self._userdata,<sp/>sock)</highlight></codeline>
<codeline lineno="2977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="2978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="2979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_socket_unregister_write:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="2980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="2981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="2982"><highlight class="normal"></highlight></codeline>
<codeline lineno="2983" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a253426d9ccf28465067f0abe871df05b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>message_callback_add(self,<sp/>sub:<sp/>str,<sp/>callback:<sp/>CallbackOnMessage)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="2984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Register<sp/>a<sp/>message<sp/>callback<sp/>for<sp/>a<sp/>specific<sp/>topic.</highlight></codeline>
<codeline lineno="2985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Messages<sp/>that<sp/>match<sp/>&apos;sub&apos;<sp/>will<sp/>be<sp/>passed<sp/>to<sp/>&apos;callback&apos;.<sp/>Any</highlight></codeline>
<codeline lineno="2986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>non-matching<sp/>messages<sp/>will<sp/>be<sp/>passed<sp/>to<sp/>the<sp/>default<sp/>`on_message`</highlight></codeline>
<codeline lineno="2987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callback.</highlight></codeline>
<codeline lineno="2988"><highlight class="normal"></highlight></codeline>
<codeline lineno="2989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Call<sp/>multiple<sp/>times<sp/>with<sp/>different<sp/>&apos;sub&apos;<sp/>to<sp/>define<sp/>multiple<sp/>topic</highlight></codeline>
<codeline lineno="2990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specific<sp/>callbacks.</highlight></codeline>
<codeline lineno="2991"><highlight class="normal"></highlight></codeline>
<codeline lineno="2992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Topic<sp/>specific<sp/>callbacks<sp/>may<sp/>be<sp/>removed<sp/>with</highlight></codeline>
<codeline lineno="2993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`message_callback_remove()`.</highlight></codeline>
<codeline lineno="2994"><highlight class="normal"></highlight></codeline>
<codeline lineno="2995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>See<sp/>`on_message`<sp/>for<sp/>the<sp/>expected<sp/>signature<sp/>of<sp/>the<sp/>callback.</highlight></codeline>
<codeline lineno="2996"><highlight class="normal"></highlight></codeline>
<codeline lineno="2997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decorator:<sp/>@client.topic_callback(sub)<sp/>(``client``<sp/>is<sp/>the<sp/>name<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>which<sp/>this<sp/>callback<sp/>is<sp/>being<sp/>attached<sp/>to)</highlight></codeline>
<codeline lineno="2999"><highlight class="normal"></highlight></codeline>
<codeline lineno="3000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example::</highlight></codeline>
<codeline lineno="3001"><highlight class="normal"></highlight></codeline>
<codeline lineno="3002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@client.topic_callback(&quot;mytopic/#&quot;)</highlight></codeline>
<codeline lineno="3003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>handle_mytopic(client,<sp/>userdata,<sp/>message):</highlight></codeline>
<codeline lineno="3004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline lineno="3005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>callback<sp/>is<sp/>None<sp/>or<sp/>sub<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;sub<sp/>and<sp/>callback<sp/>must<sp/>both<sp/>be<sp/>defined.&quot;)</highlight></codeline>
<codeline lineno="3008"><highlight class="normal"></highlight></codeline>
<codeline lineno="3009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="3010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._on_message_filtered[sub]<sp/>=<sp/>callback</highlight></codeline>
<codeline lineno="3011"><highlight class="normal"></highlight></codeline>
<codeline lineno="3012" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a04feb430ee1f099e39ebb3cf902f5c49" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>topic_callback(</highlight></codeline>
<codeline lineno="3013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>sub:<sp/>str</highlight></codeline>
<codeline lineno="3014"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Callable[[CallbackOnMessage],<sp/>CallbackOnMessage]:</highlight></codeline>
<codeline lineno="3015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>decorator(func:<sp/>CallbackOnMessage)<sp/>-&gt;<sp/>CallbackOnMessage:</highlight></codeline>
<codeline lineno="3016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.message_callback_add(sub,<sp/>func)</highlight></codeline>
<codeline lineno="3017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>func</highlight></codeline>
<codeline lineno="3018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>decorator</highlight></codeline>
<codeline lineno="3019"><highlight class="normal"></highlight></codeline>
<codeline lineno="3020" refid="classpaho_1_1mqtt_1_1client_1_1_client_1acbe2606369eca188fb224335f77b4bf1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>message_callback_remove(self,<sp/>sub:<sp/>str)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Remove<sp/>a<sp/>message<sp/>callback<sp/>previously<sp/>registered<sp/>with</highlight></codeline>
<codeline lineno="3022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`message_callback_add()`.&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>sub<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;sub<sp/>must<sp/>defined.&quot;)</highlight></codeline>
<codeline lineno="3025"><highlight class="normal"></highlight></codeline>
<codeline lineno="3026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="3027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>self._on_message_filtered[sub]</highlight></codeline>
<codeline lineno="3029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>KeyError:<sp/><sp/>#<sp/>no<sp/>such<sp/>subscription</highlight></codeline>
<codeline lineno="3030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pass</highlight></codeline>
<codeline lineno="3031"><highlight class="normal"></highlight></codeline>
<codeline lineno="3032"><highlight class="normal"><sp/><sp/><sp/><sp/>#<sp/>============================================================</highlight></codeline>
<codeline lineno="3033"><highlight class="normal"><sp/><sp/><sp/><sp/>#<sp/>Private<sp/>functions</highlight></codeline>
<codeline lineno="3034"><highlight class="normal"><sp/><sp/><sp/><sp/>#<sp/>============================================================</highlight></codeline>
<codeline lineno="3035"><highlight class="normal"></highlight></codeline>
<codeline lineno="3036" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a06921176dc7a2126f1fee720fd7c6cce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_loop_rc_handle(</highlight></codeline>
<codeline lineno="3037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc:<sp/>MQTTErrorCode,</highlight></codeline>
<codeline lineno="3039"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc:</highlight></codeline>
<codeline lineno="3041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="3042"><highlight class="normal"></highlight></codeline>
<codeline lineno="3043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED):</highlight></codeline>
<codeline lineno="3044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_DISCONNECTED</highlight></codeline>
<codeline lineno="3045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3046"><highlight class="normal"></highlight></codeline>
<codeline lineno="3047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._do_on_disconnect(packet_from_broker=False,<sp/>v1_rc=rc)</highlight></codeline>
<codeline lineno="3048"><highlight class="normal"></highlight></codeline>
<codeline lineno="3049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>==<sp/>MQTT_ERR_CONN_LOST:</highlight></codeline>
<codeline lineno="3050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_CONNECTION_LOST</highlight></codeline>
<codeline lineno="3051"><highlight class="normal"></highlight></codeline>
<codeline lineno="3052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="3053"><highlight class="normal"></highlight></codeline>
<codeline lineno="3054" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a73f6d56365da19c65942d047a601e9fa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_packet_read(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>This<sp/>gets<sp/>called<sp/>if<sp/>pselect()<sp/>indicates<sp/>that<sp/>there<sp/>is<sp/>network<sp/>data</highlight></codeline>
<codeline lineno="3056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>available<sp/>-<sp/>ie.<sp/>at<sp/>least<sp/>one<sp/>byte.<sp/><sp/>What<sp/>we<sp/>do<sp/>depends<sp/>on<sp/>what<sp/>data<sp/>we</highlight></codeline>
<codeline lineno="3057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>already<sp/>have.</highlight></codeline>
<codeline lineno="3058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>we&apos;ve<sp/>not<sp/>got<sp/>a<sp/>command,<sp/>attempt<sp/>to<sp/>read<sp/>one<sp/>and<sp/>save<sp/>it.<sp/>This<sp/>should</highlight></codeline>
<codeline lineno="3059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>always<sp/>work<sp/>because<sp/>it&apos;s<sp/>only<sp/>a<sp/>single<sp/>byte.</highlight></codeline>
<codeline lineno="3060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Then<sp/>try<sp/>to<sp/>read<sp/>the<sp/>remaining<sp/>length.<sp/>This<sp/>may<sp/>fail<sp/>because<sp/>it<sp/>is<sp/>may</highlight></codeline>
<codeline lineno="3061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>be<sp/>more<sp/>than<sp/>one<sp/>byte<sp/>-<sp/>will<sp/>need<sp/>to<sp/>save<sp/>data<sp/>pending<sp/>next<sp/>read<sp/>if<sp/>it</highlight></codeline>
<codeline lineno="3062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>does<sp/>fail.</highlight></codeline>
<codeline lineno="3063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Then<sp/>try<sp/>to<sp/>read<sp/>the<sp/>remaining<sp/>payload,<sp/>where<sp/>&apos;payload&apos;<sp/>here<sp/>means<sp/>the</highlight></codeline>
<codeline lineno="3064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>combined<sp/>variable<sp/>header<sp/>and<sp/>actual<sp/>payload.<sp/>This<sp/>is<sp/>the<sp/>most<sp/>likely<sp/>to</highlight></codeline>
<codeline lineno="3065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>fail<sp/>due<sp/>to<sp/>longer<sp/>length,<sp/>so<sp/>save<sp/>current<sp/>data<sp/>and<sp/>current<sp/>position.</highlight></codeline>
<codeline lineno="3066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>After<sp/>all<sp/>data<sp/>is<sp/>read,<sp/>send<sp/>to<sp/>_mqtt_handle_packet()<sp/>to<sp/>deal<sp/>with.</highlight></codeline>
<codeline lineno="3067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Finally,<sp/>free<sp/>the<sp/>memory<sp/>and<sp/>reset<sp/>everything<sp/>to<sp/>starting<sp/>conditions.</highlight></codeline>
<codeline lineno="3068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;command&apos;]<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>self._sock_recv(1)</highlight></codeline>
<codeline lineno="3071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>BlockingIOError:</highlight></codeline>
<codeline lineno="3072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_AGAIN</highlight></codeline>
<codeline lineno="3073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>TimeoutError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="3074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;timeout<sp/>on<sp/>socket:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="3076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>OSError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="3078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;failed<sp/>to<sp/>receive<sp/>on<sp/>socket:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="3080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(command)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;command&apos;]<sp/>=<sp/>command[0]</highlight></codeline>
<codeline lineno="3085"><highlight class="normal"></highlight></codeline>
<codeline lineno="3086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;have_remaining&apos;]<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Read<sp/>remaining</highlight></codeline>
<codeline lineno="3088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Algorithm<sp/>for<sp/>decoding<sp/>taken<sp/>from<sp/>pseudo<sp/>code<sp/>at</highlight></codeline>
<codeline lineno="3089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>http://publib.boulder.ibm.com/infocenter/wmbhelp/v6r0m0/topic/com.ibm.etools.mft.doc/ac10870_.htm</highlight></codeline>
<codeline lineno="3090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>True:</highlight></codeline>
<codeline lineno="3091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte<sp/>=<sp/>self._sock_recv(1)</highlight></codeline>
<codeline lineno="3093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>BlockingIOError:</highlight></codeline>
<codeline lineno="3094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_AGAIN</highlight></codeline>
<codeline lineno="3095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>OSError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="3096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;failed<sp/>to<sp/>receive<sp/>on<sp/>socket:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="3098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(byte)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte_value<sp/>=<sp/>byte[0]</highlight></codeline>
<codeline lineno="3103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;remaining_count&apos;].append(byte_value)</highlight></codeline>
<codeline lineno="3104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Max<sp/>4<sp/>bytes<sp/>length<sp/>for<sp/>remaining<sp/>length<sp/>as<sp/>defined<sp/>by<sp/>protocol.</highlight></codeline>
<codeline lineno="3105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Anything<sp/>more<sp/>likely<sp/>means<sp/>a<sp/>broken/malicious<sp/>client.</highlight></codeline>
<codeline lineno="3106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(self._in_packet[&apos;remaining_count&apos;])<sp/>&gt;<sp/>4:</highlight></codeline>
<codeline lineno="3107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3108"><highlight class="normal"></highlight></codeline>
<codeline lineno="3109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>+=<sp/>(</highlight></codeline>
<codeline lineno="3110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte_value<sp/>&amp;<sp/>127)<sp/>*<sp/>self._in_packet[&apos;remaining_mult&apos;]</highlight></codeline>
<codeline lineno="3111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;remaining_mult&apos;]<sp/>=<sp/>self._in_packet[&apos;remaining_mult&apos;]<sp/>*<sp/>128</highlight></codeline>
<codeline lineno="3112"><highlight class="normal"></highlight></codeline>
<codeline lineno="3113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(byte_value<sp/>&amp;<sp/>128)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break</highlight></codeline>
<codeline lineno="3115"><highlight class="normal"></highlight></codeline>
<codeline lineno="3116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;have_remaining&apos;]<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="3117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;to_process&apos;]<sp/>=<sp/>self._in_packet[&apos;remaining_length&apos;]</highlight></codeline>
<codeline lineno="3118"><highlight class="normal"></highlight></codeline>
<codeline lineno="3119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>100<sp/>#<sp/>Don&apos;t<sp/>get<sp/>stuck<sp/>in<sp/>this<sp/>loop<sp/>if<sp/>we<sp/>have<sp/>a<sp/>huge<sp/>message.</highlight></codeline>
<codeline lineno="3120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>self._in_packet[&apos;to_process&apos;]<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="3121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self._sock_recv(self._in_packet[&apos;to_process&apos;])</highlight></codeline>
<codeline lineno="3123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>BlockingIOError:</highlight></codeline>
<codeline lineno="3124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_AGAIN</highlight></codeline>
<codeline lineno="3125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>OSError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="3126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;failed<sp/>to<sp/>receive<sp/>on<sp/>socket:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="3128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(data)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;to_process&apos;]<sp/>-=<sp/>len(data)</highlight></codeline>
<codeline lineno="3133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;packet&apos;]<sp/>+=<sp/>data</highlight></codeline>
<codeline lineno="3134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="3135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>count<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._msgtime_mutex:</highlight></codeline>
<codeline lineno="3137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_in<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="3138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_AGAIN</highlight></codeline>
<codeline lineno="3139"><highlight class="normal"></highlight></codeline>
<codeline lineno="3140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>All<sp/>data<sp/>for<sp/>this<sp/>packet<sp/>is<sp/>read.</highlight></codeline>
<codeline lineno="3141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;pos&apos;]<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._packet_handle()</highlight></codeline>
<codeline lineno="3143"><highlight class="normal"></highlight></codeline>
<codeline lineno="3144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Free<sp/>data<sp/>and<sp/>reset<sp/>values</highlight></codeline>
<codeline lineno="3145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="3146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;command&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="3147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;have_remaining&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="3148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_count&quot;:<sp/>[],</highlight></codeline>
<codeline lineno="3149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_mult&quot;:<sp/>1,</highlight></codeline>
<codeline lineno="3150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;remaining_length&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="3151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;packet&quot;:<sp/>bytearray(b&quot;&quot;),</highlight></codeline>
<codeline lineno="3152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;to_process&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="3153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;pos&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="3154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3155"><highlight class="normal"></highlight></codeline>
<codeline lineno="3156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._msgtime_mutex:</highlight></codeline>
<codeline lineno="3157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_in<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="3158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="3159"><highlight class="normal"></highlight></codeline>
<codeline lineno="3160" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a879061d91d67ed72de6f7c20c91009e4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_packet_write(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>True:</highlight></codeline>
<codeline lineno="3162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>self._out_packet.popleft()</highlight></codeline>
<codeline lineno="3164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>IndexError:</highlight></codeline>
<codeline lineno="3165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3166"><highlight class="normal"></highlight></codeline>
<codeline lineno="3167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_length<sp/>=<sp/>self._sock_send(</highlight></codeline>
<codeline lineno="3169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet[&apos;packet&apos;][packet[&apos;pos&apos;]:])</highlight></codeline>
<codeline lineno="3170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>(AttributeError,<sp/>ValueError):</highlight></codeline>
<codeline lineno="3171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_packet.appendleft(packet)</highlight></codeline>
<codeline lineno="3172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>BlockingIOError:</highlight></codeline>
<codeline lineno="3174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_packet.appendleft(packet)</highlight></codeline>
<codeline lineno="3175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_AGAIN</highlight></codeline>
<codeline lineno="3176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>OSError<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="3177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_packet.appendleft(packet)</highlight></codeline>
<codeline lineno="3178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;failed<sp/>to<sp/>receive<sp/>on<sp/>socket:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="3180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_LOST</highlight></codeline>
<codeline lineno="3181"><highlight class="normal"></highlight></codeline>
<codeline lineno="3182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>write_length<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="3183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet[&apos;to_process&apos;]<sp/>-=<sp/>write_length</highlight></codeline>
<codeline lineno="3184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet[&apos;pos&apos;]<sp/>+=<sp/>write_length</highlight></codeline>
<codeline lineno="3185"><highlight class="normal"></highlight></codeline>
<codeline lineno="3186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>packet[&apos;to_process&apos;]<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(packet[&apos;command&apos;]<sp/>&amp;<sp/>0xF0)<sp/>==<sp/>PUBLISH<sp/>and<sp/>packet[&apos;qos&apos;]<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="3189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish<sp/>=<sp/>self.on_publish</highlight></codeline>
<codeline lineno="3190"><highlight class="normal"></highlight></codeline>
<codeline lineno="3191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_publish:</highlight></codeline>
<codeline lineno="3192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="3193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION1:</highlight></codeline>
<codeline lineno="3195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish<sp/>=<sp/>cast(CallbackOnPublish_v1,<sp/>on_publish)</highlight></codeline>
<codeline lineno="3196"><highlight class="normal"></highlight></codeline>
<codeline lineno="3197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish(self,<sp/>self._userdata,<sp/>packet[&quot;mid&quot;])</highlight></codeline>
<codeline lineno="3198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION2:</highlight></codeline>
<codeline lineno="3199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish<sp/>=<sp/>cast(CallbackOnPublish_v2,<sp/>on_publish)</highlight></codeline>
<codeline lineno="3200"><highlight class="normal"></highlight></codeline>
<codeline lineno="3201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish(</highlight></codeline>
<codeline lineno="3202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata,</highlight></codeline>
<codeline lineno="3204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet[&quot;mid&quot;],</highlight></codeline>
<codeline lineno="3205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReasonCode(PacketTypes.PUBACK),</highlight></codeline>
<codeline lineno="3206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Properties(PacketTypes.PUBACK),</highlight></codeline>
<codeline lineno="3207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;Unsupported<sp/>callback<sp/>API<sp/>version&quot;)</highlight></codeline>
<codeline lineno="3210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="3211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_publish:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="3213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="3214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="3215"><highlight class="normal"></highlight></codeline>
<codeline lineno="3216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>TODO:<sp/>Something<sp/>is<sp/>odd<sp/>here.<sp/>I<sp/>don&apos;t<sp/>see<sp/>why<sp/>packet[&quot;info&quot;]<sp/>can&apos;t<sp/>be<sp/>None.</highlight></codeline>
<codeline lineno="3217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>A<sp/>packet<sp/>could<sp/>be<sp/>produced<sp/>by<sp/>_handle_connack<sp/>with<sp/>qos=0<sp/>and<sp/>no<sp/>info</highlight></codeline>
<codeline lineno="3218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>(around<sp/>line<sp/>3645).<sp/>Ignore<sp/>the<sp/>mypy<sp/>check<sp/>for<sp/>now<sp/>but<sp/>I<sp/>feel<sp/>there<sp/>is<sp/>a<sp/>bug</highlight></codeline>
<codeline lineno="3219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>somewhere.</highlight></codeline>
<codeline lineno="3220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet[&apos;info&apos;]._set_as_published()<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="3221"><highlight class="normal"></highlight></codeline>
<codeline lineno="3222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(packet[&apos;command&apos;]<sp/>&amp;<sp/>0xF0)<sp/>==<sp/>DISCONNECT:</highlight></codeline>
<codeline lineno="3223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._msgtime_mutex:</highlight></codeline>
<codeline lineno="3224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_out<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="3225"><highlight class="normal"></highlight></codeline>
<codeline lineno="3226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._do_on_disconnect(</highlight></codeline>
<codeline lineno="3227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_from_broker=False,</highlight></codeline>
<codeline lineno="3228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v1_rc=MQTTErrorCode.MQTT_ERR_SUCCESS,</highlight></codeline>
<codeline lineno="3229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="3231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Only<sp/>change<sp/>to<sp/>disconnected<sp/>if<sp/>the<sp/>disconnection<sp/>was<sp/>wanted</highlight></codeline>
<codeline lineno="3232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>by<sp/>the<sp/>client<sp/>(==<sp/>state<sp/>was<sp/>disconnecting).<sp/>If<sp/>the<sp/>broker<sp/>disconnected</highlight></codeline>
<codeline lineno="3233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>use<sp/>unilaterally<sp/>don&apos;t<sp/>change<sp/>the<sp/>state<sp/>and<sp/>client<sp/>may<sp/>reconnect.</highlight></codeline>
<codeline lineno="3234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>==<sp/>_ConnectionState.MQTT_CS_DISCONNECTING:</highlight></codeline>
<codeline lineno="3235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_DISCONNECTED</highlight></codeline>
<codeline lineno="3236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3237"><highlight class="normal"></highlight></codeline>
<codeline lineno="3238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>We<sp/>haven&apos;t<sp/>finished<sp/>with<sp/>this<sp/>packet</highlight></codeline>
<codeline lineno="3240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_packet.appendleft(packet)</highlight></codeline>
<codeline lineno="3241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break</highlight></codeline>
<codeline lineno="3243"><highlight class="normal"></highlight></codeline>
<codeline lineno="3244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._msgtime_mutex:</highlight></codeline>
<codeline lineno="3245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_out<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="3246"><highlight class="normal"></highlight></codeline>
<codeline lineno="3247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3248"><highlight class="normal"></highlight></codeline>
<codeline lineno="3249" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6f526542ab51aad5a2cbe47a4f829b15" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_easy_log(self,<sp/>level:<sp/>LogLevel,<sp/>fmt:<sp/>str,<sp/>*args:<sp/>Any)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self.on_log<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>=<sp/>fmt<sp/>%<sp/>args</highlight></codeline>
<codeline lineno="3252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.on_log(self,<sp/>self._userdata,<sp/>level,<sp/>buf)</highlight></codeline>
<codeline lineno="3254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception:<sp/><sp/>#<sp/>noqa:<sp/>S110</highlight></codeline>
<codeline lineno="3255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Can&apos;t<sp/>_easy_log<sp/>this,<sp/>as<sp/>we&apos;ll<sp/>recurse<sp/>until<sp/>we<sp/>break</highlight></codeline>
<codeline lineno="3256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pass<sp/><sp/>#<sp/>self._logger<sp/>will<sp/>pick<sp/>this<sp/>up,<sp/>so<sp/>we&apos;re<sp/>fine</highlight></codeline>
<codeline lineno="3257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._logger<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level_std<sp/>=<sp/>LOGGING_LEVEL[level]</highlight></codeline>
<codeline lineno="3259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._logger.log(level_std,<sp/>fmt,<sp/>*args)</highlight></codeline>
<codeline lineno="3260"><highlight class="normal"></highlight></codeline>
<codeline lineno="3261" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a32783102fe963941edd8d2ffb8c79738" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_check_keepalive(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._keepalive<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return</highlight></codeline>
<codeline lineno="3264"><highlight class="normal"></highlight></codeline>
<codeline lineno="3265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>now<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="3266"><highlight class="normal"></highlight></codeline>
<codeline lineno="3267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._msgtime_mutex:</highlight></codeline>
<codeline lineno="3268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last_msg_out<sp/>=<sp/>self._last_msg_out</highlight></codeline>
<codeline lineno="3269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last_msg_in<sp/>=<sp/>self._last_msg_in</highlight></codeline>
<codeline lineno="3270"><highlight class="normal"></highlight></codeline>
<codeline lineno="3271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>not<sp/>None<sp/>and<sp/>(now<sp/>-<sp/>last_msg_out<sp/>&gt;=<sp/>self._keepalive<sp/>or<sp/>now<sp/>-<sp/>last_msg_in<sp/>&gt;=<sp/>self._keepalive):</highlight></codeline>
<codeline lineno="3272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>==<sp/>_ConnectionState.MQTT_CS_CONNECTED<sp/>and<sp/>self._ping_t<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._send_pingreq()</highlight></codeline>
<codeline lineno="3275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception:</highlight></codeline>
<codeline lineno="3276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="3277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._do_on_disconnect(</highlight></codeline>
<codeline lineno="3278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_from_broker=False,</highlight></codeline>
<codeline lineno="3279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v1_rc=MQTTErrorCode.MQTT_ERR_CONN_LOST,</highlight></codeline>
<codeline lineno="3280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._msgtime_mutex:</highlight></codeline>
<codeline lineno="3283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_out<sp/>=<sp/>now</highlight></codeline>
<codeline lineno="3284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_msg_in<sp/>=<sp/>now</highlight></codeline>
<codeline lineno="3285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="3287"><highlight class="normal"></highlight></codeline>
<codeline lineno="3288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._state<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED):</highlight></codeline>
<codeline lineno="3289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_DISCONNECTED</highlight></codeline>
<codeline lineno="3290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_KEEPALIVE</highlight></codeline>
<codeline lineno="3293"><highlight class="normal"></highlight></codeline>
<codeline lineno="3294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._do_on_disconnect(</highlight></codeline>
<codeline lineno="3295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_from_broker=False,</highlight></codeline>
<codeline lineno="3296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v1_rc=rc,</highlight></codeline>
<codeline lineno="3297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3298"><highlight class="normal"></highlight></codeline>
<codeline lineno="3299" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a89d85dd5a58ef7d5b7f7cc6b1cd75846" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_mid_generate(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="3300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._mid_generate_mutex:</highlight></codeline>
<codeline lineno="3301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_mid<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._last_mid<sp/>==<sp/>65536:</highlight></codeline>
<codeline lineno="3303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._last_mid<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="3304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._last_mid</highlight></codeline>
<codeline lineno="3305"><highlight class="normal"></highlight></codeline>
<codeline lineno="3306"><highlight class="normal"><sp/><sp/><sp/><sp/>@staticmethod</highlight></codeline>
<codeline lineno="3307" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a2c6ad583e35c4b1f3eaf3f6e67ab5377" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_raise_for_invalid_topic(topic:<sp/>bytes)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;<sp/>Check<sp/>if<sp/>the<sp/>topic<sp/>is<sp/>a<sp/>topic<sp/>without<sp/>wildcard<sp/>and<sp/>valid<sp/>length.</highlight></codeline>
<codeline lineno="3309"><highlight class="normal"></highlight></codeline>
<codeline lineno="3310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Raise<sp/>ValueError<sp/>if<sp/>the<sp/>topic<sp/>isn&apos;t<sp/>valid.</highlight></codeline>
<codeline lineno="3311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>b&apos;+&apos;<sp/>in<sp/>topic<sp/>or<sp/>b&apos;#&apos;<sp/>in<sp/>topic:</highlight></codeline>
<codeline lineno="3313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Publish<sp/>topic<sp/>cannot<sp/>contain<sp/>wildcards.&apos;)</highlight></codeline>
<codeline lineno="3314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(topic)<sp/>&gt;<sp/>65535:</highlight></codeline>
<codeline lineno="3315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&apos;Publish<sp/>topic<sp/>is<sp/>too<sp/>long.&apos;)</highlight></codeline>
<codeline lineno="3316"><highlight class="normal"></highlight></codeline>
<codeline lineno="3317"><highlight class="normal"><sp/><sp/><sp/><sp/>@staticmethod</highlight></codeline>
<codeline lineno="3318" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0060bd42ac7d2822e311d9dd736a0386" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_filter_wildcard_len_check(sub:<sp/>bytes)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(len(sub)<sp/>==<sp/>0<sp/>or<sp/>len(sub)<sp/>&gt;<sp/>65535</highlight></codeline>
<codeline lineno="3320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>any(b&apos;+&apos;<sp/>in<sp/>p<sp/>or<sp/>b&apos;#&apos;<sp/>in<sp/>p<sp/>for<sp/>p<sp/>in<sp/>sub.split(b&apos;/&apos;)<sp/>if<sp/>len(p)<sp/>&gt;<sp/>1)</highlight></codeline>
<codeline lineno="3321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>b&apos;#/&apos;<sp/>in<sp/>sub):</highlight></codeline>
<codeline lineno="3322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_INVAL</highlight></codeline>
<codeline lineno="3323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3325"><highlight class="normal"></highlight></codeline>
<codeline lineno="3326" refid="classpaho_1_1mqtt_1_1client_1_1_client_1adb57aebbc300f4e1d879d94a7b8621e8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_pingreq(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>PINGREQ&quot;)</highlight></codeline>
<codeline lineno="3328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_simple_command(PINGREQ)</highlight></codeline>
<codeline lineno="3329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>==<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="3330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ping_t<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="3331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="3332"><highlight class="normal"></highlight></codeline>
<codeline lineno="3333" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a258d19fbc30186a07e2c8eba714a0015" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_pingresp(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>PINGRESP&quot;)</highlight></codeline>
<codeline lineno="3335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_simple_command(PINGRESP)</highlight></codeline>
<codeline lineno="3336"><highlight class="normal"></highlight></codeline>
<codeline lineno="3337" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a3a0122fc55e9cff345874fca3f2ba8fa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_puback(self,<sp/>mid:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>PUBACK<sp/>(Mid:<sp/>%d)&quot;,<sp/>mid)</highlight></codeline>
<codeline lineno="3339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_command_with_mid(PUBACK,<sp/>mid,<sp/>False)</highlight></codeline>
<codeline lineno="3340"><highlight class="normal"></highlight></codeline>
<codeline lineno="3341" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a385e151d64692ebf2930071e2a6be974" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_pubcomp(self,<sp/>mid:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>PUBCOMP<sp/>(Mid:<sp/>%d)&quot;,<sp/>mid)</highlight></codeline>
<codeline lineno="3343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_command_with_mid(PUBCOMP,<sp/>mid,<sp/>False)</highlight></codeline>
<codeline lineno="3344"><highlight class="normal"></highlight></codeline>
<codeline lineno="3345" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa54ac1bc4810c705acaff567f8a59bea" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_pack_remaining_length(</highlight></codeline>
<codeline lineno="3346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>packet:<sp/>bytearray,<sp/>remaining_length:<sp/>int</highlight></codeline>
<codeline lineno="3347"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>bytearray:</highlight></codeline>
<codeline lineno="3348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_bytes<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="3349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>True:</highlight></codeline>
<codeline lineno="3350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte<sp/>=<sp/>remaining_length<sp/>%<sp/>128</highlight></codeline>
<codeline lineno="3351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>remaining_length<sp/>//<sp/>128</highlight></codeline>
<codeline lineno="3352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>there<sp/>are<sp/>more<sp/>digits<sp/>to<sp/>encode,<sp/>set<sp/>the<sp/>top<sp/>bit<sp/>of<sp/>this<sp/>digit</highlight></codeline>
<codeline lineno="3353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>remaining_length<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="3354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte<sp/>|=<sp/>0x80</highlight></codeline>
<codeline lineno="3355"><highlight class="normal"></highlight></codeline>
<codeline lineno="3356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_bytes.append(byte)</highlight></codeline>
<codeline lineno="3357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.append(byte)</highlight></codeline>
<codeline lineno="3358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>remaining_length<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>FIXME<sp/>-<sp/>this<sp/>doesn&apos;t<sp/>deal<sp/>with<sp/>incorrectly<sp/>large<sp/>payloads</highlight></codeline>
<codeline lineno="3360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>packet</highlight></codeline>
<codeline lineno="3361"><highlight class="normal"></highlight></codeline>
<codeline lineno="3362" refid="classpaho_1_1mqtt_1_1client_1_1_client_1abffffbf56452e97b4ca0eff5cc8f0f26" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_pack_str16(self,<sp/>packet:<sp/>bytearray,<sp/>data:<sp/>bytes<sp/>|<sp/>str)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>_force_bytes(data)</highlight></codeline>
<codeline lineno="3364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(struct.pack(&quot;!H&quot;,<sp/>len(data)))</highlight></codeline>
<codeline lineno="3365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(data)</highlight></codeline>
<codeline lineno="3366"><highlight class="normal"></highlight></codeline>
<codeline lineno="3367" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aa7a22d4b71af7b30aa1bca1c7e95aa49" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_publish(</highlight></codeline>
<codeline lineno="3368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid:<sp/>int,</highlight></codeline>
<codeline lineno="3370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic:<sp/>bytes,</highlight></codeline>
<codeline lineno="3371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload:<sp/>bytes|bytearray<sp/>=<sp/>b&quot;&quot;,</highlight></codeline>
<codeline lineno="3372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qos:<sp/>int<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="3373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retain:<sp/>bool<sp/>=<sp/>False,</highlight></codeline>
<codeline lineno="3374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup:<sp/>bool<sp/>=<sp/>False,</highlight></codeline>
<codeline lineno="3375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info:<sp/>MQTTMessageInfo<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="3376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="3377"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>we<sp/>assume<sp/>that<sp/>topic<sp/>and<sp/>payload<sp/>are<sp/>already<sp/>properly<sp/>encoded</highlight></codeline>
<codeline lineno="3379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>isinstance(topic,<sp/>bytes):</highlight></codeline>
<codeline lineno="3380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>TypeError(&apos;topic<sp/>must<sp/>be<sp/>bytes,<sp/>not<sp/>str&apos;)</highlight></codeline>
<codeline lineno="3381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>payload<sp/>and<sp/>not<sp/>isinstance(payload,<sp/>(bytes,<sp/>bytearray)):</highlight></codeline>
<codeline lineno="3382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>TypeError(&apos;payload<sp/>must<sp/>be<sp/>bytes<sp/>if<sp/>set&apos;)</highlight></codeline>
<codeline lineno="3383"><highlight class="normal"></highlight></codeline>
<codeline lineno="3384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sock<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_NO_CONN</highlight></codeline>
<codeline lineno="3386"><highlight class="normal"></highlight></codeline>
<codeline lineno="3387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>PUBLISH<sp/>|<sp/>((dup<sp/>&amp;<sp/>0x1)<sp/>&lt;&lt;<sp/>3)<sp/>|<sp/>(qos<sp/>&lt;&lt;<sp/>1)<sp/>|<sp/>retain</highlight></codeline>
<codeline lineno="3388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="3389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.append(command)</highlight></codeline>
<codeline lineno="3390"><highlight class="normal"></highlight></codeline>
<codeline lineno="3391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payloadlen<sp/>=<sp/>len(payload)</highlight></codeline>
<codeline lineno="3392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>2<sp/>+<sp/>len(topic)<sp/>+<sp/>payloadlen</highlight></codeline>
<codeline lineno="3393"><highlight class="normal"></highlight></codeline>
<codeline lineno="3394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>payloadlen<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>PUBLISH<sp/>(d%d,<sp/>q%d,<sp/>r%d,<sp/>m%d),<sp/>&apos;%s&apos;,<sp/>properties=%s<sp/>(NULL<sp/>payload)&quot;,</highlight></codeline>
<codeline lineno="3399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup,<sp/>qos,<sp/>retain,<sp/>mid,<sp/>topic,<sp/>properties</highlight></codeline>
<codeline lineno="3400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>PUBLISH<sp/>(d%d,<sp/>q%d,<sp/>r%d,<sp/>m%d),<sp/>&apos;%s&apos;<sp/>(NULL<sp/>payload)&quot;,</highlight></codeline>
<codeline lineno="3405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup,<sp/>qos,<sp/>retain,<sp/>mid,<sp/>topic</highlight></codeline>
<codeline lineno="3406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>PUBLISH<sp/>(d%d,<sp/>q%d,<sp/>r%d,<sp/>m%d),<sp/>&apos;%s&apos;,<sp/>properties=%s,<sp/>...<sp/>(%d<sp/>bytes)&quot;,</highlight></codeline>
<codeline lineno="3412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup,<sp/>qos,<sp/>retain,<sp/>mid,<sp/>topic,<sp/>properties,<sp/>payloadlen</highlight></codeline>
<codeline lineno="3413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>PUBLISH<sp/>(d%d,<sp/>q%d,<sp/>r%d,<sp/>m%d),<sp/>&apos;%s&apos;,<sp/>...<sp/>(%d<sp/>bytes)&quot;,</highlight></codeline>
<codeline lineno="3418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup,<sp/>qos,<sp/>retain,<sp/>mid,<sp/>topic,<sp/>payloadlen</highlight></codeline>
<codeline lineno="3419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3420"><highlight class="normal"></highlight></codeline>
<codeline lineno="3421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="3422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>For<sp/>message<sp/>id</highlight></codeline>
<codeline lineno="3423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>2</highlight></codeline>
<codeline lineno="3424"><highlight class="normal"></highlight></codeline>
<codeline lineno="3425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_properties<sp/>=<sp/>b&apos;\x00&apos;</highlight></codeline>
<codeline lineno="3428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_properties<sp/>=<sp/>properties.pack()</highlight></codeline>
<codeline lineno="3430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>len(packed_properties)</highlight></codeline>
<codeline lineno="3431"><highlight class="normal"></highlight></codeline>
<codeline lineno="3432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_remaining_length(packet,<sp/>remaining_length)</highlight></codeline>
<codeline lineno="3433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>topic)</highlight></codeline>
<codeline lineno="3434"><highlight class="normal"></highlight></codeline>
<codeline lineno="3435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="3436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>For<sp/>message<sp/>id</highlight></codeline>
<codeline lineno="3437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(struct.pack(&quot;!H&quot;,<sp/>mid))</highlight></codeline>
<codeline lineno="3438"><highlight class="normal"></highlight></codeline>
<codeline lineno="3439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(packed_properties)</highlight></codeline>
<codeline lineno="3441"><highlight class="normal"></highlight></codeline>
<codeline lineno="3442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(payload)</highlight></codeline>
<codeline lineno="3443"><highlight class="normal"></highlight></codeline>
<codeline lineno="3444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._packet_queue(PUBLISH,<sp/>packet,<sp/>mid,<sp/>qos,<sp/>info)</highlight></codeline>
<codeline lineno="3445"><highlight class="normal"></highlight></codeline>
<codeline lineno="3446" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a58bf78b7eb806b8ba114b0b641df031f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_pubrec(self,<sp/>mid:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>PUBREC<sp/>(Mid:<sp/>%d)&quot;,<sp/>mid)</highlight></codeline>
<codeline lineno="3448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_command_with_mid(PUBREC,<sp/>mid,<sp/>False)</highlight></codeline>
<codeline lineno="3449"><highlight class="normal"></highlight></codeline>
<codeline lineno="3450" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a313a2cfac9532a96c2d3c6a085d61fb6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_pubrel(self,<sp/>mid:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>PUBREL<sp/>(Mid:<sp/>%d)&quot;,<sp/>mid)</highlight></codeline>
<codeline lineno="3452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_command_with_mid(PUBREL<sp/>|<sp/>2,<sp/>mid,<sp/>False)</highlight></codeline>
<codeline lineno="3453"><highlight class="normal"></highlight></codeline>
<codeline lineno="3454" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8b3ffa953a0520210309435a089d0e94" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_command_with_mid(self,<sp/>command:<sp/>int,<sp/>mid:<sp/>int,<sp/>dup:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>For<sp/>PUBACK,<sp/>PUBCOMP,<sp/>PUBREC,<sp/>and<sp/>PUBREL</highlight></codeline>
<codeline lineno="3456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>dup:</highlight></codeline>
<codeline lineno="3457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>|=<sp/>0x8</highlight></codeline>
<codeline lineno="3458"><highlight class="normal"></highlight></codeline>
<codeline lineno="3459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="3460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>struct.pack(&apos;!BBH&apos;,<sp/>command,<sp/>remaining_length,<sp/>mid)</highlight></codeline>
<codeline lineno="3461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._packet_queue(command,<sp/>packet,<sp/>mid,<sp/>1)</highlight></codeline>
<codeline lineno="3462"><highlight class="normal"></highlight></codeline>
<codeline lineno="3463" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6eb410adbfc3970df2e51bf5b8af5c2f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_simple_command(self,<sp/>command:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>For<sp/>DISCONNECT,<sp/>PINGREQ<sp/>and<sp/>PINGRESP</highlight></codeline>
<codeline lineno="3465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>struct.pack(&apos;!BB&apos;,<sp/>command,<sp/>remaining_length)</highlight></codeline>
<codeline lineno="3467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._packet_queue(command,<sp/>packet,<sp/>0,<sp/>0)</highlight></codeline>
<codeline lineno="3468"><highlight class="normal"></highlight></codeline>
<codeline lineno="3469" refid="classpaho_1_1mqtt_1_1client_1_1_client_1abaa102667fd03ffbd60d48ae0b10f7d5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_connect(self,<sp/>keepalive:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>proto_ver<sp/>=<sp/>int(self._protocol)</highlight></codeline>
<codeline lineno="3471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>hard-coded<sp/>UTF-8<sp/>encoded<sp/>string</highlight></codeline>
<codeline lineno="3472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>protocol<sp/>=<sp/>b&quot;MQTT&quot;<sp/>if<sp/>proto_ver<sp/>&gt;=<sp/>MQTTv311<sp/>else<sp/>b&quot;MQIsdp&quot;</highlight></codeline>
<codeline lineno="3473"><highlight class="normal"></highlight></codeline>
<codeline lineno="3474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>2<sp/>+<sp/>len(protocol)<sp/>+<sp/>1<sp/>+<sp/>\</highlight></codeline>
<codeline lineno="3475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1<sp/>+<sp/>2<sp/>+<sp/>2<sp/>+<sp/>len(self._client_id)</highlight></codeline>
<codeline lineno="3476"><highlight class="normal"></highlight></codeline>
<codeline lineno="3477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._clean_start<sp/>is<sp/>True:</highlight></codeline>
<codeline lineno="3480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>|=<sp/>0x02</highlight></codeline>
<codeline lineno="3481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._clean_start<sp/>==<sp/>MQTT_CLEAN_START_FIRST_ONLY<sp/>and<sp/>self._mqttv5_first_connect:</highlight></codeline>
<codeline lineno="3482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>|=<sp/>0x02</highlight></codeline>
<codeline lineno="3483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._clean_session:</highlight></codeline>
<codeline lineno="3484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>|=<sp/>0x02</highlight></codeline>
<codeline lineno="3485"><highlight class="normal"></highlight></codeline>
<codeline lineno="3486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._will:</highlight></codeline>
<codeline lineno="3487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>2<sp/>+<sp/>\</highlight></codeline>
<codeline lineno="3488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len(self._will_topic)<sp/>+<sp/>2<sp/>+<sp/>len(self._will_payload)</highlight></codeline>
<codeline lineno="3489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>|=<sp/>0x04<sp/>|<sp/>((self._will_qos<sp/>&amp;<sp/>0x03)<sp/>&lt;&lt;<sp/>3)<sp/>|<sp/>(</highlight></codeline>
<codeline lineno="3490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self._will_retain<sp/>&amp;<sp/>0x01)<sp/>&lt;&lt;<sp/>5)</highlight></codeline>
<codeline lineno="3491"><highlight class="normal"></highlight></codeline>
<codeline lineno="3492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._username<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>2<sp/>+<sp/>len(self._username)</highlight></codeline>
<codeline lineno="3494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>|=<sp/>0x80</highlight></codeline>
<codeline lineno="3495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._password<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>|=<sp/>0x40</highlight></codeline>
<codeline lineno="3497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>2<sp/>+<sp/>len(self._password)</highlight></codeline>
<codeline lineno="3498"><highlight class="normal"></highlight></codeline>
<codeline lineno="3499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._connect_properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_connect_properties<sp/>=<sp/>b&apos;\x00&apos;</highlight></codeline>
<codeline lineno="3502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_connect_properties<sp/>=<sp/>self._connect_properties.pack()</highlight></codeline>
<codeline lineno="3504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>len(packed_connect_properties)</highlight></codeline>
<codeline lineno="3505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._will:</highlight></codeline>
<codeline lineno="3506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._will_properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_will_properties<sp/>=<sp/>b&apos;\x00&apos;</highlight></codeline>
<codeline lineno="3508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_will_properties<sp/>=<sp/>self._will_properties.pack()</highlight></codeline>
<codeline lineno="3510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>len(packed_will_properties)</highlight></codeline>
<codeline lineno="3511"><highlight class="normal"></highlight></codeline>
<codeline lineno="3512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>CONNECT</highlight></codeline>
<codeline lineno="3513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="3514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.append(command)</highlight></codeline>
<codeline lineno="3515"><highlight class="normal"></highlight></codeline>
<codeline lineno="3516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>as<sp/>per<sp/>the<sp/>mosquitto<sp/>broker,<sp/>if<sp/>the<sp/>MSB<sp/>of<sp/>this<sp/>version<sp/>is<sp/>set</highlight></codeline>
<codeline lineno="3517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>to<sp/>1,<sp/>then<sp/>it<sp/>treats<sp/>the<sp/>connection<sp/>as<sp/>a<sp/>bridge</highlight></codeline>
<codeline lineno="3518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._client_mode<sp/>==<sp/>MQTT_BRIDGE:</highlight></codeline>
<codeline lineno="3519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>proto_ver<sp/>|=<sp/>0x80</highlight></codeline>
<codeline lineno="3520"><highlight class="normal"></highlight></codeline>
<codeline lineno="3521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_remaining_length(packet,<sp/>remaining_length)</highlight></codeline>
<codeline lineno="3522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(struct.pack(</highlight></codeline>
<codeline lineno="3523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f&quot;!H{len(protocol)}sBBH&quot;,</highlight></codeline>
<codeline lineno="3524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len(protocol),<sp/>protocol,<sp/>proto_ver,<sp/>connect_flags,<sp/>keepalive,</highlight></codeline>
<codeline lineno="3525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>))</highlight></codeline>
<codeline lineno="3526"><highlight class="normal"></highlight></codeline>
<codeline lineno="3527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>+=<sp/>packed_connect_properties</highlight></codeline>
<codeline lineno="3529"><highlight class="normal"></highlight></codeline>
<codeline lineno="3530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>self._client_id)</highlight></codeline>
<codeline lineno="3531"><highlight class="normal"></highlight></codeline>
<codeline lineno="3532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._will:</highlight></codeline>
<codeline lineno="3533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>+=<sp/>packed_will_properties</highlight></codeline>
<codeline lineno="3535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>self._will_topic)</highlight></codeline>
<codeline lineno="3536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>self._will_payload)</highlight></codeline>
<codeline lineno="3537"><highlight class="normal"></highlight></codeline>
<codeline lineno="3538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._username<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>self._username)</highlight></codeline>
<codeline lineno="3540"><highlight class="normal"></highlight></codeline>
<codeline lineno="3541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._password<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>self._password)</highlight></codeline>
<codeline lineno="3543"><highlight class="normal"></highlight></codeline>
<codeline lineno="3544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._keepalive<sp/>=<sp/>keepalive</highlight></codeline>
<codeline lineno="3545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>CONNECT<sp/>(u%d,<sp/>p%d,<sp/>wr%d,<sp/>wq%d,<sp/>wf%d,<sp/>c%d,<sp/>k%d)<sp/>client_id=%s<sp/>properties=%s&quot;,</highlight></codeline>
<codeline lineno="3549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x80)<sp/>&gt;&gt;<sp/>7,</highlight></codeline>
<codeline lineno="3550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x40)<sp/>&gt;&gt;<sp/>6,</highlight></codeline>
<codeline lineno="3551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x20)<sp/>&gt;&gt;<sp/>5,</highlight></codeline>
<codeline lineno="3552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x18)<sp/>&gt;&gt;<sp/>3,</highlight></codeline>
<codeline lineno="3553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x4)<sp/>&gt;&gt;<sp/>2,</highlight></codeline>
<codeline lineno="3554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x2)<sp/>&gt;&gt;<sp/>1,</highlight></codeline>
<codeline lineno="3555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keepalive,</highlight></codeline>
<codeline lineno="3556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_id,</highlight></codeline>
<codeline lineno="3557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._connect_properties</highlight></codeline>
<codeline lineno="3558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>CONNECT<sp/>(u%d,<sp/>p%d,<sp/>wr%d,<sp/>wq%d,<sp/>wf%d,<sp/>c%d,<sp/>k%d)<sp/>client_id=%s&quot;,</highlight></codeline>
<codeline lineno="3563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x80)<sp/>&gt;&gt;<sp/>7,</highlight></codeline>
<codeline lineno="3564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x40)<sp/>&gt;&gt;<sp/>6,</highlight></codeline>
<codeline lineno="3565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x20)<sp/>&gt;&gt;<sp/>5,</highlight></codeline>
<codeline lineno="3566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x18)<sp/>&gt;&gt;<sp/>3,</highlight></codeline>
<codeline lineno="3567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x4)<sp/>&gt;&gt;<sp/>2,</highlight></codeline>
<codeline lineno="3568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connect_flags<sp/>&amp;<sp/>0x2)<sp/>&gt;&gt;<sp/>1,</highlight></codeline>
<codeline lineno="3569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keepalive,</highlight></codeline>
<codeline lineno="3570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_id</highlight></codeline>
<codeline lineno="3571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._packet_queue(command,<sp/>packet,<sp/>0,<sp/>0)</highlight></codeline>
<codeline lineno="3573"><highlight class="normal"></highlight></codeline>
<codeline lineno="3574" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0bafb752f096bc90fdc8714cd6707f2f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_disconnect(</highlight></codeline>
<codeline lineno="3575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncode:<sp/>ReasonCode<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="3577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="3578"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>DISCONNECT<sp/>reasonCode=%s<sp/>properties=%s&quot;,</highlight></codeline>
<codeline lineno="3581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncode,</highlight></codeline>
<codeline lineno="3582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties</highlight></codeline>
<codeline lineno="3583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Sending<sp/>DISCONNECT&quot;)</highlight></codeline>
<codeline lineno="3586"><highlight class="normal"></highlight></codeline>
<codeline lineno="3587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3588"><highlight class="normal"></highlight></codeline>
<codeline lineno="3589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>DISCONNECT</highlight></codeline>
<codeline lineno="3590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="3591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.append(command)</highlight></codeline>
<codeline lineno="3592"><highlight class="normal"></highlight></codeline>
<codeline lineno="3593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>not<sp/>None<sp/>or<sp/>reasoncode<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>reasoncode<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncode<sp/>=<sp/>ReasonCode(DISCONNECT<sp/>&gt;&gt;<sp/>4,<sp/>identifier=0)</highlight></codeline>
<codeline lineno="3597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_props<sp/>=<sp/>properties.pack()</highlight></codeline>
<codeline lineno="3600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>len(packed_props)</highlight></codeline>
<codeline lineno="3601"><highlight class="normal"></highlight></codeline>
<codeline lineno="3602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_remaining_length(packet,<sp/>remaining_length)</highlight></codeline>
<codeline lineno="3603"><highlight class="normal"></highlight></codeline>
<codeline lineno="3604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>reasoncode<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>+=<sp/>reasoncode.pack()</highlight></codeline>
<codeline lineno="3607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>+=<sp/>packed_props</highlight></codeline>
<codeline lineno="3609"><highlight class="normal"></highlight></codeline>
<codeline lineno="3610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._packet_queue(command,<sp/>packet,<sp/>0,<sp/>0)</highlight></codeline>
<codeline lineno="3611"><highlight class="normal"></highlight></codeline>
<codeline lineno="3612" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a73a309c12d2b359e5738b1780e8152f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_subscribe(</highlight></codeline>
<codeline lineno="3613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup:<sp/>int,</highlight></codeline>
<codeline lineno="3615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topics:<sp/>Sequence[tuple[bytes,<sp/>SubscribeOptions<sp/>|<sp/>int]],</highlight></codeline>
<codeline lineno="3616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="3617"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>tuple[MQTTErrorCode,<sp/>int]:</highlight></codeline>
<codeline lineno="3618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="3619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_subscribe_properties<sp/>=<sp/>b&apos;\x00&apos;</highlight></codeline>
<codeline lineno="3622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_subscribe_properties<sp/>=<sp/>properties.pack()</highlight></codeline>
<codeline lineno="3624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>len(packed_subscribe_properties)</highlight></codeline>
<codeline lineno="3625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t,<sp/>_<sp/>in<sp/>topics:</highlight></codeline>
<codeline lineno="3626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>2<sp/>+<sp/>len(t)<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="3627"><highlight class="normal"></highlight></codeline>
<codeline lineno="3628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>SUBSCRIBE<sp/>|<sp/>(dup<sp/>&lt;&lt;<sp/>3)<sp/>|<sp/>0x2</highlight></codeline>
<codeline lineno="3629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="3630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.append(command)</highlight></codeline>
<codeline lineno="3631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_remaining_length(packet,<sp/>remaining_length)</highlight></codeline>
<codeline lineno="3632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_mid<sp/>=<sp/>self._mid_generate()</highlight></codeline>
<codeline lineno="3633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(struct.pack(&quot;!H&quot;,<sp/>local_mid))</highlight></codeline>
<codeline lineno="3634"><highlight class="normal"></highlight></codeline>
<codeline lineno="3635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>+=<sp/>packed_subscribe_properties</highlight></codeline>
<codeline lineno="3637"><highlight class="normal"></highlight></codeline>
<codeline lineno="3638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t,<sp/>q<sp/>in<sp/>topics:</highlight></codeline>
<codeline lineno="3639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>t)</highlight></codeline>
<codeline lineno="3640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>+=<sp/>q.pack()<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="3642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.append(q)<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="3644"><highlight class="normal"></highlight></codeline>
<codeline lineno="3645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>SUBSCRIBE<sp/>(d%d,<sp/>m%d)<sp/>%s&quot;,</highlight></codeline>
<codeline lineno="3648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup,</highlight></codeline>
<codeline lineno="3649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_mid,</highlight></codeline>
<codeline lineno="3650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topics,</highlight></codeline>
<codeline lineno="3651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(self._packet_queue(command,<sp/>packet,<sp/>local_mid,<sp/>1),<sp/>local_mid)</highlight></codeline>
<codeline lineno="3653"><highlight class="normal"></highlight></codeline>
<codeline lineno="3654" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8076df7277079cbd709ad44ce7cb14ab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_unsubscribe(</highlight></codeline>
<codeline lineno="3655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup:<sp/>int,</highlight></codeline>
<codeline lineno="3657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topics:<sp/>list[bytes],</highlight></codeline>
<codeline lineno="3658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="3659"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>tuple[MQTTErrorCode,<sp/>int]:</highlight></codeline>
<codeline lineno="3660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="3661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_unsubscribe_properties<sp/>=<sp/>b&apos;\x00&apos;</highlight></codeline>
<codeline lineno="3664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packed_unsubscribe_properties<sp/>=<sp/>properties.pack()</highlight></codeline>
<codeline lineno="3666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>len(packed_unsubscribe_properties)</highlight></codeline>
<codeline lineno="3667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t<sp/>in<sp/>topics:</highlight></codeline>
<codeline lineno="3668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_length<sp/>+=<sp/>2<sp/>+<sp/>len(t)</highlight></codeline>
<codeline lineno="3669"><highlight class="normal"></highlight></codeline>
<codeline lineno="3670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>UNSUBSCRIBE<sp/>|<sp/>(dup<sp/>&lt;&lt;<sp/>3)<sp/>|<sp/>0x2</highlight></codeline>
<codeline lineno="3671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="3672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.append(command)</highlight></codeline>
<codeline lineno="3673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_remaining_length(packet,<sp/>remaining_length)</highlight></codeline>
<codeline lineno="3674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_mid<sp/>=<sp/>self._mid_generate()</highlight></codeline>
<codeline lineno="3675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet.extend(struct.pack(&quot;!H&quot;,<sp/>local_mid))</highlight></codeline>
<codeline lineno="3676"><highlight class="normal"></highlight></codeline>
<codeline lineno="3677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>+=<sp/>packed_unsubscribe_properties</highlight></codeline>
<codeline lineno="3679"><highlight class="normal"></highlight></codeline>
<codeline lineno="3680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t<sp/>in<sp/>topics:</highlight></codeline>
<codeline lineno="3681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._pack_str16(packet,<sp/>t)</highlight></codeline>
<codeline lineno="3682"><highlight class="normal"></highlight></codeline>
<codeline lineno="3683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>topics_repr<sp/>=<sp/>&quot;,<sp/>&quot;.join(&quot;&apos;&quot;+topic.decode(&apos;utf8&apos;)+&quot;&apos;&quot;<sp/>for<sp/>topic<sp/>in<sp/>topics)</highlight></codeline>
<codeline lineno="3684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>UNSUBSCRIBE<sp/>(d%d,<sp/>m%d)<sp/>%s<sp/>%s&quot;,</highlight></codeline>
<codeline lineno="3688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup,</highlight></codeline>
<codeline lineno="3689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_mid,</highlight></codeline>
<codeline lineno="3690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties,</highlight></codeline>
<codeline lineno="3691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topics,</highlight></codeline>
<codeline lineno="3692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sending<sp/>UNSUBSCRIBE<sp/>(d%d,<sp/>m%d)<sp/>%s&quot;,</highlight></codeline>
<codeline lineno="3697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dup,</highlight></codeline>
<codeline lineno="3698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_mid,</highlight></codeline>
<codeline lineno="3699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topics,</highlight></codeline>
<codeline lineno="3700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(self._packet_queue(command,<sp/>packet,<sp/>local_mid,<sp/>1),<sp/>local_mid)</highlight></codeline>
<codeline lineno="3702"><highlight class="normal"></highlight></codeline>
<codeline lineno="3703" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac8daeb4f637bfe88cb6da4b777f5f895" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_check_clean_session(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="3704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._clean_start<sp/>==<sp/>MQTT_CLEAN_START_FIRST_ONLY:</highlight></codeline>
<codeline lineno="3706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._mqttv5_first_connect</highlight></codeline>
<codeline lineno="3707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._clean_start<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="3709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._clean_session</highlight></codeline>
<codeline lineno="3711"><highlight class="normal"></highlight></codeline>
<codeline lineno="3712" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a7b382b434e4f1fd2a23dafc6630ab7c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_messages_reconnect_reset_out(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._out_message_mutex:</highlight></codeline>
<codeline lineno="3714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>m<sp/>in<sp/>self._out_messages.values():</highlight></codeline>
<codeline lineno="3716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.timestamp<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._max_inflight_messages<sp/>==<sp/>0<sp/>or<sp/>self._inflight_messages<sp/>&lt;<sp/>self._max_inflight_messages:</highlight></codeline>
<codeline lineno="3718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.qos<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_publish</highlight></codeline>
<codeline lineno="3720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>m.qos<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="3721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>self._inflight_messages<sp/>=<sp/>self._inflight_messages<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="3722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.state<sp/>==<sp/>mqtt_ms_wait_for_puback:</highlight></codeline>
<codeline lineno="3723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.dup<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="3724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_publish</highlight></codeline>
<codeline lineno="3725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>m.qos<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="3726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>self._inflight_messages<sp/>=<sp/>self._inflight_messages<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="3727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._check_clean_session():</highlight></codeline>
<codeline lineno="3728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.state<sp/>!=<sp/>mqtt_ms_publish:</highlight></codeline>
<codeline lineno="3729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.dup<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="3730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_publish</highlight></codeline>
<codeline lineno="3731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.state<sp/>==<sp/>mqtt_ms_wait_for_pubcomp:</highlight></codeline>
<codeline lineno="3733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_resend_pubrel</highlight></codeline>
<codeline lineno="3734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.state<sp/>==<sp/>mqtt_ms_wait_for_pubrec:</highlight></codeline>
<codeline lineno="3736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.dup<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="3737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_publish</highlight></codeline>
<codeline lineno="3738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_queued</highlight></codeline>
<codeline lineno="3740"><highlight class="normal"></highlight></codeline>
<codeline lineno="3741" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a516ccf36c1a79b971036918a9ad37ccc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_messages_reconnect_reset_in(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_message_mutex:</highlight></codeline>
<codeline lineno="3743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._check_clean_session():</highlight></codeline>
<codeline lineno="3744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_messages<sp/>=<sp/>collections.OrderedDict()</highlight></codeline>
<codeline lineno="3745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return</highlight></codeline>
<codeline lineno="3746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>m<sp/>in<sp/>self._in_messages.values():</highlight></codeline>
<codeline lineno="3747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.timestamp<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.qos<sp/>!=<sp/>2:</highlight></codeline>
<codeline lineno="3749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_messages.pop(m.mid)</highlight></codeline>
<codeline lineno="3750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Preserve<sp/>current<sp/>state</highlight></codeline>
<codeline lineno="3752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pass</highlight></codeline>
<codeline lineno="3753"><highlight class="normal"></highlight></codeline>
<codeline lineno="3754" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a71ede766395818a2ed7045db5cf1137f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_messages_reconnect_reset(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="3755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._messages_reconnect_reset_out()</highlight></codeline>
<codeline lineno="3756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._messages_reconnect_reset_in()</highlight></codeline>
<codeline lineno="3757"><highlight class="normal"></highlight></codeline>
<codeline lineno="3758" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a0a7ec7d6160e6017edbcdc731fefe5d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_packet_queue(</highlight></codeline>
<codeline lineno="3759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command:<sp/>int,</highlight></codeline>
<codeline lineno="3761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet:<sp/>bytes,</highlight></codeline>
<codeline lineno="3762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid:<sp/>int,</highlight></codeline>
<codeline lineno="3763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qos:<sp/>int,</highlight></codeline>
<codeline lineno="3764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info:<sp/>MQTTMessageInfo<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="3765"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mpkt:<sp/>_OutPacket<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="3767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;command&quot;:<sp/>command,</highlight></codeline>
<codeline lineno="3768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;mid&quot;:<sp/>mid,</highlight></codeline>
<codeline lineno="3769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;qos&quot;:<sp/>qos,</highlight></codeline>
<codeline lineno="3770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;pos&quot;:<sp/>0,</highlight></codeline>
<codeline lineno="3771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;to_process&quot;:<sp/>len(packet),</highlight></codeline>
<codeline lineno="3772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;packet&quot;:<sp/>packet,</highlight></codeline>
<codeline lineno="3773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;info&quot;:<sp/>info,</highlight></codeline>
<codeline lineno="3774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3775"><highlight class="normal"></highlight></codeline>
<codeline lineno="3776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._out_packet.append(mpkt)</highlight></codeline>
<codeline lineno="3777"><highlight class="normal"></highlight></codeline>
<codeline lineno="3778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Write<sp/>a<sp/>single<sp/>byte<sp/>to<sp/>sockpairW<sp/>(connected<sp/>to<sp/>sockpairR)<sp/>to<sp/>break</highlight></codeline>
<codeline lineno="3779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>out<sp/>of<sp/>select()<sp/>if<sp/>in<sp/>threaded<sp/>mode.</highlight></codeline>
<codeline lineno="3780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._sockpairW<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="3781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sockpairW.send(sockpair_data)</highlight></codeline>
<codeline lineno="3783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>BlockingIOError:</highlight></codeline>
<codeline lineno="3784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pass</highlight></codeline>
<codeline lineno="3785"><highlight class="normal"></highlight></codeline>
<codeline lineno="3786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>we<sp/>have<sp/>an<sp/>external<sp/>event<sp/>loop<sp/>registered,<sp/>use<sp/>that<sp/>instead</highlight></codeline>
<codeline lineno="3787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>of<sp/>calling<sp/>loop_write()<sp/>directly.</highlight></codeline>
<codeline lineno="3788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._thread<sp/>is<sp/>None<sp/>and<sp/>self._on_socket_register_write<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_callback_mutex.acquire(False):</highlight></codeline>
<codeline lineno="3790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_callback_mutex.release()</highlight></codeline>
<codeline lineno="3791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.loop_write()</highlight></codeline>
<codeline lineno="3792"><highlight class="normal"></highlight></codeline>
<codeline lineno="3793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._call_socket_register_write()</highlight></codeline>
<codeline lineno="3794"><highlight class="normal"></highlight></codeline>
<codeline lineno="3795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3796"><highlight class="normal"></highlight></codeline>
<codeline lineno="3797" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a5c1cc7ecc3bd1bc2b75604ad25d2ecae" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_packet_handle(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cmd<sp/>=<sp/>self._in_packet[&apos;command&apos;]<sp/>&amp;<sp/>0xF0</highlight></codeline>
<codeline lineno="3799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>cmd<sp/>==<sp/>PINGREQ:</highlight></codeline>
<codeline lineno="3800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_pingreq()</highlight></codeline>
<codeline lineno="3801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>PINGRESP:</highlight></codeline>
<codeline lineno="3802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_pingresp()</highlight></codeline>
<codeline lineno="3803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>PUBACK:</highlight></codeline>
<codeline lineno="3804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_pubackcomp(&quot;PUBACK&quot;)</highlight></codeline>
<codeline lineno="3805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>PUBCOMP:</highlight></codeline>
<codeline lineno="3806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_pubackcomp(&quot;PUBCOMP&quot;)</highlight></codeline>
<codeline lineno="3807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>PUBLISH:</highlight></codeline>
<codeline lineno="3808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_publish()</highlight></codeline>
<codeline lineno="3809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>PUBREC:</highlight></codeline>
<codeline lineno="3810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_pubrec()</highlight></codeline>
<codeline lineno="3811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>PUBREL:</highlight></codeline>
<codeline lineno="3812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_pubrel()</highlight></codeline>
<codeline lineno="3813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>CONNACK:</highlight></codeline>
<codeline lineno="3814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_connack()</highlight></codeline>
<codeline lineno="3815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>SUBACK:</highlight></codeline>
<codeline lineno="3816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._handle_suback()</highlight></codeline>
<codeline lineno="3817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>UNSUBACK:</highlight></codeline>
<codeline lineno="3819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._handle_unsuback()</highlight></codeline>
<codeline lineno="3820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>cmd<sp/>==<sp/>DISCONNECT<sp/>and<sp/>self._protocol<sp/>==<sp/>MQTTv5:<sp/><sp/>#<sp/>only<sp/>allowed<sp/>in<sp/>MQTT<sp/>5.0</highlight></codeline>
<codeline lineno="3821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._handle_disconnect()</highlight></codeline>
<codeline lineno="3822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>we<sp/>don&apos;t<sp/>recognise<sp/>the<sp/>command,<sp/>return<sp/>an<sp/>error<sp/>straight<sp/>away.</highlight></codeline>
<codeline lineno="3825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_ERR,<sp/>&quot;Error:<sp/>Unrecognised<sp/>command<sp/>%s&quot;,<sp/>cmd)</highlight></codeline>
<codeline lineno="3826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3827"><highlight class="normal"></highlight></codeline>
<codeline lineno="3828" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9577e4a910f852010bbff9e168af610e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_pingreq(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="3830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3831"><highlight class="normal"></highlight></codeline>
<codeline lineno="3832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>PINGREQ&quot;)</highlight></codeline>
<codeline lineno="3833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_pingresp()</highlight></codeline>
<codeline lineno="3834"><highlight class="normal"></highlight></codeline>
<codeline lineno="3835" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af3fc53df3fecb03919f0c8a6fe0992e7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_pingresp(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="3837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3838"><highlight class="normal"></highlight></codeline>
<codeline lineno="3839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>No<sp/>longer<sp/>waiting<sp/>for<sp/>a<sp/>PINGRESP.</highlight></codeline>
<codeline lineno="3840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ping_t<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="3841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>PINGRESP&quot;)</highlight></codeline>
<codeline lineno="3842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3843"><highlight class="normal"></highlight></codeline>
<codeline lineno="3844" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a9172b4201cd81105a362c9555caf8957" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_connack(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="3845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="3847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>!=<sp/>2:</highlight></codeline>
<codeline lineno="3849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3850"><highlight class="normal"></highlight></codeline>
<codeline lineno="3851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(flags,<sp/>result)<sp/>=<sp/>struct.unpack(</highlight></codeline>
<codeline lineno="3853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;!BB&quot;,<sp/>self._in_packet[&apos;packet&apos;][:2])</highlight></codeline>
<codeline lineno="3854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>result<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="3855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>This<sp/>is<sp/>probably<sp/>a<sp/>failure<sp/>from<sp/>a<sp/>broker<sp/>that<sp/>doesn&apos;t<sp/>support</highlight></codeline>
<codeline lineno="3856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>MQTT<sp/>v5.</highlight></codeline>
<codeline lineno="3857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason<sp/>=<sp/>ReasonCode(CONNACK<sp/>&gt;&gt;<sp/>4,<sp/>aName=&quot;Unsupported<sp/>protocol<sp/>version&quot;)</highlight></codeline>
<codeline lineno="3858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="3859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason<sp/>=<sp/>ReasonCode(CONNACK<sp/>&gt;&gt;<sp/>4,<sp/>identifier=result)</highlight></codeline>
<codeline lineno="3861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(CONNACK<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="3862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties.unpack(self._in_packet[&apos;packet&apos;][2:])</highlight></codeline>
<codeline lineno="3863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(flags,<sp/>result)<sp/>=<sp/>struct.unpack(&quot;!BB&quot;,<sp/>self._in_packet[&apos;packet&apos;])</highlight></codeline>
<codeline lineno="3865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason<sp/>=<sp/>convert_connack_rc_to_reason_code(result)</highlight></codeline>
<codeline lineno="3866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="3867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv311:</highlight></codeline>
<codeline lineno="3868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>result<sp/>==<sp/>CONNACK_REFUSED_PROTOCOL_VERSION:</highlight></codeline>
<codeline lineno="3869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._reconnect_on_failure:</highlight></codeline>
<codeline lineno="3870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Received<sp/>CONNACK<sp/>(%s,<sp/>%s),<sp/>attempting<sp/>downgrade<sp/>to<sp/>MQTT<sp/>v3.1.&quot;,</highlight></codeline>
<codeline lineno="3874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags,<sp/>result</highlight></codeline>
<codeline lineno="3875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Downgrade<sp/>to<sp/>MQTT<sp/>v3.1</highlight></codeline>
<codeline lineno="3877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._protocol<sp/>=<sp/>MQTTv31</highlight></codeline>
<codeline lineno="3878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.reconnect()</highlight></codeline>
<codeline lineno="3879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>(result<sp/>==<sp/>CONNACK_REFUSED_IDENTIFIER_REJECTED</highlight></codeline>
<codeline lineno="3880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>self._client_id<sp/>==<sp/>b&apos;&apos;):</highlight></codeline>
<codeline lineno="3881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self._reconnect_on_failure:</highlight></codeline>
<codeline lineno="3882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="3883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="3885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Received<sp/>CONNACK<sp/>(%s,<sp/>%s),<sp/>attempting<sp/>to<sp/>use<sp/>non-empty<sp/>CID&quot;,</highlight></codeline>
<codeline lineno="3886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags,<sp/>result,</highlight></codeline>
<codeline lineno="3887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._client_id<sp/>=<sp/>_base62(uuid.uuid4().int,<sp/>padding=22).encode(&quot;utf8&quot;)</highlight></codeline>
<codeline lineno="3889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.reconnect()</highlight></codeline>
<codeline lineno="3890"><highlight class="normal"></highlight></codeline>
<codeline lineno="3891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>result<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._state<sp/>=<sp/>_ConnectionState.MQTT_CS_CONNECTED</highlight></codeline>
<codeline lineno="3893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_delay<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="3894"><highlight class="normal"></highlight></codeline>
<codeline lineno="3895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>CONNACK<sp/>(%s,<sp/>%s)<sp/>properties=%s&quot;,<sp/>flags,<sp/>reason,<sp/>properties)</highlight></codeline>
<codeline lineno="3898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>CONNACK<sp/>(%s,<sp/>%s)&quot;,<sp/>flags,<sp/>result)</highlight></codeline>
<codeline lineno="3901"><highlight class="normal"></highlight></codeline>
<codeline lineno="3902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>it<sp/>won&apos;t<sp/>be<sp/>the<sp/>first<sp/>successful<sp/>connect<sp/>any<sp/>more</highlight></codeline>
<codeline lineno="3903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._mqttv5_first_connect<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="3904"><highlight class="normal"></highlight></codeline>
<codeline lineno="3905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="3906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect<sp/>=<sp/>self.on_connect</highlight></codeline>
<codeline lineno="3907"><highlight class="normal"></highlight></codeline>
<codeline lineno="3908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_connect:</highlight></codeline>
<codeline lineno="3909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags_dict<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="3910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags_dict[&apos;session<sp/>present&apos;]<sp/>=<sp/>flags<sp/>&amp;<sp/>0x01</highlight></codeline>
<codeline lineno="3911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="3912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="3913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION1:</highlight></codeline>
<codeline lineno="3914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="3915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect<sp/>=<sp/>cast(CallbackOnConnect_v1_mqtt5,<sp/>on_connect)</highlight></codeline>
<codeline lineno="3916"><highlight class="normal"></highlight></codeline>
<codeline lineno="3917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect(self,<sp/>self._userdata,</highlight></codeline>
<codeline lineno="3918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags_dict,<sp/>reason,<sp/>properties)</highlight></codeline>
<codeline lineno="3919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect<sp/>=<sp/>cast(CallbackOnConnect_v1_mqtt3,<sp/>on_connect)</highlight></codeline>
<codeline lineno="3921"><highlight class="normal"></highlight></codeline>
<codeline lineno="3922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect(</highlight></codeline>
<codeline lineno="3923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>self._userdata,<sp/>flags_dict,<sp/>result)</highlight></codeline>
<codeline lineno="3924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION2:</highlight></codeline>
<codeline lineno="3925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect<sp/>=<sp/>cast(CallbackOnConnect_v2,<sp/>on_connect)</highlight></codeline>
<codeline lineno="3926"><highlight class="normal"></highlight></codeline>
<codeline lineno="3927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags<sp/>=<sp/>ConnectFlags(</highlight></codeline>
<codeline lineno="3928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>session_present=flags_dict[&apos;session<sp/>present&apos;]<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="3929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3930"><highlight class="normal"></highlight></codeline>
<codeline lineno="3931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="3932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(PacketTypes.CONNACK)</highlight></codeline>
<codeline lineno="3933"><highlight class="normal"></highlight></codeline>
<codeline lineno="3934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect(</highlight></codeline>
<codeline lineno="3935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="3936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata,</highlight></codeline>
<codeline lineno="3937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connect_flags,</highlight></codeline>
<codeline lineno="3938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason,</highlight></codeline>
<codeline lineno="3939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties,</highlight></codeline>
<codeline lineno="3940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="3942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;Unsupported<sp/>callback<sp/>API<sp/>version&quot;)</highlight></codeline>
<codeline lineno="3943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="3944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="3945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_connect:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="3946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="3947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="3948"><highlight class="normal"></highlight></codeline>
<codeline lineno="3949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>result<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._out_message_mutex:</highlight></codeline>
<codeline lineno="3952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>m<sp/>in<sp/>self._out_messages.values():</highlight></codeline>
<codeline lineno="3953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.timestamp<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="3954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.state<sp/>==<sp/>mqtt_ms_queued:</highlight></codeline>
<codeline lineno="3955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.loop_write()<sp/><sp/>#<sp/>Process<sp/>outgoing<sp/>messages<sp/>that<sp/>have<sp/>just<sp/>been<sp/>queued<sp/>up</highlight></codeline>
<codeline lineno="3956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="3957"><highlight class="normal"></highlight></codeline>
<codeline lineno="3958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.qos<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:<sp/><sp/>#<sp/>Don&apos;t<sp/>call<sp/>loop_write<sp/>after<sp/>_send_publish()</highlight></codeline>
<codeline lineno="3960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_publish(</highlight></codeline>
<codeline lineno="3961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.mid,</highlight></codeline>
<codeline lineno="3962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.topic.encode(&apos;utf-8&apos;),</highlight></codeline>
<codeline lineno="3963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.payload,</highlight></codeline>
<codeline lineno="3964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.qos,</highlight></codeline>
<codeline lineno="3965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.retain,</highlight></codeline>
<codeline lineno="3966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.dup,</highlight></codeline>
<codeline lineno="3967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties=m.properties</highlight></codeline>
<codeline lineno="3968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>!=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="3970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="3971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>m.qos<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="3972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.state<sp/>==<sp/>mqtt_ms_publish:</highlight></codeline>
<codeline lineno="3973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_wait_for_puback</highlight></codeline>
<codeline lineno="3975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:<sp/><sp/>#<sp/>Don&apos;t<sp/>call<sp/>loop_write<sp/>after<sp/>_send_publish()</highlight></codeline>
<codeline lineno="3976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_publish(</highlight></codeline>
<codeline lineno="3977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.mid,</highlight></codeline>
<codeline lineno="3978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.topic.encode(&apos;utf-8&apos;),</highlight></codeline>
<codeline lineno="3979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.payload,</highlight></codeline>
<codeline lineno="3980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.qos,</highlight></codeline>
<codeline lineno="3981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.retain,</highlight></codeline>
<codeline lineno="3982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.dup,</highlight></codeline>
<codeline lineno="3983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties=m.properties</highlight></codeline>
<codeline lineno="3984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>!=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="3986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="3987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>m.qos<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="3988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.state<sp/>==<sp/>mqtt_ms_publish:</highlight></codeline>
<codeline lineno="3989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_wait_for_pubrec</highlight></codeline>
<codeline lineno="3991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:<sp/><sp/>#<sp/>Don&apos;t<sp/>call<sp/>loop_write<sp/>after<sp/>_send_publish()</highlight></codeline>
<codeline lineno="3992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_publish(</highlight></codeline>
<codeline lineno="3993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.mid,</highlight></codeline>
<codeline lineno="3994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.topic.encode(&apos;utf-8&apos;),</highlight></codeline>
<codeline lineno="3995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.payload,</highlight></codeline>
<codeline lineno="3996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.qos,</highlight></codeline>
<codeline lineno="3997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.retain,</highlight></codeline>
<codeline lineno="3998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.dup,</highlight></codeline>
<codeline lineno="3999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties=m.properties</highlight></codeline>
<codeline lineno="4000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>!=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="4002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>m.state<sp/>==<sp/>mqtt_ms_resend_pubrel:</highlight></codeline>
<codeline lineno="4004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="4005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_wait_for_pubcomp</highlight></codeline>
<codeline lineno="4006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:<sp/><sp/>#<sp/>Don&apos;t<sp/>call<sp/>loop_write<sp/>after<sp/>_send_publish()</highlight></codeline>
<codeline lineno="4007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_pubrel(m.mid)</highlight></codeline>
<codeline lineno="4008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>!=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="4009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.loop_write()<sp/><sp/>#<sp/>Process<sp/>outgoing<sp/>messages<sp/>that<sp/>have<sp/>just<sp/>been<sp/>queued<sp/>up</highlight></codeline>
<codeline lineno="4011"><highlight class="normal"></highlight></codeline>
<codeline lineno="4012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>result<sp/>&gt;<sp/>0<sp/>and<sp/>result<sp/>&lt;<sp/>6:</highlight></codeline>
<codeline lineno="4014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_CONN_REFUSED</highlight></codeline>
<codeline lineno="4015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4017"><highlight class="normal"></highlight></codeline>
<codeline lineno="4018" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a39a581a916e12859c2f15c83def19434" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_disconnect(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_type<sp/>=<sp/>DISCONNECT<sp/>&gt;&gt;<sp/>4</highlight></codeline>
<codeline lineno="4020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode<sp/>=<sp/>properties<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="4021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="4022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode<sp/>=<sp/>ReasonCode(packet_type)</highlight></codeline>
<codeline lineno="4023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode.unpack(self._in_packet[&apos;packet&apos;])</highlight></codeline>
<codeline lineno="4024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>3:</highlight></codeline>
<codeline lineno="4025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(packet_type)</highlight></codeline>
<codeline lineno="4026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>props,<sp/>props_len<sp/>=<sp/>properties.unpack(</highlight></codeline>
<codeline lineno="4027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;packet&apos;][1:])</highlight></codeline>
<codeline lineno="4028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>DISCONNECT<sp/>%s<sp/>%s&quot;,</highlight></codeline>
<codeline lineno="4029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode,</highlight></codeline>
<codeline lineno="4030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties</highlight></codeline>
<codeline lineno="4031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4032"><highlight class="normal"></highlight></codeline>
<codeline lineno="4033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sock_close()</highlight></codeline>
<codeline lineno="4034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._do_on_disconnect(</highlight></codeline>
<codeline lineno="4035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_from_broker=True,</highlight></codeline>
<codeline lineno="4036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v1_rc=MQTTErrorCode.MQTT_ERR_SUCCESS,<sp/><sp/>#<sp/>If<sp/>reason<sp/>is<sp/>absent<sp/>(remaining<sp/>length<sp/>&lt;<sp/>1),<sp/>it<sp/>means<sp/>normal<sp/>disconnection</highlight></codeline>
<codeline lineno="4037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason=reasonCode,</highlight></codeline>
<codeline lineno="4038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties=properties,</highlight></codeline>
<codeline lineno="4039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4040"><highlight class="normal"></highlight></codeline>
<codeline lineno="4041" refid="classpaho_1_1mqtt_1_1client_1_1_client_1accefd33c4253233c74c071ad9a80196b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_suback(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>SUBACK&quot;)</highlight></codeline>
<codeline lineno="4043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pack_format<sp/>=<sp/>f&quot;!H{len(self._in_packet[&apos;packet&apos;])<sp/>-<sp/>2}s&quot;</highlight></codeline>
<codeline lineno="4044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(mid,<sp/>packet)<sp/>=<sp/>struct.unpack(pack_format,<sp/>self._in_packet[&apos;packet&apos;])</highlight></codeline>
<codeline lineno="4045"><highlight class="normal"></highlight></codeline>
<codeline lineno="4046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(SUBACK<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>props,<sp/>props_len<sp/>=<sp/>properties.unpack(packet)</highlight></codeline>
<codeline lineno="4049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes<sp/>=<sp/>[ReasonCode(SUBACK<sp/>&gt;&gt;<sp/>4,<sp/>identifier=c)<sp/>for<sp/>c<sp/>in<sp/>packet[props_len:]]</highlight></codeline>
<codeline lineno="4050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pack_format<sp/>=<sp/>f&quot;!{&apos;B&apos;<sp/>*<sp/>len(packet)}&quot;</highlight></codeline>
<codeline lineno="4052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>granted_qos<sp/>=<sp/>struct.unpack(pack_format,<sp/>packet)</highlight></codeline>
<codeline lineno="4053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes<sp/>=<sp/>[ReasonCode(SUBACK<sp/>&gt;&gt;<sp/>4,<sp/>identifier=c)<sp/>for<sp/>c<sp/>in<sp/>granted_qos]</highlight></codeline>
<codeline lineno="4054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(SUBACK<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4055"><highlight class="normal"></highlight></codeline>
<codeline lineno="4056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="4057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_subscribe<sp/>=<sp/>self.on_subscribe</highlight></codeline>
<codeline lineno="4058"><highlight class="normal"></highlight></codeline>
<codeline lineno="4059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_subscribe:</highlight></codeline>
<codeline lineno="4060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:<sp/><sp/>#<sp/>Don&apos;t<sp/>call<sp/>loop_write<sp/>after<sp/>_send_publish()</highlight></codeline>
<codeline lineno="4061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION1:</highlight></codeline>
<codeline lineno="4063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_subscribe<sp/>=<sp/>cast(CallbackOnSubscribe_v1_mqtt5,<sp/>on_subscribe)</highlight></codeline>
<codeline lineno="4065"><highlight class="normal"></highlight></codeline>
<codeline lineno="4066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_subscribe(</highlight></codeline>
<codeline lineno="4067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>self._userdata,<sp/>mid,<sp/>reasoncodes,<sp/>properties)</highlight></codeline>
<codeline lineno="4068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_subscribe<sp/>=<sp/>cast(CallbackOnSubscribe_v1_mqtt3,<sp/>on_subscribe)</highlight></codeline>
<codeline lineno="4070"><highlight class="normal"></highlight></codeline>
<codeline lineno="4071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_subscribe(</highlight></codeline>
<codeline lineno="4072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>self._userdata,<sp/>mid,<sp/>granted_qos)</highlight></codeline>
<codeline lineno="4073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION2:</highlight></codeline>
<codeline lineno="4074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_subscribe<sp/>=<sp/>cast(CallbackOnSubscribe_v2,<sp/>on_subscribe)</highlight></codeline>
<codeline lineno="4075"><highlight class="normal"></highlight></codeline>
<codeline lineno="4076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_subscribe(</highlight></codeline>
<codeline lineno="4077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="4078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata,</highlight></codeline>
<codeline lineno="4079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid,</highlight></codeline>
<codeline lineno="4080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes,</highlight></codeline>
<codeline lineno="4081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties,</highlight></codeline>
<codeline lineno="4082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;Unsupported<sp/>callback<sp/>API<sp/>version&quot;)</highlight></codeline>
<codeline lineno="4085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="4086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_subscribe:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="4088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="4089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="4090"><highlight class="normal"></highlight></codeline>
<codeline lineno="4091" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae83db1219569288af970d5e355a6b88f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_publish(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>self._in_packet[&apos;command&apos;]</highlight></codeline>
<codeline lineno="4093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/>MQTTMessage()</highlight></codeline>
<codeline lineno="4094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.dup<sp/>=<sp/>((header<sp/>&amp;<sp/>0x08)<sp/>&gt;&gt;<sp/>3)<sp/>!=<sp/>0</highlight></codeline>
<codeline lineno="4095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.qos<sp/>=<sp/>(header<sp/>&amp;<sp/>0x06)<sp/>&gt;&gt;<sp/>1</highlight></codeline>
<codeline lineno="4096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.retain<sp/>=<sp/>(header<sp/>&amp;<sp/>0x01)<sp/>!=<sp/>0</highlight></codeline>
<codeline lineno="4097"><highlight class="normal"></highlight></codeline>
<codeline lineno="4098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pack_format<sp/>=<sp/>f&quot;!H{len(self._in_packet[&apos;packet&apos;])<sp/>-<sp/>2}s&quot;</highlight></codeline>
<codeline lineno="4099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(slen,<sp/>packet)<sp/>=<sp/>struct.unpack(pack_format,<sp/>self._in_packet[&apos;packet&apos;])</highlight></codeline>
<codeline lineno="4100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pack_format<sp/>=<sp/>f&quot;!{slen}s{len(packet)<sp/>-<sp/>slen}s&quot;</highlight></codeline>
<codeline lineno="4101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(topic,<sp/>packet)<sp/>=<sp/>struct.unpack(pack_format,<sp/>packet)</highlight></codeline>
<codeline lineno="4102"><highlight class="normal"></highlight></codeline>
<codeline lineno="4103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>!=<sp/>MQTTv5<sp/>and<sp/>len(topic)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="4104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4105"><highlight class="normal"></highlight></codeline>
<codeline lineno="4106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Handle<sp/>topics<sp/>with<sp/>invalid<sp/>UTF-8</highlight></codeline>
<codeline lineno="4107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>This<sp/>replaces<sp/>an<sp/>invalid<sp/>topic<sp/>with<sp/>a<sp/>message<sp/>and<sp/>the<sp/>hex</highlight></codeline>
<codeline lineno="4108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>representation<sp/>of<sp/>the<sp/>topic<sp/>for<sp/>logging.<sp/>When<sp/>the<sp/>user<sp/>attempts<sp/>to</highlight></codeline>
<codeline lineno="4109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>access<sp/>message.topic<sp/>in<sp/>the<sp/>callback,<sp/>an<sp/>exception<sp/>will<sp/>be<sp/>raised.</highlight></codeline>
<codeline lineno="4110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print_topic<sp/>=<sp/>topic.decode(&apos;utf-8&apos;)</highlight></codeline>
<codeline lineno="4112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>UnicodeDecodeError:</highlight></codeline>
<codeline lineno="4113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print_topic<sp/>=<sp/>f&quot;TOPIC<sp/>WITH<sp/>INVALID<sp/>UTF-8:<sp/>{topic!r}&quot;</highlight></codeline>
<codeline lineno="4114"><highlight class="normal"></highlight></codeline>
<codeline lineno="4115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.topic<sp/>=<sp/>topic</highlight></codeline>
<codeline lineno="4116"><highlight class="normal"></highlight></codeline>
<codeline lineno="4117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>message.qos<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="4118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pack_format<sp/>=<sp/>f&quot;!H{len(packet)<sp/>-<sp/>2}s&quot;</highlight></codeline>
<codeline lineno="4119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(message.mid,<sp/>packet)<sp/>=<sp/>struct.unpack(pack_format,<sp/>packet)</highlight></codeline>
<codeline lineno="4120"><highlight class="normal"></highlight></codeline>
<codeline lineno="4121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.properties<sp/>=<sp/>Properties(PUBLISH<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>props,<sp/>props_len<sp/>=<sp/>message.properties.unpack(packet)</highlight></codeline>
<codeline lineno="4124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>packet[props_len:]</highlight></codeline>
<codeline lineno="4125"><highlight class="normal"></highlight></codeline>
<codeline lineno="4126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.payload<sp/>=<sp/>packet</highlight></codeline>
<codeline lineno="4127"><highlight class="normal"></highlight></codeline>
<codeline lineno="4128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="4131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Received<sp/>PUBLISH<sp/>(d%d,<sp/>q%d,<sp/>r%d,<sp/>m%d),<sp/>&apos;%s&apos;,<sp/>properties=%s,<sp/>...<sp/><sp/>(%d<sp/>bytes)&quot;,</highlight></codeline>
<codeline lineno="4132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.dup,<sp/>message.qos,<sp/>message.retain,<sp/>message.mid,</highlight></codeline>
<codeline lineno="4133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print_topic,<sp/>message.properties,<sp/>len(message.payload)</highlight></codeline>
<codeline lineno="4134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_DEBUG,</highlight></codeline>
<codeline lineno="4138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Received<sp/>PUBLISH<sp/>(d%d,<sp/>q%d,<sp/>r%d,<sp/>m%d),<sp/>&apos;%s&apos;,<sp/>...<sp/><sp/>(%d<sp/>bytes)&quot;,</highlight></codeline>
<codeline lineno="4139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.dup,<sp/>message.qos,<sp/>message.retain,<sp/>message.mid,</highlight></codeline>
<codeline lineno="4140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print_topic,<sp/>len(message.payload)</highlight></codeline>
<codeline lineno="4141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4142"><highlight class="normal"></highlight></codeline>
<codeline lineno="4143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.timestamp<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="4144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>message.qos<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="4145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._handle_on_message(message)</highlight></codeline>
<codeline lineno="4146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>message.qos<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="4148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._handle_on_message(message)</highlight></codeline>
<codeline lineno="4149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._manual_ack:</highlight></codeline>
<codeline lineno="4150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_puback(message.mid)</highlight></codeline>
<codeline lineno="4153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>message.qos<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4154"><highlight class="normal"></highlight></codeline>
<codeline lineno="4155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_pubrec(message.mid)</highlight></codeline>
<codeline lineno="4156"><highlight class="normal"></highlight></codeline>
<codeline lineno="4157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.state<sp/>=<sp/>mqtt_ms_wait_for_pubrel</highlight></codeline>
<codeline lineno="4158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_message_mutex:</highlight></codeline>
<codeline lineno="4159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_messages[message.mid]<sp/>=<sp/>message</highlight></codeline>
<codeline lineno="4160"><highlight class="normal"></highlight></codeline>
<codeline lineno="4161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4164"><highlight class="normal"></highlight></codeline>
<codeline lineno="4165" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a69337fe11cd767c1dc98b124c6d77e6b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>ack(self,<sp/>mid:<sp/>int,<sp/>qos:<sp/>int)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>send<sp/>an<sp/>acknowledgement<sp/>for<sp/>a<sp/>given<sp/>message<sp/>id<sp/>(stored<sp/>in<sp/>:py:attr:`message.mid<sp/>&lt;MQTTMessage.mid&gt;`).</highlight></codeline>
<codeline lineno="4168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>only<sp/>useful<sp/>in<sp/>QoS&gt;=1<sp/>and<sp/>``manual_ack=True``<sp/>(option<sp/>of<sp/>`Client`)</highlight></codeline>
<codeline lineno="4169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._manual_ack<sp/>:</highlight></codeline>
<codeline lineno="4171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>qos<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="4172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_puback(mid)</highlight></codeline>
<codeline lineno="4173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>qos<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_pubcomp(mid)</highlight></codeline>
<codeline lineno="4175"><highlight class="normal"></highlight></codeline>
<codeline lineno="4176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4177"><highlight class="normal"></highlight></codeline>
<codeline lineno="4178" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a179085039c375e37ae247b7c447b398c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>manual_ack_set(self,<sp/>on:<sp/>bool)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>paho<sp/>library<sp/>normally<sp/>acknowledges<sp/>messages<sp/>as<sp/>soon<sp/>as<sp/>they<sp/>are<sp/>delivered<sp/>to<sp/>the<sp/>caller.</highlight></codeline>
<codeline lineno="4181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>manual_ack<sp/>is<sp/>turned<sp/>on,<sp/>then<sp/>the<sp/>caller<sp/>MUST<sp/>manually<sp/>acknowledge<sp/>every<sp/>message<sp/>once</highlight></codeline>
<codeline lineno="4182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>application<sp/>processing<sp/>is<sp/>complete<sp/>using<sp/>`ack()`</highlight></codeline>
<codeline lineno="4183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._manual_ack<sp/>=<sp/>on</highlight></codeline>
<codeline lineno="4185"><highlight class="normal"></highlight></codeline>
<codeline lineno="4186"><highlight class="normal"></highlight></codeline>
<codeline lineno="4187" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a80092d3e579cbbf65ad2cae22aa211db" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_pubrel(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="4190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>!=<sp/>2:</highlight></codeline>
<codeline lineno="4192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4193"><highlight class="normal"></highlight></codeline>
<codeline lineno="4194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid,<sp/>=<sp/>struct.unpack(&quot;!H&quot;,<sp/>self._in_packet[&apos;packet&apos;][:2])</highlight></codeline>
<codeline lineno="4195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="4197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode<sp/>=<sp/>ReasonCode(PUBREL<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode.unpack(self._in_packet[&apos;packet&apos;][2:])</highlight></codeline>
<codeline lineno="4199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>3:</highlight></codeline>
<codeline lineno="4200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(PUBREL<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>props,<sp/>props_len<sp/>=<sp/>properties.unpack(</highlight></codeline>
<codeline lineno="4202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;packet&apos;][3:])</highlight></codeline>
<codeline lineno="4203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>PUBREL<sp/>(Mid:<sp/>%d)&quot;,<sp/>mid)</highlight></codeline>
<codeline lineno="4204"><highlight class="normal"></highlight></codeline>
<codeline lineno="4205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_message_mutex:</highlight></codeline>
<codeline lineno="4206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>mid<sp/>in<sp/>self._in_messages:</highlight></codeline>
<codeline lineno="4207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Only<sp/>pass<sp/>the<sp/>message<sp/>on<sp/>if<sp/>we<sp/>have<sp/>removed<sp/>it<sp/>from<sp/>the<sp/>queue<sp/>-<sp/>this</highlight></codeline>
<codeline lineno="4208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>prevents<sp/>multiple<sp/>callbacks<sp/>for<sp/>the<sp/>same<sp/>message.</highlight></codeline>
<codeline lineno="4209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/>self._in_messages.pop(mid)</highlight></codeline>
<codeline lineno="4210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._handle_on_message(message)</highlight></codeline>
<codeline lineno="4211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="4212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._max_inflight_messages<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="4213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._out_message_mutex:</highlight></codeline>
<codeline lineno="4214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._update_inflight()</highlight></codeline>
<codeline lineno="4215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>!=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="4216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4217"><highlight class="normal"></highlight></codeline>
<codeline lineno="4218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>FIXME:<sp/>this<sp/>should<sp/>only<sp/>be<sp/>done<sp/>if<sp/>the<sp/>message<sp/>is<sp/>known</highlight></codeline>
<codeline lineno="4219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>unknown<sp/>it&apos;s<sp/>a<sp/>protocol<sp/>error<sp/>and<sp/>we<sp/>should<sp/>close<sp/>the<sp/>connection.</highlight></codeline>
<codeline lineno="4220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>But<sp/>since<sp/>we<sp/>don&apos;t<sp/>have<sp/>(on<sp/>disk)<sp/>persistence<sp/>for<sp/>the<sp/>session,<sp/>it</highlight></codeline>
<codeline lineno="4221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>is<sp/>possible<sp/>that<sp/>we<sp/>must<sp/>known<sp/>about<sp/>this<sp/>message.</highlight></codeline>
<codeline lineno="4222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Choose<sp/>to<sp/>acknowledge<sp/>this<sp/>message<sp/>(thus<sp/>losing<sp/>a<sp/>message)<sp/>but</highlight></codeline>
<codeline lineno="4223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>avoid<sp/>hanging.<sp/>See<sp/>#284.</highlight></codeline>
<codeline lineno="4224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._manual_ack:</highlight></codeline>
<codeline lineno="4225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_pubcomp(mid)</highlight></codeline>
<codeline lineno="4228"><highlight class="normal"></highlight></codeline>
<codeline lineno="4229" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4b3a7a90507c93391cf9f2094cc2f355" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_update_inflight(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Dont<sp/>lock<sp/>message_mutex<sp/>here</highlight></codeline>
<codeline lineno="4231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>m<sp/>in<sp/>self._out_messages.values():</highlight></codeline>
<codeline lineno="4232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._inflight_messages<sp/>&lt;<sp/>self._max_inflight_messages:</highlight></codeline>
<codeline lineno="4233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.qos<sp/>&gt;<sp/>0<sp/>and<sp/>m.state<sp/>==<sp/>mqtt_ms_queued:</highlight></codeline>
<codeline lineno="4234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="4235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>m.qos<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="4236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_wait_for_puback</highlight></codeline>
<codeline lineno="4237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>m.qos<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.state<sp/>=<sp/>mqtt_ms_wait_for_pubrec</highlight></codeline>
<codeline lineno="4239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._send_publish(</highlight></codeline>
<codeline lineno="4240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.mid,</highlight></codeline>
<codeline lineno="4241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.topic.encode(&apos;utf-8&apos;),</highlight></codeline>
<codeline lineno="4242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.payload,</highlight></codeline>
<codeline lineno="4243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.qos,</highlight></codeline>
<codeline lineno="4244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.retain,</highlight></codeline>
<codeline lineno="4245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m.dup,</highlight></codeline>
<codeline lineno="4246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties=m.properties,</highlight></codeline>
<codeline lineno="4247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>!=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="4249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4253"><highlight class="normal"></highlight></codeline>
<codeline lineno="4254" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ae43c54e8a1a04b4409a3f8b967dfcd65" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_pubrec(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="4257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>!=<sp/>2:</highlight></codeline>
<codeline lineno="4259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4260"><highlight class="normal"></highlight></codeline>
<codeline lineno="4261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid,<sp/>=<sp/>struct.unpack(&quot;!H&quot;,<sp/>self._in_packet[&apos;packet&apos;][:2])</highlight></codeline>
<codeline lineno="4262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="4264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode<sp/>=<sp/>ReasonCode(PUBREC<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode.unpack(self._in_packet[&apos;packet&apos;][2:])</highlight></codeline>
<codeline lineno="4266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>3:</highlight></codeline>
<codeline lineno="4267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(PUBREC<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>props,<sp/>props_len<sp/>=<sp/>properties.unpack(</highlight></codeline>
<codeline lineno="4269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;packet&apos;][3:])</highlight></codeline>
<codeline lineno="4270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>PUBREC<sp/>(Mid:<sp/>%d)&quot;,<sp/>mid)</highlight></codeline>
<codeline lineno="4271"><highlight class="normal"></highlight></codeline>
<codeline lineno="4272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._out_message_mutex:</highlight></codeline>
<codeline lineno="4273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>mid<sp/>in<sp/>self._out_messages:</highlight></codeline>
<codeline lineno="4274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg<sp/>=<sp/>self._out_messages[mid]</highlight></codeline>
<codeline lineno="4275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.state<sp/>=<sp/>mqtt_ms_wait_for_pubcomp</highlight></codeline>
<codeline lineno="4276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.timestamp<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="4277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_pubrel(mid)</highlight></codeline>
<codeline lineno="4278"><highlight class="normal"></highlight></codeline>
<codeline lineno="4279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4280"><highlight class="normal"></highlight></codeline>
<codeline lineno="4281" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a31940442a31c7e3a7816a167b7ccdf57" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_unsuback(self)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&lt;<sp/>4:</highlight></codeline>
<codeline lineno="4284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>!=<sp/>2:</highlight></codeline>
<codeline lineno="4286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4287"><highlight class="normal"></highlight></codeline>
<codeline lineno="4288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid,<sp/>=<sp/>struct.unpack(&quot;!H&quot;,<sp/>self._in_packet[&apos;packet&apos;][:2])</highlight></codeline>
<codeline lineno="4289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet<sp/>=<sp/>self._in_packet[&apos;packet&apos;][2:]</highlight></codeline>
<codeline lineno="4291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(UNSUBACK<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>props,<sp/>props_len<sp/>=<sp/>properties.unpack(packet)</highlight></codeline>
<codeline lineno="4293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes_list<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="4294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReasonCode(UNSUBACK<sp/>&gt;&gt;<sp/>4,<sp/>identifier=c)</highlight></codeline>
<codeline lineno="4295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>c<sp/>in<sp/>packet[props_len:]</highlight></codeline>
<codeline lineno="4296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]</highlight></codeline>
<codeline lineno="4297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes_list<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="4299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(UNSUBACK<sp/>&gt;&gt;<sp/>4)</highlight></codeline>
<codeline lineno="4300"><highlight class="normal"></highlight></codeline>
<codeline lineno="4301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>UNSUBACK<sp/>(Mid:<sp/>%d)&quot;,<sp/>mid)</highlight></codeline>
<codeline lineno="4302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="4303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_unsubscribe<sp/>=<sp/>self.on_unsubscribe</highlight></codeline>
<codeline lineno="4304"><highlight class="normal"></highlight></codeline>
<codeline lineno="4305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_unsubscribe:</highlight></codeline>
<codeline lineno="4306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="4307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION1:</highlight></codeline>
<codeline lineno="4309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_unsubscribe<sp/>=<sp/>cast(CallbackOnUnsubscribe_v1_mqtt5,<sp/>on_unsubscribe)</highlight></codeline>
<codeline lineno="4311"><highlight class="normal"></highlight></codeline>
<codeline lineno="4312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes:<sp/>ReasonCode<sp/>|<sp/>list[ReasonCode]<sp/>=<sp/>reasoncodes_list</highlight></codeline>
<codeline lineno="4313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(reasoncodes_list)<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="4314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes<sp/>=<sp/>reasoncodes_list[0]</highlight></codeline>
<codeline lineno="4315"><highlight class="normal"></highlight></codeline>
<codeline lineno="4316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_unsubscribe(</highlight></codeline>
<codeline lineno="4317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>self._userdata,<sp/>mid,<sp/>properties,<sp/>reasoncodes)</highlight></codeline>
<codeline lineno="4318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_unsubscribe<sp/>=<sp/>cast(CallbackOnUnsubscribe_v1_mqtt3,<sp/>on_unsubscribe)</highlight></codeline>
<codeline lineno="4320"><highlight class="normal"></highlight></codeline>
<codeline lineno="4321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_unsubscribe(self,<sp/>self._userdata,<sp/>mid)</highlight></codeline>
<codeline lineno="4322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION2:</highlight></codeline>
<codeline lineno="4323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_unsubscribe<sp/>=<sp/>cast(CallbackOnUnsubscribe_v2,<sp/>on_unsubscribe)</highlight></codeline>
<codeline lineno="4324"><highlight class="normal"></highlight></codeline>
<codeline lineno="4325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="4326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(PacketTypes.CONNACK)</highlight></codeline>
<codeline lineno="4327"><highlight class="normal"></highlight></codeline>
<codeline lineno="4328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_unsubscribe(</highlight></codeline>
<codeline lineno="4329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="4330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata,</highlight></codeline>
<codeline lineno="4331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid,</highlight></codeline>
<codeline lineno="4332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasoncodes_list,</highlight></codeline>
<codeline lineno="4333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties,</highlight></codeline>
<codeline lineno="4334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;Unsupported<sp/>callback<sp/>API<sp/>version&quot;)</highlight></codeline>
<codeline lineno="4337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="4338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_unsubscribe:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="4340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="4341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="4342"><highlight class="normal"></highlight></codeline>
<codeline lineno="4343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4344"><highlight class="normal"></highlight></codeline>
<codeline lineno="4345" refid="classpaho_1_1mqtt_1_1client_1_1_client_1aedce7105817eb81904b77a1dde5fc53b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_do_on_disconnect(</highlight></codeline>
<codeline lineno="4346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="4347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_from_broker:<sp/>bool,</highlight></codeline>
<codeline lineno="4348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v1_rc:<sp/>MQTTErrorCode,</highlight></codeline>
<codeline lineno="4349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason:<sp/>ReasonCode<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="4350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties:<sp/>Properties<sp/>|<sp/>None<sp/>=<sp/>None,</highlight></codeline>
<codeline lineno="4351"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="4353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect<sp/>=<sp/>self.on_disconnect</highlight></codeline>
<codeline lineno="4354"><highlight class="normal"></highlight></codeline>
<codeline lineno="4355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_disconnect:</highlight></codeline>
<codeline lineno="4356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="4357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION1:</highlight></codeline>
<codeline lineno="4359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect<sp/>=<sp/>cast(CallbackOnDisconnect_v1_mqtt5,<sp/>on_disconnect)</highlight></codeline>
<codeline lineno="4361"><highlight class="normal"></highlight></codeline>
<codeline lineno="4362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>packet_from_broker:</highlight></codeline>
<codeline lineno="4363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect(self,<sp/>self._userdata,<sp/>reason,<sp/>properties)</highlight></codeline>
<codeline lineno="4364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect(self,<sp/>self._userdata,<sp/>v1_rc,<sp/>None)</highlight></codeline>
<codeline lineno="4366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect<sp/>=<sp/>cast(CallbackOnDisconnect_v1_mqtt3,<sp/>on_disconnect)</highlight></codeline>
<codeline lineno="4368"><highlight class="normal"></highlight></codeline>
<codeline lineno="4369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect(self,<sp/>self._userdata,<sp/>v1_rc)</highlight></codeline>
<codeline lineno="4370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION2:</highlight></codeline>
<codeline lineno="4371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect<sp/>=<sp/>cast(CallbackOnDisconnect_v2,<sp/>on_disconnect)</highlight></codeline>
<codeline lineno="4372"><highlight class="normal"></highlight></codeline>
<codeline lineno="4373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnect_flags<sp/>=<sp/>DisconnectFlags(</highlight></codeline>
<codeline lineno="4374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_disconnect_packet_from_server=packet_from_broker</highlight></codeline>
<codeline lineno="4375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4376"><highlight class="normal"></highlight></codeline>
<codeline lineno="4377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>reason<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="4378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason<sp/>=<sp/>convert_disconnect_error_code_to_reason_code(v1_rc)</highlight></codeline>
<codeline lineno="4379"><highlight class="normal"></highlight></codeline>
<codeline lineno="4380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>properties<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="4381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(PacketTypes.DISCONNECT)</highlight></codeline>
<codeline lineno="4382"><highlight class="normal"></highlight></codeline>
<codeline lineno="4383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_disconnect(</highlight></codeline>
<codeline lineno="4384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="4385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata,</highlight></codeline>
<codeline lineno="4386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnect_flags,</highlight></codeline>
<codeline lineno="4387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason,</highlight></codeline>
<codeline lineno="4388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties,</highlight></codeline>
<codeline lineno="4389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;Unsupported<sp/>callback<sp/>API<sp/>version&quot;)</highlight></codeline>
<codeline lineno="4392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="4393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_disconnect:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="4395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="4396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="4397"><highlight class="normal"></highlight></codeline>
<codeline lineno="4398" refid="classpaho_1_1mqtt_1_1client_1_1_client_1af9fd87e840b1fe42aec1e1f287cefd3c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_do_on_publish(self,<sp/>mid:<sp/>int,<sp/>reason_code:<sp/>ReasonCode,<sp/>properties:<sp/>Properties)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="4400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish<sp/>=<sp/>self.on_publish</highlight></codeline>
<codeline lineno="4401"><highlight class="normal"></highlight></codeline>
<codeline lineno="4402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_publish:</highlight></codeline>
<codeline lineno="4403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="4404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION1:</highlight></codeline>
<codeline lineno="4406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish<sp/>=<sp/>cast(CallbackOnPublish_v1,<sp/>on_publish)</highlight></codeline>
<codeline lineno="4407"><highlight class="normal"></highlight></codeline>
<codeline lineno="4408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish(self,<sp/>self._userdata,<sp/>mid)</highlight></codeline>
<codeline lineno="4409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._callback_api_version<sp/>==<sp/>CallbackAPIVersion.VERSION2:</highlight></codeline>
<codeline lineno="4410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish<sp/>=<sp/>cast(CallbackOnPublish_v2,<sp/>on_publish)</highlight></codeline>
<codeline lineno="4411"><highlight class="normal"></highlight></codeline>
<codeline lineno="4412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_publish(</highlight></codeline>
<codeline lineno="4413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="4414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._userdata,</highlight></codeline>
<codeline lineno="4415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid,</highlight></codeline>
<codeline lineno="4416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason_code,</highlight></codeline>
<codeline lineno="4417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties,</highlight></codeline>
<codeline lineno="4418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>RuntimeError(&quot;Unsupported<sp/>callback<sp/>API<sp/>version&quot;)</highlight></codeline>
<codeline lineno="4421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="4422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_publish:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="4424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="4425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="4426"><highlight class="normal"></highlight></codeline>
<codeline lineno="4427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg<sp/>=<sp/>self._out_messages.pop(mid)</highlight></codeline>
<codeline lineno="4428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.info._set_as_published()</highlight></codeline>
<codeline lineno="4429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>msg.qos<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="4430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._inflight_messages<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="4431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._max_inflight_messages<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="4432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._update_inflight()</highlight></codeline>
<codeline lineno="4433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>rc<sp/>!=<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS:</highlight></codeline>
<codeline lineno="4434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4436"><highlight class="normal"></highlight></codeline>
<codeline lineno="4437" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a5ae2689ee0b4c83a0ac54d4c5d853d19" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_pubackcomp(</highlight></codeline>
<codeline lineno="4438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>cmd:<sp/>Literal[&apos;PUBACK&apos;]<sp/>|<sp/>Literal[&apos;PUBCOMP&apos;]</highlight></codeline>
<codeline lineno="4439"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>MQTTErrorCode:</highlight></codeline>
<codeline lineno="4440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="4442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>!=<sp/>2:</highlight></codeline>
<codeline lineno="4444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_PROTOCOL</highlight></codeline>
<codeline lineno="4445"><highlight class="normal"></highlight></codeline>
<codeline lineno="4446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_type_enum<sp/>=<sp/>PUBACK<sp/>if<sp/>cmd<sp/>==<sp/>&quot;PUBACK&quot;<sp/>else<sp/>PUBCOMP</highlight></codeline>
<codeline lineno="4447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>packet_type<sp/>=<sp/>packet_type_enum.value<sp/>&gt;&gt;<sp/>4</highlight></codeline>
<codeline lineno="4448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mid,<sp/>=<sp/>struct.unpack(&quot;!H&quot;,<sp/>self._in_packet[&apos;packet&apos;][:2])</highlight></codeline>
<codeline lineno="4449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode<sp/>=<sp/>ReasonCode(packet_type)</highlight></codeline>
<codeline lineno="4450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>Properties(packet_type)</highlight></codeline>
<codeline lineno="4451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._protocol<sp/>==<sp/>MQTTv5:</highlight></codeline>
<codeline lineno="4452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="4453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reasonCode.unpack(self._in_packet[&apos;packet&apos;][2:])</highlight></codeline>
<codeline lineno="4454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._in_packet[&apos;remaining_length&apos;]<sp/>&gt;<sp/>3:</highlight></codeline>
<codeline lineno="4455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>props,<sp/>props_len<sp/>=<sp/>properties.unpack(</highlight></codeline>
<codeline lineno="4456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._in_packet[&apos;packet&apos;][3:])</highlight></codeline>
<codeline lineno="4457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(MQTT_LOG_DEBUG,<sp/>&quot;Received<sp/>%s<sp/>(Mid:<sp/>%d)&quot;,<sp/>cmd,<sp/>mid)</highlight></codeline>
<codeline lineno="4458"><highlight class="normal"></highlight></codeline>
<codeline lineno="4459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._out_message_mutex:</highlight></codeline>
<codeline lineno="4460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>mid<sp/>in<sp/>self._out_messages:</highlight></codeline>
<codeline lineno="4461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Only<sp/>inform<sp/>the<sp/>client<sp/>the<sp/>message<sp/>has<sp/>been<sp/>sent<sp/>once.</highlight></codeline>
<codeline lineno="4462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>self._do_on_publish(mid,<sp/>reasonCode,<sp/>properties)</highlight></codeline>
<codeline lineno="4463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>rc</highlight></codeline>
<codeline lineno="4464"><highlight class="normal"></highlight></codeline>
<codeline lineno="4465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>MQTTErrorCode.MQTT_ERR_SUCCESS</highlight></codeline>
<codeline lineno="4466"><highlight class="normal"></highlight></codeline>
<codeline lineno="4467" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a77f53cbcd1dd07e8a9fbf1b25e54d9ff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_on_message(self,<sp/>message:<sp/>MQTTMessage)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4468"><highlight class="normal"></highlight></codeline>
<codeline lineno="4469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic<sp/>=<sp/>message.topic</highlight></codeline>
<codeline lineno="4471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>UnicodeDecodeError:</highlight></codeline>
<codeline lineno="4472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topic<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="4473"><highlight class="normal"></highlight></codeline>
<codeline lineno="4474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_message_callbacks<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="4475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="4476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>topic<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="4477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_message_callbacks<sp/>=<sp/>list(self._on_message_filtered.iter_match(message.topic))</highlight></codeline>
<codeline lineno="4478"><highlight class="normal"></highlight></codeline>
<codeline lineno="4479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(on_message_callbacks)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="4480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_message<sp/>=<sp/>self.on_message</highlight></codeline>
<codeline lineno="4481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_message<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="4483"><highlight class="normal"></highlight></codeline>
<codeline lineno="4484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>callback<sp/>in<sp/>on_message_callbacks:</highlight></codeline>
<codeline lineno="4485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="4486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callback(self,<sp/>self._userdata,<sp/>message)</highlight></codeline>
<codeline lineno="4488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="4489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,</highlight></codeline>
<codeline lineno="4491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;Caught<sp/>exception<sp/>in<sp/>user<sp/>defined<sp/>callback<sp/>function<sp/>%s:<sp/>%s&apos;,</highlight></codeline>
<codeline lineno="4492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callback.__name__,</highlight></codeline>
<codeline lineno="4493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err</highlight></codeline>
<codeline lineno="4494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="4496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="4497"><highlight class="normal"></highlight></codeline>
<codeline lineno="4498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_message:</highlight></codeline>
<codeline lineno="4499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="4500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_message(self,<sp/>self._userdata,<sp/>message)</highlight></codeline>
<codeline lineno="4502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="4503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_message:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="4505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>self.suppress_exceptions:</highlight></codeline>
<codeline lineno="4506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="4507"><highlight class="normal"></highlight></codeline>
<codeline lineno="4508"><highlight class="normal"></highlight></codeline>
<codeline lineno="4509" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a6cb677804ce5e4a0c2806c7f2904be92" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_handle_on_connect_fail(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._callback_mutex:</highlight></codeline>
<codeline lineno="4511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect_fail<sp/>=<sp/>self.on_connect_fail</highlight></codeline>
<codeline lineno="4512"><highlight class="normal"></highlight></codeline>
<codeline lineno="4513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>on_connect_fail:</highlight></codeline>
<codeline lineno="4514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._in_callback_mutex:</highlight></codeline>
<codeline lineno="4515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>on_connect_fail(self,<sp/>self._userdata)</highlight></codeline>
<codeline lineno="4517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>Exception<sp/>as<sp/>err:</highlight></codeline>
<codeline lineno="4518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._easy_log(</highlight></codeline>
<codeline lineno="4519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MQTT_LOG_ERR,<sp/>&apos;Caught<sp/>exception<sp/>in<sp/>on_connect_fail:<sp/>%s&apos;,<sp/>err)</highlight></codeline>
<codeline lineno="4520"><highlight class="normal"></highlight></codeline>
<codeline lineno="4521" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a00ed94095a6803019a239082f6e5f7ef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_thread_main(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.loop_forever(retry_first_connection=True)</highlight></codeline>
<codeline lineno="4524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finally:</highlight></codeline>
<codeline lineno="4525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._thread<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="4526"><highlight class="normal"></highlight></codeline>
<codeline lineno="4527" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a993bdd92083a4e903de85e24ac348176" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_reconnect_wait(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>See<sp/>reconnect_delay_set<sp/>for<sp/>details</highlight></codeline>
<codeline lineno="4529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>now<sp/>=<sp/>time_func()</highlight></codeline>
<codeline lineno="4530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>self._reconnect_delay_mutex:</highlight></codeline>
<codeline lineno="4531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._reconnect_delay<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="4532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_delay<sp/>=<sp/>self._reconnect_min_delay</highlight></codeline>
<codeline lineno="4533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_delay<sp/>=<sp/>min(</highlight></codeline>
<codeline lineno="4535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_delay<sp/>*<sp/>2,</highlight></codeline>
<codeline lineno="4536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._reconnect_max_delay,</highlight></codeline>
<codeline lineno="4537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4538"><highlight class="normal"></highlight></codeline>
<codeline lineno="4539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_time<sp/>=<sp/>now<sp/>+<sp/>self._reconnect_delay</highlight></codeline>
<codeline lineno="4540"><highlight class="normal"></highlight></codeline>
<codeline lineno="4541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining<sp/>=<sp/>target_time<sp/>-<sp/>now</highlight></codeline>
<codeline lineno="4542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>(self._state<sp/>not<sp/>in<sp/>(_ConnectionState.MQTT_CS_DISCONNECTING,<sp/>_ConnectionState.MQTT_CS_DISCONNECTED)</highlight></codeline>
<codeline lineno="4543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>not<sp/>self._thread_terminate</highlight></codeline>
<codeline lineno="4544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>remaining<sp/>&gt;<sp/>0):</highlight></codeline>
<codeline lineno="4545"><highlight class="normal"></highlight></codeline>
<codeline lineno="4546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>time.sleep(min(remaining,<sp/>1))</highlight></codeline>
<codeline lineno="4547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining<sp/>=<sp/>target_time<sp/>-<sp/>time_func()</highlight></codeline>
<codeline lineno="4548"><highlight class="normal"></highlight></codeline>
<codeline lineno="4549"><highlight class="normal"><sp/><sp/><sp/><sp/>@staticmethod</highlight></codeline>
<codeline lineno="4550" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a20c30a92a4173f13c3865d5af9bb8318" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_proxy_is_valid(p)<sp/>-&gt;<sp/>bool:<sp/><sp/>#<sp/>type:<sp/>ignore[no-untyped-def]</highlight></codeline>
<codeline lineno="4551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>check(t,<sp/>a)<sp/>-&gt;<sp/>bool:<sp/><sp/>#<sp/>type:<sp/>ignore[no-untyped-def]</highlight></codeline>
<codeline lineno="4552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(socks<sp/>is<sp/>not<sp/>None<sp/>and</highlight></codeline>
<codeline lineno="4553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>in<sp/>{socks.HTTP,<sp/>socks.SOCKS4,<sp/>socks.SOCKS5}<sp/>and<sp/>a)</highlight></codeline>
<codeline lineno="4554"><highlight class="normal"></highlight></codeline>
<codeline lineno="4555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(p,<sp/>dict):</highlight></codeline>
<codeline lineno="4556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>check(p.get(&quot;proxy_type&quot;),<sp/>p.get(&quot;proxy_addr&quot;))</highlight></codeline>
<codeline lineno="4557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>isinstance(p,<sp/>(list,<sp/>tuple)):</highlight></codeline>
<codeline lineno="4558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>len(p)<sp/>==<sp/>6<sp/>and<sp/>check(p[0],<sp/>p[1])</highlight></codeline>
<codeline lineno="4559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>False</highlight></codeline>
<codeline lineno="4561"><highlight class="normal"></highlight></codeline>
<codeline lineno="4562" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ac887e69fd47cd36be0d582b1d569e402" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_get_proxy(self)<sp/>-&gt;<sp/>dict[str,<sp/>Any]<sp/>|<sp/>None:</highlight></codeline>
<codeline lineno="4563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>socks<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="4564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>None</highlight></codeline>
<codeline lineno="4565"><highlight class="normal"></highlight></codeline>
<codeline lineno="4566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>First,<sp/>check<sp/>if<sp/>the<sp/>user<sp/>explicitly<sp/>passed<sp/>us<sp/>a<sp/>proxy<sp/>to<sp/>use</highlight></codeline>
<codeline lineno="4567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._proxy_is_valid(self._proxy):</highlight></codeline>
<codeline lineno="4568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._proxy</highlight></codeline>
<codeline lineno="4569"><highlight class="normal"></highlight></codeline>
<codeline lineno="4570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Next,<sp/>check<sp/>for<sp/>an<sp/>mqtt_proxy<sp/>environment<sp/>variable<sp/>as<sp/>long<sp/>as<sp/>the<sp/>host</highlight></codeline>
<codeline lineno="4571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>we&apos;re<sp/>trying<sp/>to<sp/>connect<sp/>to<sp/>isn&apos;t<sp/>listed<sp/>under<sp/>the<sp/>no_proxy<sp/>environment</highlight></codeline>
<codeline lineno="4572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>variable<sp/>(matches<sp/>built-in<sp/>module<sp/>urllib&apos;s<sp/>behavior)</highlight></codeline>
<codeline lineno="4573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>(hasattr(urllib.request,<sp/>&quot;proxy_bypass&quot;)<sp/>and</highlight></codeline>
<codeline lineno="4574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>urllib.request.proxy_bypass(self._host)):</highlight></codeline>
<codeline lineno="4575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>env_proxies<sp/>=<sp/>urllib.request.getproxies()</highlight></codeline>
<codeline lineno="4576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>&quot;mqtt&quot;<sp/>in<sp/>env_proxies:</highlight></codeline>
<codeline lineno="4577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parts<sp/>=<sp/>urllib.parse.urlparse(env_proxies[&quot;mqtt&quot;])</highlight></codeline>
<codeline lineno="4578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>parts.scheme<sp/>==<sp/>&quot;http&quot;:</highlight></codeline>
<codeline lineno="4579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>proxy<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="4580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;proxy_type&quot;:<sp/>socks.HTTP,</highlight></codeline>
<codeline lineno="4581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;proxy_addr&quot;:<sp/>parts.hostname,</highlight></codeline>
<codeline lineno="4582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;proxy_port&quot;:<sp/>parts.port</highlight></codeline>
<codeline lineno="4583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>proxy</highlight></codeline>
<codeline lineno="4585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>parts.scheme<sp/>==<sp/>&quot;socks&quot;:</highlight></codeline>
<codeline lineno="4586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>proxy<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="4587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;proxy_type&quot;:<sp/>socks.SOCKS5,</highlight></codeline>
<codeline lineno="4588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;proxy_addr&quot;:<sp/>parts.hostname,</highlight></codeline>
<codeline lineno="4589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;proxy_port&quot;:<sp/>parts.port</highlight></codeline>
<codeline lineno="4590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>proxy</highlight></codeline>
<codeline lineno="4592"><highlight class="normal"></highlight></codeline>
<codeline lineno="4593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Finally,<sp/>check<sp/>if<sp/>the<sp/>user<sp/>has<sp/>monkeypatched<sp/>the<sp/>PySocks<sp/>library<sp/>with</highlight></codeline>
<codeline lineno="4594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>a<sp/>default<sp/>proxy</highlight></codeline>
<codeline lineno="4595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socks_default<sp/>=<sp/>socks.get_default_proxy()</highlight></codeline>
<codeline lineno="4596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._proxy_is_valid(socks_default):</highlight></codeline>
<codeline lineno="4597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>proxy_keys<sp/>=<sp/>(&quot;proxy_type&quot;,<sp/>&quot;proxy_addr&quot;,<sp/>&quot;proxy_port&quot;,</highlight></codeline>
<codeline lineno="4598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;proxy_rdns&quot;,<sp/>&quot;proxy_username&quot;,<sp/>&quot;proxy_password&quot;)</highlight></codeline>
<codeline lineno="4599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>dict(zip(proxy_keys,<sp/>socks_default))</highlight></codeline>
<codeline lineno="4600"><highlight class="normal"></highlight></codeline>
<codeline lineno="4601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>we<sp/>didn&apos;t<sp/>find<sp/>a<sp/>proxy<sp/>through<sp/>any<sp/>of<sp/>the<sp/>above<sp/>methods,<sp/>return</highlight></codeline>
<codeline lineno="4602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>None<sp/>to<sp/>indicate<sp/>that<sp/>the<sp/>connection<sp/>should<sp/>be<sp/>handled<sp/>normally</highlight></codeline>
<codeline lineno="4603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>None</highlight></codeline>
<codeline lineno="4604"><highlight class="normal"></highlight></codeline>
<codeline lineno="4605" refid="classpaho_1_1mqtt_1_1client_1_1_client_1ab0b63bb981bf9a4eddd21a84b6c6b883" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_create_socket(self)<sp/>-&gt;<sp/>SocketLike:</highlight></codeline>
<codeline lineno="4606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._transport<sp/>==<sp/>&quot;unix&quot;:</highlight></codeline>
<codeline lineno="4607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock<sp/>=<sp/>self._create_unix_socket_connection()</highlight></codeline>
<codeline lineno="4608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock<sp/>=<sp/>self._create_socket_connection()</highlight></codeline>
<codeline lineno="4610"><highlight class="normal"></highlight></codeline>
<codeline lineno="4611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ssl:</highlight></codeline>
<codeline lineno="4612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock<sp/>=<sp/>self._ssl_wrap_socket(sock)</highlight></codeline>
<codeline lineno="4613"><highlight class="normal"></highlight></codeline>
<codeline lineno="4614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._transport<sp/>==<sp/>&quot;websockets&quot;:</highlight></codeline>
<codeline lineno="4615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sock.settimeout(self._keepalive)</highlight></codeline>
<codeline lineno="4616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>_WebsocketWrapper(</highlight></codeline>
<codeline lineno="4617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket=sock,</highlight></codeline>
<codeline lineno="4618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host=self._host,</highlight></codeline>
<codeline lineno="4619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>port=self._port,</highlight></codeline>
<codeline lineno="4620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_ssl=self._ssl,</highlight></codeline>
<codeline lineno="4621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path=self._websocket_path,</highlight></codeline>
<codeline lineno="4622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_headers=self._websocket_extra_headers,</highlight></codeline>
<codeline lineno="4623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4624"><highlight class="normal"></highlight></codeline>
<codeline lineno="4625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>sock</highlight></codeline>
<codeline lineno="4626"><highlight class="normal"></highlight></codeline>
<codeline lineno="4627" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a4926203b0f912b4bbb79d1ab74d0af1c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_create_unix_socket_connection(self)<sp/>-&gt;<sp/>_socket.socket:</highlight></codeline>
<codeline lineno="4628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unix_socket<sp/>=<sp/>socket.socket(socket.AF_UNIX,<sp/>socket.SOCK_STREAM)</highlight></codeline>
<codeline lineno="4629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unix_socket.connect(self._host)</highlight></codeline>
<codeline lineno="4630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>unix_socket</highlight></codeline>
<codeline lineno="4631"><highlight class="normal"></highlight></codeline>
<codeline lineno="4632" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a8aa7ad68fdd6428984618200990668de" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_create_socket_connection(self)<sp/>-&gt;<sp/>_socket.socket:</highlight></codeline>
<codeline lineno="4633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>proxy<sp/>=<sp/>self._get_proxy()</highlight></codeline>
<codeline lineno="4634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>addr<sp/>=<sp/>(self._host,<sp/>self._port)</highlight></codeline>
<codeline lineno="4635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>(self._bind_address,<sp/>self._bind_port)</highlight></codeline>
<codeline lineno="4636"><highlight class="normal"></highlight></codeline>
<codeline lineno="4637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>proxy:</highlight></codeline>
<codeline lineno="4638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>socks.create_connection(addr,<sp/>timeout=self._connect_timeout,<sp/>source_address=source,<sp/>**proxy)</highlight></codeline>
<codeline lineno="4639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>socket.create_connection(addr,<sp/>timeout=self._connect_timeout,<sp/>source_address=source)</highlight></codeline>
<codeline lineno="4641"><highlight class="normal"></highlight></codeline>
<codeline lineno="4642" refid="classpaho_1_1mqtt_1_1client_1_1_client_1a477426a5a3c632b26b9656f595b792fd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_ssl_wrap_socket(self,<sp/>tcp_sock:<sp/>_socket.socket)<sp/>-&gt;<sp/>ssl.SSLSocket:</highlight></codeline>
<codeline lineno="4643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ssl_context<sp/>is<sp/>None:</highlight></codeline>
<codeline lineno="4644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(</highlight></codeline>
<codeline lineno="4645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Impossible<sp/>condition.<sp/>_ssl_context<sp/>should<sp/>never<sp/>be<sp/>None<sp/>if<sp/>_ssl<sp/>is<sp/>True&quot;</highlight></codeline>
<codeline lineno="4646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4647"><highlight class="normal"></highlight></codeline>
<codeline lineno="4648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify_host<sp/>=<sp/>not<sp/>self._tls_insecure</highlight></codeline>
<codeline lineno="4649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Try<sp/>with<sp/>server_hostname,<sp/>even<sp/>it&apos;s<sp/>not<sp/>supported<sp/>in<sp/>certain<sp/>scenarios</highlight></codeline>
<codeline lineno="4651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl_sock<sp/>=<sp/>self._ssl_context.wrap_socket(</highlight></codeline>
<codeline lineno="4652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcp_sock,</highlight></codeline>
<codeline lineno="4653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>server_hostname=self._host,</highlight></codeline>
<codeline lineno="4654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>do_handshake_on_connect=False,</highlight></codeline>
<codeline lineno="4655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ssl.CertificateError:</highlight></codeline>
<codeline lineno="4657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>CertificateError<sp/>is<sp/>derived<sp/>from<sp/>ValueError</highlight></codeline>
<codeline lineno="4658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise</highlight></codeline>
<codeline lineno="4659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ValueError:</highlight></codeline>
<codeline lineno="4660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Python<sp/>version<sp/>requires<sp/>SNI<sp/>in<sp/>order<sp/>to<sp/>handle<sp/>server_hostname,<sp/>but<sp/>SNI<sp/>is<sp/>not<sp/>available</highlight></codeline>
<codeline lineno="4661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl_sock<sp/>=<sp/>self._ssl_context.wrap_socket(</highlight></codeline>
<codeline lineno="4662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcp_sock,</highlight></codeline>
<codeline lineno="4663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>do_handshake_on_connect=False,</highlight></codeline>
<codeline lineno="4664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="4665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>If<sp/>SSL<sp/>context<sp/>has<sp/>already<sp/>checked<sp/>hostname,<sp/>then<sp/>don&apos;t<sp/>need<sp/>to<sp/>do<sp/>it<sp/>again</highlight></codeline>
<codeline lineno="4667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>getattr(self._ssl_context,<sp/>&apos;check_hostname&apos;,<sp/>False):<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="4668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify_host<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="4669"><highlight class="normal"></highlight></codeline>
<codeline lineno="4670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl_sock.settimeout(self._keepalive)</highlight></codeline>
<codeline lineno="4671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl_sock.do_handshake()</highlight></codeline>
<codeline lineno="4672"><highlight class="normal"></highlight></codeline>
<codeline lineno="4673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>verify_host:</highlight></codeline>
<codeline lineno="4674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>TODO:<sp/>this<sp/>type<sp/>error<sp/>is<sp/>a<sp/>true<sp/>error:</highlight></codeline>
<codeline lineno="4675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>error:<sp/>Module<sp/>has<sp/>no<sp/>attribute<sp/>&quot;match_hostname&quot;<sp/><sp/>[attr-defined]</highlight></codeline>
<codeline lineno="4676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Python<sp/>3.12<sp/>no<sp/>longer<sp/>have<sp/>this<sp/>method.</highlight></codeline>
<codeline lineno="4677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssl.match_hostname(ssl_sock.getpeercert(),<sp/>self._host)<sp/><sp/>#<sp/>type:<sp/>ignore</highlight></codeline>
<codeline lineno="4678"><highlight class="normal"></highlight></codeline>
<codeline lineno="4679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>ssl_sock</highlight></codeline>
<codeline lineno="4680"><highlight class="normal"></highlight></codeline>
<codeline lineno="4681" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper" refkind="compound"><highlight class="normal">class<sp/>_WebsocketWrapper:</highlight></codeline>
<codeline lineno="4682" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a709f940caf89bedf529df84dd3890b09" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>OPCODE_CONTINUATION<sp/>=<sp/>0x0</highlight></codeline>
<codeline lineno="4683" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1ae0d128093c632f2c54f4a5ee3f52876c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>OPCODE_TEXT<sp/>=<sp/>0x1</highlight></codeline>
<codeline lineno="4684" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1ac3e154922637610c6fc13cd13b1be610" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>OPCODE_BINARY<sp/>=<sp/>0x2</highlight></codeline>
<codeline lineno="4685" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1ad2c958097d31e7d32c04f72f3feb3238" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>OPCODE_CONNCLOSE<sp/>=<sp/>0x8</highlight></codeline>
<codeline lineno="4686" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1abca92f365e3f895b55f7655e322c35bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>OPCODE_PING<sp/>=<sp/>0x9</highlight></codeline>
<codeline lineno="4687" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1ae3a570ecf65adb5621abb1c3bd974022" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>OPCODE_PONG<sp/>=<sp/>0xa</highlight></codeline>
<codeline lineno="4688"><highlight class="normal"></highlight></codeline>
<codeline lineno="4689"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>__init__(</highlight></codeline>
<codeline lineno="4690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="4691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>socket:<sp/>socket.socket<sp/>|<sp/>ssl.SSLSocket,</highlight></codeline>
<codeline lineno="4692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host:<sp/>str,</highlight></codeline>
<codeline lineno="4693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>port:<sp/>int,</highlight></codeline>
<codeline lineno="4694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_ssl:<sp/>bool,</highlight></codeline>
<codeline lineno="4695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path:<sp/>str,</highlight></codeline>
<codeline lineno="4696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_headers:<sp/>WebSocketHeaders<sp/>|<sp/>None,</highlight></codeline>
<codeline lineno="4697"><highlight class="normal"><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="4698" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1af268a1bb18fdbf2f78f2dbfea37cdee8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.connected<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="4699"><highlight class="normal"></highlight></codeline>
<codeline lineno="4700" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1aea0c6f2614f9d3aa836c56fb1c9d1e82" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._ssl<sp/>=<sp/>is_ssl</highlight></codeline>
<codeline lineno="4701" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1ad662e0314cf57007af872e216478bf2a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._host<sp/>=<sp/>host</highlight></codeline>
<codeline lineno="4702" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1aeceafe5ba6f8e9244957b3cc69227bc9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._port<sp/>=<sp/>port</highlight></codeline>
<codeline lineno="4703" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a1517ae45113a3c41dbf9e9d5af217100" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._socket<sp/>=<sp/>socket</highlight></codeline>
<codeline lineno="4704" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a36256e6ba288315638de51f0b40d9760" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._path<sp/>=<sp/>path</highlight></codeline>
<codeline lineno="4705"><highlight class="normal"></highlight></codeline>
<codeline lineno="4706" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a3cd6ff7447f9f99e3b1e53c592c5a8b5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sendbuffer<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4707" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a423590f97d54292bccbbc6ccaa50010b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4708"><highlight class="normal"></highlight></codeline>
<codeline lineno="4709" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1afc2f6d29479fb022470fb83caf2091a4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._requested_size<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="4710" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1ae1a102186129a74701b854da9426e1d5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._payload_head<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="4711" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a04cf02cf35c746471fcb3f66a7563f32" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer_head<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="4712"><highlight class="normal"></highlight></codeline>
<codeline lineno="4713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._do_handshake(extra_headers)</highlight></codeline>
<codeline lineno="4714"><highlight class="normal"></highlight></codeline>
<codeline lineno="4715"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>__del__(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sendbuffer<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4718"><highlight class="normal"></highlight></codeline>
<codeline lineno="4719" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a8e23bbb260d489f8a7ceb9b702ae8ee1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_do_handshake(self,<sp/>extra_headers:<sp/>WebSocketHeaders<sp/>|<sp/>None)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4720"><highlight class="normal"></highlight></codeline>
<codeline lineno="4721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sec_websocket_key<sp/>=<sp/>uuid.uuid4().bytes</highlight></codeline>
<codeline lineno="4722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sec_websocket_key<sp/>=<sp/>base64.b64encode(sec_websocket_key)</highlight></codeline>
<codeline lineno="4723"><highlight class="normal"></highlight></codeline>
<codeline lineno="4724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ssl:</highlight></codeline>
<codeline lineno="4725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default_port<sp/>=<sp/>443</highlight></codeline>
<codeline lineno="4726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_schema<sp/>=<sp/>&quot;https&quot;</highlight></codeline>
<codeline lineno="4727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default_port<sp/>=<sp/>80</highlight></codeline>
<codeline lineno="4729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>http_schema<sp/>=<sp/>&quot;http&quot;</highlight></codeline>
<codeline lineno="4730"><highlight class="normal"></highlight></codeline>
<codeline lineno="4731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>default_port<sp/>==<sp/>self._port:</highlight></codeline>
<codeline lineno="4732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host_port<sp/>=<sp/>f&quot;{self._host}&quot;</highlight></codeline>
<codeline lineno="4733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>host_port<sp/>=<sp/>f&quot;{self._host}:{self._port}&quot;</highlight></codeline>
<codeline lineno="4735"><highlight class="normal"></highlight></codeline>
<codeline lineno="4736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>websocket_headers<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="4737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Host&quot;:<sp/>host_port,</highlight></codeline>
<codeline lineno="4738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Upgrade&quot;:<sp/>&quot;websocket&quot;,</highlight></codeline>
<codeline lineno="4739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Connection&quot;:<sp/>&quot;Upgrade&quot;,</highlight></codeline>
<codeline lineno="4740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Origin&quot;:<sp/>f&quot;{http_schema}://{host_port}&quot;,</highlight></codeline>
<codeline lineno="4741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sec-WebSocket-Key&quot;:<sp/>sec_websocket_key.decode(&quot;utf8&quot;),</highlight></codeline>
<codeline lineno="4742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sec-Websocket-Version&quot;:<sp/>&quot;13&quot;,</highlight></codeline>
<codeline lineno="4743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;Sec-Websocket-Protocol&quot;:<sp/>&quot;mqtt&quot;,</highlight></codeline>
<codeline lineno="4744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4745"><highlight class="normal"></highlight></codeline>
<codeline lineno="4746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>This<sp/>is<sp/>checked<sp/>in<sp/>ws_set_options<sp/>so<sp/>it<sp/>will<sp/>either<sp/>be<sp/>None,<sp/>a</highlight></codeline>
<codeline lineno="4747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>dictionary,<sp/>or<sp/>a<sp/>callable</highlight></codeline>
<codeline lineno="4748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>isinstance(extra_headers,<sp/>dict):</highlight></codeline>
<codeline lineno="4749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>websocket_headers.update(extra_headers)</highlight></codeline>
<codeline lineno="4750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>callable(extra_headers):</highlight></codeline>
<codeline lineno="4751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>websocket_headers<sp/>=<sp/>extra_headers(websocket_headers)</highlight></codeline>
<codeline lineno="4752"><highlight class="normal"></highlight></codeline>
<codeline lineno="4753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>&quot;\r\n&quot;.join([</highlight></codeline>
<codeline lineno="4754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f&quot;GET<sp/>{self._path}<sp/>HTTP/1.1&quot;,</highlight></codeline>
<codeline lineno="4755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;\r\n&quot;.join(f&quot;{i}:<sp/>{j}&quot;<sp/>for<sp/>i,<sp/>j<sp/>in<sp/>websocket_headers.items()),</highlight></codeline>
<codeline lineno="4756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;\r\n&quot;,</highlight></codeline>
<codeline lineno="4757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]).encode(&quot;utf8&quot;)</highlight></codeline>
<codeline lineno="4758"><highlight class="normal"></highlight></codeline>
<codeline lineno="4759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._socket.send(header)</highlight></codeline>
<codeline lineno="4760"><highlight class="normal"></highlight></codeline>
<codeline lineno="4761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>has_secret<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="4762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>has_upgrade<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="4763"><highlight class="normal"></highlight></codeline>
<codeline lineno="4764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>True:</highlight></codeline>
<codeline lineno="4765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>read<sp/>HTTP<sp/>response<sp/>header<sp/>as<sp/>lines</highlight></codeline>
<codeline lineno="4766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte<sp/>=<sp/>self._socket.recv(1)</highlight></codeline>
<codeline lineno="4768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ConnectionResetError:</highlight></codeline>
<codeline lineno="4769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte<sp/>=<sp/>b&quot;&quot;</highlight></codeline>
<codeline lineno="4770"><highlight class="normal"></highlight></codeline>
<codeline lineno="4771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer.extend(byte)</highlight></codeline>
<codeline lineno="4772"><highlight class="normal"></highlight></codeline>
<codeline lineno="4773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>line<sp/>end</highlight></codeline>
<codeline lineno="4774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>byte<sp/>==<sp/>b&quot;\n&quot;:</highlight></codeline>
<codeline lineno="4775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(self._readbuffer)<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="4776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>check<sp/>upgrade</highlight></codeline>
<codeline lineno="4777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>b&quot;connection&quot;<sp/>in<sp/>str(self._readbuffer).lower().encode(&apos;utf-8&apos;):</highlight></codeline>
<codeline lineno="4778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>b&quot;upgrade&quot;<sp/>not<sp/>in<sp/>str(self._readbuffer).lower().encode(&apos;utf-8&apos;):</highlight></codeline>
<codeline lineno="4779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>WebsocketConnectionError(</highlight></codeline>
<codeline lineno="4780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;WebSocket<sp/>handshake<sp/>error,<sp/>connection<sp/>not<sp/>upgraded&quot;)</highlight></codeline>
<codeline lineno="4781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>has_upgrade<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="4783"><highlight class="normal"></highlight></codeline>
<codeline lineno="4784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>check<sp/>key<sp/>hash</highlight></codeline>
<codeline lineno="4785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>b&quot;sec-websocket-accept&quot;<sp/>in<sp/>str(self._readbuffer).lower().encode(&apos;utf-8&apos;):</highlight></codeline>
<codeline lineno="4786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GUID<sp/>=<sp/>&quot;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&quot;</highlight></codeline>
<codeline lineno="4787"><highlight class="normal"></highlight></codeline>
<codeline lineno="4788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>server_hash_str<sp/>=<sp/>self._readbuffer.decode(</highlight></codeline>
<codeline lineno="4789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;utf-8&apos;).split(&quot;:<sp/>&quot;,<sp/>1)[1]</highlight></codeline>
<codeline lineno="4790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>server_hash<sp/>=<sp/>server_hash_str.strip().encode(&apos;utf-8&apos;)</highlight></codeline>
<codeline lineno="4791"><highlight class="normal"></highlight></codeline>
<codeline lineno="4792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client_hash_key<sp/>=<sp/>sec_websocket_key.decode(&apos;utf-8&apos;)<sp/>+<sp/>GUID</highlight></codeline>
<codeline lineno="4793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Use<sp/>of<sp/>SHA-1<sp/>is<sp/>OK<sp/>here;<sp/>it&apos;s<sp/>according<sp/>to<sp/>the<sp/>Websocket<sp/>spec.</highlight></codeline>
<codeline lineno="4794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client_hash_digest<sp/>=<sp/>hashlib.sha1(client_hash_key.encode(&apos;utf-8&apos;))<sp/><sp/>#<sp/>noqa:<sp/>S324</highlight></codeline>
<codeline lineno="4795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>client_hash<sp/>=<sp/>base64.b64encode(client_hash_digest.digest())</highlight></codeline>
<codeline lineno="4796"><highlight class="normal"></highlight></codeline>
<codeline lineno="4797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>server_hash<sp/>!=<sp/>client_hash:</highlight></codeline>
<codeline lineno="4798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>WebsocketConnectionError(</highlight></codeline>
<codeline lineno="4799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;WebSocket<sp/>handshake<sp/>error,<sp/>invalid<sp/>secret<sp/>key&quot;)</highlight></codeline>
<codeline lineno="4800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>has_secret<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="4802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>ending<sp/>linebreak</highlight></codeline>
<codeline lineno="4804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break</highlight></codeline>
<codeline lineno="4805"><highlight class="normal"></highlight></codeline>
<codeline lineno="4806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>reset<sp/>linebuffer</highlight></codeline>
<codeline lineno="4807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4808"><highlight class="normal"></highlight></codeline>
<codeline lineno="4809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>connection<sp/>reset</highlight></codeline>
<codeline lineno="4810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>not<sp/>byte:</highlight></codeline>
<codeline lineno="4811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>WebsocketConnectionError(&quot;WebSocket<sp/>handshake<sp/>error&quot;)</highlight></codeline>
<codeline lineno="4812"><highlight class="normal"></highlight></codeline>
<codeline lineno="4813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>has_upgrade<sp/>or<sp/>not<sp/>has_secret:</highlight></codeline>
<codeline lineno="4814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>WebsocketConnectionError(&quot;WebSocket<sp/>handshake<sp/>error&quot;)</highlight></codeline>
<codeline lineno="4815"><highlight class="normal"></highlight></codeline>
<codeline lineno="4816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.connected<sp/>=<sp/>True</highlight></codeline>
<codeline lineno="4818"><highlight class="normal"></highlight></codeline>
<codeline lineno="4819" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a611ca4e6682db85a475534ff58c0888a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_create_frame(</highlight></codeline>
<codeline lineno="4820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>opcode:<sp/>int,<sp/>data:<sp/>bytearray,<sp/>do_masking:<sp/>int<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="4821"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>bytearray:</highlight></codeline>
<codeline lineno="4822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length<sp/>=<sp/>len(data)</highlight></codeline>
<codeline lineno="4824"><highlight class="normal"></highlight></codeline>
<codeline lineno="4825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mask_key<sp/>=<sp/>bytearray(os.urandom(4))</highlight></codeline>
<codeline lineno="4826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mask_flag<sp/>=<sp/>do_masking</highlight></codeline>
<codeline lineno="4827"><highlight class="normal"></highlight></codeline>
<codeline lineno="4828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>1<sp/>&lt;&lt;<sp/>7<sp/>is<sp/>the<sp/>final<sp/>flag,<sp/>we<sp/>don&apos;t<sp/>send<sp/>continuated<sp/>data</highlight></codeline>
<codeline lineno="4829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.append(1<sp/>&lt;&lt;<sp/>7<sp/>|<sp/>opcode)</highlight></codeline>
<codeline lineno="4830"><highlight class="normal"></highlight></codeline>
<codeline lineno="4831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>length<sp/>&lt;<sp/>126:</highlight></codeline>
<codeline lineno="4832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.append(mask_flag<sp/>&lt;&lt;<sp/>7<sp/>|<sp/>length)</highlight></codeline>
<codeline lineno="4833"><highlight class="normal"></highlight></codeline>
<codeline lineno="4834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>length<sp/>&lt;<sp/>65536:</highlight></codeline>
<codeline lineno="4835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.append(mask_flag<sp/>&lt;&lt;<sp/>7<sp/>|<sp/>126)</highlight></codeline>
<codeline lineno="4836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>+=<sp/>struct.pack(&quot;!H&quot;,<sp/>length)</highlight></codeline>
<codeline lineno="4837"><highlight class="normal"></highlight></codeline>
<codeline lineno="4838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>length<sp/>&lt;<sp/>0x8000000000000001:</highlight></codeline>
<codeline lineno="4839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.append(mask_flag<sp/>&lt;&lt;<sp/>7<sp/>|<sp/>127)</highlight></codeline>
<codeline lineno="4840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>+=<sp/>struct.pack(&quot;!Q&quot;,<sp/>length)</highlight></codeline>
<codeline lineno="4841"><highlight class="normal"></highlight></codeline>
<codeline lineno="4842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ValueError(&quot;Maximum<sp/>payload<sp/>size<sp/>is<sp/>2^63&quot;)</highlight></codeline>
<codeline lineno="4844"><highlight class="normal"></highlight></codeline>
<codeline lineno="4845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>mask_flag<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="4846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>index<sp/>in<sp/>range(length):</highlight></codeline>
<codeline lineno="4847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data[index]<sp/>^=<sp/>mask_key[index<sp/>%<sp/>4]</highlight></codeline>
<codeline lineno="4848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>mask_key<sp/>+<sp/>data</highlight></codeline>
<codeline lineno="4849"><highlight class="normal"></highlight></codeline>
<codeline lineno="4850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>header<sp/>+<sp/>data</highlight></codeline>
<codeline lineno="4851"><highlight class="normal"></highlight></codeline>
<codeline lineno="4852" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1af7b8bb8c147156c9c9e3ed0f490e731f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_buffered_read(self,<sp/>length:<sp/>int)<sp/>-&gt;<sp/>bytearray:</highlight></codeline>
<codeline lineno="4853"><highlight class="normal"></highlight></codeline>
<codeline lineno="4854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>try<sp/>to<sp/>recv<sp/>and<sp/>store<sp/>needed<sp/>bytes</highlight></codeline>
<codeline lineno="4855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wanted_bytes<sp/>=<sp/>length<sp/>-<sp/>(len(self._readbuffer)<sp/>-<sp/>self._readbuffer_head)</highlight></codeline>
<codeline lineno="4856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>wanted_bytes<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="4857"><highlight class="normal"></highlight></codeline>
<codeline lineno="4858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self._socket.recv(wanted_bytes)</highlight></codeline>
<codeline lineno="4859"><highlight class="normal"></highlight></codeline>
<codeline lineno="4860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>not<sp/>data:</highlight></codeline>
<codeline lineno="4861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>ConnectionAbortedError</highlight></codeline>
<codeline lineno="4862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer.extend(data)</highlight></codeline>
<codeline lineno="4864"><highlight class="normal"></highlight></codeline>
<codeline lineno="4865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(data)<sp/>&lt;<sp/>wanted_bytes:</highlight></codeline>
<codeline lineno="4866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>BlockingIOError</highlight></codeline>
<codeline lineno="4867"><highlight class="normal"></highlight></codeline>
<codeline lineno="4868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer_head<sp/>+=<sp/>length</highlight></codeline>
<codeline lineno="4869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._readbuffer[self._readbuffer_head<sp/>-<sp/>length:self._readbuffer_head]</highlight></codeline>
<codeline lineno="4870"><highlight class="normal"></highlight></codeline>
<codeline lineno="4871" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a1017049d83b2ee7f94299a16b49a6f5a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_recv_impl(self,<sp/>length:<sp/>int)<sp/>-&gt;<sp/>bytes:</highlight></codeline>
<codeline lineno="4872"><highlight class="normal"></highlight></codeline>
<codeline lineno="4873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>try<sp/>to<sp/>decode<sp/>websocket<sp/>payload<sp/>part<sp/>from<sp/>data</highlight></codeline>
<codeline lineno="4874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:</highlight></codeline>
<codeline lineno="4875"><highlight class="normal"></highlight></codeline>
<codeline lineno="4876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer_head<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="4877"><highlight class="normal"></highlight></codeline>
<codeline lineno="4878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>b&quot;&quot;</highlight></codeline>
<codeline lineno="4879"><highlight class="normal"></highlight></codeline>
<codeline lineno="4880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chunk_startindex<sp/>=<sp/>self._payload_head</highlight></codeline>
<codeline lineno="4881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chunk_endindex<sp/>=<sp/>self._payload_head<sp/>+<sp/>length</highlight></codeline>
<codeline lineno="4882"><highlight class="normal"></highlight></codeline>
<codeline lineno="4883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header1<sp/>=<sp/>self._buffered_read(1)</highlight></codeline>
<codeline lineno="4884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header2<sp/>=<sp/>self._buffered_read(1)</highlight></codeline>
<codeline lineno="4885"><highlight class="normal"></highlight></codeline>
<codeline lineno="4886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>opcode<sp/>=<sp/>(header1[0]<sp/>&amp;<sp/>0x0f)</highlight></codeline>
<codeline lineno="4887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maskbit<sp/>=<sp/>(header2[0]<sp/>&amp;<sp/>0x80)<sp/>==<sp/>0x80</highlight></codeline>
<codeline lineno="4888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lengthbits<sp/>=<sp/>(header2[0]<sp/>&amp;<sp/>0x7f)</highlight></codeline>
<codeline lineno="4889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload_length<sp/>=<sp/>lengthbits</highlight></codeline>
<codeline lineno="4890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mask_key<sp/>=<sp/>None</highlight></codeline>
<codeline lineno="4891"><highlight class="normal"></highlight></codeline>
<codeline lineno="4892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>read<sp/>length</highlight></codeline>
<codeline lineno="4893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>lengthbits<sp/>==<sp/>0x7e:</highlight></codeline>
<codeline lineno="4894"><highlight class="normal"></highlight></codeline>
<codeline lineno="4895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>self._buffered_read(2)</highlight></codeline>
<codeline lineno="4896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload_length,<sp/>=<sp/>struct.unpack(&quot;!H&quot;,<sp/>value)</highlight></codeline>
<codeline lineno="4897"><highlight class="normal"></highlight></codeline>
<codeline lineno="4898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elif<sp/>lengthbits<sp/>==<sp/>0x7f:</highlight></codeline>
<codeline lineno="4899"><highlight class="normal"></highlight></codeline>
<codeline lineno="4900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>self._buffered_read(8)</highlight></codeline>
<codeline lineno="4901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload_length,<sp/>=<sp/>struct.unpack(&quot;!Q&quot;,<sp/>value)</highlight></codeline>
<codeline lineno="4902"><highlight class="normal"></highlight></codeline>
<codeline lineno="4903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>read<sp/>mask</highlight></codeline>
<codeline lineno="4904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>maskbit:</highlight></codeline>
<codeline lineno="4905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mask_key<sp/>=<sp/>self._buffered_read(4)</highlight></codeline>
<codeline lineno="4906"><highlight class="normal"></highlight></codeline>
<codeline lineno="4907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>if<sp/>frame<sp/>payload<sp/>is<sp/>shorter<sp/>than<sp/>the<sp/>requested<sp/>data,<sp/>read<sp/>only<sp/>the<sp/>possible<sp/>part</highlight></codeline>
<codeline lineno="4908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>readindex<sp/>=<sp/>chunk_endindex</highlight></codeline>
<codeline lineno="4909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>payload_length<sp/>&lt;<sp/>readindex:</highlight></codeline>
<codeline lineno="4910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>readindex<sp/>=<sp/>payload_length</highlight></codeline>
<codeline lineno="4911"><highlight class="normal"></highlight></codeline>
<codeline lineno="4912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>readindex<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="4913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>get<sp/>payload<sp/>chunk</highlight></codeline>
<codeline lineno="4914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload<sp/>=<sp/>self._buffered_read(readindex)</highlight></codeline>
<codeline lineno="4915"><highlight class="normal"></highlight></codeline>
<codeline lineno="4916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>unmask<sp/>only<sp/>the<sp/>needed<sp/>part</highlight></codeline>
<codeline lineno="4917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>mask_key<sp/>is<sp/>not<sp/>None:</highlight></codeline>
<codeline lineno="4918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>index<sp/>in<sp/>range(chunk_startindex,<sp/>readindex):</highlight></codeline>
<codeline lineno="4919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload[index]<sp/>^=<sp/>mask_key[index<sp/>%<sp/>4]</highlight></codeline>
<codeline lineno="4920"><highlight class="normal"></highlight></codeline>
<codeline lineno="4921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>payload[chunk_startindex:readindex]</highlight></codeline>
<codeline lineno="4922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._payload_head<sp/>=<sp/>readindex</highlight></codeline>
<codeline lineno="4923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4925"><highlight class="normal"></highlight></codeline>
<codeline lineno="4926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>check<sp/>if<sp/>full<sp/>frame<sp/>arrived<sp/>and<sp/>reset<sp/>readbuffer<sp/>and<sp/>payloadhead<sp/>if<sp/>needed</highlight></codeline>
<codeline lineno="4927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>readindex<sp/>==<sp/>payload_length:</highlight></codeline>
<codeline lineno="4928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._readbuffer<sp/>=<sp/>bytearray()</highlight></codeline>
<codeline lineno="4929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._payload_head<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="4930"><highlight class="normal"></highlight></codeline>
<codeline lineno="4931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>respond<sp/>to<sp/>non-binary<sp/>opcodes,<sp/>their<sp/>arrival<sp/>is<sp/>not<sp/>guaranteed<sp/>because<sp/>of<sp/>non-blocking<sp/>sockets</highlight></codeline>
<codeline lineno="4932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>opcode<sp/>==<sp/>_WebsocketWrapper.OPCODE_CONNCLOSE:</highlight></codeline>
<codeline lineno="4933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frame<sp/>=<sp/>self._create_frame(</highlight></codeline>
<codeline lineno="4934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_WebsocketWrapper.OPCODE_CONNCLOSE,<sp/>payload,<sp/>0)</highlight></codeline>
<codeline lineno="4935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._socket.send(frame)</highlight></codeline>
<codeline lineno="4936"><highlight class="normal"></highlight></codeline>
<codeline lineno="4937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>opcode<sp/>==<sp/>_WebsocketWrapper.OPCODE_PING:</highlight></codeline>
<codeline lineno="4938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frame<sp/>=<sp/>self._create_frame(</highlight></codeline>
<codeline lineno="4939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_WebsocketWrapper.OPCODE_PONG,<sp/>payload,<sp/>0)</highlight></codeline>
<codeline lineno="4940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._socket.send(frame)</highlight></codeline>
<codeline lineno="4941"><highlight class="normal"></highlight></codeline>
<codeline lineno="4942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>This<sp/>isn&apos;t<sp/>*proper*<sp/>handling<sp/>of<sp/>continuation<sp/>frames,<sp/>but<sp/>given</highlight></codeline>
<codeline lineno="4943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>that<sp/>we<sp/>only<sp/>support<sp/>binary<sp/>frames,<sp/>it<sp/>is<sp/>*probably*<sp/>good<sp/>enough.</highlight></codeline>
<codeline lineno="4944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(opcode<sp/>==<sp/>_WebsocketWrapper.OPCODE_BINARY<sp/>or<sp/>opcode<sp/>==<sp/>_WebsocketWrapper.OPCODE_CONTINUATION)<sp/>\</highlight></codeline>
<codeline lineno="4945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>payload_length<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="4946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>result</highlight></codeline>
<codeline lineno="4947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raise<sp/>BlockingIOError</highlight></codeline>
<codeline lineno="4949"><highlight class="normal"></highlight></codeline>
<codeline lineno="4950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>except<sp/>ConnectionError:</highlight></codeline>
<codeline lineno="4951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.connected<sp/>=<sp/>False</highlight></codeline>
<codeline lineno="4952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>b&apos;&apos;</highlight></codeline>
<codeline lineno="4953"><highlight class="normal"></highlight></codeline>
<codeline lineno="4954" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1aee17edfeed1e65e784e81c3bb2bd9903" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>_send_impl(self,<sp/>data:<sp/>bytes)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="4955"><highlight class="normal"></highlight></codeline>
<codeline lineno="4956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>if<sp/>previous<sp/>frame<sp/>was<sp/>sent<sp/>successfully</highlight></codeline>
<codeline lineno="4957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(self._sendbuffer)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="4958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>create<sp/>websocket<sp/>frame</highlight></codeline>
<codeline lineno="4959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frame<sp/>=<sp/>self._create_frame(</highlight></codeline>
<codeline lineno="4960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_WebsocketWrapper.OPCODE_BINARY,<sp/>bytearray(data))</highlight></codeline>
<codeline lineno="4961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sendbuffer.extend(frame)</highlight></codeline>
<codeline lineno="4962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._requested_size<sp/>=<sp/>len(data)</highlight></codeline>
<codeline lineno="4963"><highlight class="normal"></highlight></codeline>
<codeline lineno="4964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>try<sp/>to<sp/>write<sp/>out<sp/>as<sp/>much<sp/>as<sp/>possible</highlight></codeline>
<codeline lineno="4965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length<sp/>=<sp/>self._socket.send(self._sendbuffer)</highlight></codeline>
<codeline lineno="4966"><highlight class="normal"></highlight></codeline>
<codeline lineno="4967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._sendbuffer<sp/>=<sp/>self._sendbuffer[length:]</highlight></codeline>
<codeline lineno="4968"><highlight class="normal"></highlight></codeline>
<codeline lineno="4969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>len(self._sendbuffer)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="4970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>buffer<sp/>sent<sp/>out<sp/>completely,<sp/>return<sp/>with<sp/>payload&apos;s<sp/>size</highlight></codeline>
<codeline lineno="4971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._requested_size</highlight></codeline>
<codeline lineno="4972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="4973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>couldn&apos;t<sp/>send<sp/>whole<sp/>data,<sp/>request<sp/>the<sp/>same<sp/>data<sp/>again<sp/>with<sp/>0<sp/>as<sp/>sent<sp/>length</highlight></codeline>
<codeline lineno="4974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>0</highlight></codeline>
<codeline lineno="4975"><highlight class="normal"></highlight></codeline>
<codeline lineno="4976" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a515c7767bf491745e84c919145e789c7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>recv(self,<sp/>length:<sp/>int)<sp/>-&gt;<sp/>bytes:</highlight></codeline>
<codeline lineno="4977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._recv_impl(length)</highlight></codeline>
<codeline lineno="4978"><highlight class="normal"></highlight></codeline>
<codeline lineno="4979" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a02f61e7e48fcdad3dfeb3d4a024e099e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>read(self,<sp/>length:<sp/>int)<sp/>-&gt;<sp/>bytes:</highlight></codeline>
<codeline lineno="4980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._recv_impl(length)</highlight></codeline>
<codeline lineno="4981"><highlight class="normal"></highlight></codeline>
<codeline lineno="4982" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a89973c7465e8bc3e7403e876785269aa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>send(self,<sp/>data:<sp/>bytes)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="4983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_impl(data)</highlight></codeline>
<codeline lineno="4984"><highlight class="normal"></highlight></codeline>
<codeline lineno="4985" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1abe973a5e6a7f4929a3dd25a612533079" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>write(self,<sp/>data:<sp/>bytes)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="4986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._send_impl(data)</highlight></codeline>
<codeline lineno="4987"><highlight class="normal"></highlight></codeline>
<codeline lineno="4988" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a091a0ef00cce0d1b5ff11ef2624e4cb8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>close(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="4989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._socket.close()</highlight></codeline>
<codeline lineno="4990"><highlight class="normal"></highlight></codeline>
<codeline lineno="4991" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a4a007dd6828e20d68670d48d37e88e88" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>fileno(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="4992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._socket.fileno()</highlight></codeline>
<codeline lineno="4993"><highlight class="normal"></highlight></codeline>
<codeline lineno="4994" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a20096a1dfb5caff67b2ea01d7e0ef7e0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>pending(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="4995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Fix<sp/>for<sp/>bug<sp/>#131:<sp/>a<sp/>SSL<sp/>socket<sp/>may<sp/>still<sp/>have<sp/>data<sp/>available</highlight></codeline>
<codeline lineno="4996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>for<sp/>reading<sp/>without<sp/>select()<sp/>being<sp/>aware<sp/>of<sp/>it.</highlight></codeline>
<codeline lineno="4997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>self._ssl:</highlight></codeline>
<codeline lineno="4998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self._socket.pending()<sp/><sp/>#<sp/>type:<sp/>ignore[union-attr]</highlight></codeline>
<codeline lineno="4999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:</highlight></codeline>
<codeline lineno="5000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>normal<sp/>socket<sp/>rely<sp/>only<sp/>on<sp/>select()</highlight></codeline>
<codeline lineno="5001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>0</highlight></codeline>
<codeline lineno="5002"><highlight class="normal"></highlight></codeline>
<codeline lineno="5003" refid="classpaho_1_1mqtt_1_1client_1_1___websocket_wrapper_1a3293bd8a5ce65b34eb2a0ac484c132cb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>def<sp/>setblocking(self,<sp/>flag:<sp/>bool)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="5004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._socket.setblocking(flag)</highlight></codeline>
    </programlisting>
    <location file="micro_gestion_objetos/venv/Lib/site-packages/paho/mqtt/client.py"/>
  </compounddef>
</doxygen>
