<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="es">
  <compounddef id="namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller" kind="namespace" language="Python">
    <compoundname>app::application::controllers::personalizacion_controller</compoundname>
    <sectiondef kind="var">
      <memberdef kind="variable" id="namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_1a154e3756c89ab16af42620612f3de040" prot="public" static="no" mutable="no">
        <type></type>
        <definition>app::application::controllers::personalizacion_controller.router</definition>
        <argsstring></argsstring>
        <name>router</name>
        <qualifiedname>app.application.controllers.personalizacion_controller.router</qualifiedname>
        <initializer>=  <ref refid="classfastapi_1_1routing_1_1_a_p_i_router" kindref="compound">APIRouter</ref>(prefix=&quot;/personalizacion&quot;, tags=[&quot;Gestión de Personalización de Usuario&quot;])</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" line="32" column="1" bodyfile="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" bodystart="32" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_1a892611f9f49670f35cdbd570095b6960" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>app.application.controllers.personalizacion_controller.crear_preferencia</definition>
        <argsstring>(MakeContractRequest data, PersonalizacionService personalizacion_service=Depends(get_personalizacion_service))</argsstring>
        <name>crear_preferencia</name>
        <qualifiedname>app.application.controllers.personalizacion_controller.crear_preferencia</qualifiedname>
        <param>
          <type><ref refid="classapp_1_1application_1_1dtos_1_1request__dtos_1_1_make_contract_request" kindref="compound">MakeContractRequest</ref></type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service" kindref="compound">PersonalizacionService</ref></type>
          <declname>personalizacion_service</declname>
          <defval>Depends(get_personalizacion_service)</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>    @brief Crea una nueva preferencia/contrato ECA para el usuario actual.
    
    @param data DTO MakeContractRequest con definición del contrato ECA.
    @param personalizacion_service Servicio de personalización (inyectado).
    
    @return JSONResponse con status 200 si exitoso, o error 400/500.
    
    @exception HTTPException Si email no coincide o hay error en micro_automatizacion.
    
    @details
    Crea una regla ECA (contrato) que automatiza comportamientos del usuario.
    
    Flujo:
    1. Verifica que el email del DTO coincida con el usuario actual
    2. Envía solicitud al microservicio micro_automatizacion
    3. Registra la preferencia en ontología de usuario
    
    @see PersonalizacionService.crear_preferencia()
    @see micro_automatizacion Para implementación de ECAs
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" line="36" column="1" bodyfile="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" bodystart="39" bodyend="70"/>
      </memberdef>
      <memberdef kind="function" id="namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_1a48b29fa9bd067de558e7e52065de6457" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>app.application.controllers.personalizacion_controller.recibir_ontologia</definition>
        <argsstring>(UploadFile file=File(..., description=&quot;Archivo de ontología (.owl)&quot;), str nombre=Form(..., description=&quot;Nombre de la ontología&quot;), str ipCoordinador=Form(..., description=&quot;IP del coordinador&quot;), PersonalizacionService personalizacion_service=Depends(get_personalizacion_service))</argsstring>
        <name>recibir_ontologia</name>
        <qualifiedname>app.application.controllers.personalizacion_controller.recibir_ontologia</qualifiedname>
        <param>
          <type><ref refid="classfastapi_1_1datastructures_1_1_upload_file" kindref="compound">UploadFile</ref></type>
          <declname>file</declname>
          <defval>File(..., description=&quot;Archivo de ontología (.owl)&quot;)</defval>
        </param>
        <param>
          <type>str</type>
          <declname>nombre</declname>
          <defval>Form(..., description=&quot;Nombre de la ontología&quot;)</defval>
        </param>
        <param>
          <type>str</type>
          <declname>ipCoordinador</declname>
          <defval>Form(..., description=&quot;IP del coordinador&quot;)</defval>
        </param>
        <param>
          <type><ref refid="classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service" kindref="compound">PersonalizacionService</ref></type>
          <declname>personalizacion_service</declname>
          <defval>Depends(get_personalizacion_service)</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>    @brief Recibe y carga ontología de perfil de usuario.
    
    @param file Archivo .owl con ontología del usuario.
    @param nombre Identificador de la ontología.
    @param ipCoordinador IP del coordinador (para tracking/notificación).
    @param personalizacion_service Servicio de personalización.
    
    @return JSONResponse con status 200 si exitoso, o error 400/500.
    
    @exception HTTPException Si hay error en procesamiento o envío.
    
    @details
    Endpoint de integración: recibe ontología del coordinador y la envía
    al microservicio micro_gestion_conocimiento para población.
    
    Flujo:
    1. Valida que el archivo sea .owl
    2. Envía al microservicio de ontologías
    3. Guarda IP del coordinador para tracking
    4. Activa ECAs del usuario
    
    @see PersonalizacionService.recibir_ontologia()
    @see micro_gestion_conocimiento Para carga de ontologías
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" line="71" column="1" bodyfile="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" bodystart="76" bodyend="108"/>
      </memberdef>
      <memberdef kind="function" id="namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_1a429b450a48f045b0b0143521a67ae7af" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>app.application.controllers.personalizacion_controller.notificar_salida_usuario</definition>
        <argsstring>(PersonalizacionService personalizacion_service=Depends(get_personalizacion_service))</argsstring>
        <name>notificar_salida_usuario</name>
        <qualifiedname>app.application.controllers.personalizacion_controller.notificar_salida_usuario</qualifiedname>
        <param>
          <type><ref refid="classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service" kindref="compound">PersonalizacionService</ref></type>
          <declname>personalizacion_service</declname>
          <defval>Depends(get_personalizacion_service)</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>    @brief Notifica la salida del usuario y desactiva sus ECAs.
    
    @param personalizacion_service Servicio de personalización.
    
    @return JSONResponse con status 200 si exitoso, o error 500.
    
    @exception HTTPException Si hay error coordinando desactivación.
    
    @details
    Implementa HU-2 (Historia de Usuario 2): cuando el usuario se desconecta,
    desactiva todas sus reglas ECAs en el microservicio de automatización.
    
    @note Operación de coordinación inter-servicios.
    
    @see PersonalizacionService.desactivarEcasUsuarioActual()
    @see micro_automatizacion Para desactivación de ECAs
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" line="109" column="1" bodyfile="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" bodystart="111" bodyend="136"/>
      </memberdef>
      <memberdef kind="function" id="namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_1aeb80e12c70c9905b4a7a3b87ee505bd4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>app.application.controllers.personalizacion_controller.registro_interaccion_usuario_objeto</definition>
        <argsstring>(RegistroInteraccionDTO data, PersonalizacionService personalizacion_service=Depends(get_personalizacion_service))</argsstring>
        <name>registro_interaccion_usuario_objeto</name>
        <qualifiedname>app.application.controllers.personalizacion_controller.registro_interaccion_usuario_objeto</qualifiedname>
        <param>
          <type><ref refid="classapp_1_1application_1_1dtos_1_1request__dtos_1_1_registro_interaccion_d_t_o" kindref="compound">RegistroInteraccionDTO</ref></type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service" kindref="compound">PersonalizacionService</ref></type>
          <declname>personalizacion_service</declname>
          <defval>Depends(get_personalizacion_service)</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>    @brief Registra una interacción entre usuario y objeto inteligente.
    
    @param data DTO RegistroInteraccionDTO con evento de interacción.
    @param personalizacion_service Servicio de personalización.
    
    @return JSONResponse con status 200 si exitoso, o error 500.
    
    @exception HTTPException Si hay error al registrar interacción.
    
    @details
    Registra eventos de interacción (p. ej. usuario accede a objeto,
    modifica preferencias, etc.) para crear historial y base para
    personalización e inferencia de patrones.
    
    @see PersonalizacionService.registroInteraccionUsuarioObjeto()
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" line="137" column="1" bodyfile="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" bodystart="137" bodyend="161"/>
      </memberdef>
      <memberdef kind="function" id="namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_1aa601f56d2df7723a033d1ff86144e976" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>app.application.controllers.personalizacion_controller.health_check</definition>
        <argsstring>(PersonalizacionService personalizacion_service=Depends(get_personalizacion_service))</argsstring>
        <name>health_check</name>
        <qualifiedname>app.application.controllers.personalizacion_controller.health_check</qualifiedname>
        <param>
          <type><ref refid="classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service" kindref="compound">PersonalizacionService</ref></type>
          <declname>personalizacion_service</declname>
          <defval>Depends(get_personalizacion_service)</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>    @brief Health check / status del microservicio.
    
    @param personalizacion_service Servicio de personalización.
    
    @return JSON con status: &apos;healthy&apos; o &apos;degraded&apos;, nombre y versión del servicio.
    
    @details
    Endpoint para monitoreo y orquestación de contenedores.
    Verifica que el servicio esté disponible.
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" line="162" column="1" bodyfile="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" bodystart="164" bodyend="182"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><verbatim>    @file personalizacion_controller.py
    @brief Controlador REST para gestión de preferencias e interacciones de usuario.
    @details
    Proporciona endpoints para:
    - Crear preferencias/contratos ECA para usuario
    - Recibir y cargar ontologías de perfil de usuario
    - Notificar salida de usuario (desactivar ECAs)
    - Registrar interacciones usuario-objeto
    - Health check del servicio
    
    @note El microservicio integra con micro_gestion_conocimiento y micro_automatizacion.
    
    @author  NexTech
    @version 1.0
    @date 2025-01-10
    
    @see PersonalizacionService Para lógica de negocio
    @see micro_gestion_conocimiento Para ontologías
    @see micro_automatizacion Para ECAs
</verbatim> </para>
    </detaileddescription>
    <location file="microservicio_personalizacion/app/application/controllers/personalizacion_controller.py" line="1" column="1"/>
  </compounddef>
</doxygen>
