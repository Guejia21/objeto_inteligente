\doxysection{matcher.\+py}
\hypertarget{matcher_8py_source}{}\label{matcher_8py_source}\index{micro\_gestion\_objetos/venv/Lib/site-\/packages/paho/mqtt/matcher.py@{micro\_gestion\_objetos/venv/Lib/site-\/packages/paho/mqtt/matcher.py}}
\mbox{\hyperlink{matcher_8py}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00001}\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher}{00001}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher}{MQTTMatcher}}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00002}00002\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Intended\ to\ manage\ topic\ filters\ including\ wildcards.}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00003}00003\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00004}00004\ \textcolor{stringliteral}{\ \ \ \ Internally,\ MQTTMatcher\ use\ a\ prefix\ tree\ (trie)\ to\ store}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00005}00005\ \textcolor{stringliteral}{\ \ \ \ values\ associated\ with\ filters,\ and\ has\ an\ iter\_match()}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00006}00006\ \textcolor{stringliteral}{\ \ \ \ method\ to\ iterate\ efficiently\ over\ all\ filters\ that\ match}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00007}00007\ \textcolor{stringliteral}{\ \ \ \ some\ topic\ name."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00009}\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node}{00009}}\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node}{Node}}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00010}00010\ \ \ \ \ \ \ \ \ \_\_slots\_\_\ =\ \textcolor{stringliteral}{'\_children'},\ \textcolor{stringliteral}{'\_content'}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00012}00012\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00013}\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node_a734465f0ef21a7b56ed2df1be5db951a}{00013}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node_a734465f0ef21a7b56ed2df1be5db951a}{\_children}}\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00014}\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node_afa5ff39162e11a81e010004897d53d8b}{00014}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node_afa5ff39162e11a81e010004897d53d8b}{\_content}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00016}00016\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00017}\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_abffae155ec70c9b0c10c19847c4c4007}{00017}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_abffae155ec70c9b0c10c19847c4c4007}{\_root}}\ =\ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node}{Node}}()}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00019}00019\ \ \ \ \ \textcolor{keyword}{def\ }\_\_setitem\_\_(self,\ key,\ value):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Add\ a\ topic\ filter\ :key\ to\ the\ prefix\ tree}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ associate\ it\ to\ :value"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ node\ =\ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_abffae155ec70c9b0c10c19847c4c4007}{\_root}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ sym\ \textcolor{keywordflow}{in}\ key.split(\textcolor{stringliteral}{'/'}):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \ \ \ \ node\ =\ node.\_children.setdefault(sym,\ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_1_1_node}{Node}}())}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ node.\_content\ =\ value}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00027}00027\ \ \ \ \ \textcolor{keyword}{def\ }\_\_getitem\_\_(self,\ key):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Retrieve\ the\ value\ associated\ with\ some\ topic\ filter\ :key"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ node\ =\ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_abffae155ec70c9b0c10c19847c4c4007}{\_root}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ sym\ \textcolor{keywordflow}{in}\ key.split(\textcolor{stringliteral}{'/'}):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ node\ =\ node.\_children[sym]}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ node.\_content\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ KeyError(key)}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ node.\_content}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ KeyError\ \textcolor{keyword}{as}\ ke:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ KeyError(key)\ \textcolor{keyword}{from}\ ke}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00039}00039\ \ \ \ \ \textcolor{keyword}{def\ }\_\_delitem\_\_(self,\ key):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Delete\ the\ value\ associated\ with\ some\ topic\ filter\ :key"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ lst\ =\ []}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ parent,\ node\ =\ \textcolor{keywordtype}{None},\ self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_abffae155ec70c9b0c10c19847c4c4007}{\_root}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ key.split(\textcolor{stringliteral}{'/'}):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parent,\ node\ =\ node,\ node.\_children[k]}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lst.append((parent,\ k,\ node))}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ TODO}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ node.\_content\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ KeyError\ \textcolor{keyword}{as}\ ke:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ KeyError(key)\ \textcolor{keyword}{from}\ ke}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ cleanup}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ parent,\ k,\ node\ \textcolor{keywordflow}{in}\ reversed(lst):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ node.\_children\ \textcolor{keywordflow}{or}\ node.\_content\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ parent.\_children[k]}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00057}\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_a110c9f1d409964947b10c551d6b9f5b8}{00057}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_a110c9f1d409964947b10c551d6b9f5b8}{iter\_match}}(self,\ topic):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ an\ iterator\ on\ all\ values\ associated\ with\ filters}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ match\ the\ :topic"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ lst\ =\ topic.split(\textcolor{stringliteral}{'/'})}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ normal\ =\ \textcolor{keywordflow}{not}\ topic.startswith(\textcolor{stringliteral}{'\$'})}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }rec(node,\ i=0):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ i\ ==\ len(lst):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ node.\_content\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ node.\_content}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ part\ =\ lst[i]}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ part\ \textcolor{keywordflow}{in}\ node.\_children:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ content\ \textcolor{keywordflow}{in}\ rec(node.\_children[part],\ i\ +\ 1):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ content}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{'+'}\ \textcolor{keywordflow}{in}\ node.\_children\ \textcolor{keywordflow}{and}\ (normal\ \textcolor{keywordflow}{or}\ i\ >\ 0):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ content\ \textcolor{keywordflow}{in}\ rec(node.\_children[\textcolor{stringliteral}{'+'}],\ i\ +\ 1):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ content}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{'\#'}\ \textcolor{keywordflow}{in}\ node.\_children\ \textcolor{keywordflow}{and}\ (normal\ \textcolor{keywordflow}{or}\ i\ >\ 0):}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ content\ =\ node.\_children[\textcolor{stringliteral}{'\#'}].\_content}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ content\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ content}
\DoxyCodeLine{\Hypertarget{matcher_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ rec(self.\mbox{\hyperlink{classpaho_1_1mqtt_1_1matcher_1_1_m_q_t_t_matcher_abffae155ec70c9b0c10c19847c4c4007}{\_root}})}

\end{DoxyCode}
