\doxysection{multiprocess.\+py}
\hypertarget{multiprocess_8py_source}{}\label{multiprocess_8py_source}\index{micro\_gestion\_objetos/venv/Lib/site-\/packages/uvicorn/supervisors/multiprocess.py@{micro\_gestion\_objetos/venv/Lib/site-\/packages/uvicorn/supervisors/multiprocess.py}}
\mbox{\hyperlink{multiprocess_8py}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00001}\mbox{\hyperlink{namespaceuvicorn_1_1supervisors_1_1multiprocess}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00003}00003\ \textcolor{keyword}{import}\ logging}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00004}00004\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00005}00005\ \textcolor{keyword}{import}\ signal}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00006}00006\ \textcolor{keyword}{import}\ threading}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00007}00007\ \textcolor{keyword}{from}\ multiprocessing\ \textcolor{keyword}{import}\ Pipe}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00008}00008\ \textcolor{keyword}{from}\ socket\ \textcolor{keyword}{import}\ socket}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00009}00009\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ Any,\ Callable}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00011}00011\ \textcolor{keyword}{import}\ click}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00013}00013\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespaceuvicorn_1_1__subprocess}{uvicorn.\_subprocess}}\ \textcolor{keyword}{import}\ get\_subprocess}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespaceuvicorn_1_1config}{uvicorn.config}}\ \textcolor{keyword}{import}\ Config}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00016}\mbox{\hyperlink{namespaceuvicorn_1_1supervisors_1_1multiprocess_a570dcef1aa557ea7e9ea65611e772e47}{00016}}\ SIGNALS\ =\ \{}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00017}00017\ \ \ \ \ getattr(signal,\ f\textcolor{stringliteral}{"{}SIG\{x\}"{}}):\ x}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00018}00018\ \ \ \ \ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ \textcolor{stringliteral}{"{}INT\ TERM\ BREAK\ HUP\ QUIT\ TTIN\ TTOU\ USR1\ USR2\ WINCH"{}}.split()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00019}00019\ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(signal,\ f\textcolor{stringliteral}{"{}SIG\{x\}"{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00020}00020\ \}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00022}\mbox{\hyperlink{namespaceuvicorn_1_1supervisors_1_1multiprocess_aff0b4a776d41fbe19d97cf2e8adb153d}{00022}}\ logger\ =\ logging.getLogger(\textcolor{stringliteral}{"{}uvicorn.error"{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00025}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process}{00025}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process}{Process}}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00026}00026\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ config:\ Config,}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ target:\ Callable[[list[socket]\ |\ \textcolor{keywordtype}{None}],\ \textcolor{keywordtype}{None}],}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ sockets:\ list[socket],}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00031}00031\ \ \ \ \ )\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00032}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a2098ebf6a0da28976890d6652d5d3512}{00032}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a2098ebf6a0da28976890d6652d5d3512}{real\_target}}\ =\ target}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00034}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aaf98040c1fd9f925a8871f377678a2da}{00034}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a9b5c4df024ec1f5ba6a90c62be8a2eff}{parent\_conn}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aaf98040c1fd9f925a8871f377678a2da}{child\_conn}}\ =\ Pipe()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00035}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{00035}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}\ =\ get\_subprocess(config,\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a752fd43211481e5a2c79c7d7eb5ec735}{target}},\ sockets)}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00037}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a6740b2900d9551722cf3be67cee3b6ba}{00037}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a6740b2900d9551722cf3be67cee3b6ba}{ping}}(self,\ timeout:\ float\ =\ 5)\ -\/>\ bool:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a9b5c4df024ec1f5ba6a90c62be8a2eff}{parent\_conn}}.send(b\textcolor{stringliteral}{"{}ping"{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a9b5c4df024ec1f5ba6a90c62be8a2eff}{parent\_conn}}.poll(timeout):}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a9b5c4df024ec1f5ba6a90c62be8a2eff}{parent\_conn}}.recv()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00044}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_afe661505a7cc0553d48ffa8634bf7e4b}{00044}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_afe661505a7cc0553d48ffa8634bf7e4b}{pong}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aaf98040c1fd9f925a8871f377678a2da}{child\_conn}}.recv()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aaf98040c1fd9f925a8871f377678a2da}{child\_conn}}.send(b\textcolor{stringliteral}{"{}pong"{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00048}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a03b638de936a12aa2ca7df437ae72b76}{00048}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a03b638de936a12aa2ca7df437ae72b76}{always\_pong}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_afe661505a7cc0553d48ffa8634bf7e4b}{pong}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00052}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a752fd43211481e5a2c79c7d7eb5ec735}{00052}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a752fd43211481e5a2c79c7d7eb5ec735}{target}}(self,\ sockets:\ list[socket]\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None})\ -\/>\ Any:\ \ \textcolor{comment}{\#\ pragma:\ no\ cover}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ os.name\ ==\ \textcolor{stringliteral}{"{}nt"{}}:\ \ \textcolor{comment}{\#\ pragma:\ py-\/not-\/win32}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Windows\ doesn't\ support\ SIGTERM,\ so\ we\ use\ SIGBREAK\ instead.}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ And\ then\ we\ raise\ SIGTERM\ when\ SIGBREAK\ is\ received.}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://learn.microsoft.com/zh-\/cn/cpp/c-\/runtime-\/library/reference/signal?view=msvc-\/170}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ signal.signal(}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ signal.SIGBREAK,\ \ \textcolor{comment}{\#\ type:\ ignore[attr-\/defined]}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{lambda}\ sig,\ frame:\ signal.raise\_signal(signal.SIGTERM),}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ threading.Thread(target=self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a03b638de936a12aa2ca7df437ae72b76}{always\_pong}},\ daemon=\textcolor{keyword}{True}).\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aeb4828b0b55b43c174d7965dcf04d640}{start}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a2098ebf6a0da28976890d6652d5d3512}{real\_target}}(sockets)}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00065}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a74f640516b63a94727640fb7f3919e67}{00065}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a74f640516b63a94727640fb7f3919e67}{is\_alive}}(self,\ timeout:\ float\ =\ 5)\ -\/>\ bool:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a74f640516b63a94727640fb7f3919e67}{is\_alive}}():}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}\ \ \textcolor{comment}{\#\ pragma:\ full\ coverage}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a6740b2900d9551722cf3be67cee3b6ba}{ping}}(timeout)}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00071}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aeb4828b0b55b43c174d7965dcf04d640}{00071}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aeb4828b0b55b43c174d7965dcf04d640}{start}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aeb4828b0b55b43c174d7965dcf04d640}{start}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00074}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a1ef62131bb701822f17c53a64c0fb846}{00074}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a1ef62131bb701822f17c53a64c0fb846}{terminate}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.exitcode\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:\ \ \textcolor{comment}{\#\ Process\ is\ still\ running}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.pid\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ os.name\ ==\ \textcolor{stringliteral}{"{}nt"{}}:\ \ \textcolor{comment}{\#\ pragma:\ py-\/not-\/win32}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Windows\ doesn't\ support\ SIGTERM.}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ So\ send\ SIGBREAK,\ and\ then\ in\ process\ raise\ SIGTERM.}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os.kill(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.pid,\ signal.CTRL\_BREAK\_EVENT)\ \ \textcolor{comment}{\#\ type:\ ignore[attr-\/defined]}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os.kill(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.pid,\ signal.SIGTERM)}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Terminated\ child\ process\ [\{self.process.pid\}]"{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a9b5c4df024ec1f5ba6a90c62be8a2eff}{parent\_conn}}.close()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_aaf98040c1fd9f925a8871f377678a2da}{child\_conn}}.close()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00088}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_ad867f2b7c090a76c30605ac3dc524a8c}{00088}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_ad867f2b7c090a76c30605ac3dc524a8c}{kill}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ Windows,\ the\ method\ will\ call\ \`{}TerminateProcess`\ to\ kill\ the\ process.}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ Unix,\ the\ method\ will\ send\ SIGKILL\ to\ the\ process.}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_ad867f2b7c090a76c30605ac3dc524a8c}{kill}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00093}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a63862639aa835f358b4267c64932d753}{00093}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a63862639aa835f358b4267c64932d753}{join}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Waiting\ for\ child\ process\ [\{self.process.pid\}]"{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a63862639aa835f358b4267c64932d753}{join}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00097}00097\ \ \ \ \ \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00098}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a85be9e36285c306e030663a9d5261ed8}{00098}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a85be9e36285c306e030663a9d5261ed8}{pid}}(self)\ -\/>\ int\ |\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process_a8724db3dc26b3d134c7c7435750ad90d}{process}}.pid}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00102}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess}{00102}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess}{Multiprocess}}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00103}00103\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ config:\ Config,}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ target:\ Callable[[list[socket]\ |\ \textcolor{keywordtype}{None}],\ \textcolor{keywordtype}{None}],}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ sockets:\ list[socket],}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00108}00108\ \ \ \ \ )\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00109}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abd947a2e6a556b55c0f9aa2fefb7736b}{00109}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abd947a2e6a556b55c0f9aa2fefb7736b}{config}}\ =\ config}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00110}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a815a9d5d262dbcd6675bd149a4c97772}{00110}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a815a9d5d262dbcd6675bd149a4c97772}{target}}\ =\ target}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00111}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ace527c78c35908fa43f35f53bdf2e791}{00111}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ace527c78c35908fa43f35f53bdf2e791}{sockets}}\ =\ sockets}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00113}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abec2a72224450c7bb2d4d390631ab156}{00113}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abec2a72224450c7bb2d4d390631ab156}{processes\_num}}\ =\ config.workers}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00114}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{00114}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}:\ list[Process]\ =\ []}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00116}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{00116}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{should\_exit}}\ =\ threading.Event()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00118}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aa661252252fdbf5d2ab551c810c5c301}{00118}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aa661252252fdbf5d2ab551c810c5c301}{signal\_queue}}:\ list[int]\ =\ []}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ sig\ \textcolor{keywordflow}{in}\ SIGNALS:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ signal.signal(sig,\ \textcolor{keyword}{lambda}\ sig,\ frame:\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aa661252252fdbf5d2ab551c810c5c301}{signal\_queue}}.append(sig))}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00122}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_afccef3da0c1db890959f34273faf58a7}{00122}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_afccef3da0c1db890959f34273faf58a7}{init\_processes}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abec2a72224450c7bb2d4d390631ab156}{processes\_num}}):}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ process\ =\ \mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process}{Process}}(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abd947a2e6a556b55c0f9aa2fefb7736b}{config}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a815a9d5d262dbcd6675bd149a4c97772}{target}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ace527c78c35908fa43f35f53bdf2e791}{sockets}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ process.start()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}.append(process)}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00128}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a562adb1d25404c30cd01f1209cc0469b}{00128}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a562adb1d25404c30cd01f1209cc0469b}{terminate\_all}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ process\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ process.terminate()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00132}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aebac7253f942ed739583a0af55885553}{00132}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aebac7253f942ed739583a0af55885553}{join\_all}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ process\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ process.join()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00136}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a4b6279e27e9e65cc44ade1b0335ed5d4}{00136}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a4b6279e27e9e65cc44ade1b0335ed5d4}{restart\_all}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ idx,\ process\ \textcolor{keywordflow}{in}\ enumerate(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}):}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ process.terminate()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ process.join()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ new\_process\ =\ \mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process}{Process}}(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abd947a2e6a556b55c0f9aa2fefb7736b}{config}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a815a9d5d262dbcd6675bd149a4c97772}{target}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ace527c78c35908fa43f35f53bdf2e791}{sockets}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ new\_process.start()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}[idx]\ =\ new\_process}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00144}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af03b2506c0883bf6068d9f2581cd66be}{00144}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af03b2506c0883bf6068d9f2581cd66be}{run}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ message\ =\ f\textcolor{stringliteral}{"{}Started\ parent\ process\ [\{os.getpid()\}]"{}}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ color\_message\ =\ \textcolor{stringliteral}{"{}Started\ parent\ process\ [\{\}]"{}}.format(click.style(str(os.getpid()),\ fg=\textcolor{stringliteral}{"{}cyan"{}},\ bold=\textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ logger.info(message,\ extra=\{\textcolor{stringliteral}{"{}color\_message"{}}:\ color\_message\})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_afccef3da0c1db890959f34273faf58a7}{init\_processes}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{should\_exit}}.wait(0.5):}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a1d22c3e0960d4600d27ef7d50e023e35}{handle\_signals}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a8c934393db06bbd3b5d59da637a4f29a}{keep\_subprocess\_alive}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a562adb1d25404c30cd01f1209cc0469b}{terminate\_all}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aebac7253f942ed739583a0af55885553}{join\_all}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ message\ =\ f\textcolor{stringliteral}{"{}Stopping\ parent\ process\ [\{os.getpid()\}]"{}}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ color\_message\ =\ \textcolor{stringliteral}{"{}Stopping\ parent\ process\ [\{\}]"{}}.format(click.style(str(os.getpid()),\ fg=\textcolor{stringliteral}{"{}cyan"{}},\ bold=\textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ logger.info(message,\ extra=\{\textcolor{stringliteral}{"{}color\_message"{}}:\ color\_message\})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00162}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a8c934393db06bbd3b5d59da637a4f29a}{00162}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a8c934393db06bbd3b5d59da637a4f29a}{keep\_subprocess\_alive}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{should\_exit}}.is\_set():}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \ \textcolor{comment}{\#\ parent\ process\ is\ exiting,\ no\ need\ to\ keep\ subprocess\ alive}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ idx,\ process\ \textcolor{keywordflow}{in}\ enumerate(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}):}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ process.is\_alive(timeout=self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abd947a2e6a556b55c0f9aa2fefb7736b}{config}}.timeout\_worker\_healthcheck):}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ process.kill()\ \ \textcolor{comment}{\#\ process\ is\ hung,\ kill\ it}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ process.join()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00172}00172\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{should\_exit}}.is\_set():}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \ \textcolor{comment}{\#\ pragma:\ full\ coverage}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Child\ process\ [\{process.pid\}]\ died"{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ process\ =\ \mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process}{Process}}(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abd947a2e6a556b55c0f9aa2fefb7736b}{config}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a815a9d5d262dbcd6675bd149a4c97772}{target}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ace527c78c35908fa43f35f53bdf2e791}{sockets}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ process.start()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}[idx]\ =\ process}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00181}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a1d22c3e0960d4600d27ef7d50e023e35}{00181}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a1d22c3e0960d4600d27ef7d50e023e35}{handle\_signals}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ sig\ \textcolor{keywordflow}{in}\ tuple(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aa661252252fdbf5d2ab551c810c5c301}{signal\_queue}}):}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_aa661252252fdbf5d2ab551c810c5c301}{signal\_queue}}.remove(sig)}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ sig\_name\ =\ SIGNALS[sig]}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ sig\_handler\ =\ getattr(self,\ f\textcolor{stringliteral}{"{}handle\_\{sig\_name.lower()\}"{}},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sig\_handler\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sig\_handler()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ pragma:\ no\ cover}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Received\ signal\ \{sig\_name\},\ but\ no\ handler\ is\ defined\ for\ it."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00191}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a9484ca24281348f88274ac050b569b35}{00191}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a9484ca24281348f88274ac050b569b35}{handle\_int}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Received\ SIGINT,\ exiting."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{should\_exit}}.set()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00194}00194\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00195}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a1c671c37002725dae4d7ed1f9a2126b1}{00195}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a1c671c37002725dae4d7ed1f9a2126b1}{handle\_term}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Received\ SIGTERM,\ exiting."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{should\_exit}}.set()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00199}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ab1712b4a27395acd84d4b891e2672d3e}{00199}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ab1712b4a27395acd84d4b891e2672d3e}{handle\_break}}(self)\ -\/>\ None:\ \ \textcolor{comment}{\#\ pragma:\ py-\/not-\/win32}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Received\ SIGBREAK,\ exiting."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af4b9d67399be6e7372ef831b01c9f86a}{should\_exit}}.set()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00202}00202\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00203}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a3521e3dca2916b777bfd8a31b5779a9e}{00203}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a3521e3dca2916b777bfd8a31b5779a9e}{handle\_hup}}(self)\ -\/>\ None:\ \ \textcolor{comment}{\#\ pragma:\ py-\/win32}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Received\ SIGHUP,\ restarting\ processes."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a4b6279e27e9e65cc44ade1b0335ed5d4}{restart\_all}}()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00207}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af92c307c3d693ef9baa5f0330ef9030a}{00207}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_af92c307c3d693ef9baa5f0330ef9030a}{handle\_ttin}}(self)\ -\/>\ None:\ \ \textcolor{comment}{\#\ pragma:\ py-\/win32}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Received\ SIGTTIN,\ increasing\ the\ number\ of\ processes."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abec2a72224450c7bb2d4d390631ab156}{processes\_num}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ process\ =\ \mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_process}{Process}}(self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abd947a2e6a556b55c0f9aa2fefb7736b}{config}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a815a9d5d262dbcd6675bd149a4c97772}{target}},\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ace527c78c35908fa43f35f53bdf2e791}{sockets}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ process.start()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}.append(process)}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00214}\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a51c66b3c1bb4c0df050ed98241036ed6}{00214}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_a51c66b3c1bb4c0df050ed98241036ed6}{handle\_ttou}}(self)\ -\/>\ None:\ \ \textcolor{comment}{\#\ pragma:\ py-\/win32}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Received\ SIGTTOU,\ decreasing\ number\ of\ processes."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abec2a72224450c7bb2d4d390631ab156}{processes\_num}}\ <=\ 1:}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Already\ reached\ one\ process,\ cannot\ decrease\ the\ number\ of\ processes\ anymore."{}})}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_abec2a72224450c7bb2d4d390631ab156}{processes\_num}}\ -\/=\ 1}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ process\ =\ self.\mbox{\hyperlink{classuvicorn_1_1supervisors_1_1multiprocess_1_1_multiprocess_ac8921b0ec1a680f3ffe7ce31847147c7}{processes}}.pop()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ process.terminate()}
\DoxyCodeLine{\Hypertarget{multiprocess_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ process.join()}

\end{DoxyCode}
