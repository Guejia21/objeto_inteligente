\doxysection{concurrency.\+py}
\hypertarget{fastapi_2concurrency_8py_source}{}\label{fastapi_2concurrency_8py_source}\index{micro\_gestion\_objetos/venv/Lib/site-\/packages/fastapi/concurrency.py@{micro\_gestion\_objetos/venv/Lib/site-\/packages/fastapi/concurrency.py}}
\mbox{\hyperlink{fastapi_2concurrency_8py}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00001}\mbox{\hyperlink{namespacefastapi_1_1concurrency}{00001}}\ \textcolor{keyword}{from}\ contextlib\ \textcolor{keyword}{import}\ asynccontextmanager\ \textcolor{keyword}{as}\ asynccontextmanager}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00002}00002\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ AsyncGenerator,\ ContextManager,\ TypeVar}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00004}00004\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespaceanyio_1_1to__thread}{anyio.to\_thread}}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00005}00005\ \textcolor{keyword}{from}\ anyio\ \textcolor{keyword}{import}\ CapacityLimiter}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1concurrency}{starlette.concurrency}}\ \textcolor{keyword}{import}\ iterate\_in\_threadpool\ \textcolor{keyword}{as}\ iterate\_in\_threadpool\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00007}00007\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1concurrency}{starlette.concurrency}}\ \textcolor{keyword}{import}\ run\_in\_threadpool\ \textcolor{keyword}{as}\ run\_in\_threadpool\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1concurrency}{starlette.concurrency}}\ \textcolor{keyword}{import}\ (\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00009}00009\ \ \ \ \ run\_until\_first\_complete\ \textcolor{keyword}{as}\ run\_until\_first\_complete,}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00010}00010\ )}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00012}\mbox{\hyperlink{namespacefastapi_1_1concurrency_a5dffc8e56cc1950856594736ffc996ac}{00012}}\ \_T\ =\ TypeVar(\textcolor{stringliteral}{"{}\_T"{}})}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00015}00015\ \textcolor{preprocessor}{@asynccontextmanager}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00016}\mbox{\hyperlink{namespacefastapi_1_1concurrency_af1e2b0f45694a484493133bdbff250bd}{00016}}\ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{namespacefastapi_1_1concurrency_af1e2b0f45694a484493133bdbff250bd}{contextmanager\_in\_threadpool}}(}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00017}00017\ \ \ \ \ cm:\ ContextManager[\_T],}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00018}00018\ )\ -\/>\ AsyncGenerator[\_T,\ \textcolor{keywordtype}{None}]:}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00019}00019\ \ \ \ \ \textcolor{comment}{\#\ blocking\ \_\_exit\_\_\ from\ running\ waiting\ on\ a\ free\ thread}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00020}00020\ \ \ \ \ \textcolor{comment}{\#\ can\ create\ race\ conditions/deadlocks\ if\ the\ context\ manager\ itself}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00021}00021\ \ \ \ \ \textcolor{comment}{\#\ has\ its\ own\ internal\ pool\ (e.g.\ a\ database\ connection\ pool)}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00022}00022\ \ \ \ \ \textcolor{comment}{\#\ to\ avoid\ this\ we\ let\ \_\_exit\_\_\ run\ without\ a\ capacity\ limit}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00023}00023\ \ \ \ \ \textcolor{comment}{\#\ since\ we're\ creating\ a\ new\ limiter\ for\ each\ call,\ any\ non-\/zero\ limit}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00024}00024\ \ \ \ \ \textcolor{comment}{\#\ works\ (1\ is\ arbitrary)}}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00025}00025\ \ \ \ \ exit\_limiter\ =\ \mbox{\hyperlink{classanyio_1_1__core_1_1__synchronization_1_1_capacity_limiter}{CapacityLimiter}}(1)}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00026}00026\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ await\ run\_in\_threadpool(cm.\_\_enter\_\_)}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00028}00028\ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ ok\ =\ bool(}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ await\ \mbox{\hyperlink{namespaceanyio_1_1to__thread_a9ecce2ae7f01bdab449c9c159ed7f314}{anyio.to\_thread.run\_sync}}(}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cm.\_\_exit\_\_,\ type(e),\ e,\ e.\_\_traceback\_\_,\ limiter=exit\_limiter}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ ok:}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ e}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ await\ \mbox{\hyperlink{namespaceanyio_1_1to__thread_a9ecce2ae7f01bdab449c9c159ed7f314}{anyio.to\_thread.run\_sync}}(}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ cm.\_\_exit\_\_,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None},\ limiter=exit\_limiter}
\DoxyCodeLine{\Hypertarget{fastapi_2concurrency_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ )}

\end{DoxyCode}
