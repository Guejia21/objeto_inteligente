\doxysection{Objeto\+Inteligente.\+py}
\hypertarget{_objeto_inteligente_8py_source}{}\label{_objeto_inteligente_8py_source}\index{micro\_gestion\_objetos/app/domain/ObjetoInteligente.py@{micro\_gestion\_objetos/app/domain/ObjetoInteligente.py}}
\mbox{\hyperlink{_objeto_inteligente_8py}{Ir a la documentación de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00001}\mbox{\hyperlink{namespace_objeto_inteligente}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Módulo\ que\ define\ la\ clase\ ObjetoInteligente\ y\ sus\ métodos\ asociados."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00002}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente}{00002}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente}{ObjetoInteligente}}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00003}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab371399bbf4f56e9c336702801a6fe1a}{00003}}\ \ \ \ \ \_instance\ =\ \textcolor{keywordtype}{None}\ \ \textcolor{comment}{\#\ Variable\ de\ clase\ para\ almacenar\ la\ única\ instancia}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00004}00004\ \ \ \ \ \textcolor{comment}{\#\ Implementación\ del\ patrón\ Singleton}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00005}00005\ \ \ \ \ \textcolor{keyword}{def\ }\_\_new\_\_(cls,\ *args,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00006}00006\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cls.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab371399bbf4f56e9c336702801a6fe1a}{\_instance}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00007}00007\ \ \ \ \ \ \ \ \ \ \ \ \ cls.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab371399bbf4f56e9c336702801a6fe1a}{\_instance}}\ =\ super(ObjetoInteligente,\ cls).\_\_new\_\_(cls)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00008}00008\ \ \ \ \ \ \ \ \ \ \ \ \ cls.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab371399bbf4f56e9c336702801a6fe1a}{\_instance}}.\_initialized\ =\ \textcolor{keyword}{False}\ \ \textcolor{comment}{\#\ Bandera\ para\ inicialización}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00009}00009\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cls.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab371399bbf4f56e9c336702801a6fe1a}{\_instance}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00011}00011\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ osid:\ str\ =\ \textcolor{keywordtype}{None},\ title:\ str\ =\ \textcolor{keywordtype}{None}):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00012}00012\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ getattr(self,\ \textcolor{stringliteral}{"{}\_initialized"{}},\ \textcolor{keyword}{False}):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00013}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_add6ec4ab0a8513163bc95fcf9a32edc4}{00013}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_add6ec4ab0a8513163bc95fcf9a32edc4}{\_initialized}}\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00014}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a11a0cd1d2482bd77173931eb35be32e6}{00014}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a11a0cd1d2482bd77173931eb35be32e6}{osid}}\ =\ osid}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00015}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab0e0cf4a3b1d147a5f76125cdc536f6e}{00015}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab0e0cf4a3b1d147a5f76125cdc536f6e}{title}}\ =\ title}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00016}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a581f532001eaaec48ed17cc6f4c16c14}{00016}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a581f532001eaaec48ed17cc6f4c16c14}{json}}\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00017}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a284329de0cf7a0f05f2036fa1ac218c1}{00017}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a284329de0cf7a0f05f2036fa1ac218c1}{datastreams}}\ =\ []}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00018}00018\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00019}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a58b26bd6d80f2d0bddf22df0b6191b97}{00019}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a58b26bd6d80f2d0bddf22df0b6191b97}{update\_attributes}}(self,\ osid:\ str,\ title:\ str):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Actualiza\ los\ atributos\ del\ objeto\ inteligente"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a11a0cd1d2482bd77173931eb35be32e6}{osid}}\ =\ osid}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_ab0e0cf4a3b1d147a5f76125cdc536f6e}{title}}\ =\ title}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00024}\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a52179611e314ba72c30b39c354446704}{00024}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a52179611e314ba72c30b39c354446704}{estructurarJSON}}(self,\ jsonOriginal):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Prepara\ el\ JSON\ del\ objeto\ y\ lo\ adapta\ al\ formato\ \{dicObj,\ dicRec\}\ requerido.}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00026}00026\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Acepta\ dos\ formas\ de\ entrada:}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ El\ dict\ completo\ que\ contiene\ keys\ como\ Conceptos,\ lugares,\ feed,\ etc.}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ Directamente\ el\ dict\ del\ \`{}feed\`{}.}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00030}00030\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Devuelve:}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \{"{}dicObj"{}:\ \{...\},\ "{}dicRec"{}:\ [...]\}\ con\ tipos\ y\ campos\ normalizados.}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ infraestructure.logging.Logging\ \textcolor{keyword}{import}\ logger}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Aceptar\ que\ nos\ pasen\ el\ objeto\ entero\ o\ solo\ el\ feed}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ payload\ =\ jsonOriginal\ \textcolor{keywordflow}{or}\ \{\}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}feed"{}}\ \textcolor{keywordflow}{in}\ payload\ \textcolor{keywordflow}{and}\ isinstance(payload.get(\textcolor{stringliteral}{"{}feed"{}}),\ dict):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ feed\ =\ payload.get(\textcolor{stringliteral}{"{}feed"{}})}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Si\ nos\ pasó\ directamente\ el\ feed}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ feed\ =\ payload}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Normalizar\ nulos}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }norm(v,\ default="{}"{}):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ v\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ v\ ==\ \textcolor{stringliteral}{"{}None"{}}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ default}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ v}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Extraer\ datastreams\ (si\ vienen\ en\ feed)}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ datastreams\ =\ []}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(feed.get(\textcolor{stringliteral}{"{}datastreams"{}}),\ list):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ datastreams\ =\ feed.get(\textcolor{stringliteral}{"{}datastreams"{}})}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Construir\ dicRec}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ dicRec\ =\ []}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ recurso\ \textcolor{keywordflow}{in}\ datastreams:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(recurso,\ dict):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desanidar\ unidad}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ unit\ =\ recurso.get(\textcolor{stringliteral}{"{}unit"{}})\ \textcolor{keywordflow}{or}\ \{\}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ symbol\ =\ norm(unit.get(\textcolor{stringliteral}{"{}symbol"{}},\ \textcolor{stringliteral}{"{}"{}}))}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ label\ =\ norm(unit.get(\textcolor{stringliteral}{"{}label"{}},\ \textcolor{stringliteral}{"{}"{}}))}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unitType\ =\ int(unit.get(\textcolor{stringliteral}{"{}unitType"{}},\ 0)\ \textcolor{keywordflow}{or}\ 0)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unitType\ =\ 0}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Tags:\ limpiar\ etiquetas\ de\ control\ y\ extraer\ caracteristica/entidad}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ raw\_tags\ =\ recurso.get(\textcolor{stringliteral}{"{}tags"{}})\ \textcolor{keywordflow}{or}\ []}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ tags\ =\ []}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ featureofinterest\ =\ \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ entityofinterest\ =\ \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ t\ \textcolor{keywordflow}{in}\ raw\_tags:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(t,\ str):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t.lower()\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}sensor"{}},\ \textcolor{stringliteral}{"{}actuador"{}},\ \textcolor{stringliteral}{"{}actuator"{}}):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ etiqueta\ de\ tipo,\ no\ la\ añadimos\ a\ tags}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}Caracteristica"{}}\ \textcolor{keywordflow}{in}\ t:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ extraer\ lo\ que\ viene\ después}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ featureofinterest\ =\ t.split(\textcolor{stringliteral}{"{}Caracteristica\ "{}},\ 1)[1]}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tags.append(featureofinterest)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{stringliteral}{"{}Entidad"{}}\ \textcolor{keywordflow}{in}\ t:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entityofinterest\ =\ t.split(\textcolor{stringliteral}{"{}Entidad\ "{}},\ 1)[1]}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tags.append(entityofinterest)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tags.append(t)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clasificar\ datastream\_type\ por\ tags\ originales}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ ds\_type\ =\ \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ any(x\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}Actuador"{}},\ \textcolor{stringliteral}{"{}Actuator"{}})\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ raw\_tags):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ds\_type\ =\ \textcolor{stringliteral}{"{}actuador"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ any(x\ ==\ \textcolor{stringliteral}{"{}Sensor"{}}\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ raw\_tags):}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ds\_type\ =\ \textcolor{stringliteral}{"{}sensor"{}}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ dicRec.append(\{}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}datastream\_id"{}}:\ str(recurso.get(\textcolor{stringliteral}{"{}id"{}})\ \textcolor{keywordflow}{or}\ recurso.get(\textcolor{stringliteral}{"{}datastream\_id"{}},\ \textcolor{stringliteral}{"{}"{}})),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}datastream\_format"{}}:\ str(recurso.get(\textcolor{stringliteral}{"{}datastream\_format"{}},\ \textcolor{stringliteral}{"{}float"{}})),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}feedid"{}}:\ str(recurso.get(\textcolor{stringliteral}{"{}feedid"{}})\ \textcolor{keywordflow}{or}\ feed.get(\textcolor{stringliteral}{"{}id"{}},\ \textcolor{stringliteral}{"{}"{}})),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}current\_value"{}}:\ str(norm(recurso.get(\textcolor{stringliteral}{"{}current\_value"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}at"{}}:\ str(norm(recurso.get(\textcolor{stringliteral}{"{}at"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max\_value"{}}:\ str(norm(recurso.get(\textcolor{stringliteral}{"{}max\_value"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min\_value"{}}:\ str(norm(recurso.get(\textcolor{stringliteral}{"{}min\_value"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}tags"{}}:\ list(tags),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}datapoints"{}}:\ str(norm(recurso.get(\textcolor{stringliteral}{"{}datapoints"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}symbol"{}}:\ str(symbol),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}label"{}}:\ str(label),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}unitType"{}}:\ int(unitType),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}datastream\_type"{}}:\ str(ds\_type),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}featureofinterest"{}}:\ str(featureofinterest),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}entityofinterest"{}}:\ str(entityofinterest)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Construir\ dicObj\ a\ partir\ de\ feed\ +\ location}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ location\ =\ feed.get(\textcolor{stringliteral}{"{}location"{}})\ \textcolor{keywordflow}{or}\ \{\}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ lat\ =\ float(location.get(\textcolor{stringliteral}{"{}lat"{}})\ \textcolor{keywordflow}{or}\ feed.get(\textcolor{stringliteral}{"{}lat"{}})\ \textcolor{keywordflow}{or}\ 0)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ lat\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ lon\ =\ float(location.get(\textcolor{stringliteral}{"{}lon"{}})\ \textcolor{keywordflow}{or}\ feed.get(\textcolor{stringliteral}{"{}lon"{}})\ \textcolor{keywordflow}{or}\ 0)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ lon\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ ele\ =\ float(location.get(\textcolor{stringliteral}{"{}ele"{}})\ \textcolor{keywordflow}{or}\ feed.get(\textcolor{stringliteral}{"{}ele"{}})\ \textcolor{keywordflow}{or}\ 0)}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ ele\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ id:\ prefer\ feed.id,\ sino\ primer\ feedid\ de\ datastreams,\ sino\ osid}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ id\_val\ =\ norm(feed.get(\textcolor{stringliteral}{"{}id"{}})\ \textcolor{keywordflow}{or}\ (datastreams[0].get(\textcolor{stringliteral}{"{}feedid"{}})\ \textcolor{keywordflow}{if}\ datastreams\ \textcolor{keywordflow}{and}\ isinstance(datastreams[0],\ dict)\ \textcolor{keywordflow}{else}\ \textcolor{keywordtype}{None})\ \textcolor{keywordflow}{or}\ self.\mbox{\hyperlink{class_objeto_inteligente_1_1_objeto_inteligente_a11a0cd1d2482bd77173931eb35be32e6}{osid}}\ \textcolor{keywordflow}{or}\ \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00139}00139\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ dicObj\ =\ \{}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}id"{}}:\ id\_val,}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ip\_object"{}}:\ str(norm(payload.get(\textcolor{stringliteral}{"{}ip\_object"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}version"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}version"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}creator"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}creator"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}status"{}}:\ int(feed.get(\textcolor{stringliteral}{"{}status"{}})\ \textcolor{keywordflow}{or}\ 0),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}tags"{}}:\ list(feed.get(\textcolor{stringliteral}{"{}tags"{}})\ \textcolor{keywordflow}{or}\ []),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}title"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}title"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}private"{}}:\ bool(feed.get(\textcolor{stringliteral}{"{}Private"{}})\ \textcolor{keywordflow}{or}\ feed.get(\textcolor{stringliteral}{"{}private"{}})\ \textcolor{keywordflow}{or}\ \textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}description"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}description"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}updated"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}updated"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}website"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}website"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}feed"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}feed"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}created"{}}:\ str(norm(feed.get(\textcolor{stringliteral}{"{}created"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}name"{}}:\ str(norm(location.get(\textcolor{stringliteral}{"{}name"{}})\ \textcolor{keywordflow}{or}\ feed.get(\textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}"{}}))),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}domain"{}}:\ int(location.get(\textcolor{stringliteral}{"{}domain"{}})\ \textcolor{keywordflow}{or}\ feed.get(\textcolor{stringliteral}{"{}domain"{}})\ \textcolor{keywordflow}{or}\ 0),}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}lat"{}}:\ lat,}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}lon"{}}:\ lon,}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ele"{}}:\ ele}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{_objeto_inteligente_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\textcolor{stringliteral}{"{}dicObj"{}}:\ dicObj,\ \textcolor{stringliteral}{"{}dicRec"{}}:\ dicRec\}}

\end{DoxyCode}
