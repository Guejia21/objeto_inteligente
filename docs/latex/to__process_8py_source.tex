\doxysection{to\+\_\+process.\+py}
\hypertarget{to__process_8py_source}{}\label{to__process_8py_source}\index{micro\_gestion\_objetos/venv/Lib/site-\/packages/anyio/to\_process.py@{micro\_gestion\_objetos/venv/Lib/site-\/packages/anyio/to\_process.py}}
\mbox{\hyperlink{to__process_8py}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00001}\mbox{\hyperlink{namespaceanyio_1_1to__process}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00003}00003\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00004}00004\ \textcolor{keyword}{import}\ pickle}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00005}00005\ \textcolor{keyword}{import}\ subprocess}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00006}00006\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00007}00007\ \textcolor{keyword}{from}\ collections\ \textcolor{keyword}{import}\ deque}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacecollections_1_1abc}{collections.abc}}\ \textcolor{keyword}{import}\ Callable}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00009}00009\ \textcolor{keyword}{from}\ importlib.util\ \textcolor{keyword}{import}\ module\_from\_spec,\ spec\_from\_file\_location}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00010}00010\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ TypeVar,\ cast}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00012}00012\ \textcolor{keyword}{from}\ .\_core.\_eventloop\ \textcolor{keyword}{import}\ current\_time,\ get\_async\_backend,\ get\_cancelled\_exc\_class}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00013}00013\ \textcolor{keyword}{from}\ .\_core.\_exceptions\ \textcolor{keyword}{import}\ BrokenWorkerProcess}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00014}00014\ \textcolor{keyword}{from}\ .\_core.\_subprocesses\ \textcolor{keyword}{import}\ open\_process}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00015}00015\ \textcolor{keyword}{from}\ .\_core.\_synchronization\ \textcolor{keyword}{import}\ CapacityLimiter}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00016}00016\ \textcolor{keyword}{from}\ .\_core.\_tasks\ \textcolor{keyword}{import}\ CancelScope,\ fail\_after}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00017}00017\ \textcolor{keyword}{from}\ .abc\ \textcolor{keyword}{import}\ ByteReceiveStream,\ ByteSendStream,\ Process}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00018}00018\ \textcolor{keyword}{from}\ .lowlevel\ \textcolor{keyword}{import}\ RunVar,\ checkpoint\_if\_cancelled}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00019}00019\ \textcolor{keyword}{from}\ .streams.buffered\ \textcolor{keyword}{import}\ BufferedByteReceiveStream}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00021}00021\ \textcolor{keywordflow}{if}\ sys.version\_info\ >=\ (3,\ 11):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00022}00022\ \ \ \ \ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ TypeVarTuple,\ Unpack}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00023}00023\ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00024}00024\ \ \ \ \ \textcolor{keyword}{from}\ typing\_extensions\ \textcolor{keyword}{import}\ TypeVarTuple,\ Unpack}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00026}\mbox{\hyperlink{namespaceanyio_1_1to__process_a1bbec4eff28cc0acffe1f752536a2f3b}{00026}}\ WORKER\_MAX\_IDLE\_TIME\ =\ 300\ \ \textcolor{comment}{\#\ 5\ minutes}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00028}\mbox{\hyperlink{namespaceanyio_1_1to__process_a294b84595380adc9942f0a720b6d6e7b}{00028}}\ T\_Retval\ =\ TypeVar(\textcolor{stringliteral}{"{}T\_Retval"{}})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00029}\mbox{\hyperlink{namespaceanyio_1_1to__process_a14388a74dac309d4830fe4ca7803d2c5}{00029}}\ PosArgsT\ =\ \mbox{\hyperlink{classtyping__extensions_1_1_type_var_tuple}{TypeVarTuple}}(\textcolor{stringliteral}{"{}PosArgsT"{}})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00031}\mbox{\hyperlink{namespaceanyio_1_1to__process_a55df9052457f99be5d6944b67213b35e}{00031}}\ \_process\_pool\_workers:\ RunVar[set[Process]]\ =\ \mbox{\hyperlink{classanyio_1_1lowlevel_1_1_run_var}{RunVar}}(\textcolor{stringliteral}{"{}\_process\_pool\_workers"{}})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00032}\mbox{\hyperlink{namespaceanyio_1_1to__process_a753404eeb26a383a8db9b65233a0b80b}{00032}}\ \_process\_pool\_idle\_workers:\ RunVar[deque[tuple[Process,\ float]]]\ =\ \mbox{\hyperlink{classanyio_1_1lowlevel_1_1_run_var}{RunVar}}(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00033}00033\ \ \ \ \ \textcolor{stringliteral}{"{}\_process\_pool\_idle\_workers"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00034}00034\ )}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00035}\mbox{\hyperlink{namespaceanyio_1_1to__process_a4f2118cc84e96df724b98151d415e471}{00035}}\ \_default\_process\_limiter:\ RunVar[CapacityLimiter]\ =\ \mbox{\hyperlink{classanyio_1_1lowlevel_1_1_run_var}{RunVar}}(\textcolor{stringliteral}{"{}\_default\_process\_limiter"{}})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00038}\mbox{\hyperlink{namespaceanyio_1_1to__process_a0742c4d1068d65bde1173a2d4078b673}{00038}}\ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{namespaceanyio_1_1to__process_a0742c4d1068d65bde1173a2d4078b673}{run\_sync}}(\ \ \textcolor{comment}{\#\ type:\ ignore[return]}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00039}00039\ \ \ \ \ func:\ Callable[[Unpack[PosArgsT]],\ T\_Retval],}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00040}00040\ \ \ \ \ *args:\ Unpack[PosArgsT],}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00041}00041\ \ \ \ \ cancellable:\ bool\ =\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00042}00042\ \ \ \ \ limiter:\ CapacityLimiter\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00043}00043\ )\ -\/>\ T\_Retval:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00044}00044\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ Call\ the\ given\ function\ with\ the\ given\ arguments\ in\ a\ worker\ process.}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00046}00046\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ If\ the\ \`{}\`{}cancellable\`{}\`{}\ option\ is\ enabled\ and\ the\ task\ waiting\ for\ its\ completion\ is}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ cancelled,\ the\ worker\ process\ running\ it\ will\ be\ abruptly\ terminated\ using\ SIGKILL}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ (or\ \`{}\`{}terminateProcess()\`{}\`{}\ on\ Windows).}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00050}00050\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ :param\ func:\ a\ callable}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ :param\ args:\ positional\ arguments\ for\ the\ callable}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ :param\ cancellable:\ \`{}\`{}True\`{}\`{}\ to\ allow\ cancellation\ of\ the\ operation\ while\ it's}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ running}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ :param\ limiter:\ capacity\ limiter\ to\ use\ to\ limit\ the\ total\ amount\ of\ processes}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ running\ (if\ omitted,\ the\ default\ limiter\ is\ used)}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ :return:\ an\ awaitable\ that\ yields\ the\ return\ value\ of\ the\ function.}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00058}00058\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00061}00061\ \ \ \ \ \textcolor{keyword}{async\ def\ }send\_raw\_command(pickled\_cmd:\ bytes)\ -\/>\ object:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ await\ stdin.send(pickled\_cmd)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ response\ =\ await\ buffered.receive\_until(b\textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ 50)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ status,\ length\ =\ response.split(b\textcolor{stringliteral}{"{}\ "{}})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ status\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ (b\textcolor{stringliteral}{"{}RETURN"{}},\ b\textcolor{stringliteral}{"{}EXCEPTION"{}}):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RuntimeError(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Worker\ process\ returned\ unexpected\ response:\ \{response!r\}"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ pickled\_response\ =\ await\ buffered.receive\_exactly(int(length))}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ BaseException\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ workers.discard(process)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ process.kill()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classanyio_1_1__core_1_1__tasks_1_1_cancel_scope}{CancelScope}}(shield=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ process.aclose()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ ProcessLookupError:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(exc,\ get\_cancelled\_exc\_class()):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ BrokenWorkerProcess\ \textcolor{keyword}{from}\ exc}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ retval\ =\ pickle.loads(pickled\_response)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ status\ ==\ b\textcolor{stringliteral}{"{}EXCEPTION"{}}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(retval,\ BaseException)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ retval}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ retval}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00093}00093\ \ \ \ \ \textcolor{comment}{\#\ First\ pickle\ the\ request\ before\ trying\ to\ reserve\ a\ worker\ process}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00094}00094\ \ \ \ \ await\ checkpoint\_if\_cancelled()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00095}00095\ \ \ \ \ request\ =\ pickle.dumps((\textcolor{stringliteral}{"{}run"{}},\ func,\ args),\ protocol=pickle.HIGHEST\_PROTOCOL)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00097}00097\ \ \ \ \ \textcolor{comment}{\#\ If\ this\ is\ the\ first\ run\ in\ this\ event\ loop\ thread,\ set\ up\ the\ necessary\ variables}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00098}00098\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ workers\ =\ \_process\_pool\_workers.get()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ idle\_workers\ =\ \_process\_pool\_idle\_workers.get()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00101}00101\ \ \ \ \ \textcolor{keywordflow}{except}\ LookupError:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ workers\ =\ set()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ idle\_workers\ =\ deque()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \_process\_pool\_workers.set(workers)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \_process\_pool\_idle\_workers.set(idle\_workers)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ get\_async\_backend().setup\_process\_pool\_exit\_at\_shutdown(workers)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00108}00108\ \ \ \ \ \textcolor{keyword}{async}\ \textcolor{keyword}{with}\ limiter\ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{namespaceanyio_1_1to__process_a3590316d35331d323a4d8205ff525f2f}{current\_default\_process\_limiter}}():}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Pop\ processes\ from\ the\ pool\ (starting\ from\ the\ most\ recently\ used)\ until\ we}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ find\ one\ that\ hasn't\ exited\ yet}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ process:\ Process}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ idle\_workers:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ process,\ idle\_since\ =\ idle\_workers.pop()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ process.returncode\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stdin\ =\ cast(ByteSendStream,\ process.stdin)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffered\ =\ \mbox{\hyperlink{classanyio_1_1streams_1_1buffered_1_1_buffered_byte_receive_stream}{BufferedByteReceiveStream}}(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cast(ByteReceiveStream,\ process.stdout)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Prune\ any\ other\ workers\ that\ have\ been\ idle\ for\ WORKER\_MAX\_IDLE\_TIME}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ seconds\ or\ longer}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ now\ =\ current\_time()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ killed\_processes:\ list[Process]\ =\ []}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ idle\_workers:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ now\ -\/\ idle\_workers[0][1]\ <\ WORKER\_MAX\_IDLE\_TIME:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ process\_to\_kill,\ idle\_since\ =\ idle\_workers.popleft()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ process\_to\_kill.kill()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ workers.remove(process\_to\_kill)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ killed\_processes.append(process\_to\_kill)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classanyio_1_1__core_1_1__tasks_1_1_cancel_scope}{CancelScope}}(shield=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ killed\_process\ \textcolor{keywordflow}{in}\ killed\_processes:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ killed\_process.aclose()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ workers.remove(process)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ command\ =\ [sys.executable,\ \textcolor{stringliteral}{"{}-\/u"{}},\ \textcolor{stringliteral}{"{}-\/m"{}},\ \_\_name\_\_]}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ process\ =\ await\ open\_process(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ command,\ stdin=subprocess.PIPE,\ stdout=subprocess.PIPE}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stdin\ =\ cast(ByteSendStream,\ process.stdin)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffered\ =\ \mbox{\hyperlink{classanyio_1_1streams_1_1buffered_1_1_buffered_byte_receive_stream}{BufferedByteReceiveStream}}(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cast(ByteReceiveStream,\ process.stdout)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ fail\_after(20):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ await\ buffered.receive(6)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ message\ !=\ b\textcolor{stringliteral}{"{}READY\(\backslash\)n"{}}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classanyio_1_1__core_1_1__exceptions_1_1_broken_worker_process}{BrokenWorkerProcess}}(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Worker\ process\ returned\ unexpected\ response:\ \{message!r\}"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ main\_module\_path\ =\ getattr(sys.modules[\textcolor{stringliteral}{"{}\_\_main\_\_"{}}],\ \textcolor{stringliteral}{"{}\_\_file\_\_"{}},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickled\ =\ pickle.dumps(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}init"{}},\ sys.path,\ main\_module\_path),}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ protocol=pickle.HIGHEST\_PROTOCOL,}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ send\_raw\_command(pickled)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ (BrokenWorkerProcess,\ get\_cancelled\_exc\_class()):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ BaseException\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ process.kill()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classanyio_1_1__core_1_1__exceptions_1_1_broken_worker_process}{BrokenWorkerProcess}}(}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Error\ during\ worker\ process\ initialization"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\ \textcolor{keyword}{from}\ exc}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ workers.add(process)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classanyio_1_1__core_1_1__tasks_1_1_cancel_scope}{CancelScope}}(shield=\textcolor{keywordflow}{not}\ cancellable):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cast(T\_Retval,\ await\ send\_raw\_command(request))}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ process\ \textcolor{keywordflow}{in}\ workers:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idle\_workers.append((process,\ current\_time()))}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00182}\mbox{\hyperlink{namespaceanyio_1_1to__process_a3590316d35331d323a4d8205ff525f2f}{00182}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespaceanyio_1_1to__process_a3590316d35331d323a4d8205ff525f2f}{current\_default\_process\_limiter}}()\ -\/>\ CapacityLimiter:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00183}00183\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ Return\ the\ capacity\ limiter\ that\ is\ used\ by\ default\ to\ limit\ the\ number\ of\ worker}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ processes.}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00186}00186\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00187}00187\ \textcolor{stringliteral}{\ \ \ \ :return:\ a\ capacity\ limiter\ object}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00188}00188\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00189}00189\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00190}00190\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_default\_process\_limiter.get()}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00192}00192\ \ \ \ \ \textcolor{keywordflow}{except}\ LookupError:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ limiter\ =\ \mbox{\hyperlink{classanyio_1_1__core_1_1__synchronization_1_1_capacity_limiter}{CapacityLimiter}}(os.cpu\_count()\ \textcolor{keywordflow}{or}\ 2)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \_default\_process\_limiter.set(limiter)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ limiter}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00197}00197\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00198}\mbox{\hyperlink{namespaceanyio_1_1to__process_a53fe96bd0d707a2014b4b67400efe677}{00198}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespaceanyio_1_1to__process_a53fe96bd0d707a2014b4b67400efe677}{process\_worker}}()\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00199}00199\ \ \ \ \ \textcolor{comment}{\#\ Redirect\ standard\ streams\ to\ os.devnull\ so\ that\ user\ code\ won't\ interfere\ with\ the}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00200}00200\ \ \ \ \ \textcolor{comment}{\#\ parent-\/worker\ communication}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00201}00201\ \ \ \ \ stdin\ =\ sys.stdin}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00202}00202\ \ \ \ \ stdout\ =\ sys.stdout}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00203}00203\ \ \ \ \ sys.stdin\ =\ open(os.devnull)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00204}00204\ \ \ \ \ sys.stdout\ =\ open(os.devnull,\ \textcolor{stringliteral}{"{}w"{}})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00205}00205\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00206}00206\ \ \ \ \ stdout.buffer.write(b\textcolor{stringliteral}{"{}READY\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00207}00207\ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ retval\ =\ exception\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ \ \ \ \ command,\ *args\ =\ pickle.load(stdin.buffer)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ EOFError:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ BaseException\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ exception\ =\ exc}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ command\ ==\ \textcolor{stringliteral}{"{}run"{}}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ func,\ args\ =\ args}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ retval\ =\ func(*args)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ BaseException\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exception\ =\ exc}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ command\ ==\ \textcolor{stringliteral}{"{}init"{}}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ main\_module\_path:\ str\ |\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sys.path,\ main\_module\_path\ =\ args}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ sys.modules[\textcolor{stringliteral}{"{}\_\_main\_\_"{}}]}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ main\_module\_path\ \textcolor{keywordflow}{and}\ os.path.isfile(main\_module\_path):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Load\ the\ parent's\ main\ module\ but\ as\ \_\_mp\_main\_\_\ instead\ of}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \_\_main\_\_\ (like\ multiprocessing\ does)\ to\ avoid\ infinite\ recursion}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spec\ =\ spec\_from\_file\_location(\textcolor{stringliteral}{"{}\_\_mp\_main\_\_"{}},\ main\_module\_path)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ spec\ \textcolor{keywordflow}{and}\ spec.loader:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ main\ =\ module\_from\_spec(spec)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spec.loader.exec\_module(main)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sys.modules[\textcolor{stringliteral}{"{}\_\_main\_\_"{}}]\ =\ main}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ BaseException\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exception\ =\ exc}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ exception\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ b\textcolor{stringliteral}{"{}EXCEPTION"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickled\ =\ pickle.dumps(exception,\ pickle.HIGHEST\_PROTOCOL)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ b\textcolor{stringliteral}{"{}RETURN"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickled\ =\ pickle.dumps(retval,\ pickle.HIGHEST\_PROTOCOL)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ BaseException\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ exception\ =\ exc}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ b\textcolor{stringliteral}{"{}EXCEPTION"{}}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ pickled\ =\ pickle.dumps(exc,\ pickle.HIGHEST\_PROTOCOL)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ stdout.buffer.write(b\textcolor{stringliteral}{"{}\%s\ \%d\(\backslash\)n"{}}\ \%\ (status,\ len(pickled)))}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ stdout.buffer.write(pickled)}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00251}00251\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Respect\ SIGTERM}}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(exception,\ SystemExit):}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ exception}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00255}00255\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00256}00256\ }
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00257}00257\ \textcolor{keywordflow}{if}\ \_\_name\_\_\ ==\ \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{to__process_8py_source_l00258}00258\ \ \ \ \ \mbox{\hyperlink{namespaceanyio_1_1to__process_a53fe96bd0d707a2014b4b67400efe677}{process\_worker}}()}

\end{DoxyCode}
