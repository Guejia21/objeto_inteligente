\doxysection{Referencia del espacio de nombres app.\+application.\+controllers.\+personalizacion\+\_\+controller}
\hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller}{}\label{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller}\index{app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}}
\doxysubsubsection*{Funciones}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a892611f9f49670f35cdbd570095b6960}{crear\+\_\+preferencia}} (\mbox{\hyperlink{classapp_1_1application_1_1dtos_1_1request__dtos_1_1_make_contract_request}{Make\+Contract\+Request}} data, \mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} personalizacion\+\_\+service=Depends(get\+\_\+personalizacion\+\_\+service))
\item 
\mbox{\hyperlink{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a48b29fa9bd067de558e7e52065de6457}{recibir\+\_\+ontologia}} (\mbox{\hyperlink{classfastapi_1_1datastructures_1_1_upload_file}{Upload\+File}} file=File(..., description="{}Archivo de ontología (.owl)"{}), str nombre=Form(..., description="{}Nombre de la ontología"{}), str ip\+Coordinador=Form(..., description="{}IP del coordinador"{}), \mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} personalizacion\+\_\+service=Depends(get\+\_\+personalizacion\+\_\+service))
\item 
\mbox{\hyperlink{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a429b450a48f045b0b0143521a67ae7af}{notificar\+\_\+salida\+\_\+usuario}} (\mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} personalizacion\+\_\+service=Depends(get\+\_\+personalizacion\+\_\+service))
\item 
\mbox{\hyperlink{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_aeb80e12c70c9905b4a7a3b87ee505bd4}{registro\+\_\+interaccion\+\_\+usuario\+\_\+objeto}} (\mbox{\hyperlink{classapp_1_1application_1_1dtos_1_1request__dtos_1_1_registro_interaccion_d_t_o}{Registro\+Interaccion\+DTO}} data, \mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} personalizacion\+\_\+service=Depends(get\+\_\+personalizacion\+\_\+service))
\item 
\mbox{\hyperlink{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_aa601f56d2df7723a033d1ff86144e976}{health\+\_\+check}} (\mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} personalizacion\+\_\+service=Depends(get\+\_\+personalizacion\+\_\+service))
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a154e3756c89ab16af42620612f3de040}{router}} = \mbox{\hyperlink{classfastapi_1_1routing_1_1_a_p_i_router}{APIRouter}}(prefix="{}/personalizacion"{}, tags=\mbox{[}"{}Gestión de Personalización de Usuario"{}\mbox{]})
\end{DoxyCompactItemize}


\doxysubsection{Descripción detallada}
\begin{DoxyVerb}    @file personalizacion_controller.py
    @brief Controlador REST para gestión de preferencias e interacciones de usuario.
    @details
    Proporciona endpoints para:
    - Crear preferencias/contratos ECA para usuario
    - Recibir y cargar ontologías de perfil de usuario
    - Notificar salida de usuario (desactivar ECAs)
    - Registrar interacciones usuario-objeto
    - Health check del servicio
    
    @note El microservicio integra con micro_gestion_conocimiento y micro_automatizacion.
    
    @author  NexTech
    @version 1.0
    @date 2025-01-10
    
    @see PersonalizacionService Para lógica de negocio
    @see micro_gestion_conocimiento Para ontologías
    @see micro_automatizacion Para ECAs
\end{DoxyVerb}
 

\label{doc-func-members}
\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_doc-func-members}
\doxysubsection{Documentación de funciones}
\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a892611f9f49670f35cdbd570095b6960}\index{app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}!crear\_preferencia@{crear\_preferencia}}
\index{crear\_preferencia@{crear\_preferencia}!app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}}
\doxysubsubsection{\texorpdfstring{crear\_preferencia()}{crear\_preferencia()}}
{\footnotesize\ttfamily \label{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a892611f9f49670f35cdbd570095b6960} 
app.\+application.\+controllers.\+personalizacion\+\_\+controller.\+crear\+\_\+preferencia (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classapp_1_1application_1_1dtos_1_1request__dtos_1_1_make_contract_request}{Make\+Contract\+Request}}}]{data}{, }\item[{\mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} }]{personalizacion\+\_\+service}{ = {\ttfamily Depends(get\+\_\+personalizacion\+\_\+service)}}\end{DoxyParamCaption})}

\begin{DoxyVerb}    @brief Crea una nueva preferencia/contrato ECA para el usuario actual.
    
    @param data DTO MakeContractRequest con definición del contrato ECA.
    @param personalizacion_service Servicio de personalización (inyectado).
    
    @return JSONResponse con status 200 si exitoso, o error 400/500.
    
    @exception HTTPException Si email no coincide o hay error en micro_automatizacion.
    
    @details
    Crea una regla ECA (contrato) que automatiza comportamientos del usuario.
    
    Flujo:
    1. Verifica que el email del DTO coincida con el usuario actual
    2. Envía solicitud al microservicio micro_automatizacion
    3. Registra la preferencia en ontología de usuario
    
    @see PersonalizacionService.crear_preferencia()
    @see micro_automatizacion Para implementación de ECAs
\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{personalizacion__controller_8py_source_l00036}{36}} del archivo \mbox{\hyperlink{personalizacion__controller_8py_source}{personalizacion\+\_\+controller.\+py}}.

\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_aa601f56d2df7723a033d1ff86144e976}\index{app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}!health\_check@{health\_check}}
\index{health\_check@{health\_check}!app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}}
\doxysubsubsection{\texorpdfstring{health\_check()}{health\_check()}}
{\footnotesize\ttfamily \label{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_aa601f56d2df7723a033d1ff86144e976} 
app.\+application.\+controllers.\+personalizacion\+\_\+controller.\+health\+\_\+check (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} }]{personalizacion\+\_\+service}{ = {\ttfamily Depends(get\+\_\+personalizacion\+\_\+service)}}\end{DoxyParamCaption})}

\begin{DoxyVerb}    @brief Health check / status del microservicio.
    
    @param personalizacion_service Servicio de personalización.
    
    @return JSON con status: 'healthy' o 'degraded', nombre y versión del servicio.
    
    @details
    Endpoint para monitoreo y orquestación de contenedores.
    Verifica que el servicio esté disponible.
\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{personalizacion__controller_8py_source_l00162}{162}} del archivo \mbox{\hyperlink{personalizacion__controller_8py_source}{personalizacion\+\_\+controller.\+py}}.

\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a429b450a48f045b0b0143521a67ae7af}\index{app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}!notificar\_salida\_usuario@{notificar\_salida\_usuario}}
\index{notificar\_salida\_usuario@{notificar\_salida\_usuario}!app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}}
\doxysubsubsection{\texorpdfstring{notificar\_salida\_usuario()}{notificar\_salida\_usuario()}}
{\footnotesize\ttfamily \label{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a429b450a48f045b0b0143521a67ae7af} 
app.\+application.\+controllers.\+personalizacion\+\_\+controller.\+notificar\+\_\+salida\+\_\+usuario (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} }]{personalizacion\+\_\+service}{ = {\ttfamily Depends(get\+\_\+personalizacion\+\_\+service)}}\end{DoxyParamCaption})}

\begin{DoxyVerb}    @brief Notifica la salida del usuario y desactiva sus ECAs.
    
    @param personalizacion_service Servicio de personalización.
    
    @return JSONResponse con status 200 si exitoso, o error 500.
    
    @exception HTTPException Si hay error coordinando desactivación.
    
    @details
    Implementa HU-2 (Historia de Usuario 2): cuando el usuario se desconecta,
    desactiva todas sus reglas ECAs en el microservicio de automatización.
    
    @note Operación de coordinación inter-servicios.
    
    @see PersonalizacionService.desactivarEcasUsuarioActual()
    @see micro_automatizacion Para desactivación de ECAs
\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{personalizacion__controller_8py_source_l00109}{109}} del archivo \mbox{\hyperlink{personalizacion__controller_8py_source}{personalizacion\+\_\+controller.\+py}}.

\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a48b29fa9bd067de558e7e52065de6457}\index{app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}!recibir\_ontologia@{recibir\_ontologia}}
\index{recibir\_ontologia@{recibir\_ontologia}!app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}}
\doxysubsubsection{\texorpdfstring{recibir\_ontologia()}{recibir\_ontologia()}}
{\footnotesize\ttfamily \label{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a48b29fa9bd067de558e7e52065de6457} 
app.\+application.\+controllers.\+personalizacion\+\_\+controller.\+recibir\+\_\+ontologia (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classfastapi_1_1datastructures_1_1_upload_file}{Upload\+File}} }]{file}{ = {\ttfamily File(...,~description="{}Archivo~de~ontología~(.owl)"{})}, }\item[{str }]{nombre}{ = {\ttfamily Form(...,~description="{}Nombre~de~la~ontología"{})}, }\item[{str }]{ip\+Coordinador}{ = {\ttfamily Form(...,~description="{}IP~del~coordinador"{})}, }\item[{\mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} }]{personalizacion\+\_\+service}{ = {\ttfamily Depends(get\+\_\+personalizacion\+\_\+service)}}\end{DoxyParamCaption})}

\begin{DoxyVerb}    @brief Recibe y carga ontología de perfil de usuario.
    
    @param file Archivo .owl con ontología del usuario.
    @param nombre Identificador de la ontología.
    @param ipCoordinador IP del coordinador (para tracking/notificación).
    @param personalizacion_service Servicio de personalización.
    
    @return JSONResponse con status 200 si exitoso, o error 400/500.
    
    @exception HTTPException Si hay error en procesamiento o envío.
    
    @details
    Endpoint de integración: recibe ontología del coordinador y la envía
    al microservicio micro_gestion_conocimiento para población.
    
    Flujo:
    1. Valida que el archivo sea .owl
    2. Envía al microservicio de ontologías
    3. Guarda IP del coordinador para tracking
    4. Activa ECAs del usuario
    
    @see PersonalizacionService.recibir_ontologia()
    @see micro_gestion_conocimiento Para carga de ontologías
\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{personalizacion__controller_8py_source_l00071}{71}} del archivo \mbox{\hyperlink{personalizacion__controller_8py_source}{personalizacion\+\_\+controller.\+py}}.

\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_aeb80e12c70c9905b4a7a3b87ee505bd4}\index{app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}!registro\_interaccion\_usuario\_objeto@{registro\_interaccion\_usuario\_objeto}}
\index{registro\_interaccion\_usuario\_objeto@{registro\_interaccion\_usuario\_objeto}!app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}}
\doxysubsubsection{\texorpdfstring{registro\_interaccion\_usuario\_objeto()}{registro\_interaccion\_usuario\_objeto()}}
{\footnotesize\ttfamily \label{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_aeb80e12c70c9905b4a7a3b87ee505bd4} 
app.\+application.\+controllers.\+personalizacion\+\_\+controller.\+registro\+\_\+interaccion\+\_\+usuario\+\_\+objeto (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classapp_1_1application_1_1dtos_1_1request__dtos_1_1_registro_interaccion_d_t_o}{Registro\+Interaccion\+DTO}}}]{data}{, }\item[{\mbox{\hyperlink{classapp_1_1domain_1_1services_1_1personalizacion__service_1_1_personalizacion_service}{Personalizacion\+Service}} }]{personalizacion\+\_\+service}{ = {\ttfamily Depends(get\+\_\+personalizacion\+\_\+service)}}\end{DoxyParamCaption})}

\begin{DoxyVerb}    @brief Registra una interacción entre usuario y objeto inteligente.
    
    @param data DTO RegistroInteraccionDTO con evento de interacción.
    @param personalizacion_service Servicio de personalización.
    
    @return JSONResponse con status 200 si exitoso, o error 500.
    
    @exception HTTPException Si hay error al registrar interacción.
    
    @details
    Registra eventos de interacción (p. ej. usuario accede a objeto,
    modifica preferencias, etc.) para crear historial y base para
    personalización e inferencia de patrones.
    
    @see PersonalizacionService.registroInteraccionUsuarioObjeto()
\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{personalizacion__controller_8py_source_l00137}{137}} del archivo \mbox{\hyperlink{personalizacion__controller_8py_source}{personalizacion\+\_\+controller.\+py}}.



\label{doc-var-members}
\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_doc-var-members}
\doxysubsection{Documentación de variables}
\Hypertarget{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a154e3756c89ab16af42620612f3de040}\index{app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}!router@{router}}
\index{router@{router}!app.application.controllers.personalizacion\_controller@{app.application.controllers.personalizacion\_controller}}
\doxysubsubsection{\texorpdfstring{router}{router}}
{\footnotesize\ttfamily \label{namespaceapp_1_1application_1_1controllers_1_1personalizacion__controller_a154e3756c89ab16af42620612f3de040} 
app.\+application.\+controllers.\+personalizacion\+\_\+controller.\+router = \mbox{\hyperlink{classfastapi_1_1routing_1_1_a_p_i_router}{APIRouter}}(prefix="{}/personalizacion"{}, tags=\mbox{[}"{}Gestión de Personalización de Usuario"{}\mbox{]})}



Definición en la línea \mbox{\hyperlink{personalizacion__controller_8py_source_l00032}{32}} del archivo \mbox{\hyperlink{personalizacion__controller_8py_source}{personalizacion\+\_\+controller.\+py}}.

