\doxysection{endpoints.\+py}
\hypertarget{endpoints_8py_source}{}\label{endpoints_8py_source}\index{micro\_gestion\_objetos/venv/Lib/site-\/packages/starlette/endpoints.py@{micro\_gestion\_objetos/venv/Lib/site-\/packages/starlette/endpoints.py}}
\mbox{\hyperlink{endpoints_8py}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00001}\mbox{\hyperlink{namespacestarlette_1_1endpoints}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00003}00003\ \textcolor{keyword}{import}\ json}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacecollections_1_1abc}{collections.abc}}\ \textcolor{keyword}{import}\ Generator}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00005}00005\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ Any,\ Callable}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00007}00007\ \textcolor{keyword}{from}\ starlette\ \textcolor{keyword}{import}\ status}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1__utils}{starlette.\_utils}}\ \textcolor{keyword}{import}\ is\_async\_callable}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00009}00009\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1concurrency}{starlette.concurrency}}\ \textcolor{keyword}{import}\ run\_in\_threadpool}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1exceptions}{starlette.exceptions}}\ \textcolor{keyword}{import}\ HTTPException}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00011}00011\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1requests}{starlette.requests}}\ \textcolor{keyword}{import}\ Request}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00012}00012\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1responses}{starlette.responses}}\ \textcolor{keyword}{import}\ PlainTextResponse,\ Response}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00013}00013\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1types}{starlette.types}}\ \textcolor{keyword}{import}\ Message,\ Receive,\ Scope,\ Send}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1websockets}{starlette.websockets}}\ \textcolor{keyword}{import}\ WebSocket}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00017}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint}{00017}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint}{HTTPEndpoint}}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00018}00018\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ scope:\ Scope,\ receive:\ Receive,\ send:\ Send)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ scope[\textcolor{stringliteral}{"{}type"{}}]\ ==\ \textcolor{stringliteral}{"{}http"{}}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00020}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a9b0e28c7a795053c23f248893c72ae95}{00020}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a9b0e28c7a795053c23f248893c72ae95}{scope}}\ =\ scope}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00021}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a84da1e9fdb6efa4306d5a7ee83df1aa9}{00021}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a84da1e9fdb6efa4306d5a7ee83df1aa9}{receive}}\ =\ receive}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00022}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a57bd5d11836b7c4a29fb2d5706488365}{00022}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a57bd5d11836b7c4a29fb2d5706488365}{send}}\ =\ send}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00023}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a25f2bb81dc37a3ff10757f45e31b786f}{00023}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a25f2bb81dc37a3ff10757f45e31b786f}{\_allowed\_methods}}\ =\ [}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \ \ \ \ method}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ method\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}GET"{}},\ \textcolor{stringliteral}{"{}HEAD"{}},\ \textcolor{stringliteral}{"{}POST"{}},\ \textcolor{stringliteral}{"{}PUT"{}},\ \textcolor{stringliteral}{"{}PATCH"{}},\ \textcolor{stringliteral}{"{}DELETE"{}},\ \textcolor{stringliteral}{"{}OPTIONS"{}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ getattr(self,\ method.lower(),\ \textcolor{keywordtype}{None})\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00029}00029\ \ \ \ \ \textcolor{keyword}{def\ }\_\_await\_\_(self)\ -\/>\ Generator[Any,\ None,\ None]:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_ae4b9f9d4f157f78a007127980491b817}{dispatch}}().\_\_await\_\_()}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00032}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_ae4b9f9d4f157f78a007127980491b817}{00032}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_ae4b9f9d4f157f78a007127980491b817}{dispatch}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ request\ =\ \mbox{\hyperlink{classstarlette_1_1requests_1_1_request}{Request}}(self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a9b0e28c7a795053c23f248893c72ae95}{scope}},\ receive=self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a84da1e9fdb6efa4306d5a7ee83df1aa9}{receive}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ handler\_name\ =\ \textcolor{stringliteral}{"{}get"{}}\ \textcolor{keywordflow}{if}\ request.method\ ==\ \textcolor{stringliteral}{"{}HEAD"{}}\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ hasattr(self,\ \textcolor{stringliteral}{"{}head"{}})\ \textcolor{keywordflow}{else}\ request.method.lower()}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ handler:\ Callable[[Request],\ Any]\ =\ getattr(self,\ handler\_name,\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a3ddf25633938686c4e1c5ff94b6ef165}{method\_not\_allowed}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ is\_async\ =\ is\_async\_callable(handler)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ is\_async:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ response\ =\ await\ handler(request)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ response\ =\ await\ run\_in\_threadpool(handler,\ request)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ await\ response(self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a9b0e28c7a795053c23f248893c72ae95}{scope}},\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a84da1e9fdb6efa4306d5a7ee83df1aa9}{receive}},\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a57bd5d11836b7c4a29fb2d5706488365}{send}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00044}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a3ddf25633938686c4e1c5ff94b6ef165}{00044}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a3ddf25633938686c4e1c5ff94b6ef165}{method\_not\_allowed}}(self,\ request:\ Request)\ -\/>\ Response:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we're\ running\ inside\ a\ starlette\ application\ then\ raise\ an}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ exception,\ so\ that\ the\ configurable\ exception\ handler\ can\ deal\ with}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ returning\ the\ response.\ For\ plain\ ASGI\ apps,\ just\ return\ the\ response.}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ headers\ =\ \{\textcolor{stringliteral}{"{}Allow"{}}:\ \textcolor{stringliteral}{"{},\ "{}}.join(self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a25f2bb81dc37a3ff10757f45e31b786f}{\_allowed\_methods}})\}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}app"{}}\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_h_t_t_p_endpoint_a9b0e28c7a795053c23f248893c72ae95}{scope}}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classstarlette_1_1exceptions_1_1_h_t_t_p_exception}{HTTPException}}(status\_code=405,\ headers=headers)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classstarlette_1_1responses_1_1_plain_text_response}{PlainTextResponse}}(\textcolor{stringliteral}{"{}Method\ Not\ Allowed"{}},\ status\_code=405,\ headers=headers)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00054}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint}{00054}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint}{WebSocketEndpoint}}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00055}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0ba4dc976b99a2f6e6d820bf8cb5e2e9}{00055}}\ \ \ \ \ encoding:\ str\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None}\ \ \textcolor{comment}{\#\ May\ be\ "{}text"{},\ "{}bytes"{},\ or\ "{}json"{}.}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00057}00057\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ scope:\ Scope,\ receive:\ Receive,\ send:\ Send)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ scope[\textcolor{stringliteral}{"{}type"{}}]\ ==\ \textcolor{stringliteral}{"{}websocket"{}}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00059}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a20bb43bb57ebac969aa25e2dd5852d1a}{00059}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a20bb43bb57ebac969aa25e2dd5852d1a}{scope}}\ =\ scope}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00060}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a9c7156f47ef6b691165dd8a318e55053}{00060}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a9c7156f47ef6b691165dd8a318e55053}{receive}}\ =\ receive}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00061}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a31987d9012928c2d2fe97bedf2bdcc2a}{00061}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a31987d9012928c2d2fe97bedf2bdcc2a}{send}}\ =\ send}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00063}00063\ \ \ \ \ \textcolor{keyword}{def\ }\_\_await\_\_(self)\ -\/>\ Generator[Any,\ None,\ None]:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a00ac5a78b7b3e7d8529fc59206fa99af}{dispatch}}().\_\_await\_\_()}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00066}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a00ac5a78b7b3e7d8529fc59206fa99af}{00066}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a00ac5a78b7b3e7d8529fc59206fa99af}{dispatch}}(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ websocket\ =\ \mbox{\hyperlink{classstarlette_1_1websockets_1_1_web_socket}{WebSocket}}(self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a20bb43bb57ebac969aa25e2dd5852d1a}{scope}},\ receive=self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a9c7156f47ef6b691165dd8a318e55053}{receive}},\ send=self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a31987d9012928c2d2fe97bedf2bdcc2a}{send}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a41b96d76db61cc4293d698c9ad789474}{on\_connect}}(websocket)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ close\_code\ =\ status.WS\_1000\_NORMAL\_CLOSURE}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ await\ websocket.receive()}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ message[\textcolor{stringliteral}{"{}type"{}}]\ ==\ \textcolor{stringliteral}{"{}websocket.receive"{}}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ await\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_aed6f44a68bec180d18e8e71353160b36}{decode}}(websocket,\ message)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0af7031cddb790ad35b46dbcbe13ef9f}{on\_receive}}(websocket,\ data)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ message[\textcolor{stringliteral}{"{}type"{}}]\ ==\ \textcolor{stringliteral}{"{}websocket.disconnect"{}}:\ \ \textcolor{comment}{\#\ pragma:\ no\ branch}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ close\_code\ =\ int(message.get(\textcolor{stringliteral}{"{}code"{}})\ \textcolor{keywordflow}{or}\ status.WS\_1000\_NORMAL\_CLOSURE)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ close\_code\ =\ status.WS\_1011\_INTERNAL\_ERROR}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ exc}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a342aad497aad9c5e3c38d0a27df771d2}{on\_disconnect}}(websocket,\ close\_code)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00087}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_aed6f44a68bec180d18e8e71353160b36}{00087}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_aed6f44a68bec180d18e8e71353160b36}{decode}}(self,\ websocket:\ WebSocket,\ message:\ Message)\ -\/>\ Any:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0ba4dc976b99a2f6e6d820bf8cb5e2e9}{encoding}}\ ==\ \textcolor{stringliteral}{"{}text"{}}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}text"{}}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ message:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ websocket.close(code=status.WS\_1003\_UNSUPPORTED\_DATA)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RuntimeError(\textcolor{stringliteral}{"{}Expected\ text\ websocket\ messages,\ but\ got\ bytes"{}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ message[\textcolor{stringliteral}{"{}text"{}}]}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0ba4dc976b99a2f6e6d820bf8cb5e2e9}{encoding}}\ ==\ \textcolor{stringliteral}{"{}bytes"{}}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}bytes"{}}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ message:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ websocket.close(code=status.WS\_1003\_UNSUPPORTED\_DATA)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RuntimeError(\textcolor{stringliteral}{"{}Expected\ bytes\ websocket\ messages,\ but\ got\ text"{}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ message[\textcolor{stringliteral}{"{}bytes"{}}]}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0ba4dc976b99a2f6e6d820bf8cb5e2e9}{encoding}}\ ==\ \textcolor{stringliteral}{"{}json"{}}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ message.get(\textcolor{stringliteral}{"{}text"{}})\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ text\ =\ message[\textcolor{stringliteral}{"{}text"{}}]}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ text\ =\ message[\textcolor{stringliteral}{"{}bytes"{}}].\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_aed6f44a68bec180d18e8e71353160b36}{decode}}(\textcolor{stringliteral}{"{}utf-\/8"{}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ json.loads(text)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ json.decoder.JSONDecodeError:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ websocket.close(code=status.WS\_1003\_UNSUPPORTED\_DATA)}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RuntimeError(\textcolor{stringliteral}{"{}Malformed\ JSON\ data\ received."{}})}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ self.\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0ba4dc976b99a2f6e6d820bf8cb5e2e9}{encoding}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None},\ f\textcolor{stringliteral}{"{}Unsupported\ 'encoding'\ attribute\ \{self.encoding\}"{}}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ message[\textcolor{stringliteral}{"{}text"{}}]\ \textcolor{keywordflow}{if}\ message.get(\textcolor{stringliteral}{"{}text"{}})\ \textcolor{keywordflow}{else}\ message[\textcolor{stringliteral}{"{}bytes"{}}]}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00115}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a41b96d76db61cc4293d698c9ad789474}{00115}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a41b96d76db61cc4293d698c9ad789474}{on\_connect}}(self,\ websocket:\ WebSocket)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Override\ to\ handle\ an\ incoming\ websocket\ connection"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ await\ websocket.accept()}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00119}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0af7031cddb790ad35b46dbcbe13ef9f}{00119}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a0af7031cddb790ad35b46dbcbe13ef9f}{on\_receive}}(self,\ websocket:\ WebSocket,\ data:\ Any)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Override\ to\ handle\ an\ incoming\ websocket\ message"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00122}\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a342aad497aad9c5e3c38d0a27df771d2}{00122}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1endpoints_1_1_web_socket_endpoint_a342aad497aad9c5e3c38d0a27df771d2}{on\_disconnect}}(self,\ websocket:\ WebSocket,\ close\_code:\ int)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{endpoints_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Override\ to\ handle\ a\ disconnecting\ websocket"{}"{}"{}}}

\end{DoxyCode}
