\doxysection{\+\_\+namespace\+\_\+utils.\+py}
\hypertarget{__namespace__utils_8py_source}{}\label{__namespace__utils_8py_source}\index{micro\_gestion\_objetos/venv/Lib/site-\/packages/pydantic/\_internal/\_namespace\_utils.py@{micro\_gestion\_objetos/venv/Lib/site-\/packages/pydantic/\_internal/\_namespace\_utils.py}}
\mbox{\hyperlink{__namespace__utils_8py}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00001}\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00003}00003\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacecollections_1_1abc}{collections.abc}}\ \textcolor{keyword}{import}\ Generator,\ Iterator,\ Mapping}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00005}00005\ \textcolor{keyword}{from}\ contextlib\ \textcolor{keyword}{import}\ contextmanager}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00006}00006\ \textcolor{keyword}{from}\ functools\ \textcolor{keyword}{import}\ cached\_property}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00007}00007\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ Any,\ Callable,\ NamedTuple,\ TypeVar}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00009}00009\ \textcolor{keyword}{from}\ typing\_extensions\ \textcolor{keyword}{import}\ ParamSpec,\ TypeAlias,\ TypeAliasType,\ TypeVarTuple}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00011}\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_ac504d6f4b5418b7eabe9d7de73bd9404}{00011}}\ GlobalsNamespace:\ TypeAlias\ =\ \textcolor{stringliteral}{'dict[str,\ Any]'}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00012}00012\ \textcolor{stringliteral}{"{}"{}"{}A\ global\ namespace.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00013}00013\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00014}00014\ \textcolor{stringliteral}{In\ most\ cases,\ this\ is\ a\ reference\ to\ the\ \`{}\_\_dict\_\_\`{}\ attribute\ of\ a\ module.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00015}00015\ \textcolor{stringliteral}{This\ namespace\ type\ is\ expected\ as\ the\ \`{}globals\`{}\ argument\ during\ annotations\ evaluation.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00016}00016\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00018}\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_ad1dd832ff0b6e22bd1b2a3e4b7f89ec7}{00018}}\ MappingNamespace:\ TypeAlias\ =\ Mapping[str,\ Any]}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00019}00019\ \textcolor{stringliteral}{"{}"{}"{}Any\ kind\ of\ namespace.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00020}00020\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00021}00021\ \textcolor{stringliteral}{In\ most\ cases,\ this\ is\ a\ local\ namespace\ (e.g.\ the\ \`{}\_\_dict\_\_\`{}\ attribute\ of\ a\ class,}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00022}00022\ \textcolor{stringliteral}{the\ [\`{}f\_locals\`{}][frame.f\_locals]\ attribute\ of\ a\ frame\ object,\ when\ dealing\ with\ types}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00023}00023\ \textcolor{stringliteral}{defined\ inside\ functions).}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00024}00024\ \textcolor{stringliteral}{This\ namespace\ type\ is\ expected\ as\ the\ \`{}locals\`{}\ argument\ during\ annotations\ evaluation.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00025}00025\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00027}\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_a481d0a42acdcb4e903adf1db0f8dd41a}{00027}}\ \_TypeVarLike:\ TypeAlias\ =\ \textcolor{stringliteral}{'TypeVar\ |\ ParamSpec\ |\ TypeVarTuple'}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00030}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_namespaces_tuple}{00030}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_namespaces_tuple}{NamespacesTuple}}(NamedTuple):}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00031}00031\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ tuple\ of\ globals\ and\ locals\ to\ be\ used\ during\ annotations\ evaluation.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00032}00032\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ This\ datastructure\ is\ defined\ as\ a\ named\ tuple\ so\ that\ it\ can\ easily\ be\ unpacked:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00034}00034\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}\`{}python\ \{lint="{}skip"{}\ test="{}skip"{}\}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ def\ eval\_type(typ:\ type[Any],\ ns:\ NamespacesTuple)\ -\/>\ None:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ return\ eval(typ,\ *ns)}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00041}00041\ \ \ \ \ globals:\ GlobalsNamespace}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00042}00042\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}The\ namespace\ to\ be\ used\ as\ the\ \`{}globals\`{}\ argument\ during\ annotations\ evaluation."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00044}00044\ \ \ \ \ locals:\ MappingNamespace}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00045}00045\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}The\ namespace\ to\ be\ used\ as\ the\ \`{}locals\`{}\ argument\ during\ annotations\ evaluation."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00048}\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_a1f39842758c38a212b520f19f0749436}{00048}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_a1f39842758c38a212b520f19f0749436}{get\_module\_ns\_of}}(obj:\ Any)\ -\/>\ dict[str,\ Any]:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00049}00049\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Get\ the\ namespace\ of\ the\ module\ where\ the\ object\ is\ defined.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00050}00050\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ Caution:\ this\ function\ does\ not\ return\ a\ copy\ of\ the\ module\ namespace,\ so\ the\ result}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ should\ not\ be\ mutated.\ The\ burden\ of\ enforcing\ this\ is\ on\ the\ caller.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00054}00054\ \ \ \ \ module\_name\ =\ getattr(obj,\ \textcolor{stringliteral}{'\_\_module\_\_'},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00055}00055\ \ \ \ \ \textcolor{keywordflow}{if}\ module\_name:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ sys.modules[module\_name].\_\_dict\_\_}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ KeyError:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ happens\ occasionally,\ see\ https://github.com/pydantic/pydantic/issues/2363}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00064}00064\ \textcolor{comment}{\#\ Note\ that\ this\ class\ is\ almost\ identical\ to\ \`{}collections.ChainMap`,\ but\ need\ to\ enforce}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00065}00065\ \textcolor{comment}{\#\ immutable\ mappings\ here:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00066}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace}{00066}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace}{LazyLocalNamespace}}(Mapping[str,\ Any]):}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00067}00067\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ lazily\ evaluated\ mapping,\ to\ be\ used\ as\ the\ \`{}locals\`{}\ argument\ during\ annotations\ evaluation.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00068}00068\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ While\ the\ [\`{}eval\`{}][eval]\ function\ expects\ a\ mapping\ as\ the\ \`{}locals\`{}\ argument,\ it\ only}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ performs\ \`{}\_\_getitem\_\_\`{}\ calls.\ The\ [\`{}Mapping\`{}][collections.abc.Mapping]\ abstract\ base\ class}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ is\ fully\ implemented\ only\ for\ type\ checking\ purposes.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00072}00072\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *namespaces:\ The\ namespaces\ to\ consider,\ in\ ascending\ order\ of\ priority.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00075}00075\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ Example:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}\`{}python\ \{lint="{}skip"{}\ test="{}skip"{}\}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ns\ =\ LazyLocalNamespace(\{'a':\ 1,\ 'b':\ 2\},\ \{'a':\ 3\})}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ns['a']}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \#>\ 3}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ns['b']}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \#>\ 2}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00086}00086\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ *namespaces:\ MappingNamespace)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00087}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_a4e50890346d360465b8095f1b38cb42e}{00087}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_a4e50890346d360465b8095f1b38cb42e}{\_namespaces}}\ =\ namespaces}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00089}00089\ \ \ \ \ \textcolor{preprocessor}{@cached\_property}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00090}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_a81019ba4fb88c31b54413c2daa35a4d4}{00090}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_af6e4bcc4807141cd747ce419369098be}{data}}(self)\ -\/>\ dict[str,\ Any]:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{k:\ v\ \textcolor{keywordflow}{for}\ ns\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_a4e50890346d360465b8095f1b38cb42e}{\_namespaces}}\ \textcolor{keywordflow}{for}\ k,\ v\ \textcolor{keywordflow}{in}\ ns.items()\}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00093}00093\ \ \ \ \ \textcolor{keyword}{def\ }\_\_len\_\_(self)\ -\/>\ int:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00094}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_af6e4bcc4807141cd747ce419369098be}{00094}}\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ len(self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_af6e4bcc4807141cd747ce419369098be}{data}})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00096}00096\ \ \ \ \ \textcolor{keyword}{def\ }\_\_getitem\_\_(self,\ key:\ str)\ -\/>\ Any:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_af6e4bcc4807141cd747ce419369098be}{data}}[key]}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00099}00099\ \ \ \ \ \textcolor{keyword}{def\ }\_\_contains\_\_(self,\ key:\ object)\ -\/>\ bool:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ key\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_af6e4bcc4807141cd747ce419369098be}{data}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00102}00102\ \ \ \ \ \textcolor{keyword}{def\ }\_\_iter\_\_(self)\ -\/>\ Iterator[str]:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ iter(self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace_af6e4bcc4807141cd747ce419369098be}{data}})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00106}\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_a2007da77c22cef92a9132f07aac648b1}{00106}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_a2007da77c22cef92a9132f07aac648b1}{ns\_for\_function}}(obj:\ Callable[...,\ Any],\ parent\_namespace:\ MappingNamespace\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None})\ -\/>\ NamespacesTuple:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00107}00107\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ the\ global\ and\ local\ namespaces\ to\ be\ used\ when\ evaluating\ annotations\ for\ the\ provided\ function.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00108}00108\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00109}00109\ \textcolor{stringliteral}{\ \ \ \ The\ global\ namespace\ will\ be\ the\ \`{}\_\_dict\_\_\`{}\ attribute\ of\ the\ module\ the\ function\ was\ defined\ in.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ The\ local\ namespace\ will\ contain\ the\ \`{}\_\_type\_params\_\_\`{}\ introduced\ by\ PEP\ 695.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00111}00111\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00113}00113\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ obj:\ The\ object\ to\ use\ when\ building\ namespaces.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ parent\_namespace:\ Optional\ namespace\ to\ be\ added\ with\ the\ lowest\ priority\ in\ the\ local\ namespace.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ If\ the\ passed\ function\ is\ a\ method,\ the\ \`{}parent\_namespace\`{}\ will\ be\ the\ namespace\ of\ the\ class}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ the\ method\ is\ defined\ in.\ Thus,\ we\ also\ fetch\ type\ \`{}\_\_type\_params\_\_\`{}\ from\ there\ (i.e.\ the}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ class-\/scoped\ type\ variables).}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00119}00119\ \ \ \ \ locals\_list:\ list[MappingNamespace]\ =\ []}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00120}00120\ \ \ \ \ \textcolor{keywordflow}{if}\ parent\_namespace\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ locals\_list.append(parent\_namespace)}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00123}00123\ \ \ \ \ \textcolor{comment}{\#\ Get\ the\ \`{}\_\_type\_params\_\_`\ attribute\ introduced\ by\ PEP\ 695.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00124}00124\ \ \ \ \ \textcolor{comment}{\#\ Note\ that\ the\ \`{}typing.\_eval\_type`\ function\ expects\ type\ params\ to\ be}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00125}00125\ \ \ \ \ \textcolor{comment}{\#\ passed\ as\ a\ separate\ argument.\ However,\ internally,\ \`{}\_eval\_type`\ calls}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00126}00126\ \ \ \ \ \textcolor{comment}{\#\ \`{}ForwardRef.\_evaluate`\ which\ will\ merge\ type\ params\ with\ the\ localns,}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00127}00127\ \ \ \ \ \textcolor{comment}{\#\ essentially\ mimicking\ what\ we\ do\ here.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00128}00128\ \ \ \ \ type\_params:\ tuple[\_TypeVarLike,\ ...]\ =\ getattr(obj,\ \textcolor{stringliteral}{'\_\_type\_params\_\_'},\ ())}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00129}00129\ \ \ \ \ \textcolor{keywordflow}{if}\ parent\_namespace\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ also\ fetch\ type\ params\ from\ the\ parent\ namespace.\ If\ present,\ it\ probably}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ means\ the\ function\ was\ defined\ in\ a\ class.\ This\ is\ to\ support\ the\ following:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://github.com/python/cpython/issues/124089.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ type\_params\ +=\ parent\_namespace.get(\textcolor{stringliteral}{'\_\_type\_params\_\_'},\ ())}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00135}00135\ \ \ \ \ locals\_list.append(\{t.\_\_name\_\_:\ t\ \textcolor{keywordflow}{for}\ t\ \textcolor{keywordflow}{in}\ type\_params\})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00137}00137\ \ \ \ \ \textcolor{comment}{\#\ What\ about\ short-\/circuiting\ to\ \`{}obj.\_\_globals\_\_`?}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00138}00138\ \ \ \ \ globalns\ =\ \mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_a1f39842758c38a212b520f19f0749436}{get\_module\_ns\_of}}(obj)}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00139}00139\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00140}00140\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_namespaces_tuple}{NamespacesTuple}}(globalns,\ \mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace}{LazyLocalNamespace}}(*locals\_list))}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00143}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver}{00143}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver}{NsResolver}}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00144}00144\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ class\ responsible\ for\ the\ namespaces\ resolving\ logic\ for\ annotations\ evaluation.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00145}00145\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ This\ class\ handles\ the\ namespace\ logic\ when\ evaluating\ annotations\ mainly\ for\ class\ objects.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00147}00147\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00148}00148\ \textcolor{stringliteral}{\ \ \ \ It\ holds\ a\ stack\ of\ classes\ that\ are\ being\ inspected\ during\ the\ core\ schema\ building,}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ and\ the\ \`{}types\_namespace\`{}\ property\ exposes\ the\ globals\ and\ locals\ to\ be\ used\ for}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00150}00150\ \textcolor{stringliteral}{\ \ \ \ type\ annotation\ evaluation.\ Additionally\ -\/-\/\ if\ no\ class\ is\ present\ in\ the\ stack\ -\/-\/\ a}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00151}00151\ \textcolor{stringliteral}{\ \ \ \ fallback\ globals\ and\ locals\ can\ be\ provided\ using\ the\ \`{}namespaces\_tuple\`{}\ argument}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ (this\ is\ useful\ when\ generating\ a\ schema\ for\ a\ simple\ annotation,\ e.g.\ when\ using}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ \`{}TypeAdapter\`{}).}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00154}00154\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00155}00155\ \textcolor{stringliteral}{\ \ \ \ The\ namespace\ creation\ logic\ is\ unfortunately\ flawed\ in\ some\ cases,\ for\ backwards}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00156}00156\ \textcolor{stringliteral}{\ \ \ \ compatibility\ reasons\ and\ to\ better\ support\ valid\ edge\ cases.\ See\ the\ description}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ for\ the\ \`{}parent\_namespace\`{}\ argument\ and\ the\ example\ for\ more\ details.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00158}00158\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ namespaces\_tuple:\ The\ default\ globals\ and\ locals\ to\ use\ if\ no\ class\ is\ present}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ on\ the\ stack.\ This\ can\ be\ useful\ when\ using\ the\ \`{}GenerateSchema\`{}\ class}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ with\ \`{}TypeAdapter\`{},\ where\ the\ "{}type"{}\ being\ analyzed\ is\ a\ simple\ annotation.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ parent\_namespace:\ An\ optional\ parent\ namespace\ that\ will\ be\ added\ to\ the\ locals}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ with\ the\ lowest\ priority.\ For\ a\ given\ class\ defined\ in\ a\ function,\ the\ locals}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ of\ this\ function\ are\ usually\ used\ as\ the\ parent\ namespace:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00166}00166\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}\`{}\`{}python\ \{lint="{}skip"{}\ test="{}skip"{}\}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ from\ pydantic\ import\ BaseModel}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00169}00169\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ def\ func()\ -\/>\ None:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SomeType\ =\ int}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00172}00172\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ class\ Model(BaseModel):}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f:\ 'SomeType'}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00175}00175\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ when\ collecting\ fields,\ an\ namespace\ resolver\ instance\ will\ be\ created}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ this\ way:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ ns\_resolver\ =\ NsResolver(parent\_namespace=\{'SomeType':\ SomeType\})}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00180}00180\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ For\ backwards\ compatibility\ reasons\ and\ to\ support\ valid\ edge\ cases,\ this\ parent}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ namespace\ will\ be\ used\ for\ *every*\ type\ being\ pushed\ to\ the\ stack.\ In\ the\ future,}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ we\ might\ want\ to\ be\ smarter\ by\ only\ doing\ so\ when\ the\ type\ being\ pushed\ is\ defined}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ in\ the\ same\ module\ as\ the\ parent\ namespace.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00185}00185\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00186}00186\ \textcolor{stringliteral}{\ \ \ \ Example:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00187}00187\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}\`{}python\ \{lint="{}skip"{}\ test="{}skip"{}\}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00188}00188\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ns\_resolver\ =\ NsResolver(}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00189}00189\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ parent\_namespace=\{'fallback':\ 1\},}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00190}00190\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ )}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00191}00191\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00192}00192\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ class\ Sub:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00193}00193\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ m:\ 'Model'}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00194}00194\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00195}00195\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ class\ Model:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00196}00196\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ some\_local\ =\ 1}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ sub:\ Sub}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00198}00198\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00199}00199\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ns\_resolver\ =\ NsResolver()}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00200}00200\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \#\ This\ is\ roughly\ what\ happens\ when\ we\ build\ a\ core\ schema\ for\ \`{}Model\`{}:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ with\ ns\_resolver.push(Model):}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ ns\_resolver.types\_namespace}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \#>\ NamespacesTuple(\{'Sub':\ Sub\},\ \{'Model':\ Model,\ 'some\_local':\ 1\})}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \#\ First\ thing\ to\ notice\ here,\ the\ model\ being\ pushed\ is\ added\ to\ the\ locals.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \#\ Because\ \`{}NsResolver\`{}\ is\ being\ used\ during\ the\ model\ definition,\ it\ is\ not}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \#\ yet\ added\ to\ the\ globals.\ This\ is\ useful\ when\ resolving\ self-\/referencing\ annotations.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00208}00208\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ with\ ns\_resolver.push(Sub):}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ns\_resolver.types\_namespace}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#>\ NamespacesTuple(\{'Sub':\ Sub\},\ \{'Sub':\ Sub,\ 'Model':\ Model\})}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ Second\ thing\ to\ notice:\ \`{}Sub\`{}\ is\ present\ in\ both\ the\ globals\ and\ locals.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ This\ is\ not\ an\ issue,\ just\ that\ as\ described\ above,\ the\ model\ being\ pushed}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ is\ added\ to\ the\ locals,\ but\ it\ happens\ to\ be\ present\ in\ the\ globals\ as\ well}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ because\ it\ is\ already\ defined.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00216}00216\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ Third\ thing\ to\ notice:\ \`{}Model\`{}\ is\ also\ added\ in\ locals.\ This\ is\ a\ backwards}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00217}00217\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ compatibility\ workaround\ that\ allows\ for\ \`{}Sub\`{}\ to\ be\ able\ to\ resolve\ \`{}'Model'\`{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ correctly\ (as\ otherwise\ models\ would\ have\ to\ be\ rebuilt\ even\ though\ this}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00219}00219\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ doesn't\ look\ necessary).}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00220}00220\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00223}00223\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ namespaces\_tuple:\ NamespacesTuple\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ parent\_namespace:\ MappingNamespace\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00227}00227\ \ \ \ \ )\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00228}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_af096f6b27bae380f358e24a0bd27b7b8}{00228}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_af096f6b27bae380f358e24a0bd27b7b8}{\_base\_ns\_tuple}}\ =\ namespaces\_tuple\ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_namespaces_tuple}{NamespacesTuple}}(\{\},\ \{\})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00229}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_a443129ef28fba2e50b2c68b9ae218dca}{00229}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_a443129ef28fba2e50b2c68b9ae218dca}{\_parent\_ns}}\ =\ parent\_namespace}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00230}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{00230}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{\_types\_stack}}:\ list[type[Any]\ |\ TypeAliasType]\ =\ []}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00232}00232\ \ \ \ \ \textcolor{preprocessor}{@cached\_property}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00233}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_aaa7bb415d32fb25f11d6ff91cf95c95f}{00233}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_aaa7bb415d32fb25f11d6ff91cf95c95f}{types\_namespace}}(self)\ -\/>\ NamespacesTuple:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}The\ current\ global\ and\ local\ namespaces\ to\ be\ used\ for\ annotations\ evaluation."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{\_types\_stack}}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ TODO:\ should\ we\ merge\ the\ parent\ namespace\ here?}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ relevant\ for\ TypeAdapter,\ where\ there\ are\ no\ types\ on\ the\ stack,\ and\ we\ might}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ need\ access\ to\ the\ parent\_ns.\ Right\ now,\ we\ sidestep\ this\ in\ \`{}type\_adapter.py`\ by\ passing}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ locals\ to\ both\ parent\_ns\ and\ the\ base\_ns\_tuple,\ but\ this\ is\ a\ bit\ hacky.}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ might\ consider\ something\ like:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ self.\_parent\_ns\ is\ not\ None:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \#\ Hacky\ workarounds,\ see\ class\ docstring:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \#\ An\ optional\ parent\ namespace\ that\ will\ be\ added\ to\ the\ locals\ with\ the\ lowest\ priority}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ locals\_list:\ list[MappingNamespace]\ =\ [self.\_parent\_ns,\ self.\_base\_ns\_tuple.locals]}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ return\ NamespacesTuple(self.\_base\_ns\_tuple.globals,\ LazyLocalNamespace(*locals\_list))}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_af096f6b27bae380f358e24a0bd27b7b8}{\_base\_ns\_tuple}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ typ\ =\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{\_types\_stack}}[-\/1]}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00249}00249\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ globalns\ =\ \mbox{\hyperlink{namespacepydantic_1_1__internal_1_1__namespace__utils_a1f39842758c38a212b520f19f0749436}{get\_module\_ns\_of}}(typ)}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00251}00251\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ locals\_list:\ list[MappingNamespace]\ =\ []}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Hacky\ workarounds,\ see\ class\ docstring:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ An\ optional\ parent\ namespace\ that\ will\ be\ added\ to\ the\ locals\ with\ the\ lowest\ priority}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_a443129ef28fba2e50b2c68b9ae218dca}{\_parent\_ns}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ locals\_list.append(self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_a443129ef28fba2e50b2c68b9ae218dca}{\_parent\_ns}})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{\_types\_stack}})\ >\ 1:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ first\_type\ =\ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{\_types\_stack}}[0]}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00259}00259\ \ \ \ \ \ \ \ \ \ \ \ \ locals\_list.append(\{first\_type.\_\_name\_\_:\ first\_type\})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00260}00260\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00261}00261\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Adding\ \`{}\_\_type\_params\_\_`\ *before*\ \`{}vars(typ)`,\ as\ the\ latter\ takes\ priority}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (see\ https://github.com/python/cpython/pull/120272).}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ TODO\ \`{}typ.\_\_type\_params\_\_`\ when\ we\ drop\ support\ for\ Python\ 3.11:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ type\_params:\ tuple[\_TypeVarLike,\ ...]\ =\ getattr(typ,\ \textcolor{stringliteral}{'\_\_type\_params\_\_'},\ ())}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ type\_params:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Adding\ \`{}\_\_type\_params\_\_`\ is\ mostly\ useful\ for\ generic\ classes\ defined\ using}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ PEP\ 695\ syntax\ *and*\ using\ forward\ annotations\ (see\ the\ example\ in}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://github.com/python/cpython/issues/114053).\ For\ TypeAliasType\ instances,}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ it\ is\ way\ less\ common,\ but\ still\ required\ if\ using\ a\ string\ annotation\ in\ the\ alias}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ value,\ e.g.\ \`{}type\ A[T]\ =\ 'T'`\ (which\ is\ not\ necessary\ in\ most\ cases).}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ \ \ locals\_list.append(\{t.\_\_name\_\_:\ t\ \textcolor{keywordflow}{for}\ t\ \textcolor{keywordflow}{in}\ type\_params\})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00272}00272\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ TypeAliasType\ instances\ don't\ have\ a\ \`{}\_\_dict\_\_`\ attribute,\ so\ the\ check}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ is\ necessary:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(typ,\ \textcolor{stringliteral}{'\_\_dict\_\_'}):}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ locals\_list.append(vars(typ))}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ \`{}len(self.\_types\_stack)\ >\ 1`\ check\ above\ prevents\ this\ from\ being\ added\ twice:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ locals\_list.append(\{typ.\_\_name\_\_:\ typ\})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00280}00280\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_namespaces_tuple}{NamespacesTuple}}(globalns,\ \mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_lazy_local_namespace}{LazyLocalNamespace}}(*locals\_list))}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00282}00282\ }
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00283}00283\ \ \ \ \ \textcolor{preprocessor}{@contextmanager}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00284}\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_a007d9562d8ad42642e12b6ec0d1e95a0}{00284}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_a007d9562d8ad42642e12b6ec0d1e95a0}{push}}(self,\ typ:\ type[Any]\ |\ TypeAliasType,\ /)\ -\/>\ Generator[\textcolor{keywordtype}{None}]:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Push\ a\ type\ to\ the\ stack."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{\_types\_stack}}.append(typ)}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reset\ the\ cached\ property:}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ self.\_\_dict\_\_.pop(\textcolor{stringliteral}{'types\_namespace'},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classpydantic_1_1__internal_1_1__namespace__utils_1_1_ns_resolver_ac53e1f2680bba8bdfc5630fbb9f9cf63}{\_types\_stack}}.pop()}
\DoxyCodeLine{\Hypertarget{__namespace__utils_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_\_dict\_\_.pop(\textcolor{stringliteral}{'types\_namespace'},\ \textcolor{keywordtype}{None})}

\end{DoxyCode}
