\doxysection{Referencia del espacio de nombres main}
\hypertarget{namespacemain}{}\label{namespacemain}\index{main@{main}}
\doxysubsubsection*{Funciones}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacemain_a5e8523353d7c034328ad494a0cacb6eb}{route}} (Request request, str path\+\_\+name, APIRouter \mbox{\hyperlink{namespaceapi__router}{api\+\_\+router}}=Depends(APIRouter))
\item 
\mbox{\hyperlink{namespacemain_ae435cbc6ee0c9077a8ed5c42a77b49d5}{redirect\+\_\+to\+\_\+docs}} ()
\begin{DoxyCompactList}\small\item\em Redirige raíz a documentación Swagger. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacemain_a4b0afba9bb946ff70defaa002c1f41e2}{lifespan}} (\mbox{\hyperlink{classfastapi_1_1applications_1_1_fast_a_p_i}{Fast\+API}} \mbox{\hyperlink{namespacemain_a5fa94f0581009434c7a63791944d6ff4}{app}})
\item 
\mbox{\hyperlink{namespacemain_a79124365d1c83d2112cc071a29831386}{conectar\+\_\+wifi}} ()
\item 
\mbox{\hyperlink{namespacemain_a799b0d523414a91d4d3924ae19ec6e0f}{shutdown}} ()
\item 
\mbox{\hyperlink{namespacemain_a3140e9a5b6a71ffbf498198cfc471b88}{main}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacemain_a5fa94f0581009434c7a63791944d6ff4}{app}} = \mbox{\hyperlink{classfastapi_1_1applications_1_1_fast_a_p_i}{Fast\+API}}()
\item 
\mbox{\hyperlink{namespacemain_a0cf58d9b4a444874a8cf80fdf162b0fb}{host}}
\item 
\mbox{\hyperlink{namespacemain_a12fac67ac230690557ab76d3faa71d8c}{port}}
\item 
\mbox{\hyperlink{namespacemain_a9d9c0f06ea285d6128fdce786fa66851}{shutdown\+\_\+event}} = asyncio.\+Event()
\item 
list \mbox{\hyperlink{namespacemain_aa530773ea5df6edbdc7807a0eaa51773}{running\+\_\+tasks}} = \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Descripción detallada}
\begin{DoxyVerb}    @file main.py
    @brief Punto de entrada y configuración de la aplicación FastAPI para micro_gestion_objetos.
    @details
    Define la aplicación FastAPI, registra routers, y configura el servidor ASGI.
    Este microservicio gestiona el ciclo de vida de objetos inteligentes:
    creación, consultas de estado, envío de datos, y comunicación con datastreams.
    
    @author  NexTech
    @version 1.0.0
    @date 2025-01-10
    
    @see objeto_controller Para endpoints REST
    @see ObjetoService Para lógica de negocio
\end{DoxyVerb}


\begin{DoxyVerb}    @file main.py
    @brief Punto de entrada para micro_gestion_conocimiento.
    @details Gestiona ontologías OWL, consultas SPARQL, y reglas ECA.
    @version 1.0.0
\end{DoxyVerb}


\begin{DoxyVerb} * @file main.py
 * @brief Punto de entrada principal del Microservicio de Datastreams (Microdot)
 * @details
 * Servicio responsable de gestionar datastreams de objetos inteligentes usando Microdot framework (MicroPython).
 * 
 * Funcionalidades principales:
 * - Servidor HTTP asincrónico basado en Microdot
 * - Gestión de datastreams (sensores y actuadores)
 * - Publicación periódica de telemetría a ThingBoard y Mosquitto
 * - Consumo de mensajes MQTT para inicialización y actuaciones
 * - Cierre seguro con manejo de señales UNIX
 * - Soporte para WiFi en dispositivos ESP32
 * 
 * @see routes/datastreams.py para definición de endpoints
 * @see services/datastream_service.py para lógica de negocio
 * @see config.py para configuración del servicio
 * 
 * @author Sistema de Objetos Inteligentes
 * @version 1.0.0
 * @date 2024
\end{DoxyVerb}
 

\label{doc-func-members}
\Hypertarget{namespacemain_doc-func-members}
\doxysubsection{Documentación de funciones}
\Hypertarget{namespacemain_a79124365d1c83d2112cc071a29831386}\index{main@{main}!conectar\_wifi@{conectar\_wifi}}
\index{conectar\_wifi@{conectar\_wifi}!main@{main}}
\doxysubsubsection{\texorpdfstring{conectar\_wifi()}{conectar\_wifi()}}
{\footnotesize\ttfamily \label{namespacemain_a79124365d1c83d2112cc071a29831386} 
main.\+conectar\+\_\+wifi (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Definición en la línea \mbox{\hyperlink{microservicio__data__stream_2main_8py_source_l00054}{54}} del archivo \mbox{\hyperlink{microservicio__data__stream_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_a4b0afba9bb946ff70defaa002c1f41e2}\index{main@{main}!lifespan@{lifespan}}
\index{lifespan@{lifespan}!main@{main}}
\doxysubsubsection{\texorpdfstring{lifespan()}{lifespan()}}
{\footnotesize\ttfamily \label{namespacemain_a4b0afba9bb946ff70defaa002c1f41e2} 
main.\+lifespan (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classfastapi_1_1applications_1_1_fast_a_p_i}{Fast\+API}}}]{app}{}\end{DoxyParamCaption})}



Definición en la línea \mbox{\hyperlink{micro__automatizacion__ecas_2app_2main_8py_source_l00012}{12}} del archivo \mbox{\hyperlink{micro__automatizacion__ecas_2app_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_a3140e9a5b6a71ffbf498198cfc471b88}\index{main@{main}!main@{main}}
\index{main@{main}!main@{main}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{namespacemain_a3140e9a5b6a71ffbf498198cfc471b88} 
main.\+main (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

\begin{DoxyVerb} * @brief Función principal que inicializa y ejecuta el servidor Microdot
 * @details
 * Secuencia de inicialización:
 * 1. Imprime configuración del servicio (HOST, PORT, OSID, TITLE)
 * 2. Registra manejadores de señales UNIX (SIGINT, SIGTERM) para shutdown seguro
 * 3. Inicia servidor Microdot asincrónico
 * 4. Si OSID está configurado:
 *    - Publica telemetría periódicamente a ThingBoard (si token disponible)
 *    - Publica telemetría periódicamente a Mosquitto
 * 5. Si OSID no está configurado: espera mensajes MQTT de inicialización
 * 6. Aguarda evento de shutdown
 * 
 * @return void (async)
 * @see shutdown() función invocada en cierre
 * @see Config configuración centralizada
 * @see publicar_valores tarea de publicación periódica
 * @see consumer_mqtt consumidor de mensajes de inicialización
\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{microservicio__data__stream_2main_8py_source_l00116}{116}} del archivo \mbox{\hyperlink{microservicio__data__stream_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_ae435cbc6ee0c9077a8ed5c42a77b49d5}\index{main@{main}!redirect\_to\_docs@{redirect\_to\_docs}}
\index{redirect\_to\_docs@{redirect\_to\_docs}!main@{main}}
\doxysubsubsection{\texorpdfstring{redirect\_to\_docs()}{redirect\_to\_docs()}}
{\footnotesize\ttfamily \label{namespacemain_ae435cbc6ee0c9077a8ed5c42a77b49d5} 
main.\+redirect\+\_\+to\+\_\+docs (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Redirige raíz a documentación Swagger. 

\begin{DoxyVerb}    @brief Redirige raíz a documentación Swagger.
    
    @return RedirectResponse a /docs.
\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{micro__gestion__objetos_2app_2main_8py_source_l00034}{34}} del archivo \mbox{\hyperlink{micro__gestion__objetos_2app_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_a5e8523353d7c034328ad494a0cacb6eb}\index{main@{main}!route@{route}}
\index{route@{route}!main@{main}}
\doxysubsubsection{\texorpdfstring{route()}{route()}}
{\footnotesize\ttfamily \label{namespacemain_a5e8523353d7c034328ad494a0cacb6eb} 
main.\+route (\begin{DoxyParamCaption}\item[{Request}]{request}{, }\item[{str}]{path\+\_\+name}{, }\item[{APIRouter }]{api\+\_\+router}{ = {\ttfamily Depends(APIRouter)}}\end{DoxyParamCaption})}



Definición en la línea \mbox{\hyperlink{gateway_2app_2main_8py_source_l00007}{7}} del archivo \mbox{\hyperlink{gateway_2app_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_a799b0d523414a91d4d3924ae19ec6e0f}\index{main@{main}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!main@{main}}
\doxysubsubsection{\texorpdfstring{shutdown()}{shutdown()}}
{\footnotesize\ttfamily \label{namespacemain_a799b0d523414a91d4d3924ae19ec6e0f} 
main.\+shutdown (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

\begin{DoxyVerb} * @brief Maneja el cierre seguro del servidor Microdot
 * @details
 * Coordina la detención ordenada de:
 * 1. Event loop - propaga shutdown_event
 * 2. Tareas asyncio - cancela todas las tareas en running_tasks
 * 3. Conexiones MQTT - cierra clientes mosquitto y ThingBoard
 * 4. Servidor HTTP - detiene Microdot
 * 
 * @return void
 * @see running_tasks lista de tareas en ejecución
 * @see mosquitto_broker cliente MQTT Mosquitto
 * @see tb_broker cliente MQTT ThingBoard
\end{DoxyVerb}


\begin{DoxyVerb}Maneja el cierre seguro del servidor\end{DoxyVerb}
 

Definición en la línea \mbox{\hyperlink{microservicio__data__stream_2main_8py_source_l00063}{63}} del archivo \mbox{\hyperlink{microservicio__data__stream_2main_8py_source}{main.\+py}}.



\label{doc-var-members}
\Hypertarget{namespacemain_doc-var-members}
\doxysubsection{Documentación de variables}
\Hypertarget{namespacemain_a5fa94f0581009434c7a63791944d6ff4}\index{main@{main}!app@{app}}
\index{app@{app}!main@{main}}
\doxysubsubsection{\texorpdfstring{app}{app}}
{\footnotesize\ttfamily \label{namespacemain_a5fa94f0581009434c7a63791944d6ff4} 
main.\+app = \mbox{\hyperlink{classfastapi_1_1applications_1_1_fast_a_p_i}{Fast\+API}}()}



Definición en la línea \mbox{\hyperlink{gateway_2app_2main_8py_source_l00004}{4}} del archivo \mbox{\hyperlink{gateway_2app_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_a0cf58d9b4a444874a8cf80fdf162b0fb}\index{main@{main}!host@{host}}
\index{host@{host}!main@{main}}
\doxysubsubsection{\texorpdfstring{host}{host}}
{\footnotesize\ttfamily \label{namespacemain_a0cf58d9b4a444874a8cf80fdf162b0fb} 
main.\+host}



Definición en la línea \mbox{\hyperlink{gateway_2app_2main_8py_source_l00024}{24}} del archivo \mbox{\hyperlink{gateway_2app_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_a12fac67ac230690557ab76d3faa71d8c}\index{main@{main}!port@{port}}
\index{port@{port}!main@{main}}
\doxysubsubsection{\texorpdfstring{port}{port}}
{\footnotesize\ttfamily \label{namespacemain_a12fac67ac230690557ab76d3faa71d8c} 
main.\+port}



Definición en la línea \mbox{\hyperlink{gateway_2app_2main_8py_source_l00025}{25}} del archivo \mbox{\hyperlink{gateway_2app_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_aa530773ea5df6edbdc7807a0eaa51773}\index{main@{main}!running\_tasks@{running\_tasks}}
\index{running\_tasks@{running\_tasks}!main@{main}}
\doxysubsubsection{\texorpdfstring{running\_tasks}{running\_tasks}}
{\footnotesize\ttfamily \label{namespacemain_aa530773ea5df6edbdc7807a0eaa51773} 
list main.\+running\+\_\+tasks = \mbox{[}$\,$\mbox{]}}



Definición en la línea \mbox{\hyperlink{microservicio__data__stream_2main_8py_source_l00051}{51}} del archivo \mbox{\hyperlink{microservicio__data__stream_2main_8py_source}{main.\+py}}.

\Hypertarget{namespacemain_a9d9c0f06ea285d6128fdce786fa66851}\index{main@{main}!shutdown\_event@{shutdown\_event}}
\index{shutdown\_event@{shutdown\_event}!main@{main}}
\doxysubsubsection{\texorpdfstring{shutdown\_event}{shutdown\_event}}
{\footnotesize\ttfamily \label{namespacemain_a9d9c0f06ea285d6128fdce786fa66851} 
main.\+shutdown\+\_\+event = asyncio.\+Event()}



Definición en la línea \mbox{\hyperlink{microservicio__data__stream_2main_8py_source_l00050}{50}} del archivo \mbox{\hyperlink{microservicio__data__stream_2main_8py_source}{main.\+py}}.

