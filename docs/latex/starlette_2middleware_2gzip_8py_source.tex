\doxysection{gzip.\+py}
\hypertarget{starlette_2middleware_2gzip_8py_source}{}\label{starlette_2middleware_2gzip_8py_source}\index{micro\_gestion\_objetos/venv/Lib/site-\/packages/starlette/middleware/gzip.py@{micro\_gestion\_objetos/venv/Lib/site-\/packages/starlette/middleware/gzip.py}}
\mbox{\hyperlink{starlette_2middleware_2gzip_8py}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00001}\mbox{\hyperlink{namespacestarlette_1_1middleware_1_1gzip}{00001}}\ \textcolor{keyword}{import}\ gzip}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00002}00002\ \textcolor{keyword}{import}\ io}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00003}00003\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ NoReturn}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1datastructures}{starlette.datastructures}}\ \textcolor{keyword}{import}\ Headers,\ MutableHeaders}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacestarlette_1_1types}{starlette.types}}\ \textcolor{keyword}{import}\ ASGIApp,\ Message,\ Receive,\ Scope,\ Send}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00008}\mbox{\hyperlink{namespacestarlette_1_1middleware_1_1gzip_ae643f9f000ef4af87e3920f69d9d91c2}{00008}}\ DEFAULT\_EXCLUDED\_CONTENT\_TYPES\ =\ (\textcolor{stringliteral}{"{}text/event-\/stream"{}},)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00011}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware}{00011}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware}{GZipMiddleware}}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00012}00012\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ app:\ ASGIApp,\ minimum\_size:\ int\ =\ 500,\ compresslevel:\ int\ =\ 9)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00013}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ab8e3e3bdb47428caed83721a69b765ba}{00013}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ab8e3e3bdb47428caed83721a69b765ba}{app}}\ =\ app}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00014}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ae3d39cc61c087a682d5d7f0bf1c68d42}{00014}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ae3d39cc61c087a682d5d7f0bf1c68d42}{minimum\_size}}\ =\ minimum\_size}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00015}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_a249da91459d379f956861ea01971da51}{00015}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_a249da91459d379f956861ea01971da51}{compresslevel}}\ =\ compresslevel}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00017}00017\ \ \ \ \ \textcolor{keyword}{async\ def\ }\_\_call\_\_(self,\ scope:\ Scope,\ receive:\ Receive,\ send:\ Send)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ scope[\textcolor{stringliteral}{"{}type"{}}]\ !=\ \textcolor{stringliteral}{"{}http"{}}:\ \ \textcolor{comment}{\#\ pragma:\ no\ cover}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ab8e3e3bdb47428caed83721a69b765ba}{app}}(scope,\ receive,\ send)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ headers\ =\ \mbox{\hyperlink{classstarlette_1_1datastructures_1_1_headers}{Headers}}(scope=scope)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ responder:\ ASGIApp}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}gzip"{}}\ \textcolor{keywordflow}{in}\ headers.get(\textcolor{stringliteral}{"{}Accept-\/Encoding"{}},\ \textcolor{stringliteral}{"{}"{}}):}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ responder\ =\ \mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder}{GZipResponder}}(self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ab8e3e3bdb47428caed83721a69b765ba}{app}},\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ae3d39cc61c087a682d5d7f0bf1c68d42}{minimum\_size}},\ compresslevel=self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_a249da91459d379f956861ea01971da51}{compresslevel}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ responder\ =\ \mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder}{IdentityResponder}}(self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ab8e3e3bdb47428caed83721a69b765ba}{app}},\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_middleware_ae3d39cc61c087a682d5d7f0bf1c68d42}{minimum\_size}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ await\ responder(scope,\ receive,\ send)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00032}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder}{00032}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder}{IdentityResponder}}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00033}00033\ \ \ \ \ content\_encoding:\ str}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00035}00035\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ app:\ ASGIApp,\ minimum\_size:\ int)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00036}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_acadfeffebb9efedb73dc682be6077b5f}{00036}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_acadfeffebb9efedb73dc682be6077b5f}{app}}\ =\ app}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00037}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abd33e0783549662b0668c10fd2cfdf68}{00037}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abd33e0783549662b0668c10fd2cfdf68}{minimum\_size}}\ =\ minimum\_size}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00038}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{00038}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}:\ Send\ =\ unattached\_send}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00039}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{00039}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}}:\ Message\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00040}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af734c49dac23def8ad6540e7c3e24ff8}{00040}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af734c49dac23def8ad6540e7c3e24ff8}{started}}\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00041}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a7bd103edd4cdf37e0f971800283b582b}{00041}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a7bd103edd4cdf37e0f971800283b582b}{content\_encoding\_set}}\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00042}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_ab0365865d2d945cd520569f78dc252af}{00042}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_ab0365865d2d945cd520569f78dc252af}{content\_type\_is\_excluded}}\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00044}00044\ \ \ \ \ \textcolor{keyword}{async\ def\ }\_\_call\_\_(self,\ scope:\ Scope,\ receive:\ Receive,\ send:\ Send)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}\ =\ send}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00046}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af5cb93aa480806bb35fdaf11b7dc616f}{00046}}\ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_acadfeffebb9efedb73dc682be6077b5f}{app}}(scope,\ receive,\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af5cb93aa480806bb35fdaf11b7dc616f}{send\_with\_compression}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00048}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a02bd71faf4638c4ec2b8cfa8524df8b1}{00048}}\ \ \ \ \ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af5cb93aa480806bb35fdaf11b7dc616f}{send\_with\_compression}}(self,\ message:\ Message)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ message\_type\ =\ message[\textcolor{stringliteral}{"{}type"{}}]}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ message\_type\ ==\ \textcolor{stringliteral}{"{}http.response.start"{}}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Don't\ send\ the\ initial\ message\ until\ we've\ determined\ how\ to}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ modify\ the\ outgoing\ headers\ correctly.}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}}\ =\ message}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ headers\ =\ \mbox{\hyperlink{classstarlette_1_1datastructures_1_1_headers}{Headers}}(raw=self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}}[\textcolor{stringliteral}{"{}headers"{}}])}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a7bd103edd4cdf37e0f971800283b582b}{content\_encoding\_set}}\ =\ \textcolor{stringliteral}{"{}content-\/encoding"{}}\ \textcolor{keywordflow}{in}\ headers}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_ab0365865d2d945cd520569f78dc252af}{content\_type\_is\_excluded}}\ =\ headers.get(\textcolor{stringliteral}{"{}content-\/type"{}},\ \textcolor{stringliteral}{"{}"{}}).startswith(DEFAULT\_EXCLUDED\_CONTENT\_TYPES)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ message\_type\ ==\ \textcolor{stringliteral}{"{}http.response.body"{}}\ \textcolor{keywordflow}{and}\ (self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a7bd103edd4cdf37e0f971800283b582b}{content\_encoding\_set}}\ \textcolor{keywordflow}{or}\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_ab0365865d2d945cd520569f78dc252af}{content\_type\_is\_excluded}}):}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af734c49dac23def8ad6540e7c3e24ff8}{started}}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af734c49dac23def8ad6540e7c3e24ff8}{started}}\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(message)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ message\_type\ ==\ \textcolor{stringliteral}{"{}http.response.body"{}}\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af734c49dac23def8ad6540e7c3e24ff8}{started}}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_af734c49dac23def8ad6540e7c3e24ff8}{started}}\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ body\ =\ message.get(\textcolor{stringliteral}{"{}body"{}},\ b\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ more\_body\ =\ message.get(\textcolor{stringliteral}{"{}more\_body"{}},\ \textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(body)\ <\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abd33e0783549662b0668c10fd2cfdf68}{minimum\_size}}\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ more\_body:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Don't\ apply\ compression\ to\ small\ outgoing\ responses.}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(message)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{keywordflow}{not}\ more\_body:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Standard\ response.}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ body\ =\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a3256713e974fffad6ac662a00b391e06}{apply\_compression}}(body,\ more\_body=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headers\ =\ \mbox{\hyperlink{classstarlette_1_1datastructures_1_1_mutable_headers}{MutableHeaders}}(raw=self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}}[\textcolor{stringliteral}{"{}headers"{}}])}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headers.add\_vary\_header(\textcolor{stringliteral}{"{}Accept-\/Encoding"{}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ body\ !=\ message[\textcolor{stringliteral}{"{}body"{}}]:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headers[\textcolor{stringliteral}{"{}Content-\/Encoding"{}}]\ =\ self.content\_encoding}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headers[\textcolor{stringliteral}{"{}Content-\/Length"{}}]\ =\ str(len(body))}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message[\textcolor{stringliteral}{"{}body"{}}]\ =\ body}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(message)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Initial\ body\ in\ streaming\ response.}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ body\ =\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a3256713e974fffad6ac662a00b391e06}{apply\_compression}}(body,\ more\_body=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headers\ =\ \mbox{\hyperlink{classstarlette_1_1datastructures_1_1_mutable_headers}{MutableHeaders}}(raw=self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}}[\textcolor{stringliteral}{"{}headers"{}}])}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headers.add\_vary\_header(\textcolor{stringliteral}{"{}Accept-\/Encoding"{}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ body\ !=\ message[\textcolor{stringliteral}{"{}body"{}}]:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headers[\textcolor{stringliteral}{"{}Content-\/Encoding"{}}]\ =\ self.content\_encoding}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ headers[\textcolor{stringliteral}{"{}Content-\/Length"{}}]}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message[\textcolor{stringliteral}{"{}body"{}}]\ =\ body}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(message)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ message\_type\ ==\ \textcolor{stringliteral}{"{}http.response.body"{}}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Remaining\ body\ in\ streaming\ response.}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ body\ =\ message.get(\textcolor{stringliteral}{"{}body"{}},\ b\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ more\_body\ =\ message.get(\textcolor{stringliteral}{"{}more\_body"{}},\ \textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ message[\textcolor{stringliteral}{"{}body"{}}]\ =\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a3256713e974fffad6ac662a00b391e06}{apply\_compression}}(body,\ more\_body=more\_body)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(message)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ message\_type\ ==\ \textcolor{stringliteral}{"{}http.response.pathsend"{}}:\ \ \textcolor{comment}{\#\ pragma:\ no\ branch}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Don't\ apply\ GZip\ to\ pathsend\ responses}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_abe6edf57c333499b5af6f3ac28b57a0e}{initial\_message}})}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ await\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a46bdf34d56bf1c2024011c26087f774a}{send}}(message)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00109}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a3256713e974fffad6ac662a00b391e06}{00109}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder_a3256713e974fffad6ac662a00b391e06}{apply\_compression}}(self,\ body:\ bytes,\ *,\ more\_body:\ bool)\ -\/>\ bytes:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Apply\ compression\ on\ the\ response\ body.}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00111}00111\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ more\_body\ is\ False,\ any\ compression\ file\ should\ be\ closed.\ If\ it}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00113}00113\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ isn't,\ it\ won't\ be\ closed\ automatically\ until\ all\ background\ tasks}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ complete.}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ body}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00119}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder}{00119}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder}{GZipResponder}}(\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_identity_responder}{IdentityResponder}}):}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00120}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_afd72acd532bf3e956d89639fcddf5dbb}{00120}}\ \ \ \ \ content\_encoding\ =\ \textcolor{stringliteral}{"{}gzip"{}}}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00122}00122\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ app:\ ASGIApp,\ minimum\_size:\ int,\ compresslevel:\ int\ =\ 9)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(app,\ minimum\_size)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00125}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_a2d6fb228df155e0c713f201bd8e05f8a}{00125}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_a2d6fb228df155e0c713f201bd8e05f8a}{gzip\_buffer}}\ =\ io.BytesIO()}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00126}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_ad9dfff8b88f2d3b876a03829d139a52a}{00126}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_ad9dfff8b88f2d3b876a03829d139a52a}{gzip\_file}}\ =\ gzip.GzipFile(mode=\textcolor{stringliteral}{"{}wb"{}},\ fileobj=self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_a2d6fb228df155e0c713f201bd8e05f8a}{gzip\_buffer}},\ compresslevel=compresslevel)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00128}00128\ \ \ \ \ \textcolor{keyword}{async\ def\ }\_\_call\_\_(self,\ scope:\ Scope,\ receive:\ Receive,\ send:\ Send)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_a2d6fb228df155e0c713f201bd8e05f8a}{gzip\_buffer}},\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_ad9dfff8b88f2d3b876a03829d139a52a}{gzip\_file}}:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ await\ super().\_\_call\_\_(scope,\ receive,\ send)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00132}\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_ad14bbf25590eb381b83d5307d3fe0de6}{00132}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_ad14bbf25590eb381b83d5307d3fe0de6}{apply\_compression}}(self,\ body:\ bytes,\ *,\ more\_body:\ bool)\ -\/>\ bytes:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_ad9dfff8b88f2d3b876a03829d139a52a}{gzip\_file}}.write(body)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ more\_body:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_ad9dfff8b88f2d3b876a03829d139a52a}{gzip\_file}}.close()}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ body\ =\ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_a2d6fb228df155e0c713f201bd8e05f8a}{gzip\_buffer}}.getvalue()}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_a2d6fb228df155e0c713f201bd8e05f8a}{gzip\_buffer}}.seek(0)}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classstarlette_1_1middleware_1_1gzip_1_1_g_zip_responder_a2d6fb228df155e0c713f201bd8e05f8a}{gzip\_buffer}}.truncate()}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ body}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00144}\mbox{\hyperlink{namespacestarlette_1_1middleware_1_1gzip_a9e0c81562a880e834878c9cfa1597bb6}{00144}}\ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{namespacestarlette_1_1middleware_1_1gzip_a9e0c81562a880e834878c9cfa1597bb6}{unattached\_send}}(message:\ Message)\ -\/>\ NoReturn:}
\DoxyCodeLine{\Hypertarget{starlette_2middleware_2gzip_8py_source_l00145}00145\ \ \ \ \ \textcolor{keywordflow}{raise}\ RuntimeError(\textcolor{stringliteral}{"{}send\ awaitable\ not\ set"{}})\ \ \textcolor{comment}{\#\ pragma:\ no\ cover}}

\end{DoxyCode}
